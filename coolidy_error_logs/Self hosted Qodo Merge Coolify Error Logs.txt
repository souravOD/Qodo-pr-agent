2025-Dec-11 07:23:28.307342
[2025-12-11 07:23:28 +0000] [1] [INFO] Listening at: http://0.0.0.0:3000 (1)
2025-Dec-11 07:23:28.307355
[2025-12-11 07:23:28 +0000] [1] [INFO] Using worker: uvicorn.workers.UvicornWorker
2025-Dec-11 07:23:28.312599
[2025-12-11 07:23:28 +0000] [7] [INFO] Booting worker with pid: 7
2025-Dec-11 07:23:28.324073
[2025-12-11 07:23:28 +0000] [8] [INFO] Booting worker with pid: 8
2025-Dec-11 07:23:28.387915
[2025-12-11 07:23:28 +0000] [9] [INFO] Booting worker with pid: 9
2025-Dec-11 07:23:28.409598
[2025-12-11 07:23:28 +0000] [10] [INFO] Booting worker with pid: 10
2025-Dec-11 07:23:28.477440
[2025-12-11 07:23:28 +0000] [11] [INFO] Booting worker with pid: 11
2025-Dec-11 07:23:28.541181
[2025-12-11 07:23:28 +0000] [12] [INFO] Booting worker with pid: 12
2025-Dec-11 07:23:28.601172
[2025-12-11 07:23:28 +0000] [13] [INFO] Booting worker with pid: 13
2025-Dec-11 07:23:28.631482
[2025-12-11 07:23:28 +0000] [14] [INFO] Booting worker with pid: 14
2025-Dec-11 07:23:28.730044
[2025-12-11 07:23:28 +0000] [15] [INFO] Booting worker with pid: 15
2025-Dec-11 07:23:28.805087
[2025-12-11 07:23:28 +0000] [16] [INFO] Booting worker with pid: 16
2025-Dec-11 07:23:28.881991
[2025-12-11 07:23:28 +0000] [17] [INFO] Booting worker with pid: 17
2025-Dec-11 07:23:28.970964
[2025-12-11 07:23:28 +0000] [18] [INFO] Booting worker with pid: 18
2025-Dec-11 07:23:29.036910
[2025-12-11 07:23:29 +0000] [19] [INFO] Booting worker with pid: 19
2025-Dec-11 07:23:29.054767
[2025-12-11 07:23:29 +0000] [20] [INFO] Booting worker with pid: 20
2025-Dec-11 07:23:29.084780
[2025-12-11 07:23:29 +0000] [21] [INFO] Booting worker with pid: 21
2025-Dec-11 07:23:29.136830
[2025-12-11 07:23:29 +0000] [22] [INFO] Booting worker with pid: 22
2025-Dec-11 07:23:29.226183
[2025-12-11 07:23:29 +0000] [23] [INFO] Booting worker with pid: 23
2025-Dec-11 07:23:29.254582
[2025-12-11 07:23:29 +0000] [24] [INFO] Booting worker with pid: 24
2025-Dec-11 07:23:29.304303
[2025-12-11 07:23:29 +0000] [25] [INFO] Booting worker with pid: 25
2025-Dec-11 07:23:29.319388
[2025-12-11 07:23:29 +0000] [26] [INFO] Booting worker with pid: 26
2025-Dec-11 07:23:29.394450
[2025-12-11 07:23:29 +0000] [27] [INFO] Booting worker with pid: 27
2025-Dec-11 07:23:29.506010
[2025-12-11 07:23:29 +0000] [28] [INFO] Booting worker with pid: 28
2025-Dec-11 07:23:29.560537
[2025-12-11 07:23:29 +0000] [29] [INFO] Booting worker with pid: 29
2025-Dec-11 07:23:29.616231
[2025-12-11 07:23:29 +0000] [30] [INFO] Booting worker with pid: 30
2025-Dec-11 07:23:29.641977
[2025-12-11 07:23:29 +0000] [31] [INFO] Booting worker with pid: 31
2025-Dec-11 07:23:38.784760
/usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-Dec-11 07:23:38.784862
import pkg_resources
2025-Dec-11 07:23:39.755682
/usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-Dec-11 07:23:39.755730
import pkg_resources
2025-Dec-11 07:23:39.848765
/usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-Dec-11 07:23:39.848834
import pkg_resources
2025-Dec-11 07:23:40.124147
2025-12-11 07:23:40.123 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-Dec-11 07:23:40.126944
2025-12-11 07:23:40.125 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-Dec-11 07:23:40.144269
/usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-Dec-11 07:23:40.144291
import pkg_resources
2025-Dec-11 07:23:40.278205
/usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-Dec-11 07:23:40.278242
import pkg_resources
2025-Dec-11 07:23:40.364784
/usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-Dec-11 07:23:40.364840
import pkg_resources
2025-Dec-11 07:23:40.425942
/usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-Dec-11 07:23:40.425979
import pkg_resources
2025-Dec-11 07:23:40.441236
/usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-Dec-11 07:23:40.441267
import pkg_resources
2025-Dec-11 07:23:40.727444
2025-12-11 07:23:40.724 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-Dec-11 07:23:40.727502
2025-12-11 07:23:40.725 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-Dec-11 07:23:40.858193
/usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-Dec-11 07:23:40.858235
import pkg_resources
2025-Dec-11 07:23:40.870850
/usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-Dec-11 07:23:40.870881
import pkg_resources
2025-Dec-11 07:23:40.894793
2025-12-11 07:23:40.894 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-Dec-11 07:23:40.894984
2025-12-11 07:23:40.894 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-Dec-11 07:23:40.948029
2025-12-11 07:23:40.943 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-Dec-11 07:23:40.948071
2025-12-11 07:23:40.944 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-Dec-11 07:23:41.182615
[2025-12-11 07:23:41 +0000] [16] [INFO] Started server process [16]
2025-Dec-11 07:23:41.182667
[2025-12-11 07:23:41 +0000] [16] [INFO] Waiting for application startup.
2025-Dec-11 07:23:41.182970
[2025-12-11 07:23:41 +0000] [16] [INFO] Application startup complete.
2025-Dec-11 07:23:41.188155
2025-12-11 07:23:41.187 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-Dec-11 07:23:41.192257
2025-12-11 07:23:41.191 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-Dec-11 07:23:41.200719
[2025-12-11 07:23:41 +0000] [14] [INFO] Started server process [14]
2025-Dec-11 07:23:41.200988
[2025-12-11 07:23:41 +0000] [14] [INFO] Waiting for application startup.
2025-Dec-11 07:23:41.201042
[2025-12-11 07:23:41 +0000] [14] [INFO] Application startup complete.
2025-Dec-11 07:23:41.216729
2025-12-11 07:23:41.216 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-Dec-11 07:23:41.216897
2025-12-11 07:23:41.216 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-Dec-11 07:23:41.267996
2025-12-11 07:23:41.267 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-Dec-11 07:23:41.268057
2025-12-11 07:23:41.267 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-Dec-11 07:23:41.274233
[2025-12-11 07:23:41 +0000] [23] [INFO] Started server process [23]
2025-Dec-11 07:23:41.274261
[2025-12-11 07:23:41 +0000] [23] [INFO] Waiting for application startup.
2025-Dec-11 07:23:41.278893
[2025-12-11 07:23:41 +0000] [23] [INFO] Application startup complete.
2025-Dec-11 07:23:41.381654
[2025-12-11 07:23:41 +0000] [19] [INFO] Started server process [19]
2025-Dec-11 07:23:41.382088
[2025-12-11 07:23:41 +0000] [19] [INFO] Waiting for application startup.
2025-Dec-11 07:23:41.382471
[2025-12-11 07:23:41 +0000] [19] [INFO] Application startup complete.
2025-Dec-11 07:23:41.396295
[2025-12-11 07:23:41 +0000] [28] [INFO] Started server process [28]
2025-Dec-11 07:23:41.396340
[2025-12-11 07:23:41 +0000] [28] [INFO] Waiting for application startup.
2025-Dec-11 07:23:41.396344
[2025-12-11 07:23:41 +0000] [28] [INFO] Application startup complete.
2025-Dec-11 07:23:41.428280
/usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-Dec-11 07:23:41.428319
import pkg_resources
2025-Dec-11 07:23:41.458629
[2025-12-11 07:23:41 +0000] [17] [INFO] Started server process [17]
2025-Dec-11 07:23:41.458689
[2025-12-11 07:23:41 +0000] [17] [INFO] Waiting for application startup.
2025-Dec-11 07:23:41.459682
[2025-12-11 07:23:41 +0000] [17] [INFO] Application startup complete.
2025-Dec-11 07:23:41.487999
[2025-12-11 07:23:41 +0000] [18] [INFO] Started server process [18]
2025-Dec-11 07:23:41.488651
[2025-12-11 07:23:41 +0000] [18] [INFO] Waiting for application startup.
2025-Dec-11 07:23:41.488658
[2025-12-11 07:23:41 +0000] [18] [INFO] Application startup complete.
2025-Dec-11 07:23:41.518063
/usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-Dec-11 07:23:41.518156
import pkg_resources
2025-Dec-11 07:23:41.534191
2025-12-11 07:23:41.533 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-Dec-11 07:23:41.535933
2025-12-11 07:23:41.534 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-Dec-11 07:23:41.599918
2025-12-11 07:23:41.599 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-Dec-11 07:23:41.600095
2025-12-11 07:23:41.599 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-Dec-11 07:23:41.613422
/usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-Dec-11 07:23:41.613460
import pkg_resources
2025-Dec-11 07:23:41.635535
/usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-Dec-11 07:23:41.635576
import pkg_resources
2025-Dec-11 07:23:41.719620
/usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-Dec-11 07:23:41.719661
import pkg_resources
2025-Dec-11 07:23:41.720205
[2025-12-11 07:23:41 +0000] [13] [INFO] Started server process [13]
2025-Dec-11 07:23:41.723054
[2025-12-11 07:23:41 +0000] [13] [INFO] Waiting for application startup.
2025-Dec-11 07:23:41.723492
[2025-12-11 07:23:41 +0000] [13] [INFO] Application startup complete.
2025-Dec-11 07:23:41.741868
[2025-12-11 07:23:41 +0000] [26] [INFO] Started server process [26]
2025-Dec-11 07:23:41.742391
[2025-12-11 07:23:41 +0000] [26] [INFO] Waiting for application startup.
2025-Dec-11 07:23:41.742403
[2025-12-11 07:23:41 +0000] [26] [INFO] Application startup complete.
2025-Dec-11 07:23:41.806873
/usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-Dec-11 07:23:41.807012
import pkg_resources
2025-Dec-11 07:23:41.913189
/usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-Dec-11 07:23:41.913258
import pkg_resources
2025-Dec-11 07:23:42.011085
2025-12-11 07:23:42.010 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-Dec-11 07:23:42.011116
2025-12-11 07:23:42.010 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-Dec-11 07:23:42.014273
2025-12-11 07:23:42.013 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-Dec-11 07:23:42.014473
2025-12-11 07:23:42.014 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-Dec-11 07:23:42.042999
/usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-Dec-11 07:23:42.043036
import pkg_resources
2025-Dec-11 07:23:42.152473
2025-12-11 07:23:42.151 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-Dec-11 07:23:42.153603
2025-12-11 07:23:42.152 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-Dec-11 07:23:42.178653
[2025-12-11 07:23:42 +0000] [7] [INFO] Started server process [7]
2025-Dec-11 07:23:42.179062
[2025-12-11 07:23:42 +0000] [7] [INFO] Waiting for application startup.
2025-Dec-11 07:23:42.179634
[2025-12-11 07:23:42 +0000] [7] [INFO] Application startup complete.
2025-Dec-11 07:23:42.197790
2025-12-11 07:23:42.197 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-Dec-11 07:23:42.198061
2025-12-11 07:23:42.197 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-Dec-11 07:23:42.201116
/usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-Dec-11 07:23:42.201172
import pkg_resources
2025-Dec-11 07:23:42.212546
[2025-12-11 07:23:42 +0000] [10] [INFO] Started server process [10]
2025-Dec-11 07:23:42.215129
[2025-12-11 07:23:42 +0000] [10] [INFO] Waiting for application startup.
2025-Dec-11 07:23:42.216248
[2025-12-11 07:23:42 +0000] [10] [INFO] Application startup complete.
2025-Dec-11 07:23:42.219563
/usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-Dec-11 07:23:42.219590
import pkg_resources
2025-Dec-11 07:23:42.233368
/usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-Dec-11 07:23:42.233420
import pkg_resources
2025-Dec-11 07:23:42.234298
/usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-Dec-11 07:23:42.234376
import pkg_resources
2025-Dec-11 07:23:42.241130
2025-12-11 07:23:42.240 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-Dec-11 07:23:42.241304
2025-12-11 07:23:42.241 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-Dec-11 07:23:42.292317
2025-12-11 07:23:42.291 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-Dec-11 07:23:42.292502
2025-12-11 07:23:42.292 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-Dec-11 07:23:42.294362
2025-12-11 07:23:42.293 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-Dec-11 07:23:42.294497
2025-12-11 07:23:42.294 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-Dec-11 07:23:42.296182
[2025-12-11 07:23:42 +0000] [15] [INFO] Started server process [15]
2025-Dec-11 07:23:42.296238
[2025-12-11 07:23:42 +0000] [15] [INFO] Waiting for application startup.
2025-Dec-11 07:23:42.296610
[2025-12-11 07:23:42 +0000] [15] [INFO] Application startup complete.
2025-Dec-11 07:23:42.329923
[2025-12-11 07:23:42 +0000] [25] [INFO] Started server process [25]
2025-Dec-11 07:23:42.329979
[2025-12-11 07:23:42 +0000] [25] [INFO] Waiting for application startup.
2025-Dec-11 07:23:42.330173
[2025-12-11 07:23:42 +0000] [25] [INFO] Application startup complete.
2025-Dec-11 07:23:42.395905
[2025-12-11 07:23:42 +0000] [20] [INFO] Started server process [20]
2025-Dec-11 07:23:42.395983
[2025-12-11 07:23:42 +0000] [20] [INFO] Waiting for application startup.
2025-Dec-11 07:23:42.396091
[2025-12-11 07:23:42 +0000] [20] [INFO] Application startup complete.
2025-Dec-11 07:23:42.419988
2025-12-11 07:23:42.418 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-Dec-11 07:23:42.420051
2025-12-11 07:23:42.418 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-Dec-11 07:23:42.422478
[2025-12-11 07:23:42 +0000] [22] [INFO] Started server process [22]
2025-Dec-11 07:23:42.422496
[2025-12-11 07:23:42 +0000] [22] [INFO] Waiting for application startup.
2025-Dec-11 07:23:42.422954
[2025-12-11 07:23:42 +0000] [22] [INFO] Application startup complete.
2025-Dec-11 07:23:42.427915
2025-12-11 07:23:42.427 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-Dec-11 07:23:42.428046
2025-12-11 07:23:42.427 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-Dec-11 07:23:42.444173
[2025-12-11 07:23:42 +0000] [9] [INFO] Started server process [9]
2025-Dec-11 07:23:42.444274
[2025-12-11 07:23:42 +0000] [9] [INFO] Waiting for application startup.
2025-Dec-11 07:23:42.444479
[2025-12-11 07:23:42 +0000] [9] [INFO] Application startup complete.
2025-Dec-11 07:23:42.486423
/usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-Dec-11 07:23:42.486470
import pkg_resources
2025-Dec-11 07:23:42.535353
[2025-12-11 07:23:42 +0000] [12] [INFO] Started server process [12]
2025-Dec-11 07:23:42.535416
[2025-12-11 07:23:42 +0000] [12] [INFO] Waiting for application startup.
2025-Dec-11 07:23:42.535640
[2025-12-11 07:23:42 +0000] [12] [INFO] Application startup complete.
2025-Dec-11 07:23:42.550938
[2025-12-11 07:23:42 +0000] [11] [INFO] Started server process [11]
2025-Dec-11 07:23:42.551001
[2025-12-11 07:23:42 +0000] [11] [INFO] Waiting for application startup.
2025-Dec-11 07:23:42.551005
[2025-12-11 07:23:42 +0000] [11] [INFO] Application startup complete.
2025-Dec-11 07:23:42.596502
2025-12-11 07:23:42.596 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-Dec-11 07:23:42.596693
2025-12-11 07:23:42.596 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-Dec-11 07:23:42.627473
2025-12-11 07:23:42.625 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-Dec-11 07:23:42.628287
2025-12-11 07:23:42.628 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-Dec-11 07:23:42.634577
2025-12-11 07:23:42.634 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-Dec-11 07:23:42.636722
2025-12-11 07:23:42.636 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-Dec-11 07:23:42.659971
/usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-Dec-11 07:23:42.660015
import pkg_resources
2025-Dec-11 07:23:42.682677
2025-12-11 07:23:42.682 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-Dec-11 07:23:42.682723
2025-12-11 07:23:42.682 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-Dec-11 07:23:42.726227
[2025-12-11 07:23:42 +0000] [31] [INFO] Started server process [31]
2025-Dec-11 07:23:42.726620
[2025-12-11 07:23:42 +0000] [31] [INFO] Waiting for application startup.
2025-Dec-11 07:23:42.726660
[2025-12-11 07:23:42 +0000] [31] [INFO] Application startup complete.
2025-Dec-11 07:23:42.742137
[2025-12-11 07:23:42 +0000] [8] [INFO] Started server process [8]
2025-Dec-11 07:23:42.742180
[2025-12-11 07:23:42 +0000] [8] [INFO] Waiting for application startup.
2025-Dec-11 07:23:42.742393
[2025-12-11 07:23:42 +0000] [8] [INFO] Application startup complete.
2025-Dec-11 07:23:42.747941
[2025-12-11 07:23:42 +0000] [30] [INFO] Started server process [30]
2025-Dec-11 07:23:42.747985
[2025-12-11 07:23:42 +0000] [30] [INFO] Waiting for application startup.
2025-Dec-11 07:23:42.748185
[2025-12-11 07:23:42 +0000] [30] [INFO] Application startup complete.
2025-Dec-11 07:23:42.767034
/usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-Dec-11 07:23:42.767086
import pkg_resources
2025-Dec-11 07:23:42.783065
[2025-12-11 07:23:42 +0000] [21] [INFO] Started server process [21]
2025-Dec-11 07:23:42.783122
[2025-12-11 07:23:42 +0000] [21] [INFO] Waiting for application startup.
2025-Dec-11 07:23:42.783286
[2025-12-11 07:23:42 +0000] [21] [INFO] Application startup complete.
2025-Dec-11 07:23:42.838305
2025-12-11 07:23:42.837 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-Dec-11 07:23:42.838406
2025-12-11 07:23:42.838 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-Dec-11 07:23:42.944892
[2025-12-11 07:23:42 +0000] [29] [INFO] Started server process [29]
2025-Dec-11 07:23:42.945069
[2025-12-11 07:23:42 +0000] [29] [INFO] Waiting for application startup.
2025-Dec-11 07:23:42.945123
[2025-12-11 07:23:42 +0000] [29] [INFO] Application startup complete.
2025-Dec-11 07:23:42.989663
2025-12-11 07:23:42.989 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-Dec-11 07:23:42.989799
2025-12-11 07:23:42.989 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-Dec-11 07:23:43.080675
2025-12-11 07:23:43.080 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-Dec-11 07:23:43.080730
2025-12-11 07:23:43.080 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-Dec-11 07:23:43.094996
[2025-12-11 07:23:43 +0000] [24] [INFO] Started server process [24]
2025-Dec-11 07:23:43.095026
[2025-12-11 07:23:43 +0000] [24] [INFO] Waiting for application startup.
2025-Dec-11 07:23:43.095348
[2025-12-11 07:23:43 +0000] [24] [INFO] Application startup complete.
2025-Dec-11 07:23:43.179236
[2025-12-11 07:23:43 +0000] [27] [INFO] Started server process [27]
2025-Dec-11 07:23:43.179270
[2025-12-11 07:23:43 +0000] [27] [INFO] Waiting for application startup.
2025-Dec-11 07:23:43.179490
[2025-12-11 07:23:43 +0000] [27] [INFO] Application startup complete.
2025-Dec-11 07:24:47.221729
{"text": "Received a GitHub webhook\n", "record": {"elapsed": {"repr": "0:01:05.046525", "seconds": 65.046525}, "exception": null, "extra": {}, "file": {"name": "github_app.py", "path": "/app/pr_agent/servers/github_app.py"}, "function": "handle_github_webhooks", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 45, "message": "Received a GitHub webhook", "module": "github_app", "name": "pr_agent.servers.github_app", "process": {"id": 30, "name": "MainProcess"}, "thread": {"id": 126091663866752, "name": "MainThread"}, "time": {"repr": "2025-12-11 07:24:47.221445+00:00", "timestamp": 1765437887.221445}}}
2025-Dec-11 07:24:47.237379
{"text": "Handling request with event: issue_comment, action: created\n", "record": {"elapsed": {"repr": "0:01:05.062209", "seconds": 65.062209}, "exception": null, "extra": {}, "file": {"name": "github_app.py", "path": "/app/pr_agent/servers/github_app.py"}, "function": "handle_request", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 321, "message": "Handling request with event: issue_comment, action: created", "module": "github_app", "name": "pr_agent.servers.github_app", "process": {"id": 30, "name": "MainProcess"}, "thread": {"id": 126091663866752, "name": "MainThread"}, "time": {"repr": "2025-12-11 07:24:47.237129+00:00", "timestamp": 1765437887.237129}}}
2025-Dec-11 07:24:47.238492
{"text": "Request body\n", "record": {"elapsed": {"repr": "0:01:05.063132", "seconds": 65.063132}, "exception": null, "extra": {"artifact": {"action": "created", "issue": {"url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/1", "repository_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend", "labels_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/1/labels{/name}", "comments_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/1/comments", "events_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/1/events", "html_url": "https://github.com/souravOD/nutri-b2c-frontend/pull/1", "id": 3527983986, "node_id": "PR_kwDOQEZhKM6uaI7J", "number": 1, "title": "Fix: Search UX and multi-filter logic (frontend)", "user": {"login": "NamanOdysseyts", "id": 238778617, "node_id": "U_kgDODjt4-Q", "avatar_url": "https://avatars.githubusercontent.com/u/238778617?v=4", "gravatar_id": "", "url": "https://api.github.com/users/NamanOdysseyts", "html_url": "https://github.com/NamanOdysseyts", "followers_url": "https://api.github.com/users/NamanOdysseyts/followers", "following_url": "https://api.github.com/users/NamanOdysseyts/following{/other_user}", "gists_url": "https://api.github.com/users/NamanOdysseyts/gists{/gist_id}", "starred_url": "https://api.github.com/users/NamanOdysseyts/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/NamanOdysseyts/subscriptions", "organizations_url": "https://api.github.com/users/NamanOdysseyts/orgs", "repos_url": "https://api.github.com/users/NamanOdysseyts/repos", "events_url": "https://api.github.com/users/NamanOdysseyts/events{/privacy}", "received_events_url": "https://api.github.com/users/NamanOdysseyts/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 9561404867, "node_id": "LA_kwDOQEZhKM8AAAACOed1ww", "url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/labels/Review%20effort%202/5", "name": "Review effort 2/5", "color": "d1bcf9", "default": false, "description": null}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 88, "created_at": "2025-10-18T02:45:21Z", "updated_at": "2025-12-11T07:24:46Z", "closed_at": null, "author_association": "COLLABORATOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "html_url": "https://github.com/souravOD/nutri-b2c-frontend/pull/1", "diff_url": "https://github.com/souravOD/nutri-b2c-frontend/pull/1.diff", "patch_url": "https://github.com/souravOD/nutri-b2c-frontend/pull/1.patch", "merged_at": null}, "body": "- Improved search bar UX in app/search/page.tsx:\r\n  - X icon clears input and refocuses\r\n  - Escape key clears input\r\n  - Enter key triggers search\r\n\r\n- Updated filter count logic:\r\n  - Accurately counts all active filters\r\n  - Apply button badge reflects true total", "reactions": {"url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/1/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/1/timeline", "performed_via_github_app": null, "state_reason": null}, "comment": {"url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/comments/3640600288", "html_url": "https://github.com/souravOD/nutri-b2c-frontend/pull/1#issuecomment-3640600288", "issue_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/1", "id": 3640600288, "node_id": "IC_kwDOQEZhKM7Y_ybg", "user": {"login": "souravOD", "id": 238303722, "node_id": "U_kgDODjQ56g", "avatar_url": "https://avatars.githubusercontent.com/u/238303722?v=4", "gravatar_id": "", "url": "https://api.github.com/users/souravOD", "html_url": "https://github.com/souravOD", "followers_url": "https://api.github.com/users/souravOD/followers", "following_url": "https://api.github.com/users/souravOD/following{/other_user}", "gists_url": "https://api.github.com/users/souravOD/gists{/gist_id}", "starred_url": "https://api.github.com/users/souravOD/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/souravOD/subscriptions", "organizations_url": "https://api.github.com/users/souravOD/orgs", "repos_url": "https://api.github.com/users/souravOD/repos", "events_url": "https://api.github.com/users/souravOD/events{/privacy}", "received_events_url": "https://api.github.com/users/souravOD/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "created_at": "2025-12-11T07:24:45Z", "updated_at": "2025-12-11T07:24:45Z", "body": "/review Can you please review this PR", "author_association": "OWNER", "reactions": {"url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/comments/3640600288/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "performed_via_github_app": null}, "repository": {"id": 1078354216, "node_id": "R_kgDOQEZhKA", "name": "nutri-b2c-frontend", "full_name": "souravOD/nutri-b2c-frontend", "private": false, "owner": {"login": "souravOD", "id": 238303722, "node_id": "U_kgDODjQ56g", "avatar_url": "https://avatars.githubusercontent.com/u/238303722?v=4", "gravatar_id": "", "url": "https://api.github.com/users/souravOD", "html_url": "https://github.com/souravOD", "followers_url": "https://api.github.com/users/souravOD/followers", "following_url": "https://api.github.com/users/souravOD/following{/other_user}", "gists_url": "https://api.github.com/users/souravOD/gists{/gist_id}", "starred_url": "https://api.github.com/users/souravOD/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/souravOD/subscriptions", "organizations_url": "https://api.github.com/users/souravOD/orgs", "repos_url": "https://api.github.com/users/souravOD/repos", "events_url": "https://api.github.com/users/souravOD/events{/privacy}", "received_events_url": "https://api.github.com/users/souravOD/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "html_url": "https://github.com/souravOD/nutri-b2c-frontend", "description": null, "fork": true, "url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend", "forks_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/forks", "keys_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/keys{/key_id}", "collaborators_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/collaborators{/collaborator}", "teams_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/teams", "hooks_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/hooks", "issue_events_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/events{/number}", "events_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/events", "assignees_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/assignees{/user}", "branches_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/branches{/branch}", "tags_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/tags", "blobs_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/git/blobs{/sha}", "git_tags_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/git/tags{/sha}", "git_refs_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/git/refs{/sha}", "trees_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/git/trees{/sha}", "statuses_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/statuses/{sha}", "languages_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/languages", "stargazers_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/stargazers", "contributors_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/contributors", "subscribers_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/subscribers", "subscription_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/subscription", "commits_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/commits{/sha}", "git_commits_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/git/commits{/sha}", "comments_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/comments{/number}", "issue_comment_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/comments{/number}", "contents_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/contents/{+path}", "compare_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/compare/{base}...{head}", "merges_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/merges", "archive_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/{archive_format}{/ref}", "downloads_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/downloads", "issues_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues{/number}", "pulls_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls{/number}", "milestones_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/milestones{/number}", "notifications_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/notifications{?since,all,participating}", "labels_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/labels{/name}", "releases_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/releases{/id}", "deployments_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/deployments", "created_at": "2025-10-17T15:44:00Z", "updated_at": "2025-11-14T04:02:00Z", "pushed_at": "2025-10-16T19:32:39Z", "git_url": "git://github.com/souravOD/nutri-b2c-frontend.git", "ssh_url": "git@github.com:souravOD/nutri-b2c-frontend.git", "clone_url": "https://github.com/souravOD/nutri-b2c-frontend.git", "svn_url": "https://github.com/souravOD/nutri-b2c-frontend", "homepage": "https://v0-next-js-app-requirements-omega.vercel.app", "size": 11387, "stargazers_count": 0, "watchers_count": 0, "language": null, "has_issues": false, "has_projects": true, "has_downloads": true, "has_wiki": false, "has_pages": false, "has_discussions": false, "forks_count": 1, "mirror_url": null, "archived": false, "disabled": false, "open_issues_count": 2, "license": null, "allow_forking": true, "is_template": false, "web_commit_signoff_required": false, "topics": [], "visibility": "public", "forks": 1, "open_issues": 2, "watchers": 0, "default_branch": "main"}, "sender": {"login": "souravOD", "id": 238303722, "node_id": "U_kgDODjQ56g", "avatar_url": "https://avatars.githubusercontent.com/u/238303722?v=4", "gravatar_id": "", "url": "https://api.github.com/users/souravOD", "html_url": "https://github.com/souravOD", "followers_url": "https://api.github.com/users/souravOD/followers", "following_url": "https://api.github.com/users/souravOD/following{/other_user}", "gists_url": "https://api.github.com/users/souravOD/gists{/gist_id}", "starred_url": "https://api.github.com/users/souravOD/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/souravOD/subscriptions", "organizations_url": "https://api.github.com/users/souravOD/orgs", "repos_url": "https://api.github.com/users/souravOD/repos", "events_url": "https://api.github.com/users/souravOD/events{/privacy}", "received_events_url": "https://api.github.com/users/souravOD/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "installation": {"id": 92375808, "node_id": "MDIzOkludGVncmF0aW9uSW5zdGFsbGF0aW9uOTIzNzU4MDg="}}, "event": "issue_comment"}, "file": {"name": "github_app.py", "path": "/app/pr_agent/servers/github_app.py"}, "function": "handle_request", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 342, "message": "Request body", "module": "github_app", "name": "pr_agent.servers.github_app", "process": {"id": 30, "name": "MainProcess"}, "thread": {"id": 126091663866752, "name": "MainThread"}, "time": {"repr": "2025-12-11 07:24:47.238052+00:00", "timestamp": 1765437887.238052}}}
2025-Dec-11 07:24:48.238640
{"text": "Processing comment on PR api_url='https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1', comment_body=/review Can you please review this PR\n", "record": {"elapsed": {"repr": "0:01:06.063342", "seconds": 66.063342}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "84aad2c7f2a44ec3bd9339bcf2de1e4c", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "github_app.py", "path": "/app/pr_agent/servers/github_app.py"}, "function": "handle_comments_on_pr", "level": {"icon": "â„¹ï¸", "name": "INFO", "no": 20}, "line": 118, "message": "Processing comment on PR api_url='https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1', comment_body=/review Can you please review this PR", "module": "github_app", "name": "pr_agent.servers.github_app", "process": {"id": 30, "name": "MainProcess"}, "thread": {"id": 126091663866752, "name": "MainThread"}, "time": {"repr": "2025-12-11 07:24:48.238262+00:00", "timestamp": 1765437888.238262}}}
2025-Dec-11 07:24:51.669036
{"text": "AI metadata is disabled for this command\n", "record": {"elapsed": {"repr": "0:01:09.493771", "seconds": 69.493771}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "84aad2c7f2a44ec3bd9339bcf2de1e4c", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "pr_reviewer.py", "path": "/app/pr_agent/tools/pr_reviewer.py"}, "function": "__init__", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 75, "message": "AI metadata is disabled for this command", "module": "pr_reviewer", "name": "pr_agent.tools.pr_reviewer", "process": {"id": 30, "name": "MainProcess"}, "thread": {"id": 126091663866752, "name": "MainThread"}, "time": {"repr": "2025-12-11 07:24:51.668691+00:00", "timestamp": 1765437891.668691}}}
2025-Dec-11 07:24:51.875195
{"text": "Reviewing PR: https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1 ...\n", "record": {"elapsed": {"repr": "0:01:09.699915", "seconds": 69.699915}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "84aad2c7f2a44ec3bd9339bcf2de1e4c", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "pr_reviewer.py", "path": "/app/pr_agent/tools/pr_reviewer.py"}, "function": "run", "level": {"icon": "â„¹ï¸", "name": "INFO", "no": 20}, "line": 134, "message": "Reviewing PR: https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1 ...", "module": "pr_reviewer", "name": "pr_agent.tools.pr_reviewer", "process": {"id": 30, "name": "MainProcess"}, "thread": {"id": 126091663866752, "name": "MainThread"}, "time": {"repr": "2025-12-11 07:24:51.874835+00:00", "timestamp": 1765437891.874835}}}
2025-Dec-11 07:24:51.875721
{"text": "Relevant configs\n", "record": {"elapsed": {"repr": "0:01:09.700642", "seconds": 69.700642}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "84aad2c7f2a44ec3bd9339bcf2de1e4c", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "artifacts": {"pr_reviewer": {"require_score_review": false, "require_tests_review": true, "require_estimate_effort_to_review": true, "require_can_be_split_review": false, "require_security_review": true, "require_estimate_contribution_time_cost": false, "require_todo_scan": false, "require_ticket_analysis_review": true, "publish_output_no_suggestions": true, "persistent_comment": true, "extra_instructions": "", "num_max_findings": 3, "final_update_message": true, "enable_review_labels_security": true, "enable_review_labels_effort": true, "require_all_thresholds_for_incremental_review": false, "minimal_commits_for_incremental_review": 0, "minimal_minutes_for_incremental_review": 0, "enable_intro_text": true, "enable_help_text": false}, "config": {"enable_ai_metadata": false, "custom_model_max_tokens": 200000, "model": "openai/gpt-5.1", "fallback_models": "[\\\"openai/gpt-5\\\", \\\"openai/gpt-5-mini\\\", \\\"openai/gpt-5-nano\\\"]", "temperature": 1, "git_provider": "github", "publish_output": true, "publish_output_progress": true, "verbosity_level": 0, "use_extra_bad_extensions": false, "log_level": "DEBUG", "use_wiki_settings_file": true, "use_repo_settings_file": true, "use_global_settings_file": true, "disable_auto_feedback": false, "ai_timeout": 120, "skip_keys": [], "custom_reasoning_model": false, "response_language": "en-US", "max_description_tokens": 500, "max_commits_tokens": 500, "max_model_tokens": 32000, "model_token_count_estimate_factor": 0.3, "patch_extension_skip_types": [".md", ".txt"], "allow_dynamic_context": true, "max_extra_lines_before_dynamic_context": 10, "patch_extra_lines_before": 5, "patch_extra_lines_after": 1, "secret_provider": "", "cli_mode": false, "ai_disclaimer_title": "", "ai_disclaimer": "", "output_relevant_configurations": false, "large_patch_policy": "clip", "duplicate_prompt_examples": false, "seed": -1, "add_repo_metadata": false, "add_repo_metadata_file_list": ["AGENTS.MD", "CLAUDE.MD", "QODO.MD"], "ignore_pr_title": ["^\\[Auto\\]", "^Auto"], "ignore_pr_target_branches": [], "ignore_pr_source_branches": [], "ignore_pr_labels": [], "ignore_pr_authors": [], "ignore_repositories": [], "ignore_language_framework": [], "is_auto_command": false, "reasoning_effort": "medium", "enable_auto_approval": false, "auto_approve_for_low_review_effort": -1, "auto_approve_for_no_suggestions": false, "ensure_ticket_compliance": false, "enable_claude_extended_thinking": false, "extended_thinking_budget_tokens": 2048, "extended_thinking_max_output_tokens": 4096, "enable_custom_labels": false}}}, "file": {"name": "pr_reviewer.py", "path": "/app/pr_agent/tools/pr_reviewer.py"}, "function": "run", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 137, "message": "Relevant configs", "module": "pr_reviewer", "name": "pr_agent.tools.pr_reviewer", "process": {"id": 30, "name": "MainProcess"}, "thread": {"id": 126091663866752, "name": "MainThread"}, "time": {"repr": "2025-12-11 07:24:51.875562+00:00", "timestamp": 1765437891.875562}}}
2025-Dec-11 07:24:51.876141
{"text": "Existing description\n", "record": {"elapsed": {"repr": "0:01:09.701084", "seconds": 69.701084}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "84aad2c7f2a44ec3bd9339bcf2de1e4c", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "description": "- improved search bar ux in app/search/page.tsx:\r\n  - x icon clears input and refocuses\r\n  - escape key clears input\r\n  - enter key triggers search\r\n\r\n- updated filter count logic:\r\n  - accurately counts all active filters\r\n  - apply button badge reflects true total"}, "file": {"name": "git_provider.py", "path": "/app/pr_agent/git_providers/git_provider.py"}, "function": "get_user_description", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 225, "message": "Existing description", "module": "git_provider", "name": "pr_agent.git_providers.git_provider", "process": {"id": 30, "name": "MainProcess"}, "thread": {"id": 126091663866752, "name": "MainThread"}, "time": {"repr": "2025-12-11 07:24:51.876004+00:00", "timestamp": 1765437891.876004}}}
2025-Dec-11 07:24:51.876379
{"text": "Existing description was not generated by the pr-agent\n", "record": {"elapsed": {"repr": "0:01:09.701184", "seconds": 69.701184}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "84aad2c7f2a44ec3bd9339bcf2de1e4c", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "git_provider.py", "path": "/app/pr_agent/git_providers/git_provider.py"}, "function": "get_user_description", "level": {"icon": "â„¹ï¸", "name": "INFO", "no": 20}, "line": 229, "message": "Existing description was not generated by the pr-agent", "module": "git_provider", "name": "pr_agent.git_providers.git_provider", "process": {"id": 30, "name": "MainProcess"}, "thread": {"id": 126091663866752, "name": "MainThread"}, "time": {"repr": "2025-12-11 07:24:51.876104+00:00", "timestamp": 1765437891.876104}}}
2025-Dec-11 07:24:52.437853
{"text": "Generating prediction with openai/gpt-5.1\n", "record": {"elapsed": {"repr": "0:01:10.262544", "seconds": 70.262544}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "84aad2c7f2a44ec3bd9339bcf2de1e4c", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "pr_processing.py", "path": "/app/pr_agent/algo/pr_processing.py"}, "function": "retry_with_fallback_models", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 326, "message": "Generating prediction with openai/gpt-5.1", "module": "pr_processing", "name": "pr_agent.algo.pr_processing", "process": {"id": 30, "name": "MainProcess"}, "thread": {"id": 126091663866752, "name": "MainThread"}, "time": {"repr": "2025-12-11 07:24:52.437464+00:00", "timestamp": 1765437892.437464}}}
2025-Dec-11 07:24:53.316710
{"text": "PR main language: TypeScript\n", "record": {"elapsed": {"repr": "0:01:11.141381", "seconds": 71.141381}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "84aad2c7f2a44ec3bd9339bcf2de1e4c", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "pr_processing.py", "path": "/app/pr_agent/algo/pr_processing.py"}, "function": "get_pr_diff", "level": {"icon": "â„¹ï¸", "name": "INFO", "no": 20}, "line": 63, "message": "PR main language: TypeScript", "module": "pr_processing", "name": "pr_agent.algo.pr_processing", "process": {"id": 30, "name": "MainProcess"}, "thread": {"id": 126091663866752, "name": "MainThread"}, "time": {"repr": "2025-12-11 07:24:53.316301+00:00", "timestamp": 1765437893.316301}}}
2025-Dec-11 07:24:53.324621
{"text": "Tokens: 4738, total tokens under limit: 32000, returning full diff.\n", "record": {"elapsed": {"repr": "0:01:11.148783", "seconds": 71.148783}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "84aad2c7f2a44ec3bd9339bcf2de1e4c", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "pr_processing.py", "path": "/app/pr_agent/algo/pr_processing.py"}, "function": "get_pr_diff", "level": {"icon": "â„¹ï¸", "name": "INFO", "no": 20}, "line": 74, "message": "Tokens: 4738, total tokens under limit: 32000, returning full diff.", "module": "pr_processing", "name": "pr_agent.algo.pr_processing", "process": {"id": 30, "name": "MainProcess"}, "thread": {"id": 126091663866752, "name": "MainThread"}, "time": {"repr": "2025-12-11 07:24:53.323703+00:00", "timestamp": 1765437893.323703}}}
2025-Dec-11 07:24:53.324696
{"text": "PR diff\n", "record": {"elapsed": {"repr": "0:01:11.149133", "seconds": 71.149133}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "84aad2c7f2a44ec3bd9339bcf2de1e4c", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "diff": "\n\n## File: 'app/search/page.tsx'\n\n@@ -1,7 +1,8 @@\n__new hunk__\n1  \"use client\"\n2  \n3 +import { useState, useEffect, useMemo, useRef } from \"react\"\n4 +// import { X } from \"lucide-react\"\n5  import { useSearchParams, useRouter } from \"next/navigation\"\n6  import { useQuery } from \"@tanstack/react-query\"\n7  import { Input } from \"@/components/ui/input\"\n8  import { Button } from \"@/components/ui/button\"\n__old hunk__\n \"use client\"\n \n-import { useState, useEffect, useMemo } from \"react\"\n import { useSearchParams, useRouter } from \"next/navigation\"\n import { useQuery } from \"@tanstack/react-query\"\n import { Input } from \"@/components/ui/input\"\n import { Button } from \"@/components/ui/button\"\n\n@@ -41,11 +42,12 @@\n__new hunk__\n42  export default function SearchPage() {\n43    const searchParams = useSearchParams()\n44    const router = useRouter()\n45    const { filters, setFilters, resetFilters } = useFilters()\n46    const { settings } = useSettings()\n47  \n48    const [searchQuery, setSearchQuery] = useState(searchParams.get(\"q\") || filters.q || \"\")\n49 +  const inputRef = useRef(null);\n50    const [sortBy, setSortBy] = useState(settings.behavior.defaultSort || \"time\")\n51    const [filtersOpen, setFiltersOpen] = useState(false)\n52  \n53    // Update search query from URL params\n\n@@ -75,29 +77,54 @@ export default function SearchPage() {\n__new hunk__\n77        filters.fiberMin > 0 ||\n78        filters.sugarMax < 100 ||\n79        filters.sodiumMax < 4000 ||\n80        filters.maxTime < 120 ||\n81        !!filters.mealType\n82      )\n83    }, [filters])\n84  \n85 +  // const activeFilterCount = useMemo(() => {\n86 +  //   let count = 0\n87 +  //   if (filters.dietaryRestrictions.length > 0) count++\n88 +  //   if (filters.allergens.length > 0) count++\n89 +  //   if (filters.cuisines.length > 0) count++\n90 +  //   if (filters.majorConditions.length > 0) count++\n91 +  //   if (filters.calories[0] > 0 || filters.calories[1] < 1200) count++\n92 +  //   if (filters.proteinMin > 0) count++\n93 +  //   if (filters.carbsMin > 0) count++\n94 +  //   if (filters.fatMin > 0) count++\n95 +  //   if (filters.fiberMin > 0) count++\n96 +  //   if (filters.sugarMax < 100) count++\n97 +  //   if (filters.sodiumMax < 4000) count++\n98 +  //   if (filters.maxTime < 120) count++\n99 +  //   if (filters.mealType) count++\n100 +  //   return count\n101 +  // }, [filters])\n102    const activeFilterCount = useMemo(() => {\n103 +    let count = 0;\n104 +\n105 +  // Sum all selected array filters\n106 +    count += filters.dietaryRestrictions.length;\n107 +    count += filters.allergens.length;\n108 +    count += filters.cuisines.length;\n109 +    count += filters.majorConditions.length;\n110 +\n111 +    // Range and min/max filters\n112 +    if (filters.calories[0] > 0) count++; // Min calories\n113 +    if (filters.calories[1] < 1200) count++; // Max calories\n114 +    if (filters.proteinMin > 0) count++;\n115 +    if (filters.carbsMin > 0) count++;\n116 +    if (filters.fatMin > 0) count++;\n117 +    if (filters.fiberMin > 0) count++;\n118 +    if (filters.sugarMax < 100) count++;\n119 +    if (filters.sodiumMax < 4000) count++;\n120 +    if (filters.maxTime < 120) count++;\n121 +    \n122 +    // Single-value selection\n123 +    if (filters.mealType) count++;\n124 +\n125 +    return count;\n126 +  }, [filters]);\n127  \n128    const {\n129      data: searchResults = [],\n130      isLoading,\n__old hunk__\n       filters.fiberMin > 0 ||\n       filters.sugarMax < 100 ||\n       filters.sodiumMax < 4000 ||\n       filters.maxTime < 120 ||\n       !!filters.mealType\n     )\n   }, [filters])\n \n   const activeFilterCount = useMemo(() => {\n-    let count = 0\n-    if (filters.dietaryRestrictions.length > 0) count++\n-    if (filters.allergens.length > 0) count++\n-    if (filters.cuisines.length > 0) count++\n-    if (filters.majorConditions.length > 0) count++\n-    if (filters.calories[0] > 0 || filters.calories[1] < 1200) count++\n-    if (filters.proteinMin > 0) count++\n-    if (filters.carbsMin > 0) count++\n-    if (filters.fatMin > 0) count++\n-    if (filters.fiberMin > 0) count++\n-    if (filters.sugarMax < 100) count++\n-    if (filters.sodiumMax < 4000) count++\n-    if (filters.maxTime < 120) count++\n-    if (filters.mealType) count++\n-    return count\n-  }, [filters])\n \n   const {\n     data: searchResults = [],\n     isLoading,\n\n@@ -113,12 +140,22 @@ export default function SearchPage() {\n__new hunk__\n140          const rankedResults = rank(rawResults, settings)\n141          return rankedResults\n142        }\n143  \n144        return rawResults.map((recipe) => ({ ...recipe, score: 0 }))\n145      },\n146      enabled: !!(searchQuery || hasActiveFilters),\n147    })\n148 +  const handleSearchInputKeyDown = (e: React.KeyboardEvent) => {\n149 +    if (e.key === \"Escape\" && searchQuery) {\n150 +      setSearchQuery(\"\");\n151 +      inputRef.current?.focus();\n152 +    }\n153 +    if (e.key === \"Enter\") {\n154 +      handleSearch(searchQuery);\n155 +    }\n156 +  };\n157 +\n158  \n159    const handleSearch = (query: string) => {\n160      setSearchQuery(query)\n161      setFilters({ ...filters, q: query })\n\n@@ -182,13 +219,13 @@ export default function SearchPage() {\n__new hunk__\n219    return (\n220      \n221        \n222          {/* Search Header */}\n223          \n224            Search Recipes\n225  \n226            {/* Search Input */}\n227 +          {/* \n228              \n229              \n       \n         {/* Search Header */}\n         \n           Search Recipes\n \n           {/* Search Input */}\n-          \n             \n              setSearchQuery(e.target.value)}\n234                onKeyDown={(e) => e.key === \"Enter\" && handleSearch(searchQuery)}\n235                className=\"pl-10 pr-4 h-12 text-lg\"\n236              />\n237 +           */}\n238 +          \n239 +            \n240 +             setSearchQuery(e.target.value)}\n246 +              onKeyDown={handleSearchInputKeyDown}\n247 +              style={{ paddingRight: searchQuery ? \"2rem\" : undefined, width: \"100%\" }}\n248 +              className=\"pl-10 pr-4 h-12 text-lg\"\n249 +            />\n250 +            {searchQuery && (\n251 +               {\n266 +                  setSearchQuery(\"\");\n267 +                  inputRef.current?.focus();\n268 +              }}\n269 +              >\n270 +                \n271 +            \n272 +          )}\n273            \n274  \n275 +\n276            {/* Search Actions */}\n277            \n278               handleSearch(searchQuery)} size=\"sm\">\n279                Search\n\n\n## File: 'components/filter-panel.tsx'\n\n@@ -54,35 +54,58 @@\n__new hunk__\n54  export function FilterPanel({ open, onOpenChange, initialValues, onApply, onReset }: FilterPanelProps) {\n55    const form = useForm({\n56      resolver: zodResolver(schema),\n57      // provide full defaults (OUTPUT fits into INPUT just fine)\n58      defaultValues: schema.parse(initialValues ?? {}),\n59      mode: \"onChange\",\n60    })\n61  \n62     useEffect(() => {\n63      form.reset(schema.parse(initialValues ?? {}));\n64    }, [open, initialValues, form]);\n65  \n66 +  // function getActiveFiltersCount(): number {\n67 +  //   const values = form.getValues()\n68 +  //   let count = 0\n69 +  //   if ((values.dietaryRestrictions || []).length > 0) count++\n70 +  //   if ((values.allergens || []).length > 0) count++\n71 +  //   if ((values.cuisines || []).length > 0) count++\n72 +  //   if ((values.majorConditions || []).length > 0) count++\n73 +  //   if (values.calories && (values.calories[0] > 0 || values.calories[1] < 1200)) count++\n74 +  //   if ((values.proteinMin || 0) > 0) count++\n75 +  //   if ((values.carbsMin || 0) > 0) count++\n76 +  //   if ((values.fatMin || 0) > 0) count++\n77 +  //   if ((values.fiberMin || 0) > 0) count++\n78 +  //   if ((values.sugarMax || 100) < 100) count++\n79 +  //   if ((values.sodiumMax || 4000) < 4000) count++\n80 +  //   if ((values.maxTime || 120) < 120) count++\n81 +  //   if ((values.mealType || \"\") !== \"\") count++\n82 +  //   return count\n83 +  // }\n84    function getActiveFiltersCount(): number {\n85 +    const values = form.getValues();\n86 +    let count = 0;\n87 +\n88 +    // Count all selected array filters individually\n89 +    count += values.dietaryRestrictions.length;\n90 +    count += values.allergens.length;\n91 +    count += values.cuisines.length;\n92 +    count += values.majorConditions.length;\n93 +\n94 +    // Numeric and single-value filters\n95 +    if (values.calories[0] > 0) count++;           // Min calories\n96 +    if (values.calories[1] < 1200) count++;        // Max calories\n97 +    if (values.proteinMin > 0) count++;\n98 +    if (values.carbsMin > 0) count++;\n99 +    if (values.fatMin > 0) count++;\n100 +    if (values.fiberMin > 0) count++;\n101 +    if (values.sugarMax < 100) count++;\n102 +    if (values.sodiumMax < 4000) count++;\n103 +    if (values.maxTime < 120) count++;\n104 +    if (values.mealType) count++;\n105 +\n106 +    return count;\n107    }\n108    function handleApply() {\n109      const values = schema.parse(form.getValues())\n110      onApply(values)\n111      onOpenChange(false)\n__old hunk__\n export function FilterPanel({ open, onOpenChange, initialValues, onApply, onReset }: FilterPanelProps) {\n   const form = useForm({\n     resolver: zodResolver(schema),\n     // provide full defaults (OUTPUT fits into INPUT just fine)\n     defaultValues: schema.parse(initialValues ?? {}),\n     mode: \"onChange\",\n   })\n \n    useEffect(() => {\n     form.reset(schema.parse(initialValues ?? {}));\n   }, [open, initialValues, form]);\n \n   function getActiveFiltersCount(): number {\n-    const values = form.getValues()\n-    let count = 0\n-    if ((values.dietaryRestrictions || []).length > 0) count++\n-    if ((values.allergens || []).length > 0) count++\n-    if ((values.cuisines || []).length > 0) count++\n-    if ((values.majorConditions || []).length > 0) count++\n-    if (values.calories && (values.calories[0] > 0 || values.calories[1] < 1200)) count++\n-    if ((values.proteinMin || 0) > 0) count++\n-    if ((values.carbsMin || 0) > 0) count++\n-    if ((values.fatMin || 0) > 0) count++\n-    if ((values.fiberMin || 0) > 0) count++\n-    if ((values.sugarMax || 100) < 100) count++\n-    if ((values.sodiumMax || 4000) < 4000) count++\n-    if ((values.maxTime || 120) < 120) count++\n-    if ((values.mealType || \"\") !== \"\") count++\n-    return count\n   }\n-\n   function handleApply() {\n     const values = schema.parse(form.getValues())\n     onApply(values)\n     onOpenChange(false)"}, "file": {"name": "pr_reviewer.py", "path": "/app/pr_agent/tools/pr_reviewer.py"}, "function": "_prepare_prediction", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 197, "message": "PR diff", "module": "pr_reviewer", "name": "pr_agent.tools.pr_reviewer", "process": {"id": 30, "name": "MainProcess"}, "thread": {"id": 126091663866752, "name": "MainThread"}, "time": {"repr": "2025-12-11 07:24:53.324053+00:00", "timestamp": 1765437893.324053}}}
2025-Dec-11 07:24:53.339284
{"text": "Prompts\n", "record": {"elapsed": {"repr": "0:01:11.163139", "seconds": 71.163139}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "84aad2c7f2a44ec3bd9339bcf2de1e4c", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "artifact": {"system": "You are PR-Reviewer, a language model designed to review a Git Pull Request (PR).\nYour task is to provide constructive and concise feedback for the PR.\nThe review should focus on new code added in the PR code diff (lines starting with '+')\n\n\nThe format we will use to present the PR code diff:\n======\n## File: 'src/file1.py'\n\n\n@@ ... @@ def func1():\n__new hunk__\n11  unchanged code line0\n12  unchanged code line1\n13 +new code line2 added\n14  unchanged code line3\n__old hunk__\n unchanged code line0\n unchanged code line1\n-old code line2 removed\n unchanged code line3\n\n@@ ... @@ def func2():\n__new hunk__\n unchanged code line4\n+new code line5 added\n unchanged code line6\n\n## File: 'src/file2.py'\n...\n======\n\n- In the format above, the diff is organized into separate '__new hunk__' and '__old hunk__' sections for each code chunk. '__new hunk__' contains the updated code, while '__old hunk__' shows the removed code. If no code was removed in a specific chunk, the __old hunk__ section will be omitted.\n- We also added line numbers for the '__new hunk__' code, to help you refer to the code lines in your suggestions. These line numbers are not part of the actual code, and should only be used for reference.\n- Code lines are prefixed with symbols ('+', '-', ' '). The '+' symbol indicates new code added in the PR, the '-' symbol indicates code removed in the PR, and the ' ' symbol indicates unchanged code. The review should address new code added in the PR code diff (lines starting with '+').\n- When quoting variables, names or file paths from the code, use backticks (`) instead of single quote (').\n- Note that you only see changed code segments (diff hunks in a PR), not the entire codebase. Avoid suggestions that might duplicate existing functionality or questioning code elements (like variables declarations or import statements) that may be defined elsewhere in the codebase.\n- Also note that if the code ends at an opening brace or statement that begins a new scope (like 'if', 'for', 'try'), don't treat it as incomplete. Instead, acknowledge the visible scope boundary and analyze only the code shown.\n\n\nThe output must be a YAML object equivalent to type $PRReview, according to the following Pydantic definitions:\n=====\n\nclass KeyIssuesComponentLink(BaseModel):\n    relevant_file: str = Field(description=\"The full file path of the relevant file\")\n    issue_header: str = Field(description=\"One or two word title for the issue. For example: 'Possible Bug', etc.\")\n    issue_content: str = Field(description=\"A short and concise summary of what should be further inspected and validated during the PR review process for this issue. Do not mention line numbers in this field.\")\n    start_line: int = Field(description=\"The start line that corresponds to this issue in the relevant file\")\n    end_line: int = Field(description=\"The end line that corresponds to this issue in the relevant file\")\n\nclass Review(BaseModel):\n    estimated_effort_to_review_[1-5]: int = Field(description=\"Estimate, on a scale of 1-5 (inclusive), the time and effort required to review this PR by an experienced and knowledgeable developer. 1 means short and easy review , 5 means long and hard review. Take into account the size, complexity, quality, and the needed changes of the PR code diff.\")\n    relevant_tests: str = Field(description=\"yes/no question: does this PR have relevant tests added or updated ?\")\n    key_issues_to_review: List[KeyIssuesComponentLink] = Field(\"A short and diverse list (0-3 issues) of high-priority bugs, problems or performance concerns introduced in the PR code, which the PR reviewer should further focus on and validate during the review process.\")\n    security_concerns: str = Field(description=\"Does this PR code introduce vulnerabilities such as exposure of sensitive information (e.g., API keys, secrets, passwords), or security concerns like SQL injection, XSS, CSRF, and others ? Answer 'No' (without explaining why) if there are no possible issues. If there are security concerns or issues, start your answer with a short header, such as: 'Sensitive information exposure: ...', 'SQL injection: ...', etc. Explain your answer. Be specific and give examples if possible\")\n\nclass PRReview(BaseModel):\n    review: Review\n=====\n\n\nExample output:\n```yaml\nreview:\n  estimated_effort_to_review_[1-5]: |\n    3\n  relevant_tests: |\n    No\n  key_issues_to_review:\n    - relevant_file: |\n        directory/xxx.py\n      issue_header: |\n        Possible Bug\n      issue_content: |\n        ...\n      start_line: 12\n      end_line: 14\n    - ...\n  security_concerns: |\n    No\n```\n\nAnswer should be a valid YAML, and nothing else. Each YAML output MUST be after a newline, with proper indent, and block scalar indicator ('|')", "user": "\n\n\n--PR Info--\n\nToday's Date: 2025-12-11\n\nTitle: 'Fix: Search UX and multi-filter logic (frontend)'\n\nBranch: 'feature/initial-fixes'\n\nPR Description:\n======\n- Improved search bar UX in app/search/page.tsx:\r\n  - X icon clears input and refocuses\r\n  - Escape key clears input\r\n  - Enter key triggers search\r\n\r\n- Updated filter count logic:\r\n  - Accurately counts all active filters\r\n  - Apply button badge reflects true total\n======\n\n\nThe PR code diff:\n======\n## File: 'app/search/page.tsx'\n\n@@ -1,7 +1,8 @@\n__new hunk__\n1  \"use client\"\n2  \n3 +import { useState, useEffect, useMemo, useRef } from \"react\"\n4 +// import { X } from \"lucide-react\"\n5  import { useSearchParams, useRouter } from \"next/navigation\"\n6  import { useQuery } from \"@tanstack/react-query\"\n7  import { Input } from \"@/components/ui/input\"\n8  import { Button } from \"@/components/ui/button\"\n__old hunk__\n \"use client\"\n \n-import { useState, useEffect, useMemo } from \"react\"\n import { useSearchParams, useRouter } from \"next/navigation\"\n import { useQuery } from \"@tanstack/react-query\"\n import { Input } from \"@/components/ui/input\"\n import { Button } from \"@/components/ui/button\"\n\n@@ -41,11 +42,12 @@\n__new hunk__\n42  export default function SearchPage() {\n43    const searchParams = useSearchParams()\n44    const router = useRouter()\n45    const { filters, setFilters, resetFilters } = useFilters()\n46    const { settings } = useSettings()\n47  \n48    const [searchQuery, setSearchQuery] = useState(searchParams.get(\"q\") || filters.q || \"\")\n49 +  const inputRef = useRef(null);\n50    const [sortBy, setSortBy] = useState(settings.behavior.defaultSort || \"time\")\n51    const [filtersOpen, setFiltersOpen] = useState(false)\n52  \n53    // Update search query from URL params\n\n@@ -75,29 +77,54 @@ export default function SearchPage() {\n__new hunk__\n77        filters.fiberMin > 0 ||\n78        filters.sugarMax < 100 ||\n79        filters.sodiumMax < 4000 ||\n80        filters.maxTime < 120 ||\n81        !!filters.mealType\n82      )\n83    }, [filters])\n84  \n85 +  // const activeFilterCount = useMemo(() => {\n86 +  //   let count = 0\n87 +  //   if (filters.dietaryRestrictions.length > 0) count++\n88 +  //   if (filters.allergens.length > 0) count++\n89 +  //   if (filters.cuisines.length > 0) count++\n90 +  //   if (filters.majorConditions.length > 0) count++\n91 +  //   if (filters.calories[0] > 0 || filters.calories[1] < 1200) count++\n92 +  //   if (filters.proteinMin > 0) count++\n93 +  //   if (filters.carbsMin > 0) count++\n94 +  //   if (filters.fatMin > 0) count++\n95 +  //   if (filters.fiberMin > 0) count++\n96 +  //   if (filters.sugarMax < 100) count++\n97 +  //   if (filters.sodiumMax < 4000) count++\n98 +  //   if (filters.maxTime < 120) count++\n99 +  //   if (filters.mealType) count++\n100 +  //   return count\n101 +  // }, [filters])\n102    const activeFilterCount = useMemo(() => {\n103 +    let count = 0;\n104 +\n105 +  // Sum all selected array filters\n106 +    count += filters.dietaryRestrictions.length;\n107 +    count += filters.allergens.length;\n108 +    count += filters.cuisines.length;\n109 +    count += filters.majorConditions.length;\n110 +\n111 +    // Range and min/max filters\n112 +    if (filters.calories[0] > 0) count++; // Min calories\n113 +    if (filters.calories[1] < 1200) count++; // Max calories\n114 +    if (filters.proteinMin > 0) count++;\n115 +    if (filters.carbsMin > 0) count++;\n116 +    if (filters.fatMin > 0) count++;\n117 +    if (filters.fiberMin > 0) count++;\n118 +    if (filters.sugarMax < 100) count++;\n119 +    if (filters.sodiumMax < 4000) count++;\n120 +    if (filters.maxTime < 120) count++;\n121 +    \n122 +    // Single-value selection\n123 +    if (filters.mealType) count++;\n124 +\n125 +    return count;\n126 +  }, [filters]);\n127  \n128    const {\n129      data: searchResults = [],\n130      isLoading,\n__old hunk__\n       filters.fiberMin > 0 ||\n       filters.sugarMax < 100 ||\n       filters.sodiumMax < 4000 ||\n       filters.maxTime < 120 ||\n       !!filters.mealType\n     )\n   }, [filters])\n \n   const activeFilterCount = useMemo(() => {\n-    let count = 0\n-    if (filters.dietaryRestrictions.length > 0) count++\n-    if (filters.allergens.length > 0) count++\n-    if (filters.cuisines.length > 0) count++\n-    if (filters.majorConditions.length > 0) count++\n-    if (filters.calories[0] > 0 || filters.calories[1] < 1200) count++\n-    if (filters.proteinMin > 0) count++\n-    if (filters.carbsMin > 0) count++\n-    if (filters.fatMin > 0) count++\n-    if (filters.fiberMin > 0) count++\n-    if (filters.sugarMax < 100) count++\n-    if (filters.sodiumMax < 4000) count++\n-    if (filters.maxTime < 120) count++\n-    if (filters.mealType) count++\n-    return count\n-  }, [filters])\n \n   const {\n     data: searchResults = [],\n     isLoading,\n\n@@ -113,12 +140,22 @@ export default function SearchPage() {\n__new hunk__\n140          const rankedResults = rank(rawResults, settings)\n141          return rankedResults\n142        }\n143  \n144        return rawResults.map((recipe) => ({ ...recipe, score: 0 }))\n145      },\n146      enabled: !!(searchQuery || hasActiveFilters),\n147    })\n148 +  const handleSearchInputKeyDown = (e: React.KeyboardEvent) => {\n149 +    if (e.key === \"Escape\" && searchQuery) {\n150 +      setSearchQuery(\"\");\n151 +      inputRef.current?.focus();\n152 +    }\n153 +    if (e.key === \"Enter\") {\n154 +      handleSearch(searchQuery);\n155 +    }\n156 +  };\n157 +\n158  \n159    const handleSearch = (query: string) => {\n160      setSearchQuery(query)\n161      setFilters({ ...filters, q: query })\n\n@@ -182,13 +219,13 @@ export default function SearchPage() {\n__new hunk__\n219    return (\n220      \n221        \n222          {/* Search Header */}\n223          \n224            Search Recipes\n225  \n226            {/* Search Input */}\n227 +          {/* \n228              \n229              \n       \n         {/* Search Header */}\n         \n           Search Recipes\n \n           {/* Search Input */}\n-          \n             \n              setSearchQuery(e.target.value)}\n234                onKeyDown={(e) => e.key === \"Enter\" && handleSearch(searchQuery)}\n235                className=\"pl-10 pr-4 h-12 text-lg\"\n236              />\n237 +           */}\n238 +          \n239 +            \n240 +             setSearchQuery(e.target.value)}\n246 +              onKeyDown={handleSearchInputKeyDown}\n247 +              style={{ paddingRight: searchQuery ? \"2rem\" : undefined, width: \"100%\" }}\n248 +              className=\"pl-10 pr-4 h-12 text-lg\"\n249 +            />\n250 +            {searchQuery && (\n251 +               {\n266 +                  setSearchQuery(\"\");\n267 +                  inputRef.current?.focus();\n268 +              }}\n269 +              >\n270 +                \n271 +            \n272 +          )}\n273            \n274  \n275 +\n276            {/* Search Actions */}\n277            \n278               handleSearch(searchQuery)} size=\"sm\">\n279                Search\n\n\n## File: 'components/filter-panel.tsx'\n\n@@ -54,35 +54,58 @@\n__new hunk__\n54  export function FilterPanel({ open, onOpenChange, initialValues, onApply, onReset }: FilterPanelProps) {\n55    const form = useForm({\n56      resolver: zodResolver(schema),\n57      // provide full defaults (OUTPUT fits into INPUT just fine)\n58      defaultValues: schema.parse(initialValues ?? {}),\n59      mode: \"onChange\",\n60    })\n61  \n62     useEffect(() => {\n63      form.reset(schema.parse(initialValues ?? {}));\n64    }, [open, initialValues, form]);\n65  \n66 +  // function getActiveFiltersCount(): number {\n67 +  //   const values = form.getValues()\n68 +  //   let count = 0\n69 +  //   if ((values.dietaryRestrictions || []).length > 0) count++\n70 +  //   if ((values.allergens || []).length > 0) count++\n71 +  //   if ((values.cuisines || []).length > 0) count++\n72 +  //   if ((values.majorConditions || []).length > 0) count++\n73 +  //   if (values.calories && (values.calories[0] > 0 || values.calories[1] < 1200)) count++\n74 +  //   if ((values.proteinMin || 0) > 0) count++\n75 +  //   if ((values.carbsMin || 0) > 0) count++\n76 +  //   if ((values.fatMin || 0) > 0) count++\n77 +  //   if ((values.fiberMin || 0) > 0) count++\n78 +  //   if ((values.sugarMax || 100) < 100) count++\n79 +  //   if ((values.sodiumMax || 4000) < 4000) count++\n80 +  //   2025-12-11T07:23:28.307071801Z [2025-12-11 07:23:28 +0000] [1] [INFO] Starting gunicorn 23.0.0
2025-Dec-11 07:24:53.339284
if ((values.maxTime || 120) < 120) count++\n81 +  //   if ((values.mealType || \"\") !== \"\") count++\n82 +  //   return count\n83 +  // }\n84    function getActiveFiltersCount(): number {\n85 +    const values = form.getValues();\n86 +    let count = 0;\n87 +\n88 +    // Count all selected array filters individually\n89 +    count += values.dietaryRestrictions.length;\n90 +    count += values.allergens.length;\n91 +    count += values.cuisines.length;\n92 +    count += values.majorConditions.length;\n93 +\n94 +    // Numeric and single-value filters\n95 +    if (values.calories[0] > 0) count++;           // Min calories\n96 +    if (values.calories[1] < 1200) count++;        // Max calories\n97 +    if (values.proteinMin > 0) count++;\n98 +    if (values.carbsMin > 0) count++;\n99 +    if (values.fatMin > 0) count++;\n100 +    if (values.fiberMin > 0) count++;\n101 +    if (values.sugarMax < 100) count++;\n102 +    if (values.sodiumMax < 4000) count++;\n103 +    if (values.maxTime < 120) count++;\n104 +    if (values.mealType) count++;\n105 +\n106 +    return count;\n107    }\n108    function handleApply() {\n109      const values = schema.parse(form.getValues())\n110      onApply(values)\n111      onOpenChange(false)\n__old hunk__\n export function FilterPanel({ open, onOpenChange, initialValues, onApply, onReset }: FilterPanelProps) {\n   const form = useForm({\n     resolver: zodResolver(schema),\n     // provide full defaults (OUTPUT fits into INPUT just fine)\n     defaultValues: schema.parse(initialValues ?? {}),\n     mode: \"onChange\",\n   })\n \n    useEffect(() => {\n     form.reset(schema.parse(initialValues ?? {}));\n   }, [open, initialValues, form]);\n \n   function getActiveFiltersCount(): number {\n-    const values = form.getValues()\n-    let count = 0\n-    if ((values.dietaryRestrictions || []).length > 0) count++\n-    if ((values.allergens || []).length > 0) count++\n-    if ((values.cuisines || []).length > 0) count++\n-    if ((values.majorConditions || []).length > 0) count++\n-    if (values.calories && (values.calories[0] > 0 || values.calories[1] < 1200)) count++\n-    if ((values.proteinMin || 0) > 0) count++\n-    if ((values.carbsMin || 0) > 0) count++\n-    if ((values.fatMin || 0) > 0) count++\n-    if ((values.fiberMin || 0) > 0) count++\n-    if ((values.sugarMax || 100) < 100) count++\n-    if ((values.sodiumMax || 4000) < 4000) count++\n-    if ((values.maxTime || 120) < 120) count++\n-    if ((values.mealType || \"\") !== \"\") count++\n-    return count\n   }\n-\n   function handleApply() {\n     const values = schema.parse(form.getValues())\n     onApply(values)\n     onOpenChange(false)\n======\n\n\nResponse (should be a valid YAML, and nothing else):\n```yaml"}}, "file": {"name": "litellm_ai_handler.py", "path": "/app/pr_agent/algo/ai_handlers/litellm_ai_handler.py"}, "function": "chat_completion", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 397, "message": "Prompts", "module": "litellm_ai_handler", "name": "pr_agent.algo.ai_handlers.litellm_ai_handler", "process": {"id": 30, "name": "MainProcess"}, "thread": {"id": 126091663866752, "name": "MainThread"}, "time": {"repr": "2025-12-11 07:24:53.338059+00:00", "timestamp": 1765437893.338059}}}
2025-Dec-11 07:24:53.340572
{"text": "LiteLLM call model='openai/gpt-5.1'\n", "record": {"elapsed": {"repr": "0:01:11.164776", "seconds": 71.164776}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "84aad2c7f2a44ec3bd9339bcf2de1e4c", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "litellm_ai_handler.py", "path": "/app/pr_agent/algo/ai_handlers/litellm_ai_handler.py"}, "function": "chat_completion", "level": {"icon": "âš ï¸", "name": "WARNING", "no": 30}, "line": 426, "message": "LiteLLM call model='openai/gpt-5.1'", "module": "litellm_ai_handler", "name": "pr_agent.algo.ai_handlers.litellm_ai_handler", "process": {"id": 30, "name": "MainProcess"}, "thread": {"id": 126091663866752, "name": "MainThread"}, "time": {"repr": "2025-12-11 07:24:53.339696+00:00", "timestamp": 1765437893.339696}}}
2025-Dec-11 07:24:53.340614
{"text": "Using OpenAI client directly for LiteLLM proxy with model: openai/gpt-5.1\n", "record": {"elapsed": {"repr": "0:01:11.165055", "seconds": 71.165055}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "84aad2c7f2a44ec3bd9339bcf2de1e4c", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "litellm_ai_handler.py", "path": "/app/pr_agent/algo/ai_handlers/litellm_ai_handler.py"}, "function": "_get_completion", "level": {"icon": "â„¹ï¸", "name": "INFO", "no": 20}, "line": 473, "message": "Using OpenAI client directly for LiteLLM proxy with model: openai/gpt-5.1", "module": "litellm_ai_handler", "name": "pr_agent.algo.ai_handlers.litellm_ai_handler", "process": {"id": 30, "name": "MainProcess"}, "thread": {"id": 126091663866752, "name": "MainThread"}, "time": {"repr": "2025-12-11 07:24:53.339975+00:00", "timestamp": 1765437893.339975}}}
2025-Dec-11 07:24:54.114077
{"text": "Received a GitHub webhook\n", "record": {"elapsed": {"repr": "0:01:11.519592", "seconds": 71.519592}, "exception": null, "extra": {}, "file": {"name": "github_app.py", "path": "/app/pr_agent/servers/github_app.py"}, "function": "handle_github_webhooks", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 45, "message": "Received a GitHub webhook", "module": "github_app", "name": "pr_agent.servers.github_app", "process": {"id": 24, "name": "MainProcess"}, "thread": {"id": 126091663866752, "name": "MainThread"}, "time": {"repr": "2025-12-11 07:24:54.113660+00:00", "timestamp": 1765437894.11366}}}
2025-Dec-11 07:24:54.132129
{"text": "Handling request with event: issue_comment, action: created\n", "record": {"elapsed": {"repr": "0:01:11.537501", "seconds": 71.537501}, "exception": null, "extra": {}, "file": {"name": "github_app.py", "path": "/app/pr_agent/servers/github_app.py"}, "function": "handle_request", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 321, "message": "Handling request with event: issue_comment, action: created", "module": "github_app", "name": "pr_agent.servers.github_app", "process": {"id": 24, "name": "MainProcess"}, "thread": {"id": 126091663866752, "name": "MainThread"}, "time": {"repr": "2025-12-11 07:24:54.131569+00:00", "timestamp": 1765437894.131569}}}
2025-Dec-11 07:24:54.132768
{"text": "Request body\n", "record": {"elapsed": {"repr": "0:01:11.538360", "seconds": 71.53836}, "exception": null, "extra": {"artifact": {"action": "created", "issue": {"url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/1", "repository_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend", "labels_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/1/labels{/name}", "comments_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/1/comments", "events_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/1/events", "html_url": "https://github.com/souravOD/nutri-b2c-frontend/pull/1", "id": 3527983986, "node_id": "PR_kwDOQEZhKM6uaI7J", "number": 1, "title": "Fix: Search UX and multi-filter logic (frontend)", "user": {"login": "NamanOdysseyts", "id": 238778617, "node_id": "U_kgDODjt4-Q", "avatar_url": "https://avatars.githubusercontent.com/u/238778617?v=4", "gravatar_id": "", "url": "https://api.github.com/users/NamanOdysseyts", "html_url": "https://github.com/NamanOdysseyts", "followers_url": "https://api.github.com/users/NamanOdysseyts/followers", "following_url": "https://api.github.com/users/NamanOdysseyts/following{/other_user}", "gists_url": "https://api.github.com/users/NamanOdysseyts/gists{/gist_id}", "starred_url": "https://api.github.com/users/NamanOdysseyts/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/NamanOdysseyts/subscriptions", "organizations_url": "https://api.github.com/users/NamanOdysseyts/orgs", "repos_url": "https://api.github.com/users/NamanOdysseyts/repos", "events_url": "https://api.github.com/users/NamanOdysseyts/events{/privacy}", "received_events_url": "https://api.github.com/users/NamanOdysseyts/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 9561404867, "node_id": "LA_kwDOQEZhKM8AAAACOed1ww", "url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/labels/Review%20effort%202/5", "name": "Review effort 2/5", "color": "d1bcf9", "default": false, "description": null}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 89, "created_at": "2025-10-18T02:45:21Z", "updated_at": "2025-12-11T07:24:52Z", "closed_at": null, "author_association": "COLLABORATOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "html_url": "https://github.com/souravOD/nutri-b2c-frontend/pull/1", "diff_url": "https://github.com/souravOD/nutri-b2c-frontend/pull/1.diff", "patch_url": "https://github.com/souravOD/nutri-b2c-frontend/pull/1.patch", "merged_at": null}, "body": "- Improved search bar UX in app/search/page.tsx:\r\n  - X icon clears input and refocuses\r\n  - Escape key clears input\r\n  - Enter key triggers search\r\n\r\n- Updated filter count logic:\r\n  - Accurately counts all active filters\r\n  - Apply button badge reflects true total", "reactions": {"url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/1/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/1/timeline", "performed_via_github_app": null, "state_reason": null}, "comment": {"url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/comments/3640600567", "html_url": "https://github.com/souravOD/nutri-b2c-frontend/pull/1#issuecomment-3640600567", "issue_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/1", "id": 3640600567, "node_id": "IC_kwDOQEZhKM7Y_yf3", "user": {"login": "confersolutions-pr-agent-testing[bot]", "id": 241213316, "node_id": "BOT_kgDODmCfhA", "avatar_url": "https://avatars.githubusercontent.com/u/238303722?v=4", "gravatar_id": "", "url": "https://api.github.com/users/confersolutions-pr-agent-testing%5Bbot%5D", "html_url": "https://github.com/apps/confersolutions-pr-agent-testing", "followers_url": "https://api.github.com/users/confersolutions-pr-agent-testing%5Bbot%5D/followers", "following_url": "https://api.github.com/users/confersolutions-pr-agent-testing%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/confersolutions-pr-agent-testing%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/confersolutions-pr-agent-testing%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/confersolutions-pr-agent-testing%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/confersolutions-pr-agent-testing%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/confersolutions-pr-agent-testing%5Bbot%5D/repos", "events_url": "https://api.github.com/users/confersolutions-pr-agent-testing%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/confersolutions-pr-agent-testing%5Bbot%5D/received_events", "type": "Bot", "user_view_type": "public", "site_admin": false}, "created_at": "2025-12-11T07:24:52Z", "updated_at": "2025-12-11T07:24:52Z", "body": "Preparing review...", "author_association": "NONE", "reactions": {"url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/comments/3640600567/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "performed_via_github_app": {"id": 2209305, "client_id": "Iv23li7bKiGgGVtVjmWH", "slug": "confersolutions-pr-agent-testing", "node_id": "A_kwDODjQ56s4AIbYZ", "owner": {"login": "souravOD", "id": 238303722, "node_id": "U_kgDODjQ56g", "avatar_url": "https://avatars.githubusercontent.com/u/238303722?v=4", "gravatar_id": "", "url": "https://api.github.com/users/souravOD", "html_url": "https://github.com/souravOD", "followers_url": "https://api.github.com/users/souravOD/followers", "following_url": "https://api.github.com/users/souravOD/following{/other_user}", "gists_url": "https://api.github.com/users/souravOD/gists{/gist_id}", "starred_url": "https://api.github.com/users/souravOD/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/souravOD/subscriptions", "organizations_url": "https://api.github.com/users/souravOD/orgs", "repos_url": "https://api.github.com/users/souravOD/repos", "events_url": "https://api.github.com/users/souravOD/events{/privacy}", "received_events_url": "https://api.github.com/users/souravOD/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "name": "confersolutions-pr-agent-testing", "description": "", "external_url": "https://app.affine.pro/workspace/5faca6c6-75a5-4a38-a457-467462b9e9bd/4tBJ2igTRqph8VLY69JYh", "html_url": "https://github.com/apps/confersolutions-pr-agent-testing", "created_at": "2025-10-30T23:17:56Z", "updated_at": "2025-12-04T21:49:27Z", "permissions": {"actions": "read", "checks": "read", "contents": "read", "issues": "write", "metadata": "read", "pull_requests": "write", "statuses": "read"}, "events": ["commit_comment", "issues", "issue_comment", "merge_queue_entry", "pull_request", "pull_request_review", "pull_request_review_comment", "pull_request_review_thread", "push"]}}, "repository": {"id": 1078354216, "node_id": "R_kgDOQEZhKA", "name": "nutri-b2c-frontend", "full_name": "souravOD/nutri-b2c-frontend", "private": false, "owner": {"login": "souravOD", "id": 238303722, "node_id": "U_kgDODjQ56g", "avatar_url": "https://avatars.githubusercontent.com/u/238303722?v=4", "gravatar_id": "", "url": "https://api.github.com/users/souravOD", "html_url": "https://github.com/souravOD", "followers_url": "https://api.github.com/users/souravOD/followers", "following_url": "https://api.github.com/users/souravOD/following{/other_user}", "gists_url": "https://api.github.com/users/souravOD/gists{/gist_id}", "starred_url": "https://api.github.com/users/souravOD/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/souravOD/subscriptions", "organizations_url": "https://api.github.com/users/souravOD/orgs", "repos_url": "https://api.github.com/users/souravOD/repos", "events_url": "https://api.github.com/users/souravOD/events{/privacy}", "received_events_url": "https://api.github.com/users/souravOD/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "html_url": "https://github.com/souravOD/nutri-b2c-frontend", "description": null, "fork": true, "url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend", "forks_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/forks", "keys_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/keys{/key_id}", "collaborators_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/collaborators{/collaborator}", "teams_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/teams", "hooks_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/hooks", "issue_events_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/events{/number}", "events_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/events", "assignees_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/assignees{/user}", "branches_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/branches{/branch}", "tags_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/tags", "blobs_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/git/blobs{/sha}", "git_tags_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/git/tags{/sha}", "git_refs_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/git/refs{/sha}", "trees_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/git/trees{/sha}", "statuses_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/statuses/{sha}", "languages_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/languages", "stargazers_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/stargazers", "contributors_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/contributors", "subscribers_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/subscribers", "subscription_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/subscription", "commits_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/commits{/sha}", "git_commits_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/git/commits{/sha}", "comments_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/comments{/number}", "issue_comment_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/comments{/number}", "contents_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/contents/{+path}", "compare_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/compare/{base}...{head}", "merges_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/merges", "archive_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/{archive_format}{/ref}", "downloads_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/downloads", "issues_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues{/number}", "pulls_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls{/number}", "milestones_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/milestones{/number}", "notifications_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/notifications{?since,all,participating}", "labels_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/labels{/name}", "releases_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/releases{/id}", "deployments_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/deployments", "created_at": "2025-10-17T15:44:00Z", "updated_at": "2025-11-14T04:02:00Z", "pushed_at": "2025-10-16T19:32:39Z", "git_url": "git://github.com/souravOD/nutri-b2c-frontend.git", "ssh_url": "git@github.com:souravOD/nutri-b2c-frontend.git", "clone_url": "https://github.com/souravOD/nutri-b2c-frontend.git", "svn_url": "https://github.com/souravOD/nutri-b2c-frontend", "homepage": "https://v0-next-js-app-requirements-omega.vercel.app", "size": 11387, "stargazers_count": 0, "watchers_count": 0, "language": null, "has_issues": false, "has_projects": true, "has_downloads": true, "has_wiki": false, "has_pages": false, "has_discussions": false, "forks_count": 1, "mirror_url": null, "archived": false, "disabled": false, "open_issues_count": 2, "license": null, "allow_forking": true, "is_template": false, "web_commit_signoff_required": false, "topics": [], "visibility": "public", "forks": 1, "open_issues": 2, "watchers": 0, "default_branch": "main"}, "sender": {"login": "confersolutions-pr-agent-testing[bot]", "id": 241213316, "node_id": "BOT_kgDODmCfhA", "avatar_url": "https://avatars.githubusercontent.com/u/238303722?v=4", "gravatar_id": "", "url": "https://api.github.com/users/confersolutions-pr-agent-testing%5Bbot%5D", "html_url": "https://github.com/apps/confersolutions-pr-agent-testing", "followers_url": "https://api.github.com/users/confersolutions-pr-agent-testing%5Bbot%5D/followers", "following_url": "https://api.github.com/users/confersolutions-pr-agent-testing%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/confersolutions-pr-agent-testing%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/confersolutions-pr-agent-testing%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/confersolutions-pr-agent-testing%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/confersolutions-pr-agent-testing%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/confersolutions-pr-agent-testing%5Bbot%5D/repos", "events_url": "https://api.github.com/users/confersolutions-pr-agent-testing%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/confersolutions-pr-agent-testing%5Bbot%5D/received_events", "type": "Bot", "user_view_type": "public", "site_admin": false}, "installation": {"id": 92375808, "node_id": "MDIzOkludGVncmF0aW9uSW5zdGFsbGF0aW9uOTIzNzU4MDg="}}, "event": "issue_comment"}, "file": {"name": "github_app.py", "path": "/app/pr_agent/servers/github_app.py"}, "function": "handle_request", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 342, "message": "Request body", "module": "github_app", "name": "pr_agent.servers.github_app", "process": {"id": 24, "name": "MainProcess"}, "thread": {"id": 126091663866752, "name": "MainThread"}, "time": {"repr": "2025-12-11 07:24:54.132428+00:00", "timestamp": 1765437894.132428}}}
2025-Dec-11 07:24:54.132886
{"text": "Ignoring comment not starting with /\n", "record": {"elapsed": {"repr": "0:01:11.538565", "seconds": 71.538565}, "exception": null, "extra": {}, "file": {"name": "github_app.py", "path": "/app/pr_agent/servers/github_app.py"}, "function": "handle_comments_on_pr", "level": {"icon": "â„¹ï¸", "name": "INFO", "no": 20}, "line": 96, "message": "Ignoring comment not starting with /", "module": "github_app", "name": "pr_agent.servers.github_app", "process": {"id": 24, "name": "MainProcess"}, "thread": {"id": 126091663866752, "name": "MainThread"}, "time": {"repr": "2025-12-11 07:24:54.132633+00:00", "timestamp": 1765437894.132633}}}
2025-Dec-11 07:25:00.702195
{"text": "\nAI response:\nreview:\n  estimated_effort_to_review_[1-5]: |\n    2\n  relevant_tests: |\n    No\n  key_issues_to_review:\n    - relevant_file: |\n        app/search/page.tsx\n      issue_header: |\n        Possible Bug\n      issue_content: |\n        The new `X` clear button renders `` but the `X` icon import from `lucide-react` is commented out, which will cause a runtime error unless `X` is globally available; ensure the icon is properly imported or removed.\n      start_line: 3\n      end_line: 271\n    - relevant_file: |\n        app/search/page.tsx\n      issue_header: |\n        Inconsistent Styling\n      issue_content: |\n        The search input wrapper now uses inline `style` with absolute positioning instead of Tailwind/utility classes used elsewhere, which may lead to inconsistent theming and harder maintenance; consider using consistent class-based styling.\n      start_line: 238\n      end_line: 273\n    - relevant_file: |\n        components/filter-panel.tsx\n      issue_header: |\n        Potential Type Safety\n      issue_content: |\n        The new `getActiveFiltersCount` assumes `values.dietaryRestrictions`, `allergens`, `cuisines`, `majorConditions`, and `calories` are always defined arrays, which might throw if the form defaults ever change; consider defensive defaults similar to the previous implementation.\n      start_line: 85\n      end_line: 107\n  security_concerns: |\n    No\n", "record": {"elapsed": {"repr": "0:01:18.526725", "seconds": 78.526725}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "84aad2c7f2a44ec3bd9339bcf2de1e4c", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "litellm_ai_handler.py", "path": "/app/pr_agent/algo/ai_handlers/litellm_ai_handler.py"}, "function": "chat_completion", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 439, "message": "\nAI response:\nreview:\n  estimated_effort_to_review_[1-5]: |\n    2\n  relevant_tests: |\n    No\n  key_issues_to_review:\n    - relevant_file: |\n        app/search/page.tsx\n      issue_header: |\n        Possible Bug\n      issue_content: |\n        The new `X` clear button renders `` but the `X` icon import from `lucide-react` is commented out, which will cause a runtime error unless `X` is globally available; ensure the icon is properly imported or removed.\n      start_line: 3\n      end_line: 271\n    - relevant_file: |\n        app/search/page.tsx\n      issue_header: |\n        Inconsistent Styling\n      issue_content: |\n        The search input wrapper now uses inline `style` with absolute positioning instead of Tailwind/utility classes used elsewhere, which may lead to inconsistent theming and harder maintenance; consider using consistent class-based styling.\n      start_line: 238\n      end_line: 273\n    - relevant_file: |\n        components/filter-panel.tsx\n      issue_header: |\n        Potential Type Safety\n      issue_content: |\n        The new `getActiveFiltersCount` assumes `values.dietaryRestrictions`, `allergens`, `cuisines`, `majorConditions`, and `calories` are always defined arrays, which might throw if the form defaults ever change; consider defensive defaults similar to the previous implementation.\n      start_line: 85\n      end_line: 107\n  security_concerns: |\n    No", "module": "litellm_ai_handler", "name": "pr_agent.algo.ai_handlers.litellm_ai_handler", "process": {"id": 30, "name": "MainProcess"}, "thread": {"id": 126091663866752, "name": "MainThread"}, "time": {"repr": "2025-12-11 07:25:00.701645+00:00", "timestamp": 1765437900.701645}}}
2025-Dec-11 07:25:00.702591
{"text": "Failed to generate prediction with openai/gpt-5.1\n", "record": {"elapsed": {"repr": "0:01:18.527201", "seconds": 78.527201}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "84aad2c7f2a44ec3bd9339bcf2de1e4c", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "artifact": {"error": "'dict' object has no attribute 'dict'"}}, "file": {"name": "pr_processing.py", "path": "/app/pr_agent/algo/pr_processing.py"}, "function": "retry_with_fallback_models", "level": {"icon": "âš ï¸", "name": "WARNING", "no": 30}, "line": 333, "message": "Failed to generate prediction with openai/gpt-5.1", "module": "pr_processing", "name": "pr_agent.algo.pr_processing", "process": {"id": 30, "name": "MainProcess"}, "thread": {"id": 126091663866752, "name": "MainThread"}, "time": {"repr": "2025-12-11 07:25:00.702121+00:00", "timestamp": 1765437900.702121}}}
2025-Dec-11 07:25:00.702662
{"text": "Generating prediction with openai/gpt-5\n", "record": {"elapsed": {"repr": "0:01:18.527293", "seconds": 78.527293}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "84aad2c7f2a44ec3bd9339bcf2de1e4c", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "pr_processing.py", "path": "/app/pr_agent/algo/pr_processing.py"}, "function": "retry_with_fallback_models", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 326, "message": "Generating prediction with openai/gpt-5", "module": "pr_processing", "name": "pr_agent.algo.pr_processing", "process": {"id": 30, "name": "MainProcess"}, "thread": {"id": 126091663866752, "name": "MainThread"}, "time": {"repr": "2025-12-11 07:25:00.702213+00:00", "timestamp": 1765437900.702213}}}
2025-Dec-11 07:25:00.817755
{"text": "PR main language: TypeScript\n", "record": {"elapsed": {"repr": "0:01:18.642337", "seconds": 78.642337}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "84aad2c7f2a44ec3bd9339bcf2de1e4c", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "pr_processing.py", "path": "/app/pr_agent/algo/pr_processing.py"}, "function": "get_pr_diff", "level": {"icon": "â„¹ï¸", "name": "INFO", "no": 20}, "line": 63, "message": "PR main language: TypeScript", "module": "pr_processing", "name": "pr_agent.algo.pr_processing", "process": {"id": 30, "name": "MainProcess"}, "thread": {"id": 126091663866752, "name": "MainThread"}, "time": {"repr": "2025-12-11 07:25:00.817257+00:00", "timestamp": 1765437900.817257}}}
2025-Dec-11 07:25:00.828612
{"text": "Tokens: 4738, total tokens under limit: 32000, returning full diff.\n", "record": {"elapsed": {"repr": "0:01:18.652777", "seconds": 78.652777}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "84aad2c7f2a44ec3bd9339bcf2de1e4c", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "pr_processing.py", "path": "/app/pr_agent/algo/pr_processing.py"}, "function": "get_pr_diff", "level": {"icon": "â„¹ï¸", "name": "INFO", "no": 20}, "line": 74, "message": "Tokens: 4738, total tokens under limit: 32000, returning full diff.", "module": "pr_processing", "name": "pr_agent.algo.pr_processing", "process": {"id": 30, "name": "MainProcess"}, "thread": {"id": 126091663866752, "name": "MainThread"}, "time": {"repr": "2025-12-11 07:25:00.827697+00:00", "timestamp": 1765437900.827697}}}
2025-Dec-11 07:25:00.828702
{"text": "PR diff\n", "record": {"elapsed": {"repr": "0:01:18.653059", "seconds": 78.653059}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "84aad2c7f2a44ec3bd9339bcf2de1e4c", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "diff": "\n\n## File: 'app/search/page.tsx'\n\n@@ -1,7 +1,8 @@\n__new hunk__\n1  \"use client\"\n2  \n3 +import { useState, useEffect, useMemo, useRef } from \"react\"\n4 +// import { X } from \"lucide-react\"\n5  import { useSearchParams, useRouter } from \"next/navigation\"\n6  import { useQuery } from \"@tanstack/react-query\"\n7  import { Input } from \"@/components/ui/input\"\n8  import { Button } from \"@/components/ui/button\"\n__old hunk__\n \"use client\"\n \n-import { useState, useEffect, useMemo } from \"react\"\n import { useSearchParams, useRouter } from \"next/navigation\"\n import { useQuery } from \"@tanstack/react-query\"\n import { Input } from \"@/components/ui/input\"\n import { Button } from \"@/components/ui/button\"\n\n@@ -41,11 +42,12 @@\n__new hunk__\n42  export default function SearchPage() {\n43    const searchParams = useSearchParams()\n44    const router = useRouter()\n45    const { filters, setFilters, resetFilters } = useFilters()\n46    const { settings } = useSettings()\n47  \n48    const [searchQuery, setSearchQuery] = useState(searchParams.get(\"q\") || filters.q || \"\")\n49 +  const inputRef = useRef(null);\n50    const [sortBy, setSortBy] = useState(settings.behavior.defaultSort || \"time\")\n51    const [filtersOpen, setFiltersOpen] = useState(false)\n52  \n53    // Update search query from URL params\n\n@@ -75,29 +77,54 @@ export default function SearchPage() {\n__new hunk__\n77        filters.fiberMin > 0 ||\n78        filters.sugarMax < 100 ||\n79        filters.sodiumMax < 4000 ||\n80        filters.maxTime < 120 ||\n81        !!filters.mealType\n82      )\n83    }, [filters])\n84  \n85 +  // const activeFilterCount = useMemo(() => {\n86 +  //   let count = 0\n87 +  //   if (filters.dietaryRestrictions.length > 0) count++\n88 +  //   if (filters.allergens.length > 0) count++\n89 +  //   if (filters.cuisines.length > 0) count++\n90 +  //   if (filters.majorConditions.length > 0) count++\n91 +  //   if (filters.calories[0] > 0 || filters.calories[1] < 1200) count++\n92 +  //   if (filters.proteinMin > 0) count++\n93 +  //   if (filters.carbsMin > 0) count++\n94 +  //   if (filters.fatMin > 0) count++\n95 +  //   if (filters.fiberMin > 0) count++\n96 +  //   if (filters.sugarMax < 100) count++\n97 +  //   if (filters.sodiumMax < 4000) count++\n98 +  //   if (filters.maxTime < 120) count++\n99 +  //   if (filters.mealType) count++\n100 +  //   return count\n101 +  // }, [filters])\n102    const activeFilterCount = useMemo(() => {\n103 +    let count = 0;\n104 +\n105 +  // Sum all selected array filters\n106 +    count += filters.dietaryRestrictions.length;\n107 +    count += filters.allergens.length;\n108 +    count += filters.cuisines.length;\n109 +    count += filters.majorConditions.length;\n110 +\n111 +    // Range and min/max filters\n112 +    if (filters.calories[0] > 0) count++; // Min calories\n113 +    if (filters.calories[1] < 1200) count++; // Max calories\n114 +    if (filters.proteinMin > 0) count++;\n115 +    if (filters.carbsMin > 0) count++;\n116 +    if (filters.fatMin > 0) count++;\n117 +    if (filters.fiberMin > 0) count++;\n118 +    if (filters.sugarMax < 100) count++;\n119 +    if (filters.sodiumMax < 4000) count++;\n120 +    if (filters.maxTime < 120) count++;\n121 +    \n122 +    // Single-value selection\n123 +    if (filters.mealType) count++;\n124 +\n125 +    return count;\n126 +  }, [filters]);\n127  \n128    const {\n129      data: searchResults = [],\n130      isLoading,\n__old hunk__\n       filters.fiberMin > 0 ||\n       filters.sugarMax < 100 ||\n       filters.sodiumMax < 4000 ||\n       filters.maxTime < 120 ||\n       !!filters.mealType\n     )\n   }, [filters])\n \n   const activeFilterCount = useMemo(() => {\n-    let count = 0\n-    if (filters.dietaryRestrictions.length > 0) count++\n-    if (filters.allergens.length > 0) count++\n-    if (filters.cuisines.length > 0) count++\n-    if (filters.majorConditions.length > 0) count++\n-    if (filters.calories[0] > 0 || filters.calories[1] < 1200) count++\n-    if (filters.proteinMin > 0) count++\n-    if (filters.carbsMin > 0) count++\n-    if (filters.fatMin > 0) count++\n-    if (filters.fiberMin > 0) count++\n-    if (filters.sugarMax < 100) count++\n-    if (filters.sodiumMax < 4000) count++\n-    if (filters.maxTime < 120) count++\n-    if (filters.mealType) count++\n-    return count\n-  }, [filters])\n \n   const {\n     data: searchResults = [],\n     isLoading,\n\n@@ -113,12 +140,22 @@ export default function SearchPage() {\n__new hunk__\n140          const rankedResults = rank(rawResults, settings)\n141          return rankedResults\n142        }\n143  \n144        return rawResults.map((recipe) => ({ ...recipe, score: 0 }))\n145      },\n146      enabled: !!(searchQuery || hasActiveFilters),\n147    })\n148 +  const handleSearchInputKeyDown = (e: React.KeyboardEvent) => {\n149 +    if (e.key === \"Escape\" && searchQuery) {\n150 +      setSearchQuery(\"\");\n151 +      inputRef.current?.focus();\n152 +    }\n153 +    if (e.key === \"Enter\") {\n154 +      handleSearch(searchQuery);\n155 +    }\n156 +  };\n157 +\n158  \n159    const handleSearch = (query: string) => {\n160      setSearchQuery(query)\n161      setFilters({ ...filters, q: query })\n\n@@ -182,13 +219,13 @@ export default function SearchPage() {\n__new hunk__\n219    return (\n220      \n221        \n222          {/* Search Header */}\n223          \n224            Search Recipes\n225  \n226            {/* Search Input */}\n227 +          {/* \n228              \n229              \n       \n         {/* Search Header */}\n         \n           Search Recipes\n \n           {/* Search Input */}\n-          \n             \n              setSearchQuery(e.target.value)}\n234                onKeyDown={(e) => e.key === \"Enter\" && handleSearch(searchQuery)}\n235                className=\"pl-10 pr-4 h-12 text-lg\"\n236              />\n237 +           */}\n238 +          \n239 +            \n240 +             setSearchQuery(e.target.value)}\n246 +              onKeyDown={handleSearchInputKeyDown}\n247 +              style={{ paddingRight: searchQuery ? \"2rem\" : undefined, width: \"100%\" }}\n248 +              className=\"pl-10 pr-4 h-12 text-lg\"\n249 +            />\n250 +            {searchQuery && (\n251 +               {\n266 +                  setSearchQuery(\"\");\n267 +                  inputRef.current?.focus();\n268 +              }}\n269 +              >\n270 +                \n271 +            \n272 +          )}\n273            \n274  \n275 +\n276            {/* Search Actions */}\n277            \n278               handleSearch(searchQuery)} size=\"sm\">\n279                Search\n\n\n## File: 'components/filter-panel.tsx'\n\n@@ -54,35 +54,58 @@\n__new hunk__\n54  export function FilterPanel({ open, onOpenChange, initialValues, onApply, onReset }: FilterPanelProps) {\n55    const form = useForm({\n56      resolver: zodResolver(schema),\n57      // provide full defaults (OUTPUT fits into INPUT just fine)\n58      defaultValues: schema.parse(initialValues ?? {}),\n59      mode: \"onChange\",\n60    })\n61  \n62     useEffect(() => {\n63      form.reset(schema.parse(initialValues ?? {}));\n64    }, [open, initialValues, form]);\n65  \n66 +  // function getActiveFiltersCount(): number {\n67 +  //   const values = form.getValues()\n68 +  //   let count = 0\n69 +  //   if ((values.dietaryRestrictions || []).length > 0) count++\n70 +  //   if ((values.allergens || []).length > 0) count++\n71 +  //   if ((values.cuisines || []).length > 0) count++\n72 +  //   if ((values.majorConditions || []).length > 0) count++\n73 +  //   if (values.calories && (values.calories[0] > 0 || values.calories[1] < 1200)) count++\n74 +  //   if ((values.proteinMin || 0) > 0) count++\n75 +  //   if ((values.carbsMin || 0) > 0) count++\n76 +  //   if ((values.fatMin || 0) > 0) count++\n77 +  //   if ((values.fiberMin || 0) > 0) count++\n78 +  //   if ((values.sugarMax || 100) < 100) count++\n79 +  //   if ((values.sodiumMax || 4000) < 4000) count++\n80 +  //   if ((values.maxTime || 120) < 120) count++\n81 +  //   if ((values.mealType || \"\") !== \"\") count++\n82 +  //   return count\n83 +  // }\n84    function getActiveFiltersCount(): number {\n85 +    const values = form.getValues();\n86 +    let count = 0;\n87 +\n88 +    // Count all selected array filters individually\n89 +    count += values.dietaryRestrictions.length;\n90 +    count += values.allergens.length;\n91 +    count += values.cuisines.length;\n92 +    count += values.majorConditions.length;\n93 +\n94 +    // Numeric and single-value filters\n95 +    if (values.calories[0] > 0) count++;           // Min calories\n96 +    if (values.calories[1] < 1200) count++;        // Max calories\n97 +    if (values.proteinMin > 0) count++;\n98 +    if (values.carbsMin > 0) count++;\n99 +    if (values.fatMin > 0) count++;\n100 +    if (values.fiberMin > 0) count++;\n101 +    if (values.sugarMax < 100) count++;\n102 +    if (values.sodiumMax < 4000) count++;\n103 +    if (values.maxTime < 120) count++;\n104 +    if (values.mealType) count++;\n105 +\n106 +    return count;\n107    }\n108    function handleApply() {\n109      const values = schema.parse(form.getValues())\n110      onApply(values)\n111      onOpenChange(false)\n__old hunk__\n export function FilterPanel({ open, onOpenChange, initialValues, onApply, onReset }: FilterPanelProps) {\n   const form = useForm({\n     resolver: zodResolver(schema),\n     // provide full defaults (OUTPUT fits into INPUT just fine)\n     defaultValues: schema.parse(initialValues ?? {}),\n     mode: \"onChange\",\n   })\n \n    useEffect(() => {\n     form.reset(schema.parse(initialValues ?? {}));\n   }, [open, initialValues, form]);\n \n   function getActiveFiltersCount(): number {\n-    const values = form.getValues()\n-    let count = 0\n-    if ((values.dietaryRestrictions || []).length > 0) count++\n-    if ((values.allergens || []).length > 0) count++\n-    if ((values.cuisines || []).length > 0) count++\n-    if ((values.majorConditions || []).length > 0) count++\n-    if (values.calories && (values.calories[0] > 0 || values.calories[1] < 1200)) count++\n-    if ((values.proteinMin || 0) > 0) count++\n-    if ((values.carbsMin || 0) > 0) count++\n-    if ((values.fatMin || 0) > 0) count++\n-    if ((values.fiberMin || 0) > 0) count++\n-    if ((values.sugarMax || 100) < 100) count++\n-    if ((values.sodiumMax || 4000) < 4000) count++\n-    if ((values.maxTime || 120) < 120) count++\n-    if ((values.mealType || \"\") !== \"\") count++\n-    return count\n   }\n-\n   function handleApply() {\n     const values = schema.parse(form.getValues())\n     onApply(values)\n     onOpenChange(false)"}, "file": {"name": "pr_reviewer.py", "path": "/app/pr_agent/tools/pr_reviewer.py"}, "function": "_prepare_prediction", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 197, "message": "PR diff", "module": "pr_reviewer", "name": "pr_agent.tools.pr_reviewer", "process": {"id": 30, "name": "MainProcess"}, "thread": {"id": 126091663866752, "name": "MainThread"}, "time": {"repr": "2025-12-11 07:25:00.827979+00:00", "timestamp": 1765437900.827979}}}
2025-Dec-11 07:25:00.844896
{"text": "Prompts\n", "record": {"elapsed": {"repr": "0:01:18.668847", "seconds": 78.668847}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "84aad2c7f2a44ec3bd9339bcf2de1e4c", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "artifact": {"system": "You are PR-Reviewer, a language model designed to review a Git Pull Request (PR).\nYour task is to provide constructive and concise feedback for the PR.\nThe review should focus on new code added in the PR code diff (lines starting with '+')\n\n\nThe format we will use to present the PR code diff:\n======\n## File: 'src/file1.py'\n\n\n@@ ... @@ def func1():\n__new hunk__\n11  unchanged code line0\n12  unchanged code line1\n13 +new code line2 added\n14  unchanged code line3\n__old hunk__\n unchanged code line0\n unchanged code line1\n-old code line2 removed\n unchanged code line3\n\n@@ ... @@ def func2():\n__new hunk__\n unchanged code line4\n+new code line5 added\n unchanged code line6\n\n## File: 'src/file2.py'\n...\n======\n\n- In the format above, the diff is organized into separate '__new hunk__' and '__old hunk__' sections for each code chunk. '__new hunk__' contains the updated code, while '__old hunk__' shows the removed code. If no code was removed in a specific chunk, the __old hunk__ section will be omitted.\n- We also added line numbers for the '__new hunk__' code, to help you refer to the code lines in your suggestions. These line numbers are not part of the actual code, and should only be used for reference.\n- Code lines are prefixed with symbols ('+', '-', ' '). The '+' symbol indicates new code added in the PR, the '-' symbol indicates code removed in the PR, and the ' ' symbol indicates unchanged code. The review should address new code added in the PR code diff (lines starting with '+').\n- When quoting variables, names or file paths from the code, use backticks (`) instead of single quote (').\n- Note that you only see changed code segments (diff hunks in a PR), not the entire codebase. Avoid suggestions that might duplicate existing functionality or questioning code elements (like variables declarations or import statements) that may be defined elsewhere in the codebase.\n- Also note that if the code ends at an opening brace or statement that begins a new scope (like 'if', 'for', 'try'), don't treat it as incomplete. Instead, acknowledge the visible scope boundary and analyze only the code shown.\n\n\nThe output must be a YAML object equivalent to type $PRReview, according to the following Pydantic definitions:\n=====\n\nclass KeyIssuesComponentLink(BaseModel):\n    relevant_file: str = Field(description=\"The full file path of the relevant file\")\n    issue_header: str = Field(description=\"One or two word title for the issue. For example: 'Possible Bug', etc.\")\n    issue_content: str = Field(description=\"A short and concise summary of what should be further inspected and validated during the PR review process for this issue. Do not mention line numbers in this field.\")\n    start_line: int = Field(description=\"The start line that corresponds to this issue in the relevant file\")\n    end_line: int = Field(description=\"The end line that corresponds to this issue in the relevant file\")\n\nclass Review(BaseModel):\n    estimated_effort_to_review_[1-5]: int = Field(description=\"Estimate, on a scale of 1-5 (inclusive), the time and effort required to review this PR by an experienced and knowledgeable developer. 1 means short and easy review , 5 means long and hard review. Take into account the size, complexity, quality, and the needed changes of the PR code diff.\")\n    relevant_tests: str = Field(description=\"yes/no question: does this PR have relevant tests added or updated ?\")\n    key_issues_to_review: List[KeyIssuesComponentLink] = Field(\"A short and diverse list (0-3 issues) of high-priority bugs, problems or performance concerns introduced in the PR code, which the PR reviewer should further focus on and validate during the review process.\")\n    security_concerns: str = Field(description=\"Does this PR code introduce vulnerabilities such as exposure of sensitive information (e.g., API keys, secrets, passwords), or security concerns like SQL injection, XSS, CSRF, and others ? Answer 'No' (without explaining why) if there are no possible issues. If there are security concerns or issues, start your answer with a short header, such as: 'Sensitive information exposure: ...', 'SQL injection: ...', etc. Explain your answer. Be specific and give examples if possible\")\n\nclass PRReview(BaseModel):\n    review: Review\n=====\n\n\nExample output:\n```yaml\nreview:\n  estimated_effort_to_review_[1-5]: |\n    3\n  relevant_tests: |\n    No\n  key_issues_to_review:\n    - relevant_file: |\n        directory/xxx.py\n      issue_header: |\n        Possible Bug\n      issue_content: |\n        ...\n      start_line: 12\n      end_line: 14\n    - ...\n  security_concerns: |\n    No\n```\n\nAnswer should be a valid YAML, and nothing else. Each YAML output MUST be after a newline, with proper indent, and block scalar indicator ('|')", "user": "\n\n\n--PR Info--\n\nToday's Date: 2025-12-11\n\nTitle: 'Fix: Search UX and multi-filter logic (frontend)'\n\nBranch: 'feature/initial-fixes'\n\nPR Description:\n======\n- Improved search bar UX in app/search/page.tsx:\r\n  - X icon clears input and refocuses\r\n  - Escape key clears input\r\n  - Enter key triggers search\r\n\r\n- Updated filter count logic:\r\n  - Accurately counts all active filters\r\n  - Apply button badge reflects true total\n======\n\n\nThe PR code diff:\n======\n## File: 'app/search/page.tsx'\n\n@@ -1,7 +1,8 @@\n__new hunk__\n1  \"use client\"\n2  \n3 +import { useState, useEffect, useMemo, useRef } from \"react\"\n4 +// import { X } from \"lucide-react\"\n5  import { useSearchParams, useRouter } from \"next/navigation\"\n6  import { useQuery } from \"@tanstack/react-query\"\n7  import { Input } from \"@/components/ui/input\"\n8  import { Button } from \"@/components/ui/button\"\n__old hunk__\n \"use client\"\n \n-import { useState, useEffect, useMemo } from \"react\"\n import { useSearchParams, useRouter } from \"next/navigation\"\n import { useQuery } from \"@tanstack/react-query\"\n import { Input } from \"@/components/ui/input\"\n import { Button } from \"@/components/ui/button\"\n\n@@ -41,11 +42,12 @@\n__new hunk__\n42  export default function SearchPage() {\n43    const searchParams = useSearchParams()\n44    const router = useRouter()\n45    const { filters, setFilters, resetFilters } = useFilters()\n46    const { settings } = useSettings()\n47  \n48    const [searchQuery, setSearchQuery] = useState(searchParams.get(\"q\") || filters.q || \"\")\n49 +  const inputRef = useRef(null);\n50    const [sortBy, setSortBy] = useState(settings.behavior.defaultSort || \"time\")\n51    const [filtersOpen, setFiltersOpen] = useState(false)\n52  \n53    // Update search query from URL params\n\n@@ -75,29 +77,54 @@ export default function SearchPage() {\n__new hunk__\n77        filters.fiberMin > 0 ||\n78        filters.sugarMax < 100 ||\n79        filters.sodiumMax < 4000 ||\n80        filters.maxTime < 120 ||\n81        !!filters.mealType\n82      )\n83    }, [filters])\n84  \n85 +  // const activeFilterCount = useMemo(() => {\n86 +  //   let count = 0\n87 +  //   if (filters.dietaryRestrictions.length > 0) count++\n88 +  //   if (filters.allergens.length > 0) count++\n89 +  //   if (filters.cuisines.length > 0) count++\n90 +  //   if (filters.majorConditions.length > 0) count++\n91 +  //   if (filters.calories[0] > 0 || filters.calories[1] < 1200) count++\n92 +  //   if (filters.proteinMin > 0) count++\n93 +  //   if (filters.carbsMin > 0) count++\n94 +  //   if (filters.fatMin > 0) count++\n95 +  //   if (filters.fiberMin > 0) count++\n96 +  //   if (filters.sugarMax < 100) count++\n97 +  //   if (filters.sodiumMax < 4000) count++\n98 +  //   if (filters.maxTime < 120) count++\n99 +  //   if (filters.mealType) count++\n100 +  //   return count\n101 +  // }, [filters])\n102    const activeFilterCount = useMemo(() => {\n103 +    let count = 0;\n104 +\n105 +  // Sum all selected array filters\n106 +    count += filters.dietaryRestrictions.length;\n107 +    count += filters.allergens.length;\n108 +    count += filters.cuisines.length;\n109 +    count += filters.majorConditions.length;\n110 +\n111 +    // Range and min/max filters\n112 +    if (filters.calories[0] > 0) count++; // Min calories\n113 +    if (filters.calories[1] < 1200) count++; // Max calories\n114 +    if (filters.proteinMin > 0) count++;\n115 +    if (filters.carbsMin > 0) count++;\n116 +    if (filters.fatMin > 0) count++;\n117 +    if (filters.fiberMin > 0) count++;\n118 +    if (filters.sugarMax < 100) count++;\n119 +    if (filters.sodiumMax < 4000) count++;\n120 +    if (filters.maxTime < 120) count++;\n121 +    \n122 +    // Single-value selection\n123 +    if (filters.mealType) count++;\n124 +\n125 +    return count;\n126 +  }, [filters]);\n127  \n128    const {\n129      data: searchResults = [],\n130      isLoading,\n__old hunk__\n       filters.fiberMin > 0 ||\n       filters.sugarMax < 100 ||\n       filters.sodiumMax < 4000 ||\n       filters.maxTime < 120 ||\n       !!filters.mealType\n     )\n   }, [filters])\n \n   const activeFilterCount = useMemo(() => {\n-    let count = 0\n-    if (filters.dietaryRestrictions.length > 0) count++\n-    if (filters.allergens.length > 0) count++\n-    if (filters.cuisines.length > 0) count++\n-    if (filters.majorConditions.length > 0) count++\n-    if (filters.calories[0] > 0 || filters.calories[1] < 1200) count++\n-    if (filters.proteinMin > 0) count++\n-    if (filters.carbsMin > 0) count++\n-    if (filters.fatMin > 0) count++\n-    if (filters.fiberMin > 0) count++\n-    if (filters.sugarMax < 100) count++\n-    if (filters.sodiumMax < 4000) count++\n-    if (filters.maxTime < 120) count++\n-    if (filters.mealType) count++\n-    return count\n-  }, [filters])\n \n   const {\n     data: searchResults = [],\n     isLoading,\n\n@@ -113,12 +140,22 @@ export default function SearchPage() {\n__new hunk__\n140          const rankedResults = rank(rawResults, settings)\n141          return rankedResults\n142        }\n143  \n144        return rawResults.map((recipe) => ({ ...recipe, score: 0 }))\n145      },\n146      enabled: !!(searchQuery || hasActiveFilters),\n147    })\n148 +  const handleSearchInputKeyDown = (e: React.KeyboardEvent) => {\n149 +    if (e.key === \"Escape\" && searchQuery) {\n150 +      setSearchQuery(\"\");\n151 +      inputRef.current?.focus();\n152 +    }\n153 +    if (e.key === \"Enter\") {\n154 +      handleSearch(searchQuery);\n155 +    }\n156 +  };\n157 +\n158  \n159    const handleSearch = (query: string) => {\n160      setSearchQuery(query)\n161      setFilters({ ...filters, q: query })\n\n@@ -182,13 +219,13 @@ export default function SearchPage() {\n__new hunk__\n219    return (\n220      \n221        \n222          {/* Search Header */}\n223          \n224            Search Recipes\n225  \n226            {/* Search Input */}\n227 +          {/* \n228              \n229              \n       \n         {/* Search Header */}\n         \n           Search Recipes\n \n           {/* Search Input */}\n-          \n             \n              setSearchQuery(e.target.value)}\n234                onKeyDown={(e) => e.key === \"Enter\" && handleSearch(searchQuery)}\n235                className=\"pl-10 pr-4 h-12 text-lg\"\n236              />\n237 +           */}\n238 +          \n239 +            \n240 +             setSearchQuery(e.target.value)}\n246 +              onKeyDown={handleSearchInputKeyDown}\n247 +              style={{ paddingRight: searchQuery ? \"2rem\" : undefined, width: \"100%\" }}\n248 +              className=\"pl-10 pr-4 h-12 text-lg\"\n249 +            />\n250 +            {searchQuery && (\n251 +               {\n266 +                  setSearchQuery(\"\");\n267 +                  inputRef.current?.focus();\n268 +              }}\n269 +              >\n270 +                \n271 +            \n272 +          )}\n273            \n274  \n275 +\n276            {/* Search Actions */}\n277            \n278               handleSearch(searchQuery)} size=\"sm\">\n279                Search\n\n\n## File: 'components/filter-panel.tsx'\n\n@@ -54,35 +54,58 @@\n__new hunk__\n54  export function FilterPanel({ open, onOpenChange, initialValues, onApply, onReset }: FilterPanelProps) {\n55    const form = useForm({\n56      resolver: zodResolver(schema),\n57      // provide full defaults (OUTPUT fits into INPUT just fine)\n58      defaultValues: schema.parse(initialValues ?? {}),\n59      mode: \"onChange\",\n60    })\n61  \n62     useEffect(() => {\n63      form.reset(schema.parse(initialValues ?? {}));\n64    }, [open, initialValues, form]);\n65  \n66 +  // function getActiveFiltersCount(): number {\n67 +  //   const values = form.getValues()\n68 +  //   let count = 0\n69 +  //   if ((values.dietaryRestrictions || []).length > 0) count++\n70 +  //   if ((values.allergens || []).length > 0) count++\n71 +  //   if ((values.cuisines || []).length > 0) count++\n72 +  //   if ((values.majorConditions || []).length > 0) count++\n73 +  //   if (values.calories && (values.calories[0] > 0 || values.calories[1] < 1200)) count++\n74 +  //   if ((values.proteinMin || 0) > 0) count++\n75 +  //   if ((values.carbsMin || 0) > 0) count++\n76 +  //   if ((values.fatMin || 0) > 0) count++\n77 +  //   if ((values.fiberMin || 0) > 0) count++\n78 +  //   if ((values.sugarMax || 100) < 100) count++\n79 +  //   if ((values.sodiumMax || 4000) < 4000) count++\n80 +  //   2025-12-11T07:25:00.844896788Z if ((values.maxTime || 120) < 120) count++\n81 +  //   if ((values.mealType || \"\") !== \"\") count++\n82 +  //   return count\n83 +  // }\n84    function getActiveFiltersCount(): number {\n85 +    const values = form.getValues();\n86 +    let count = 0;\n87 +\n88 +    // Count all selected array filters individually\n89 +    count += values.dietaryRestrictions.length;\n90 +    count += values.allergens.length;\n91 +    count += values.cuisines.length;\n92 +    count += values.majorConditions.length;\n93 +\n94 +    // Numeric and single-value filters\n95 +    if (values.calories[0] > 0) count++;           // Min calories\n96 +    if (values.calories[1] < 1200) count++;        // Max calories\n97 +    if (values.proteinMin > 0) count++;\n98 +    if (values.carbsMin > 0) count++;\n99 +    if (values.fatMin > 0) count++;\n100 +    if (values.fiberMin > 0) count++;\n101 +    if (values.sugarMax < 100) count++;\n102 +    if (values.sodiumMax < 4000) count++;\n103 +    if (values.maxTime < 120) count++;\n104 +    if (values.mealType) count++;\n105 +\n106 +    return count;\n107    }\n108    function handleApply() {\n109      const values = schema.parse(form.getValues())\n110      onApply(values)\n111      onOpenChange(false)\n__old hunk__\n export function FilterPanel({ open, onOpenChange, initialValues, onApply, onReset }: FilterPanelProps) {\n   const form = useForm({\n     resolver: zodResolver(schema),\n     // provide full defaults (OUTPUT fits into INPUT just fine)\n     defaultValues: schema.parse(initialValues ?? {}),\n     mode: \"onChange\",\n   })\n \n    useEffect(() => {\n     form.reset(schema.parse(initialValues ?? {}));\n   }, [open, initialValues, form]);\n \n   function getActiveFiltersCount(): number {\n-    const values = form.getValues()\n-    let count = 0\n-    if ((values.dietaryRestrictions || []).length > 0) count++\n-    if ((values.allergens || []).length > 0) count++\n-    if ((values.cuisines || []).length > 0) count++\n-    if ((values.majorConditions || []).length > 0) count++\n-    if (values.calories && (values.calories[0] > 0 || values.calories[1] < 1200)) count++\n-    if ((values.proteinMin || 0) > 0) count++\n-    if ((values.carbsMin || 0) > 0) count++\n-    if ((values.fatMin || 0) > 0) count++\n-    if ((values.fiberMin || 0) > 0) count++\n-    if ((values.sugarMax || 100) < 100) count++\n-    if ((values.sodiumMax || 4000) < 4000) count++\n-    if ((values.maxTime || 120) < 120) count++\n-    if ((values.mealType || \"\") !== \"\") count++\n-    return count\n   }\n-\n   function handleApply() {\n     const values = schema.parse(form.getValues())\n     onApply(values)\n     onOpenChange(false)\n======\n\n\nResponse (should be a valid YAML, and nothing else):\n```yaml"}}, "file": {"name": "litellm_ai_handler.py", "path": "/app/pr_agent/algo/ai_handlers/litellm_ai_handler.py"}, "function": "chat_completion", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 397, "message": "Prompts", "module": "litellm_ai_handler", "name": "pr_agent.algo.ai_handlers.litellm_ai_handler", "process": {"id": 30, "name": "MainProcess"}, "thread": {"id": 126091663866752, "name": "MainThread"}, "time": {"repr": "2025-12-11 07:25:00.843767+00:00", "timestamp": 1765437900.843767}}}
2025-Dec-11 07:25:00.845382
{"text": "LiteLLM call model='openai/gpt-5'\n", "record": {"elapsed": {"repr": "0:01:18.669755", "seconds": 78.669755}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "84aad2c7f2a44ec3bd9339bcf2de1e4c", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "litellm_ai_handler.py", "path": "/app/pr_agent/algo/ai_handlers/litellm_ai_handler.py"}, "function": "chat_completion", "level": {"icon": "âš ï¸", "name": "WARNING", "no": 30}, "line": 426, "message": "LiteLLM call model='openai/gpt-5'", "module": "litellm_ai_handler", "name": "pr_agent.algo.ai_handlers.litellm_ai_handler", "process": {"id": 30, "name": "MainProcess"}, "thread": {"id": 126091663866752, "name": "MainThread"}, "time": {"repr": "2025-12-11 07:25:00.844675+00:00", "timestamp": 1765437900.844675}}}
2025-Dec-11 07:25:00.845388
{"text": "Using OpenAI client directly for LiteLLM proxy with model: openai/gpt-5\n", "record": {"elapsed": {"repr": "0:01:18.669920", "seconds": 78.66992}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "84aad2c7f2a44ec3bd9339bcf2de1e4c", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "litellm_ai_handler.py", "path": "/app/pr_agent/algo/ai_handlers/litellm_ai_handler.py"}, "function": "_get_completion", "level": {"icon": "â„¹ï¸", "name": "INFO", "no": 20}, "line": 473, "message": "Using OpenAI client directly for LiteLLM proxy with model: openai/gpt-5", "module": "litellm_ai_handler", "name": "pr_agent.algo.ai_handlers.litellm_ai_handler", "process": {"id": 30, "name": "MainProcess"}, "thread": {"id": 126091663866752, "name": "MainThread"}, "time": {"repr": "2025-12-11 07:25:00.844840+00:00", "timestamp": 1765437900.84484}}}
2025-Dec-11 07:26:14.481412
{"text": "\nAI response:\nreview:\n  estimated_effort_to_review_[1-5]: |\n    2\n  relevant_tests: |\n    No\n  key_issues_to_review:\n    - relevant_file: |\n        app/search/page.tsx\n      issue_header: |\n        Missing Import\n      issue_content: |\n        The clear button renders an `X` icon but its import is commented out, which will cause a compile/runtime error. Import `X` from `lucide-react` or replace it with an existing icon.\n      start_line: 270\n      end_line: 271\n    - relevant_file: |\n        app/search/page.tsx\n      issue_header: |\n        Type Error\n      issue_content: |\n        The handler uses `React.KeyboardEvent` in a type position without importing the `React` namespace. Add a type import (e.g., `import type React from \"react\"` or `import type { KeyboardEvent } from \"react\"` and use `KeyboardEvent`).\n      start_line: 148\n      end_line: 156\n    - relevant_file: |\n        app/search/page.tsx\n      issue_header: |\n        UX/State Sync\n      issue_content: |\n        Clearing via the X button or Escape updates only local `searchQuery` and does not sync `filters.q` or the URL, which can leave results out-of-sync. Consider calling `handleSearch(\"\")` (and updating the query param) when clearing.\n      start_line: 266\n      end_line: 269\n  security_concerns: |\n    No\n", "record": {"elapsed": {"repr": "0:02:32.305979", "seconds": 152.305979}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "84aad2c7f2a44ec3bd9339bcf2de1e4c", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "litellm_ai_handler.py", "path": "/app/pr_agent/algo/ai_handlers/litellm_ai_handler.py"}, "function": "chat_completion", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 439, "message": "\nAI response:\nreview:\n  estimated_effort_to_review_[1-5]: |\n    2\n  relevant_tests: |\n    No\n  key_issues_to_review:\n    - relevant_file: |\n        app/search/page.tsx\n      issue_header: |\n        Missing Import\n      issue_content: |\n        The clear button renders an `X` icon but its import is commented out, which will cause a compile/runtime error. Import `X` from `lucide-react` or replace it with an existing icon.\n      start_line: 270\n      end_line: 271\n    - relevant_file: |\n        app/search/page.tsx\n      issue_header: |\n        Type Error\n      issue_content: |\n        The handler uses `React.KeyboardEvent` in a type position without importing the `React` namespace. Add a type import (e.g., `import type React from \"react\"` or `import type { KeyboardEvent } from \"react\"` and use `KeyboardEvent`).\n      start_line: 148\n      end_line: 156\n    - relevant_file: |\n        app/search/page.tsx\n      issue_header: |\n        UX/State Sync\n      issue_content: |\n        Clearing via the X button or Escape updates only local `searchQuery` and does not sync `filters.q` or the URL, which can leave results out-of-sync. Consider calling `handleSearch(\"\")` (and updating the query param) when clearing.\n      start_line: 266\n      end_line: 269\n  security_concerns: |\n    No", "module": "litellm_ai_handler", "name": "pr_agent.algo.ai_handlers.litellm_ai_handler", "process": {"id": 30, "name": "MainProcess"}, "thread": {"id": 126091663866752, "name": "MainThread"}, "time": {"repr": "2025-12-11 07:26:14.480899+00:00", "timestamp": 1765437974.480899}}}
2025-Dec-11 07:26:14.481528
{"text": "Failed to generate prediction with openai/gpt-5\n", "record": {"elapsed": {"repr": "0:02:32.306288", "seconds": 152.306288}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "84aad2c7f2a44ec3bd9339bcf2de1e4c", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "artifact": {"error": "'dict' object has no attribute 'dict'"}}, "file": {"name": "pr_processing.py", "path": "/app/pr_agent/algo/pr_processing.py"}, "function": "retry_with_fallback_models", "level": {"icon": "âš ï¸", "name": "WARNING", "no": 30}, "line": 333, "message": "Failed to generate prediction with openai/gpt-5", "module": "pr_processing", "name": "pr_agent.algo.pr_processing", "process": {"id": 30, "name": "MainProcess"}, "thread": {"id": 126091663866752, "name": "MainThread"}, "time": {"repr": "2025-12-11 07:26:14.481208+00:00", "timestamp": 1765437974.481208}}}
2025-Dec-11 07:26:14.481541
{"text": "Generating prediction with openai/gpt-5-mini\n", "record": {"elapsed": {"repr": "0:02:32.306370", "seconds": 152.30637}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "84aad2c7f2a44ec3bd9339bcf2de1e4c", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "pr_processing.py", "path": "/app/pr_agent/algo/pr_processing.py"}, "function": "retry_with_fallback_models", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 326, "message": "Generating prediction with openai/gpt-5-mini", "module": "pr_processing", "name": "pr_agent.algo.pr_processing", "process": {"id": 30, "name": "MainProcess"}, "thread": {"id": 126091663866752, "name": "MainThread"}, "time": {"repr": "2025-12-11 07:26:14.481290+00:00", "timestamp": 1765437974.48129}}}
2025-Dec-11 07:26:14.695946
{"text": "PR main language: TypeScript\n", "record": {"elapsed": {"repr": "0:02:32.520439", "seconds": 152.520439}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "84aad2c7f2a44ec3bd9339bcf2de1e4c", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "pr_processing.py", "path": "/app/pr_agent/algo/pr_processing.py"}, "function": "get_pr_diff", "level": {"icon": "â„¹ï¸", "name": "INFO", "no": 20}, "line": 63, "message": "PR main language: TypeScript", "module": "pr_processing", "name": "pr_agent.algo.pr_processing", "process": {"id": 30, "name": "MainProcess"}, "thread": {"id": 126091663866752, "name": "MainThread"}, "time": {"repr": "2025-12-11 07:26:14.695359+00:00", "timestamp": 1765437974.695359}}}
2025-Dec-11 07:26:14.706311
{"text": "Tokens: 4738, total tokens under limit: 32000, returning full diff.\n", "record": {"elapsed": {"repr": "0:02:32.530946", "seconds": 152.530946}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "84aad2c7f2a44ec3bd9339bcf2de1e4c", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "pr_processing.py", "path": "/app/pr_agent/algo/pr_processing.py"}, "function": "get_pr_diff", "level": {"icon": "â„¹ï¸", "name": "INFO", "no": 20}, "line": 74, "message": "Tokens: 4738, total tokens under limit: 32000, returning full diff.", "module": "pr_processing", "name": "pr_agent.algo.pr_processing", "process": {"id": 30, "name": "MainProcess"}, "thread": {"id": 126091663866752, "name": "MainThread"}, "time": {"repr": "2025-12-11 07:26:14.705866+00:00", "timestamp": 1765437974.705866}}}
2025-Dec-11 07:26:14.706767
{"text": "PR diff\n", "record": {"elapsed": {"repr": "0:02:32.531208", "seconds": 152.531208}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "84aad2c7f2a44ec3bd9339bcf2de1e4c", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "diff": "\n\n## File: 'app/search/page.tsx'\n\n@@ -1,7 +1,8 @@\n__new hunk__\n1  \"use client\"\n2  \n3 +import { useState, useEffect, useMemo, useRef } from \"react\"\n4 +// import { X } from \"lucide-react\"\n5  import { useSearchParams, useRouter } from \"next/navigation\"\n6  import { useQuery } from \"@tanstack/react-query\"\n7  import { Input } from \"@/components/ui/input\"\n8  import { Button } from \"@/components/ui/button\"\n__old hunk__\n \"use client\"\n \n-import { useState, useEffect, useMemo } from \"react\"\n import { useSearchParams, useRouter } from \"next/navigation\"\n import { useQuery } from \"@tanstack/react-query\"\n import { Input } from \"@/components/ui/input\"\n import { Button } from \"@/components/ui/button\"\n\n@@ -41,11 +42,12 @@\n__new hunk__\n42  export default function SearchPage() {\n43    const searchParams = useSearchParams()\n44    const router = useRouter()\n45    const { filters, setFilters, resetFilters } = useFilters()\n46    const { settings } = useSettings()\n47  \n48    const [searchQuery, setSearchQuery] = useState(searchParams.get(\"q\") || filters.q || \"\")\n49 +  const inputRef = useRef(null);\n50    const [sortBy, setSortBy] = useState(settings.behavior.defaultSort || \"time\")\n51    const [filtersOpen, setFiltersOpen] = useState(false)\n52  \n53    // Update search query from URL params\n\n@@ -75,29 +77,54 @@ export default function SearchPage() {\n__new hunk__\n77        filters.fiberMin > 0 ||\n78        filters.sugarMax < 100 ||\n79        filters.sodiumMax < 4000 ||\n80        filters.maxTime < 120 ||\n81        !!filters.mealType\n82      )\n83    }, [filters])\n84  \n85 +  // const activeFilterCount = useMemo(() => {\n86 +  //   let count = 0\n87 +  //   if (filters.dietaryRestrictions.length > 0) count++\n88 +  //   if (filters.allergens.length > 0) count++\n89 +  //   if (filters.cuisines.length > 0) count++\n90 +  //   if (filters.majorConditions.length > 0) count++\n91 +  //   if (filters.calories[0] > 0 || filters.calories[1] < 1200) count++\n92 +  //   if (filters.proteinMin > 0) count++\n93 +  //   if (filters.carbsMin > 0) count++\n94 +  //   if (filters.fatMin > 0) count++\n95 +  //   if (filters.fiberMin > 0) count++\n96 +  //   if (filters.sugarMax < 100) count++\n97 +  //   if (filters.sodiumMax < 4000) count++\n98 +  //   if (filters.maxTime < 120) count++\n99 +  //   if (filters.mealType) count++\n100 +  //   return count\n101 +  // }, [filters])\n102    const activeFilterCount = useMemo(() => {\n103 +    let count = 0;\n104 +\n105 +  // Sum all selected array filters\n106 +    count += filters.dietaryRestrictions.length;\n107 +    count += filters.allergens.length;\n108 +    count += filters.cuisines.length;\n109 +    count += filters.majorConditions.length;\n110 +\n111 +    // Range and min/max filters\n112 +    if (filters.calories[0] > 0) count++; // Min calories\n113 +    if (filters.calories[1] < 1200) count++; // Max calories\n114 +    if (filters.proteinMin > 0) count++;\n115 +    if (filters.carbsMin > 0) count++;\n116 +    if (filters.fatMin > 0) count++;\n117 +    if (filters.fiberMin > 0) count++;\n118 +    if (filters.sugarMax < 100) count++;\n119 +    if (filters.sodiumMax < 4000) count++;\n120 +    if (filters.maxTime < 120) count++;\n121 +    \n122 +    // Single-value selection\n123 +    if (filters.mealType) count++;\n124 +\n125 +    return count;\n126 +  }, [filters]);\n127  \n128    const {\n129      data: searchResults = [],\n130      isLoading,\n__old hunk__\n       filters.fiberMin > 0 ||\n       filters.sugarMax < 100 ||\n       filters.sodiumMax < 4000 ||\n       filters.maxTime < 120 ||\n       !!filters.mealType\n     )\n   }, [filters])\n \n   const activeFilterCount = useMemo(() => {\n-    let count = 0\n-    if (filters.dietaryRestrictions.length > 0) count++\n-    if (filters.allergens.length > 0) count++\n-    if (filters.cuisines.length > 0) count++\n-    if (filters.majorConditions.length > 0) count++\n-    if (filters.calories[0] > 0 || filters.calories[1] < 1200) count++\n-    if (filters.proteinMin > 0) count++\n-    if (filters.carbsMin > 0) count++\n-    if (filters.fatMin > 0) count++\n-    if (filters.fiberMin > 0) count++\n-    if (filters.sugarMax < 100) count++\n-    if (filters.sodiumMax < 4000) count++\n-    if (filters.maxTime < 120) count++\n-    if (filters.mealType) count++\n-    return count\n-  }, [filters])\n \n   const {\n     data: searchResults = [],\n     isLoading,\n\n@@ -113,12 +140,22 @@ export default function SearchPage() {\n__new hunk__\n140          const rankedResults = rank(rawResults, settings)\n141          return rankedResults\n142        }\n143  \n144        return rawResults.map((recipe) => ({ ...recipe, score: 0 }))\n145      },\n146      enabled: !!(searchQuery || hasActiveFilters),\n147    })\n148 +  const handleSearchInputKeyDown = (e: React.KeyboardEvent) => {\n149 +    if (e.key === \"Escape\" && searchQuery) {\n150 +      setSearchQuery(\"\");\n151 +      inputRef.current?.focus();\n152 +    }\n153 +    if (e.key === \"Enter\") {\n154 +      handleSearch(searchQuery);\n155 +    }\n156 +  };\n157 +\n158  \n159    const handleSearch = (query: string) => {\n160      setSearchQuery(query)\n161      setFilters({ ...filters, q: query })\n\n@@ -182,13 +219,13 @@ export default function SearchPage() {\n__new hunk__\n219    return (\n220      \n221        \n222          {/* Search Header */}\n223          \n224            Search Recipes\n225  \n226            {/* Search Input */}\n227 +          {/* \n228              \n229              \n       \n         {/* Search Header */}\n         \n           Search Recipes\n \n           {/* Search Input */}\n-          \n             \n              setSearchQuery(e.target.value)}\n234                onKeyDown={(e) => e.key === \"Enter\" && handleSearch(searchQuery)}\n235                className=\"pl-10 pr-4 h-12 text-lg\"\n236              />\n237 +           */}\n238 +          \n239 +            \n240 +             setSearchQuery(e.target.value)}\n246 +              onKeyDown={handleSearchInputKeyDown}\n247 +              style={{ paddingRight: searchQuery ? \"2rem\" : undefined, width: \"100%\" }}\n248 +              className=\"pl-10 pr-4 h-12 text-lg\"\n249 +            />\n250 +            {searchQuery && (\n251 +               {\n266 +                  setSearchQuery(\"\");\n267 +                  inputRef.current?.focus();\n268 +              }}\n269 +              >\n270 +                \n271 +            \n272 +          )}\n273            \n274  \n275 +\n276            {/* Search Actions */}\n277            \n278               handleSearch(searchQuery)} size=\"sm\">\n279                Search\n\n\n## File: 'components/filter-panel.tsx'\n\n@@ -54,35 +54,58 @@\n__new hunk__\n54  export function FilterPanel({ open, onOpenChange, initialValues, onApply, onReset }: FilterPanelProps) {\n55    const form = useForm({\n56      resolver: zodResolver(schema),\n57      // provide full defaults (OUTPUT fits into INPUT just fine)\n58      defaultValues: schema.parse(initialValues ?? {}),\n59      mode: \"onChange\",\n60    })\n61  \n62     useEffect(() => {\n63      form.reset(schema.parse(initialValues ?? {}));\n64    }, [open, initialValues, form]);\n65  \n66 +  // function getActiveFiltersCount(): number {\n67 +  //   const values = form.getValues()\n68 +  //   let count = 0\n69 +  //   if ((values.dietaryRestrictions || []).length > 0) count++\n70 +  //   if ((values.allergens || []).length > 0) count++\n71 +  //   if ((values.cuisines || []).length > 0) count++\n72 +  //   if ((values.majorConditions || []).length > 0) count++\n73 +  //   if (values.calories && (values.calories[0] > 0 || values.calories[1] < 1200)) count++\n74 +  //   if ((values.proteinMin || 0) > 0) count++\n75 +  //   if ((values.carbsMin || 0) > 0) count++\n76 +  //   if ((values.fatMin || 0) > 0) count++\n77 +  //   if ((values.fiberMin || 0) > 0) count++\n78 +  //   if ((values.sugarMax || 100) < 100) count++\n79 +  //   if ((values.sodiumMax || 4000) < 4000) count++\n80 +  //   if ((values.maxTime || 120) < 120) count++\n81 +  //   if ((values.mealType || \"\") !== \"\") count++\n82 +  //   return count\n83 +  // }\n84    function getActiveFiltersCount(): number {\n85 +    const values = form.getValues();\n86 +    let count = 0;\n87 +\n88 +    // Count all selected array filters individually\n89 +    count += values.dietaryRestrictions.length;\n90 +    count += values.allergens.length;\n91 +    count += values.cuisines.length;\n92 +    count += values.majorConditions.length;\n93 +\n94 +    // Numeric and single-value filters\n95 +    if (values.calories[0] > 0) count++;           // Min calories\n96 +    if (values.calories[1] < 1200) count++;        // Max calories\n97 +    if (values.proteinMin > 0) count++;\n98 +    if (values.carbsMin > 0) count++;\n99 +    if (values.fatMin > 0) count++;\n100 +    if (values.fiberMin > 0) count++;\n101 +    if (values.sugarMax < 100) count++;\n102 +    if (values.sodiumMax < 4000) count++;\n103 +    if (values.maxTime < 120) count++;\n104 +    if (values.mealType) count++;\n105 +\n106 +    return count;\n107    }\n108    function handleApply() {\n109      const values = schema.parse(form.getValues())\n110      onApply(values)\n111      onOpenChange(false)\n__old hunk__\n export function FilterPanel({ open, onOpenChange, initialValues, onApply, onReset }: FilterPanelProps) {\n   const form = useForm({\n     resolver: zodResolver(schema),\n     // provide full defaults (OUTPUT fits into INPUT just fine)\n     defaultValues: schema.parse(initialValues ?? {}),\n     mode: \"onChange\",\n   })\n \n    useEffect(() => {\n     form.reset(schema.parse(initialValues ?? {}));\n   }, [open, initialValues, form]);\n \n   function getActiveFiltersCount(): number {\n-    const values = form.getValues()\n-    let count = 0\n-    if ((values.dietaryRestrictions || []).length > 0) count++\n-    if ((values.allergens || []).length > 0) count++\n-    if ((values.cuisines || []).length > 0) count++\n-    if ((values.majorConditions || []).length > 0) count++\n-    if (values.calories && (values.calories[0] > 0 || values.calories[1] < 1200)) count++\n-    if ((values.proteinMin || 0) > 0) count++\n-    if ((values.carbsMin || 0) > 0) count++\n-    if ((values.fatMin || 0) > 0) count++\n-    if ((values.fiberMin || 0) > 0) count++\n-    if ((values.sugarMax || 100) < 100) count++\n-    if ((values.sodiumMax || 4000) < 4000) count++\n-    if ((values.maxTime || 120) < 120) count++\n-    if ((values.mealType || \"\") !== \"\") count++\n-    return count\n   }\n-\n   function handleApply() {\n     const values = schema.parse(form.getValues())\n     onApply(values)\n     onOpenChange(false)"}, "file": {"name": "pr_reviewer.py", "path": "/app/pr_agent/tools/pr_reviewer.py"}, "function": "_prepare_prediction", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 197, "message": "PR diff", "module": "pr_reviewer", "name": "pr_agent.tools.pr_reviewer", "process": {"id": 30, "name": "MainProcess"}, "thread": {"id": 126091663866752, "name": "MainThread"}, "time": {"repr": "2025-12-11 07:26:14.706128+00:00", "timestamp": 1765437974.706128}}}
2025-Dec-11 07:26:14.721708
{"text": "Prompts\n", "record": {"elapsed": {"repr": "0:02:32.546104", "seconds": 152.546104}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "84aad2c7f2a44ec3bd9339bcf2de1e4c", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "artifact": {"system": "You are PR-Reviewer, a language model designed to review a Git Pull Request (PR).\nYour task is to provide constructive and concise feedback for the PR.\nThe review should focus on new code added in the PR code diff (lines starting with '+')\n\n\nThe format we will use to present the PR code diff:\n======\n## File: 'src/file1.py'\n\n\n@@ ... @@ def func1():\n__new hunk__\n11  unchanged code line0\n12  unchanged code line1\n13 +new code line2 added\n14  unchanged code line3\n__old hunk__\n unchanged code line0\n unchanged code line1\n-old code line2 removed\n unchanged code line3\n\n@@ ... @@ def func2():\n__new hunk__\n unchanged code line4\n+new code line5 added\n unchanged code line6\n\n## File: 'src/file2.py'\n...\n======\n\n- In the format above, the diff is organized into separate '__new hunk__' and '__old hunk__' sections for each code chunk. '__new hunk__' contains the updated code, while '__old hunk__' shows the removed code. If no code was removed in a specific chunk, the __old hunk__ section will be omitted.\n- We also added line numbers for the '__new hunk__' code, to help you refer to the code lines in your suggestions. These line numbers are not part of the actual code, and should only be used for reference.\n- Code lines are prefixed with symbols ('+', '-', ' '). The '+' symbol indicates new code added in the PR, the '-' symbol indicates code removed in the PR, and the ' ' symbol indicates unchanged code. The review should address new code added in the PR code diff (lines starting with '+').\n- When quoting variables, names or file paths from the code, use backticks (`) instead of single quote (').\n- Note that you only see changed code segments (diff hunks in a PR), not the entire codebase. Avoid suggestions that might duplicate existing functionality or questioning code elements (like variables declarations or import statements) that may be defined elsewhere in the codebase.\n- Also note that if the code ends at an opening brace or statement that begins a new scope (like 'if', 'for', 'try'), don't treat it as incomplete. Instead, acknowledge the visible scope boundary and analyze only the code shown.\n\n\nThe output must be a YAML object equivalent to type $PRReview, according to the following Pydantic definitions:\n=====\n\nclass KeyIssuesComponentLink(BaseModel):\n    relevant_file: str = Field(description=\"The full file path of the relevant file\")\n    issue_header: str = Field(description=\"One or two word title for the issue. For example: 'Possible Bug', etc.\")\n    issue_content: str = Field(description=\"A short and concise summary of what should be further inspected and validated during the PR review process for this issue. Do not mention line numbers in this field.\")\n    start_line: int = Field(description=\"The start line that corresponds to this issue in the relevant file\")\n    end_line: int = Field(description=\"The end line that corresponds to this issue in the relevant file\")\n\nclass Review(BaseModel):\n    estimated_effort_to_review_[1-5]: int = Field(description=\"Estimate, on a scale of 1-5 (inclusive), the time and effort required to review this PR by an experienced and knowledgeable developer. 1 means short and easy review , 5 means long and hard review. Take into account the size, complexity, quality, and the needed changes of the PR code diff.\")\n    relevant_tests: str = Field(description=\"yes/no question: does this PR have relevant tests added or updated ?\")\n    key_issues_to_review: List[KeyIssuesComponentLink] = Field(\"A short and diverse list (0-3 issues) of high-priority bugs, problems or performance concerns introduced in the PR code, which the PR reviewer should further focus on and validate during the review process.\")\n    security_concerns: str = Field(description=\"Does this PR code introduce vulnerabilities such as exposure of sensitive information (e.g., API keys, secrets, passwords), or security concerns like SQL injection, XSS, CSRF, and others ? Answer 'No' (without explaining why) if there are no possible issues. If there are security concerns or issues, start your answer with a short header, such as: 'Sensitive information exposure: ...', 'SQL injection: ...', etc. Explain your answer. Be specific and give examples if possible\")\n\nclass PRReview(BaseModel):\n    review: Review\n=====\n\n\nExample output:\n```yaml\nreview:\n  estimated_effort_to_review_[1-5]: |\n    3\n  relevant_tests: |\n    No\n  key_issues_to_review:\n    - relevant_file: |\n        directory/xxx.py\n      issue_header: |\n        Possible Bug\n      issue_content: |\n        ...\n      start_line: 12\n      end_line: 14\n    - ...\n  security_concerns: |\n    No\n```\n\nAnswer should be a valid YAML, and nothing else. Each YAML output MUST be after a newline, with proper indent, and block scalar indicator ('|')", "user": "\n\n\n--PR Info--\n\nToday's Date: 2025-12-11\n\nTitle: 'Fix: Search UX and multi-filter logic (frontend)'\n\nBranch: 'feature/initial-fixes'\n\nPR Description:\n======\n- Improved search bar UX in app/search/page.tsx:\r\n  - X icon clears input and refocuses\r\n  - Escape key clears input\r\n  - Enter key triggers search\r\n\r\n- Updated filter count logic:\r\n  - Accurately counts all active filters\r\n  - Apply button badge reflects true total\n======\n\n\nThe PR code diff:\n======\n## File: 'app/search/page.tsx'\n\n@@ -1,7 +1,8 @@\n__new hunk__\n1  \"use client\"\n2  \n3 +import { useState, useEffect, useMemo, useRef } from \"react\"\n4 +// import { X } from \"lucide-react\"\n5  import { useSearchParams, useRouter } from \"next/navigation\"\n6  import { useQuery } from \"@tanstack/react-query\"\n7  import { Input } from \"@/components/ui/input\"\n8  import { Button } from \"@/components/ui/button\"\n__old hunk__\n \"use client\"\n \n-import { useState, useEffect, useMemo } from \"react\"\n import { useSearchParams, useRouter } from \"next/navigation\"\n import { useQuery } from \"@tanstack/react-query\"\n import { Input } from \"@/components/ui/input\"\n import { Button } from \"@/components/ui/button\"\n\n@@ -41,11 +42,12 @@\n__new hunk__\n42  export default function SearchPage() {\n43    const searchParams = useSearchParams()\n44    const router = useRouter()\n45    const { filters, setFilters, resetFilters } = useFilters()\n46    const { settings } = useSettings()\n47  \n48    const [searchQuery, setSearchQuery] = useState(searchParams.get(\"q\") || filters.q || \"\")\n49 +  const inputRef = useRef(null);\n50    const [sortBy, setSortBy] = useState(settings.behavior.defaultSort || \"time\")\n51    const [filtersOpen, setFiltersOpen] = useState(false)\n52  \n53    // Update search query from URL params\n\n@@ -75,29 +77,54 @@ export default function SearchPage() {\n__new hunk__\n77        filters.fiberMin > 0 ||\n78        filters.sugarMax < 100 ||\n79        filters.sodiumMax < 4000 ||\n80        filters.maxTime < 120 ||\n81        !!filters.mealType\n82      )\n83    }, [filters])\n84  \n85 +  // const activeFilterCount = useMemo(() => {\n86 +  //   let count = 0\n87 +  //   if (filters.dietaryRestrictions.length > 0) count++\n88 +  //   if (filters.allergens.length > 0) count++\n89 +  //   if (filters.cuisines.length > 0) count++\n90 +  //   if (filters.majorConditions.length > 0) count++\n91 +  //   if (filters.calories[0] > 0 || filters.calories[1] < 1200) count++\n92 +  //   if (filters.proteinMin > 0) count++\n93 +  //   if (filters.carbsMin > 0) count++\n94 +  //   if (filters.fatMin > 0) count++\n95 +  //   if (filters.fiberMin > 0) count++\n96 +  //   if (filters.sugarMax < 100) count++\n97 +  //   if (filters.sodiumMax < 4000) count++\n98 +  //   if (filters.maxTime < 120) count++\n99 +  //   if (filters.mealType) count++\n100 +  //   return count\n101 +  // }, [filters])\n102    const activeFilterCount = useMemo(() => {\n103 +    let count = 0;\n104 +\n105 +  // Sum all selected array filters\n106 +    count += filters.dietaryRestrictions.length;\n107 +    count += filters.allergens.length;\n108 +    count += filters.cuisines.length;\n109 +    count += filters.majorConditions.length;\n110 +\n111 +    // Range and min/max filters\n112 +    if (filters.calories[0] > 0) count++; // Min calories\n113 +    if (filters.calories[1] < 1200) count++; // Max calories\n114 +    if (filters.proteinMin > 0) count++;\n115 +    if (filters.carbsMin > 0) count++;\n116 +    if (filters.fatMin > 0) count++;\n117 +    if (filters.fiberMin > 0) count++;\n118 +    if (filters.sugarMax < 100) count++;\n119 +    if (filters.sodiumMax < 4000) count++;\n120 +    if (filters.maxTime < 120) count++;\n121 +    \n122 +    // Single-value selection\n123 +    if (filters.mealType) count++;\n124 +\n125 +    return count;\n126 +  }, [filters]);\n127  \n128    const {\n129      data: searchResults = [],\n130      isLoading,\n__old hunk__\n       filters.fiberMin > 0 ||\n       filters.sugarMax < 100 ||\n       filters.sodiumMax < 4000 ||\n       filters.maxTime < 120 ||\n       !!filters.mealType\n     )\n   }, [filters])\n \n   const activeFilterCount = useMemo(() => {\n-    let count = 0\n-    if (filters.dietaryRestrictions.length > 0) count++\n-    if (filters.allergens.length > 0) count++\n-    if (filters.cuisines.length > 0) count++\n-    if (filters.majorConditions.length > 0) count++\n-    if (filters.calories[0] > 0 || filters.calories[1] < 1200) count++\n-    if (filters.proteinMin > 0) count++\n-    if (filters.carbsMin > 0) count++\n-    if (filters.fatMin > 0) count++\n-    if (filters.fiberMin > 0) count++\n-    if (filters.sugarMax < 100) count++\n-    if (filters.sodiumMax < 4000) count++\n-    if (filters.maxTime < 120) count++\n-    if (filters.mealType) count++\n-    return count\n-  }, [filters])\n \n   const {\n     data: searchResults = [],\n     isLoading,\n\n@@ -113,12 +140,22 @@ export default function SearchPage() {\n__new hunk__\n140          const rankedResults = rank(rawResults, settings)\n141          return rankedResults\n142        }\n143  \n144        return rawResults.map((recipe) => ({ ...recipe, score: 0 }))\n145      },\n146      enabled: !!(searchQuery || hasActiveFilters),\n147    })\n148 +  const handleSearchInputKeyDown = (e: React.KeyboardEvent) => {\n149 +    if (e.key === \"Escape\" && searchQuery) {\n150 +      setSearchQuery(\"\");\n151 +      inputRef.current?.focus();\n152 +    }\n153 +    if (e.key === \"Enter\") {\n154 +      handleSearch(searchQuery);\n155 +    }\n156 +  };\n157 +\n158  \n159    const handleSearch = (query: string) => {\n160      setSearchQuery(query)\n161      setFilters({ ...filters, q: query })\n\n@@ -182,13 +219,13 @@ export default function SearchPage() {\n__new hunk__\n219    return (\n220      \n221        \n222          {/* Search Header */}\n223          \n224            Search Recipes\n225  \n226            {/* Search Input */}\n227 +          {/* \n228              \n229              \n       \n         {/* Search Header */}\n         \n           Search Recipes\n \n           {/* Search Input */}\n-          \n             \n              setSearchQuery(e.target.value)}\n234                onKeyDown={(e) => e.key === \"Enter\" && handleSearch(searchQuery)}\n235                className=\"pl-10 pr-4 h-12 text-lg\"\n236              />\n237 +           */}\n238 +          \n239 +            \n240 +             setSearchQuery(e.target.value)}\n246 +              onKeyDown={handleSearchInputKeyDown}\n247 +              style={{ paddingRight: searchQuery ? \"2rem\" : undefined, width: \"100%\" }}\n248 +              className=\"pl-10 pr-4 h-12 text-lg\"\n249 +            />\n250 +            {searchQuery && (\n251 +               {\n266 +                  setSearchQuery(\"\");\n267 +                  inputRef.current?.focus();\n268 +              }}\n269 +              >\n270 +                \n271 +            \n272 +          )}\n273            \n274  \n275 +\n276            {/* Search Actions */}\n277            \n278               handleSearch(searchQuery)} size=\"sm\">\n279                Search\n\n\n## File: 'components/filter-panel.tsx'\n\n@@ -54,35 +54,58 @@\n__new hunk__\n54  export function FilterPanel({ open, onOpenChange, initialValues, onApply, onReset }: FilterPanelProps) {\n55    const form = useForm({\n56      resolver: zodResolver(schema),\n57      // provide full defaults (OUTPUT fits into INPUT just fine)\n58      defaultValues: schema.parse(initialValues ?? {}),\n59      mode: \"onChange\",\n60    })\n61  \n62     useEffect(() => {\n63      form.reset(schema.parse(initialValues ?? {}));\n64    }, [open, initialValues, form]);\n65  \n66 +  // function getActiveFiltersCount(): number {\n67 +  //   const values = form.getValues()\n68 +  //   let count = 0\n69 +  //   if ((values.dietaryRestrictions || []).length > 0) count++\n70 +  //   if ((values.allergens || []).length > 0) count++\n71 +  //   if ((values.cuisines || []).length > 0) count++\n72 +  //   if ((values.majorConditions || []).length > 0) count++\n73 +  //   if (values.calories && (values.calories[0] > 0 || values.calories[1] < 1200)) count++\n74 +  //   if ((values.proteinMin || 0) > 0) count++\n75 +  //   if ((values.carbsMin || 0) > 0) count++\n76 +  //   if ((values.fatMin || 0) > 0) count++\n77 +  //   if ((values.fiberMin || 0) > 0) count++\n78 +  //   if ((values.sugarMax || 100) < 100) count++\n79 +  //   if ((values.sodiumMax || 4000) < 4000) count++\n80 +  //  2025-12-11T07:26:14.721708565Z  if ((values.maxTime || 120) < 120) count++\n81 +  //   if ((values.mealType || \"\") !== \"\") count++\n82 +  //   return count\n83 +  // }\n84    function getActiveFiltersCount(): number {\n85 +    const values = form.getValues();\n86 +    let count = 0;\n87 +\n88 +    // Count all selected array filters individually\n89 +    count += values.dietaryRestrictions.length;\n90 +    count += values.allergens.length;\n91 +    count += values.cuisines.length;\n92 +    count += values.majorConditions.length;\n93 +\n94 +    // Numeric and single-value filters\n95 +    if (values.calories[0] > 0) count++;           // Min calories\n96 +    if (values.calories[1] < 1200) count++;        // Max calories\n97 +    if (values.proteinMin > 0) count++;\n98 +    if (values.carbsMin > 0) count++;\n99 +    if (values.fatMin > 0) count++;\n100 +    if (values.fiberMin > 0) count++;\n101 +    if (values.sugarMax < 100) count++;\n102 +    if (values.sodiumMax < 4000) count++;\n103 +    if (values.maxTime < 120) count++;\n104 +    if (values.mealType) count++;\n105 +\n106 +    return count;\n107    }\n108    function handleApply() {\n109      const values = schema.parse(form.getValues())\n110      onApply(values)\n111      onOpenChange(false)\n__old hunk__\n export function FilterPanel({ open, onOpenChange, initialValues, onApply, onReset }: FilterPanelProps) {\n   const form = useForm({\n     resolver: zodResolver(schema),\n     // provide full defaults (OUTPUT fits into INPUT just fine)\n     defaultValues: schema.parse(initialValues ?? {}),\n     mode: \"onChange\",\n   })\n \n    useEffect(() => {\n     form.reset(schema.parse(initialValues ?? {}));\n   }, [open, initialValues, form]);\n \n   function getActiveFiltersCount(): number {\n-    const values = form.getValues()\n-    let count = 0\n-    if ((values.dietaryRestrictions || []).length > 0) count++\n-    if ((values.allergens || []).length > 0) count++\n-    if ((values.cuisines || []).length > 0) count++\n-    if ((values.majorConditions || []).length > 0) count++\n-    if (values.calories && (values.calories[0] > 0 || values.calories[1] < 1200)) count++\n-    if ((values.proteinMin || 0) > 0) count++\n-    if ((values.carbsMin || 0) > 0) count++\n-    if ((values.fatMin || 0) > 0) count++\n-    if ((values.fiberMin || 0) > 0) count++\n-    if ((values.sugarMax || 100) < 100) count++\n-    if ((values.sodiumMax || 4000) < 4000) count++\n-    if ((values.maxTime || 120) < 120) count++\n-    if ((values.mealType || \"\") !== \"\") count++\n-    return count\n   }\n-\n   function handleApply() {\n     const values = schema.parse(form.getValues())\n     onApply(values)\n     onOpenChange(false)\n======\n\n\nResponse (should be a valid YAML, and nothing else):\n```yaml"}}, "file": {"name": "litellm_ai_handler.py", "path": "/app/pr_agent/algo/ai_handlers/litellm_ai_handler.py"}, "function": "chat_completion", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 397, "message": "Prompts", "module": "litellm_ai_handler", "name": "pr_agent.algo.ai_handlers.litellm_ai_handler", "process": {"id": 30, "name": "MainProcess"}, "thread": {"id": 126091663866752, "name": "MainThread"}, "time": {"repr": "2025-12-11 07:26:14.721024+00:00", "timestamp": 1765437974.721024}}}
2025-Dec-11 07:26:14.722065
{"text": "LiteLLM call model='openai/gpt-5-mini'\n", "record": {"elapsed": {"repr": "0:02:32.546887", "seconds": 152.546887}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "84aad2c7f2a44ec3bd9339bcf2de1e4c", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "litellm_ai_handler.py", "path": "/app/pr_agent/algo/ai_handlers/litellm_ai_handler.py"}, "function": "chat_completion", "level": {"icon": "âš ï¸", "name": "WARNING", "no": 30}, "line": 426, "message": "LiteLLM call model='openai/gpt-5-mini'", "module": "litellm_ai_handler", "name": "pr_agent.algo.ai_handlers.litellm_ai_handler", "process": {"id": 30, "name": "MainProcess"}, "thread": {"id": 126091663866752, "name": "MainThread"}, "time": {"repr": "2025-12-11 07:26:14.721807+00:00", "timestamp": 1765437974.721807}}}
2025-Dec-11 07:26:14.722072
{"text": "Using OpenAI client directly for LiteLLM proxy with model: openai/gpt-5-mini\n", "record": {"elapsed": {"repr": "0:02:32.547013", "seconds": 152.547013}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "84aad2c7f2a44ec3bd9339bcf2de1e4c", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "litellm_ai_handler.py", "path": "/app/pr_agent/algo/ai_handlers/litellm_ai_handler.py"}, "function": "_get_completion", "level": {"icon": "â„¹ï¸", "name": "INFO", "no": 20}, "line": 473, "message": "Using OpenAI client directly for LiteLLM proxy with model: openai/gpt-5-mini", "module": "litellm_ai_handler", "name": "pr_agent.algo.ai_handlers.litellm_ai_handler", "process": {"id": 30, "name": "MainProcess"}, "thread": {"id": 126091663866752, "name": "MainThread"}, "time": {"repr": "2025-12-11 07:26:14.721933+00:00", "timestamp": 1765437974.721933}}}
2025-Dec-11 07:26:54.484164
{"text": "\nAI response:\nreview:\n  estimated_effort_to_review_[1-5]: |\n    2\n  relevant_tests: |\n    No\n  key_issues_to_review:\n    - relevant_file: |\n        app/search/page.tsx\n      issue_header: |\n        Missing icon import\n      issue_content: |\n        The new JSX uses the `X` (and `Search`) icon components but the `X` import is commented out and there is no visible `Search` import in the diff. This will cause a build-time runtime error (undefined component). Add/import the icons (for example `import { Search, X } from \"lucide-react\"`), or confirm icons are exported/available from whichever icon package you use.\n      start_line: 3\n      end_line: 5\n    - relevant_file: |\n        components/filter-panel.tsx\n      issue_header: |\n        Unsafe property access\n      issue_content: |\n        The revised `getActiveFiltersCount` assumes array/numeric fields are always present (e.g. `values.dietaryRestrictions.length`, `values.calories[0]`). Previously there were fallbacks (`|| []`, `|| 100`, etc.). If `form.getValues()` can return undefined or omit keys for some inputs this may throw. Either keep safe defaults, normalize `values` from `form.getValues()` to guaranteed shapes, or use optional chaining/defaults.\n      start_line: 84\n      end_line: 106\n    - relevant_file: |\n        app/search/page.tsx\n      issue_header: |\n        Ref forwarding assumption\n      issue_content: |\n        The `Input` component is given a `ref={inputRef}` so it must forward refs (React.forwardRef) and accept an `HTMLInputElement` ref. If `Input` doesn't forward the ref, `inputRef.current` will be null and focusing/using the ref will fail. Confirm `Input` forwards refs and typings align; otherwise attach the ref to the underlying native input or modify `Input` to forward refs.\n      start_line: 240\n      end_line: 246\n  security_concerns: |\n    No\n", "record": {"elapsed": {"repr": "0:03:12.308733", "seconds": 192.308733}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "84aad2c7f2a44ec3bd9339bcf2de1e4c", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "litellm_ai_handler.py", "path": "/app/pr_agent/algo/ai_handlers/litellm_ai_handler.py"}, "function": "chat_completion", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 439, "message": "\nAI response:\nreview:\n  estimated_effort_to_review_[1-5]: |\n    2\n  relevant_tests: |\n    No\n  key_issues_to_review:\n    - relevant_file: |\n        app/search/page.tsx\n      issue_header: |\n        Missing icon import\n      issue_content: |\n        The new JSX uses the `X` (and `Search`) icon components but the `X` import is commented out and there is no visible `Search` import in the diff. This will cause a build-time runtime error (undefined component). Add/import the icons (for example `import { Search, X } from \"lucide-react\"`), or confirm icons are exported/available from whichever icon package you use.\n      start_line: 3\n      end_line: 5\n    - relevant_file: |\n        components/filter-panel.tsx\n      issue_header: |\n        Unsafe property access\n      issue_content: |\n        The revised `getActiveFiltersCount` assumes array/numeric fields are always present (e.g. `values.dietaryRestrictions.length`, `values.calories[0]`). Previously there were fallbacks (`|| []`, `|| 100`, etc.). If `form.getValues()` can return undefined or omit keys for some inputs this may throw. Either keep safe defaults, normalize `values` from `form.getValues()` to guaranteed shapes, or use optional chaining/defaults.\n      start_line: 84\n      end_line: 106\n    - relevant_file: |\n        app/search/page.tsx\n      issue_header: |\n        Ref forwarding assumption\n      issue_content: |\n        The `Input` component is given a `ref={inputRef}` so it must forward refs (React.forwardRef) and accept an `HTMLInputElement` ref. If `Input` doesn't forward the ref, `inputRef.current` will be null and focusing/using the ref will fail. Confirm `Input` forwards refs and typings align; otherwise attach the ref to the underlying native input or modify `Input` to forward refs.\n      start_line: 240\n      end_line: 246\n  security_concerns: |\n    No", "module": "litellm_ai_handler", "name": "pr_agent.algo.ai_handlers.litellm_ai_handler", "process": {"id": 30, "name": "MainProcess"}, "thread": {"id": 126091663866752, "name": "MainThread"}, "time": {"repr": "2025-12-11 07:26:54.483653+00:00", "timestamp": 1765438014.483653}}}
2025-Dec-11 07:26:54.484318
{"text": "Failed to generate prediction with openai/gpt-5-mini\n", "record": {"elapsed": {"repr": "0:03:12.309053", "seconds": 192.309053}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "84aad2c7f2a44ec3bd9339bcf2de1e4c", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "artifact": {"error": "'dict' object has no attribute 'dict'"}}, "file": {"name": "pr_processing.py", "path": "/app/pr_agent/algo/pr_processing.py"}, "function": "retry_with_fallback_models", "level": {"icon": "âš ï¸", "name": "WARNING", "no": 30}, "line": 333, "message": "Failed to generate prediction with openai/gpt-5-mini", "module": "pr_processing", "name": "pr_agent.algo.pr_processing", "process": {"id": 30, "name": "MainProcess"}, "thread": {"id": 126091663866752, "name": "MainThread"}, "time": {"repr": "2025-12-11 07:26:54.483973+00:00", "timestamp": 1765438014.483973}}}
2025-Dec-11 07:26:54.484352
{"text": "Generating prediction with openai/gpt-5-nano\n", "record": {"elapsed": {"repr": "0:03:12.309153", "seconds": 192.309153}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "84aad2c7f2a44ec3bd9339bcf2de1e4c", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "pr_processing.py", "path": "/app/pr_agent/algo/pr_processing.py"}, "function": "retry_with_fallback_models", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 326, "message": "Generating prediction with openai/gpt-5-nano", "module": "pr_processing", "name": "pr_agent.algo.pr_processing", "process": {"id": 30, "name": "MainProcess"}, "thread": {"id": 126091663866752, "name": "MainThread"}, "time": {"repr": "2025-12-11 07:26:54.484073+00:00", "timestamp": 1765438014.484073}}}
2025-Dec-11 07:26:54.697528
{"text": "PR main language: TypeScript\n", "record": {"elapsed": {"repr": "0:03:12.522278", "seconds": 192.522278}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "84aad2c7f2a44ec3bd9339bcf2de1e4c", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "pr_processing.py", "path": "/app/pr_agent/algo/pr_processing.py"}, "function": "get_pr_diff", "level": {"icon": "â„¹ï¸", "name": "INFO", "no": 20}, "line": 63, "message": "PR main language: TypeScript", "module": "pr_processing", "name": "pr_agent.algo.pr_processing", "process": {"id": 30, "name": "MainProcess"}, "thread": {"id": 126091663866752, "name": "MainThread"}, "time": {"repr": "2025-12-11 07:26:54.697198+00:00", "timestamp": 1765438014.697198}}}
2025-Dec-11 07:26:54.703311
{"text": "Tokens: 4738, total tokens under limit: 32000, returning full diff.\n", "record": {"elapsed": {"repr": "0:03:12.528117", "seconds": 192.528117}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "84aad2c7f2a44ec3bd9339bcf2de1e4c", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "pr_processing.py", "path": "/app/pr_agent/algo/pr_processing.py"}, "function": "get_pr_diff", "level": {"icon": "â„¹ï¸", "name": "INFO", "no": 20}, "line": 74, "message": "Tokens: 4738, total tokens under limit: 32000, returning full diff.", "module": "pr_processing", "name": "pr_agent.algo.pr_processing", "process": {"id": 30, "name": "MainProcess"}, "thread": {"id": 126091663866752, "name": "MainThread"}, "time": {"repr": "2025-12-11 07:26:54.703037+00:00", "timestamp": 1765438014.703037}}}
2025-Dec-11 07:26:54.703528
{"text": "PR diff\n", "record": {"elapsed": {"repr": "0:03:12.528279", "seconds": 192.528279}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "84aad2c7f2a44ec3bd9339bcf2de1e4c", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "diff": "\n\n## File: 'app/search/page.tsx'\n\n@@ -1,7 +1,8 @@\n__new hunk__\n1  \"use client\"\n2  \n3 +import { useState, useEffect, useMemo, useRef } from \"react\"\n4 +// import { X } from \"lucide-react\"\n5  import { useSearchParams, useRouter } from \"next/navigation\"\n6  import { useQuery } from \"@tanstack/react-query\"\n7  import { Input } from \"@/components/ui/input\"\n8  import { Button } from \"@/components/ui/button\"\n__old hunk__\n \"use client\"\n \n-import { useState, useEffect, useMemo } from \"react\"\n import { useSearchParams, useRouter } from \"next/navigation\"\n import { useQuery } from \"@tanstack/react-query\"\n import { Input } from \"@/components/ui/input\"\n import { Button } from \"@/components/ui/button\"\n\n@@ -41,11 +42,12 @@\n__new hunk__\n42  export default function SearchPage() {\n43    const searchParams = useSearchParams()\n44    const router = useRouter()\n45    const { filters, setFilters, resetFilters } = useFilters()\n46    const { settings } = useSettings()\n47  \n48    const [searchQuery, setSearchQuery] = useState(searchParams.get(\"q\") || filters.q || \"\")\n49 +  const inputRef = useRef(null);\n50    const [sortBy, setSortBy] = useState(settings.behavior.defaultSort || \"time\")\n51    const [filtersOpen, setFiltersOpen] = useState(false)\n52  \n53    // Update search query from URL params\n\n@@ -75,29 +77,54 @@ export default function SearchPage() {\n__new hunk__\n77        filters.fiberMin > 0 ||\n78        filters.sugarMax < 100 ||\n79        filters.sodiumMax < 4000 ||\n80        filters.maxTime < 120 ||\n81        !!filters.mealType\n82      )\n83    }, [filters])\n84  \n85 +  // const activeFilterCount = useMemo(() => {\n86 +  //   let count = 0\n87 +  //   if (filters.dietaryRestrictions.length > 0) count++\n88 +  //   if (filters.allergens.length > 0) count++\n89 +  //   if (filters.cuisines.length > 0) count++\n90 +  //   if (filters.majorConditions.length > 0) count++\n91 +  //   if (filters.calories[0] > 0 || filters.calories[1] < 1200) count++\n92 +  //   if (filters.proteinMin > 0) count++\n93 +  //   if (filters.carbsMin > 0) count++\n94 +  //   if (filters.fatMin > 0) count++\n95 +  //   if (filters.fiberMin > 0) count++\n96 +  //   if (filters.sugarMax < 100) count++\n97 +  //   if (filters.sodiumMax < 4000) count++\n98 +  //   if (filters.maxTime < 120) count++\n99 +  //   if (filters.mealType) count++\n100 +  //   return count\n101 +  // }, [filters])\n102    const activeFilterCount = useMemo(() => {\n103 +    let count = 0;\n104 +\n105 +  // Sum all selected array filters\n106 +    count += filters.dietaryRestrictions.length;\n107 +    count += filters.allergens.length;\n108 +    count += filters.cuisines.length;\n109 +    count += filters.majorConditions.length;\n110 +\n111 +    // Range and min/max filters\n112 +    if (filters.calories[0] > 0) count++; // Min calories\n113 +    if (filters.calories[1] < 1200) count++; // Max calories\n114 +    if (filters.proteinMin > 0) count++;\n115 +    if (filters.carbsMin > 0) count++;\n116 +    if (filters.fatMin > 0) count++;\n117 +    if (filters.fiberMin > 0) count++;\n118 +    if (filters.sugarMax < 100) count++;\n119 +    if (filters.sodiumMax < 4000) count++;\n120 +    if (filters.maxTime < 120) count++;\n121 +    \n122 +    // Single-value selection\n123 +    if (filters.mealType) count++;\n124 +\n125 +    return count;\n126 +  }, [filters]);\n127  \n128    const {\n129      data: searchResults = [],\n130      isLoading,\n__old hunk__\n       filters.fiberMin > 0 ||\n       filters.sugarMax < 100 ||\n       filters.sodiumMax < 4000 ||\n       filters.maxTime < 120 ||\n       !!filters.mealType\n     )\n   }, [filters])\n \n   const activeFilterCount = useMemo(() => {\n-    let count = 0\n-    if (filters.dietaryRestrictions.length > 0) count++\n-    if (filters.allergens.length > 0) count++\n-    if (filters.cuisines.length > 0) count++\n-    if (filters.majorConditions.length > 0) count++\n-    if (filters.calories[0] > 0 || filters.calories[1] < 1200) count++\n-    if (filters.proteinMin > 0) count++\n-    if (filters.carbsMin > 0) count++\n-    if (filters.fatMin > 0) count++\n-    if (filters.fiberMin > 0) count++\n-    if (filters.sugarMax < 100) count++\n-    if (filters.sodiumMax < 4000) count++\n-    if (filters.maxTime < 120) count++\n-    if (filters.mealType) count++\n-    return count\n-  }, [filters])\n \n   const {\n     data: searchResults = [],\n     isLoading,\n\n@@ -113,12 +140,22 @@ export default function SearchPage() {\n__new hunk__\n140          const rankedResults = rank(rawResults, settings)\n141          return rankedResults\n142        }\n143  \n144        return rawResults.map((recipe) => ({ ...recipe, score: 0 }))\n145      },\n146      enabled: !!(searchQuery || hasActiveFilters),\n147    })\n148 +  const handleSearchInputKeyDown = (e: React.KeyboardEvent) => {\n149 +    if (e.key === \"Escape\" && searchQuery) {\n150 +      setSearchQuery(\"\");\n151 +      inputRef.current?.focus();\n152 +    }\n153 +    if (e.key === \"Enter\") {\n154 +      handleSearch(searchQuery);\n155 +    }\n156 +  };\n157 +\n158  \n159    const handleSearch = (query: string) => {\n160      setSearchQuery(query)\n161      setFilters({ ...filters, q: query })\n\n@@ -182,13 +219,13 @@ export default function SearchPage() {\n__new hunk__\n219    return (\n220      \n221        \n222          {/* Search Header */}\n223          \n224            Search Recipes\n225  \n226            {/* Search Input */}\n227 +          {/* \n228              \n229              \n       \n         {/* Search Header */}\n         \n           Search Recipes\n \n           {/* Search Input */}\n-          \n             \n              setSearchQuery(e.target.value)}\n234                onKeyDown={(e) => e.key === \"Enter\" && handleSearch(searchQuery)}\n235                className=\"pl-10 pr-4 h-12 text-lg\"\n236              />\n237 +           */}\n238 +          \n239 +            \n240 +             setSearchQuery(e.target.value)}\n246 +              onKeyDown={handleSearchInputKeyDown}\n247 +              style={{ paddingRight: searchQuery ? \"2rem\" : undefined, width: \"100%\" }}\n248 +              className=\"pl-10 pr-4 h-12 text-lg\"\n249 +            />\n250 +            {searchQuery && (\n251 +               {\n266 +                  setSearchQuery(\"\");\n267 +                  inputRef.current?.focus();\n268 +              }}\n269 +              >\n270 +                \n271 +            \n272 +          )}\n273            \n274  \n275 +\n276            {/* Search Actions */}\n277            \n278               handleSearch(searchQuery)} size=\"sm\">\n279                Search\n\n\n## File: 'components/filter-panel.tsx'\n\n@@ -54,35 +54,58 @@\n__new hunk__\n54  export function FilterPanel({ open, onOpenChange, initialValues, onApply, onReset }: FilterPanelProps) {\n55    const form = useForm({\n56      resolver: zodResolver(schema),\n57      // provide full defaults (OUTPUT fits into INPUT just fine)\n58      defaultValues: schema.parse(initialValues ?? {}),\n59      mode: \"onChange\",\n60    })\n61  \n62     useEffect(() => {\n63      form.reset(schema.parse(initialValues ?? {}));\n64    }, [open, initialValues, form]);\n65  \n66 +  // function getActiveFiltersCount(): number {\n67 +  //   const values = form.getValues()\n68 +  //   let count = 0\n69 +  //   if ((values.dietaryRestrictions || []).length > 0) count++\n70 +  //   if ((values.allergens || []).length > 0) count++\n71 +  //   if ((values.cuisines || []).length > 0) count++\n72 +  //   if ((values.majorConditions || []).length > 0) count++\n73 +  //   if (values.calories && (values.calories[0] > 0 || values.calories[1] < 1200)) count++\n74 +  //   if ((values.proteinMin || 0) > 0) count++\n75 +  //   if ((values.carbsMin || 0) > 0) count++\n76 +  //   if ((values.fatMin || 0) > 0) count++\n77 +  //   if ((values.fiberMin || 0) > 0) count++\n78 +  //   if ((values.sugarMax || 100) < 100) count++\n79 +  //   if ((values.sodiumMax || 4000) < 4000) count++\n80 +  //   if ((values.maxTime || 120) < 120) count++\n81 +  //   if ((values.mealType || \"\") !== \"\") count++\n82 +  //   return count\n83 +  // }\n84    function getActiveFiltersCount(): number {\n85 +    const values = form.getValues();\n86 +    let count = 0;\n87 +\n88 +    // Count all selected array filters individually\n89 +    count += values.dietaryRestrictions.length;\n90 +    count += values.allergens.length;\n91 +    count += values.cuisines.length;\n92 +    count += values.majorConditions.length;\n93 +\n94 +    // Numeric and single-value filters\n95 +    if (values.calories[0] > 0) count++;           // Min calories\n96 +    if (values.calories[1] < 1200) count++;        // Max calories\n97 +    if (values.proteinMin > 0) count++;\n98 +    if (values.carbsMin > 0) count++;\n99 +    if (values.fatMin > 0) count++;\n100 +    if (values.fiberMin > 0) count++;\n101 +    if (values.sugarMax < 100) count++;\n102 +    if (values.sodiumMax < 4000) count++;\n103 +    if (values.maxTime < 120) count++;\n104 +    if (values.mealType) count++;\n105 +\n106 +    return count;\n107    }\n108    function handleApply() {\n109      const values = schema.parse(form.getValues())\n110      onApply(values)\n111      onOpenChange(false)\n__old hunk__\n export function FilterPanel({ open, onOpenChange, initialValues, onApply, onReset }: FilterPanelProps) {\n   const form = useForm({\n     resolver: zodResolver(schema),\n     // provide full defaults (OUTPUT fits into INPUT just fine)\n     defaultValues: schema.parse(initialValues ?? {}),\n     mode: \"onChange\",\n   })\n \n    useEffect(() => {\n     form.reset(schema.parse(initialValues ?? {}));\n   }, [open, initialValues, form]);\n \n   function getActiveFiltersCount(): number {\n-    const values = form.getValues()\n-    let count = 0\n-    if ((values.dietaryRestrictions || []).length > 0) count++\n-    if ((values.allergens || []).length > 0) count++\n-    if ((values.cuisines || []).length > 0) count++\n-    if ((values.majorConditions || []).length > 0) count++\n-    if (values.calories && (values.calories[0] > 0 || values.calories[1] < 1200)) count++\n-    if ((values.proteinMin || 0) > 0) count++\n-    if ((values.carbsMin || 0) > 0) count++\n-    if ((values.fatMin || 0) > 0) count++\n-    if ((values.fiberMin || 0) > 0) count++\n-    if ((values.sugarMax || 100) < 100) count++\n-    if ((values.sodiumMax || 4000) < 4000) count++\n-    if ((values.maxTime || 120) < 120) count++\n-    if ((values.mealType || \"\") !== \"\") count++\n-    return count\n   }\n-\n   function handleApply() {\n     const values = schema.parse(form.getValues())\n     onApply(values)\n     onOpenChange(false)"}, "file": {"name": "pr_reviewer.py", "path": "/app/pr_agent/tools/pr_reviewer.py"}, "function": "_prepare_prediction", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 197, "message": "PR diff", "module": "pr_reviewer", "name": "pr_agent.tools.pr_reviewer", "process": {"id": 30, "name": "MainProcess"}, "thread": {"id": 126091663866752, "name": "MainThread"}, "time": {"repr": "2025-12-11 07:26:54.703199+00:00", "timestamp": 1765438014.703199}}}
2025-Dec-11 07:26:54.713151
{"text": "Prompts\n", "record": {"elapsed": {"repr": "0:03:12.537723", "seconds": 192.537723}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "84aad2c7f2a44ec3bd9339bcf2de1e4c", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "artifact": {"system": "You are PR-Reviewer, a language model designed to review a Git Pull Request (PR).\nYour task is to provide constructive and concise feedback for the PR.\nThe review should focus on new code added in the PR code diff (lines starting with '+')\n\n\nThe format we will use to present the PR code diff:\n======\n## File: 'src/file1.py'\n\n\n@@ ... @@ def func1():\n__new hunk__\n11  unchanged code line0\n12  unchanged code line1\n13 +new code line2 added\n14  unchanged code line3\n__old hunk__\n unchanged code line0\n unchanged code line1\n-old code line2 removed\n unchanged code line3\n\n@@ ... @@ def func2():\n__new hunk__\n unchanged code line4\n+new code line5 added\n unchanged code line6\n\n## File: 'src/file2.py'\n...\n======\n\n- In the format above, the diff is organized into separate '__new hunk__' and '__old hunk__' sections for each code chunk. '__new hunk__' contains the updated code, while '__old hunk__' shows the removed code. If no code was removed in a specific chunk, the __old hunk__ section will be omitted.\n- We also added line numbers for the '__new hunk__' code, to help you refer to the code lines in your suggestions. These line numbers are not part of the actual code, and should only be used for reference.\n- Code lines are prefixed with symbols ('+', '-', ' '). The '+' symbol indicates new code added in the PR, the '-' symbol indicates code removed in the PR, and the ' ' symbol indicates unchanged code. The review should address new code added in the PR code diff (lines starting with '+').\n- When quoting variables, names or file paths from the code, use backticks (`) instead of single quote (').\n- Note that you only see changed code segments (diff hunks in a PR), not the entire codebase. Avoid suggestions that might duplicate existing functionality or questioning code elements (like variables declarations or import statements) that may be defined elsewhere in the codebase.\n- Also note that if the code ends at an opening brace or statement that begins a new scope (like 'if', 'for', 'try'), don't treat it as incomplete. Instead, acknowledge the visible scope boundary and analyze only the code shown.\n\n\nThe output must be a YAML object equivalent to type $PRReview, according to the following Pydantic definitions:\n=====\n\nclass KeyIssuesComponentLink(BaseModel):\n    relevant_file: str = Field(description=\"The full file path of the relevant file\")\n    issue_header: str = Field(description=\"One or two word title for the issue. For example: 'Possible Bug', etc.\")\n    issue_content: str = Field(description=\"A short and concise summary of what should be further inspected and validated during the PR review process for this issue. Do not mention line numbers in this field.\")\n    start_line: int = Field(description=\"The start line that corresponds to this issue in the relevant file\")\n    end_line: int = Field(description=\"The end line that corresponds to this issue in the relevant file\")\n\nclass Review(BaseModel):\n    estimated_effort_to_review_[1-5]: int = Field(description=\"Estimate, on a scale of 1-5 (inclusive), the time and effort required to review this PR by an experienced and knowledgeable developer. 1 means short and easy review , 5 means long and hard review. Take into account the size, complexity, quality, and the needed changes of the PR code diff.\")\n    relevant_tests: str = Field(description=\"yes/no question: does this PR have relevant tests added or updated ?\")\n    key_issues_to_review: List[KeyIssuesComponentLink] = Field(\"A short and diverse list (0-3 issues) of high-priority bugs, problems or performance concerns introduced in the PR code, which the PR reviewer should further focus on and validate during the review process.\")\n    security_concerns: str = Field(description=\"Does this PR code introduce vulnerabilities such as exposure of sensitive information (e.g., API keys, secrets, passwords), or security concerns like SQL injection, XSS, CSRF, and others ? Answer 'No' (without explaining why) if there are no possible issues. If there are security concerns or issues, start your answer with a short header, such as: 'Sensitive information exposure: ...', 'SQL injection: ...', etc. Explain your answer. Be specific and give examples if possible\")\n\nclass PRReview(BaseModel):\n    review: Review\n=====\n\n\nExample output:\n```yaml\nreview:\n  estimated_effort_to_review_[1-5]: |\n    3\n  relevant_tests: |\n    No\n  key_issues_to_review:\n    - relevant_file: |\n        directory/xxx.py\n      issue_header: |\n        Possible Bug\n      issue_content: |\n        ...\n      start_line: 12\n      end_line: 14\n    - ...\n  security_concerns: |\n    No\n```\n\nAnswer should be a valid YAML, and nothing else. Each YAML output MUST be after a newline, with proper indent, and block scalar indicator ('|')", "user": "\n\n\n--PR Info--\n\nToday's Date: 2025-12-11\n\nTitle: 'Fix: Search UX and multi-filter logic (frontend)'\n\nBranch: 'feature/initial-fixes'\n\nPR Description:\n======\n- Improved search bar UX in app/search/page.tsx:\r\n  - X icon clears input and refocuses\r\n  - Escape key clears input\r\n  - Enter key triggers search\r\n\r\n- Updated filter count logic:\r\n  - Accurately counts all active filters\r\n  - Apply button badge reflects true total\n======\n\n\nThe PR code diff:\n======\n## File: 'app/search/page.tsx'\n\n@@ -1,7 +1,8 @@\n__new hunk__\n1  \"use client\"\n2  \n3 +import { useState, useEffect, useMemo, useRef } from \"react\"\n4 +// import { X } from \"lucide-react\"\n5  import { useSearchParams, useRouter } from \"next/navigation\"\n6  import { useQuery } from \"@tanstack/react-query\"\n7  import { Input } from \"@/components/ui/input\"\n8  import { Button } from \"@/components/ui/button\"\n__old hunk__\n \"use client\"\n \n-import { useState, useEffect, useMemo } from \"react\"\n import { useSearchParams, useRouter } from \"next/navigation\"\n import { useQuery } from \"@tanstack/react-query\"\n import { Input } from \"@/components/ui/input\"\n import { Button } from \"@/components/ui/button\"\n\n@@ -41,11 +42,12 @@\n__new hunk__\n42  export default function SearchPage() {\n43    const searchParams = useSearchParams()\n44    const router = useRouter()\n45    const { filters, setFilters, resetFilters } = useFilters()\n46    const { settings } = useSettings()\n47  \n48    const [searchQuery, setSearchQuery] = useState(searchParams.get(\"q\") || filters.q || \"\")\n49 +  const inputRef = useRef(null);\n50    const [sortBy, setSortBy] = useState(settings.behavior.defaultSort || \"time\")\n51    const [filtersOpen, setFiltersOpen] = useState(false)\n52  \n53    // Update search query from URL params\n\n@@ -75,29 +77,54 @@ export default function SearchPage() {\n__new hunk__\n77        filters.fiberMin > 0 ||\n78        filters.sugarMax < 100 ||\n79        filters.sodiumMax < 4000 ||\n80        filters.maxTime < 120 ||\n81        !!filters.mealType\n82      )\n83    }, [filters])\n84  \n85 +  // const activeFilterCount = useMemo(() => {\n86 +  //   let count = 0\n87 +  //   if (filters.dietaryRestrictions.length > 0) count++\n88 +  //   if (filters.allergens.length > 0) count++\n89 +  //   if (filters.cuisines.length > 0) count++\n90 +  //   if (filters.majorConditions.length > 0) count++\n91 +  //   if (filters.calories[0] > 0 || filters.calories[1] < 1200) count++\n92 +  //   if (filters.proteinMin > 0) count++\n93 +  //   if (filters.carbsMin > 0) count++\n94 +  //   if (filters.fatMin > 0) count++\n95 +  //   if (filters.fiberMin > 0) count++\n96 +  //   if (filters.sugarMax < 100) count++\n97 +  //   if (filters.sodiumMax < 4000) count++\n98 +  //   if (filters.maxTime < 120) count++\n99 +  //   if (filters.mealType) count++\n100 +  //   return count\n101 +  // }, [filters])\n102    const activeFilterCount = useMemo(() => {\n103 +    let count = 0;\n104 +\n105 +  // Sum all selected array filters\n106 +    count += filters.dietaryRestrictions.length;\n107 +    count += filters.allergens.length;\n108 +    count += filters.cuisines.length;\n109 +    count += filters.majorConditions.length;\n110 +\n111 +    // Range and min/max filters\n112 +    if (filters.calories[0] > 0) count++; // Min calories\n113 +    if (filters.calories[1] < 1200) count++; // Max calories\n114 +    if (filters.proteinMin > 0) count++;\n115 +    if (filters.carbsMin > 0) count++;\n116 +    if (filters.fatMin > 0) count++;\n117 +    if (filters.fiberMin > 0) count++;\n118 +    if (filters.sugarMax < 100) count++;\n119 +    if (filters.sodiumMax < 4000) count++;\n120 +    if (filters.maxTime < 120) count++;\n121 +    \n122 +    // Single-value selection\n123 +    if (filters.mealType) count++;\n124 +\n125 +    return count;\n126 +  }, [filters]);\n127  \n128    const {\n129      data: searchResults = [],\n130      isLoading,\n__old hunk__\n       filters.fiberMin > 0 ||\n       filters.sugarMax < 100 ||\n       filters.sodiumMax < 4000 ||\n       filters.maxTime < 120 ||\n       !!filters.mealType\n     )\n   }, [filters])\n \n   const activeFilterCount = useMemo(() => {\n-    let count = 0\n-    if (filters.dietaryRestrictions.length > 0) count++\n-    if (filters.allergens.length > 0) count++\n-    if (filters.cuisines.length > 0) count++\n-    if (filters.majorConditions.length > 0) count++\n-    if (filters.calories[0] > 0 || filters.calories[1] < 1200) count++\n-    if (filters.proteinMin > 0) count++\n-    if (filters.carbsMin > 0) count++\n-    if (filters.fatMin > 0) count++\n-    if (filters.fiberMin > 0) count++\n-    if (filters.sugarMax < 100) count++\n-    if (filters.sodiumMax < 4000) count++\n-    if (filters.maxTime < 120) count++\n-    if (filters.mealType) count++\n-    return count\n-  }, [filters])\n \n   const {\n     data: searchResults = [],\n     isLoading,\n\n@@ -113,12 +140,22 @@ export default function SearchPage() {\n__new hunk__\n140          const rankedResults = rank(rawResults, settings)\n141          return rankedResults\n142        }\n143  \n144        return rawResults.map((recipe) => ({ ...recipe, score: 0 }))\n145      },\n146      enabled: !!(searchQuery || hasActiveFilters),\n147    })\n148 +  const handleSearchInputKeyDown = (e: React.KeyboardEvent) => {\n149 +    if (e.key === \"Escape\" && searchQuery) {\n150 +      setSearchQuery(\"\");\n151 +      inputRef.current?.focus();\n152 +    }\n153 +    if (e.key === \"Enter\") {\n154 +      handleSearch(searchQuery);\n155 +    }\n156 +  };\n157 +\n158  \n159    const handleSearch = (query: string) => {\n160      setSearchQuery(query)\n161      setFilters({ ...filters, q: query })\n\n@@ -182,13 +219,13 @@ export default function SearchPage() {\n__new hunk__\n219    return (\n220      \n221        \n222          {/* Search Header */}\n223          \n224            Search Recipes\n225  \n226            {/* Search Input */}\n227 +          {/* \n228              \n229              \n       \n         {/* Search Header */}\n         \n           Search Recipes\n \n           {/* Search Input */}\n-          \n             \n              setSearchQuery(e.target.value)}\n234                onKeyDown={(e) => e.key === \"Enter\" && handleSearch(searchQuery)}\n235                className=\"pl-10 pr-4 h-12 text-lg\"\n236              />\n237 +           */}\n238 +          \n239 +            \n240 +             setSearchQuery(e.target.value)}\n246 +              onKeyDown={handleSearchInputKeyDown}\n247 +              style={{ paddingRight: searchQuery ? \"2rem\" : undefined, width: \"100%\" }}\n248 +              className=\"pl-10 pr-4 h-12 text-lg\"\n249 +            />\n250 +            {searchQuery && (\n251 +               {\n266 +                  setSearchQuery(\"\");\n267 +                  inputRef.current?.focus();\n268 +              }}\n269 +              >\n270 +                \n271 +            \n272 +          )}\n273            \n274  \n275 +\n276            {/* Search Actions */}\n277            \n278               handleSearch(searchQuery)} size=\"sm\">\n279                Search\n\n\n## File: 'components/filter-panel.tsx'\n\n@@ -54,35 +54,58 @@\n__new hunk__\n54  export function FilterPanel({ open, onOpenChange, initialValues, onApply, onReset }: FilterPanelProps) {\n55    const form = useForm({\n56      resolver: zodResolver(schema),\n57      // provide full defaults (OUTPUT fits into INPUT just fine)\n58      defaultValues: schema.parse(initialValues ?? {}),\n59      mode: \"onChange\",\n60    })\n61  \n62     useEffect(() => {\n63      form.reset(schema.parse(initialValues ?? {}));\n64    }, [open, initialValues, form]);\n65  \n66 +  // function getActiveFiltersCount(): number {\n67 +  //   const values = form.getValues()\n68 +  //   let count = 0\n69 +  //   if ((values.dietaryRestrictions || []).length > 0) count++\n70 +  //   if ((values.allergens || []).length > 0) count++\n71 +  //   if ((values.cuisines || []).length > 0) count++\n72 +  //   if ((values.majorConditions || []).length > 0) count++\n73 +  //   if (values.calories && (values.calories[0] > 0 || values.calories[1] < 1200)) count++\n74 +  //   if ((values.proteinMin || 0) > 0) count++\n75 +  //   if ((values.carbsMin || 0) > 0) count++\n76 +  //   if ((values.fatMin || 0) > 0) count++\n77 +  //   if ((values.fiberMin || 0) > 0) count++\n78 +  //   if ((values.sugarMax || 100) < 100) count++\n79 +  //   if ((values.sodiumMax || 4000) < 4000) count++\n80 +  //  2025-12-11T07:26:54.713151345Z  if ((values.maxTime || 120) < 120) count++\n81 +  //   if ((values.mealType || \"\") !== \"\") count++\n82 +  //   return count\n83 +  // }\n84    function getActiveFiltersCount(): number {\n85 +    const values = form.getValues();\n86 +    let count = 0;\n87 +\n88 +    // Count all selected array filters individually\n89 +    count += values.dietaryRestrictions.length;\n90 +    count += values.allergens.length;\n91 +    count += values.cuisines.length;\n92 +    count += values.majorConditions.length;\n93 +\n94 +    // Numeric and single-value filters\n95 +    if (values.calories[0] > 0) count++;           // Min calories\n96 +    if (values.calories[1] < 1200) count++;        // Max calories\n97 +    if (values.proteinMin > 0) count++;\n98 +    if (values.carbsMin > 0) count++;\n99 +    if (values.fatMin > 0) count++;\n100 +    if (values.fiberMin > 0) count++;\n101 +    if (values.sugarMax < 100) count++;\n102 +    if (values.sodiumMax < 4000) count++;\n103 +    if (values.maxTime < 120) count++;\n104 +    if (values.mealType) count++;\n105 +\n106 +    return count;\n107    }\n108    function handleApply() {\n109      const values = schema.parse(form.getValues())\n110      onApply(values)\n111      onOpenChange(false)\n__old hunk__\n export function FilterPanel({ open, onOpenChange, initialValues, onApply, onReset }: FilterPanelProps) {\n   const form = useForm({\n     resolver: zodResolver(schema),\n     // provide full defaults (OUTPUT fits into INPUT just fine)\n     defaultValues: schema.parse(initialValues ?? {}),\n     mode: \"onChange\",\n   })\n \n    useEffect(() => {\n     form.reset(schema.parse(initialValues ?? {}));\n   }, [open, initialValues, form]);\n \n   function getActiveFiltersCount(): number {\n-    const values = form.getValues()\n-    let count = 0\n-    if ((values.dietaryRestrictions || []).length > 0) count++\n-    if ((values.allergens || []).length > 0) count++\n-    if ((values.cuisines || []).length > 0) count++\n-    if ((values.majorConditions || []).length > 0) count++\n-    if (values.calories && (values.calories[0] > 0 || values.calories[1] < 1200)) count++\n-    if ((values.proteinMin || 0) > 0) count++\n-    if ((values.carbsMin || 0) > 0) count++\n-    if ((values.fatMin || 0) > 0) count++\n-    if ((values.fiberMin || 0) > 0) count++\n-    if ((values.sugarMax || 100) < 100) count++\n-    if ((values.sodiumMax || 4000) < 4000) count++\n-    if ((values.maxTime || 120) < 120) count++\n-    if ((values.mealType || \"\") !== \"\") count++\n-    return count\n   }\n-\n   function handleApply() {\n     const values = schema.parse(form.getValues())\n     onApply(values)\n     onOpenChange(false)\n======\n\n\nResponse (should be a valid YAML, and nothing else):\n```yaml"}}, "file": {"name": "litellm_ai_handler.py", "path": "/app/pr_agent/algo/ai_handlers/litellm_ai_handler.py"}, "function": "chat_completion", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 397, "message": "Prompts", "module": "litellm_ai_handler", "name": "pr_agent.algo.ai_handlers.litellm_ai_handler", "process": {"id": 30, "name": "MainProcess"}, "thread": {"id": 126091663866752, "name": "MainThread"}, "time": {"repr": "2025-12-11 07:26:54.712643+00:00", "timestamp": 1765438014.712643}}}
2025-Dec-11 07:26:54.713362
{"text": "LiteLLM call model='openai/gpt-5-nano'\n", "record": {"elapsed": {"repr": "0:03:12.538284", "seconds": 192.538284}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "84aad2c7f2a44ec3bd9339bcf2de1e4c", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "litellm_ai_handler.py", "path": "/app/pr_agent/algo/ai_handlers/litellm_ai_handler.py"}, "function": "chat_completion", "level": {"icon": "âš ï¸", "name": "WARNING", "no": 30}, "line": 426, "message": "LiteLLM call model='openai/gpt-5-nano'", "module": "litellm_ai_handler", "name": "pr_agent.algo.ai_handlers.litellm_ai_handler", "process": {"id": 30, "name": "MainProcess"}, "thread": {"id": 126091663866752, "name": "MainThread"}, "time": {"repr": "2025-12-11 07:26:54.713204+00:00", "timestamp": 1765438014.713204}}}
2025-Dec-11 07:26:54.713464
{"text": "Using OpenAI client directly for LiteLLM proxy with model: openai/gpt-5-nano\n", "record": {"elapsed": {"repr": "0:03:12.538391", "seconds": 192.538391}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "84aad2c7f2a44ec3bd9339bcf2de1e4c", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "litellm_ai_handler.py", "path": "/app/pr_agent/algo/ai_handlers/litellm_ai_handler.py"}, "function": "_get_completion", "level": {"icon": "â„¹ï¸", "name": "INFO", "no": 20}, "line": 473, "message": "Using OpenAI client directly for LiteLLM proxy with model: openai/gpt-5-nano", "module": "litellm_ai_handler", "name": "pr_agent.algo.ai_handlers.litellm_ai_handler", "process": {"id": 30, "name": "MainProcess"}, "thread": {"id": 126091663866752, "name": "MainThread"}, "time": {"repr": "2025-12-11 07:26:54.713311+00:00", "timestamp": 1765438014.713311}}}
2025-Dec-11 07:27:50.874027
{"text": "\nAI response:\n```yaml\nreview:\n  estimated_effort_to_review_[1-5]: |\n    3\n  relevant_tests: |\n    No\n  key_issues_to_review:\n    - relevant_file: |\n        app/search/page.tsx\n      issue_header: |\n        Icon imports\n      issue_content: |\n        The new search input uses lucide-react icons (Search and X) but the import for X is commented out, and there is no explicit import for Search in the diff. This will likely cause runtime rendering errors. Ensure both icons are properly imported (for example: import { Search, X } from \"lucide-react\") or replace with supported icons.\n      start_line: 3\n      end_line: 4\n    - relevant_file: |\n        app/search/page.tsx\n      issue_header: |\n        Active filter count wiring\n      issue_content: |\n        activeFilterCount is computed in the frontend, but there is no visible wiring to display this count as a badge or indicator in the UI. Confirm and implement binding so the Apply button or filter summary reflects the true total of active filters.\n      start_line: 102\n      end_line: 126\n    - relevant_file: |\n        components/filter-panel.tsx\n      issue_header: |\n        Dead code: getActiveFiltersCount skeleton\n      issue_content: |\n        There appears to be a commented-out skeleton implementation of getActiveFiltersCount and then a separate actual implementation. Remove the dead commented code and keep a single, clean implementation to avoid confusion and potential divergence.\n      start_line: 66\n      end_line: 83\n  security_concerns: |\n    No\n```\n", "record": {"elapsed": {"repr": "0:04:08.698618", "seconds": 248.698618}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "84aad2c7f2a44ec3bd9339bcf2de1e4c", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "litellm_ai_handler.py", "path": "/app/pr_agent/algo/ai_handlers/litellm_ai_handler.py"}, "function": "chat_completion", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 439, "message": "\nAI response:\n```yaml\nreview:\n  estimated_effort_to_review_[1-5]: |\n    3\n  relevant_tests: |\n    No\n  key_issues_to_review:\n    - relevant_file: |\n        app/search/page.tsx\n      issue_header: |\n        Icon imports\n      issue_content: |\n        The new search input uses lucide-react icons (Search and X) but the import for X is commented out, and there is no explicit import for Search in the diff. This will likely cause runtime rendering errors. Ensure both icons are properly imported (for example: import { Search, X } from \"lucide-react\") or replace with supported icons.\n      start_line: 3\n      end_line: 4\n    - relevant_file: |\n        app/search/page.tsx\n      issue_header: |\n        Active filter count wiring\n      issue_content: |\n        activeFilterCount is computed in the frontend, but there is no visible wiring to display this count as a badge or indicator in the UI. Confirm and implement binding so the Apply button or filter summary reflects the true total of active filters.\n      start_line: 102\n      end_line: 126\n    - relevant_file: |\n        components/filter-panel.tsx\n      issue_header: |\n        Dead code: getActiveFiltersCount skeleton\n      issue_content: |\n        There appears to be a commented-out skeleton implementation of getActiveFiltersCount and then a separate actual implementation. Remove the dead commented code and keep a single, clean implementation to avoid confusion and potential divergence.\n      start_line: 66\n      end_line: 83\n  security_concerns: |\n    No\n```", "module": "litellm_ai_handler", "name": "pr_agent.algo.ai_handlers.litellm_ai_handler", "process": {"id": 30, "name": "MainProcess"}, "thread": {"id": 126091663866752, "name": "MainThread"}, "time": {"repr": "2025-12-11 07:27:50.873538+00:00", "timestamp": 1765438070.873538}}}
2025-Dec-11 07:27:50.874560
{"text": "Failed to generate prediction with openai/gpt-5-nano\n", "record": {"elapsed": {"repr": "0:04:08.698991", "seconds": 248.698991}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "84aad2c7f2a44ec3bd9339bcf2de1e4c", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "artifact": {"error": "'dict' object has no attribute 'dict'"}}, "file": {"name": "pr_processing.py", "path": "/app/pr_agent/algo/pr_processing.py"}, "function": "retry_with_fallback_models", "level": {"icon": "âš ï¸", "name": "WARNING", "no": 30}, "line": 333, "message": "Failed to generate prediction with openai/gpt-5-nano", "module": "pr_processing", "name": "pr_agent.algo.pr_processing", "process": {"id": 30, "name": "MainProcess"}, "thread": {"id": 126091663866752, "name": "MainThread"}, "time": {"repr": "2025-12-11 07:27:50.873911+00:00", "timestamp": 1765438070.873911}}}
2025-Dec-11 07:27:50.874570
