
2025-12-10T02:19:05.277459823Z [2025-12-10 02:19:05 +0000] [1] [INFO] Starting gunicorn 23.0.0
2025-12-10T02:19:05.277548978Z [2025-12-10 02:19:05 +0000] [1] [INFO] Listening at: http://0.0.0.0:3000 (1)
2025-12-10T02:19:05.277552864Z [2025-12-10 02:19:05 +0000] [1] [INFO] Using worker: uvicorn.workers.UvicornWorker
2025-12-10T02:19:05.287245125Z [2025-12-10 02:19:05 +0000] [7] [INFO] Booting worker with pid: 7
2025-12-10T02:19:05.321714977Z [2025-12-10 02:19:05 +0000] [8] [INFO] Booting worker with pid: 8
2025-12-10T02:19:05.416045218Z [2025-12-10 02:19:05 +0000] [9] [INFO] Booting worker with pid: 9
2025-12-10T02:19:05.466218743Z [2025-12-10 02:19:05 +0000] [10] [INFO] Booting worker with pid: 10
2025-12-10T02:19:05.495884403Z [2025-12-10 02:19:05 +0000] [11] [INFO] Booting worker with pid: 11
2025-12-10T02:19:05.512597648Z [2025-12-10 02:19:05 +0000] [12] [INFO] Booting worker with pid: 12
2025-12-10T02:19:05.528442255Z [2025-12-10 02:19:05 +0000] [13] [INFO] Booting worker with pid: 13
2025-12-10T02:19:05.624030511Z [2025-12-10 02:19:05 +0000] [14] [INFO] Booting worker with pid: 14
2025-12-10T02:19:05.652178684Z [2025-12-10 02:19:05 +0000] [15] [INFO] Booting worker with pid: 15
2025-12-10T02:19:05.693930453Z [2025-12-10 02:19:05 +0000] [16] [INFO] Booting worker with pid: 16
2025-12-10T02:19:05.751139806Z [2025-12-10 02:19:05 +0000] [17] [INFO] Booting worker with pid: 17
2025-12-10T02:19:05.833941478Z [2025-12-10 02:19:05 +0000] [18] [INFO] Booting worker with pid: 18
2025-12-10T02:19:05.884094994Z [2025-12-10 02:19:05 +0000] [19] [INFO] Booting worker with pid: 19
2025-12-10T02:19:05.920223206Z [2025-12-10 02:19:05 +0000] [20] [INFO] Booting worker with pid: 20
2025-12-10T02:19:05.991086631Z [2025-12-10 02:19:05 +0000] [21] [INFO] Booting worker with pid: 21
2025-12-10T02:19:06.075023784Z [2025-12-10 02:19:06 +0000] [22] [INFO] Booting worker with pid: 22
2025-12-10T02:19:06.142918024Z [2025-12-10 02:19:06 +0000] [23] [INFO] Booting worker with pid: 23
2025-12-10T02:19:06.209771034Z [2025-12-10 02:19:06 +0000] [24] [INFO] Booting worker with pid: 24
2025-12-10T02:19:06.248753719Z [2025-12-10 02:19:06 +0000] [25] [INFO] Booting worker with pid: 25
2025-12-10T02:19:06.257658112Z [2025-12-10 02:19:06 +0000] [26] [INFO] Booting worker with pid: 26
2025-12-10T02:19:06.363505164Z [2025-12-10 02:19:06 +0000] [27] [INFO] Booting worker with pid: 27
2025-12-10T02:19:06.378676655Z [2025-12-10 02:19:06 +0000] [28] [INFO] Booting worker with pid: 28
2025-12-10T02:19:06.452869459Z [2025-12-10 02:19:06 +0000] [29] [INFO] Booting worker with pid: 29
2025-12-10T02:19:06.477713772Z [2025-12-10 02:19:06 +0000] [30] [INFO] Booting worker with pid: 30
2025-12-10T02:19:06.544721333Z [2025-12-10 02:19:06 +0000] [31] [INFO] Booting worker with pid: 31
2025-12-10T02:19:22.274481510Z /usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-12-10T02:19:22.274564486Z   import pkg_resources
2025-12-10T02:19:22.274568092Z /usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-12-10T02:19:22.274570986Z   import pkg_resources
2025-12-10T02:19:22.278466629Z /usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-12-10T02:19:22.278521701Z   import pkg_resources
2025-12-10T02:19:22.279316208Z /usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-12-10T02:19:22.279371142Z   import pkg_resources
2025-12-10T02:19:22.295296820Z /usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-12-10T02:19:22.295392364Z   import pkg_resources
2025-12-10T02:19:22.304317527Z /usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-12-10T02:19:22.304380683Z   import pkg_resources
2025-12-10T02:19:22.339727208Z /usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-12-10T02:19:22.339770293Z   import pkg_resources
2025-12-10T02:19:22.394887040Z /usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-12-10T02:19:22.394951167Z   import pkg_resources
2025-12-10T02:19:22.476625019Z /usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-12-10T02:19:22.476697457Z   import pkg_resources
2025-12-10T02:19:22.811242099Z /usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-12-10T02:19:22.811326295Z   import pkg_resources
2025-12-10T02:19:22.838440250Z /usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-12-10T02:19:22.838484837Z   import pkg_resources
2025-12-10T02:19:23.093005793Z /usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-12-10T02:19:23.093047415Z   import pkg_resources
2025-12-10T02:19:23.142507936Z /usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-12-10T02:19:23.142554667Z   import pkg_resources
2025-12-10T02:19:23.155063824Z /usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-12-10T02:19:23.155117906Z   import pkg_resources
2025-12-10T02:19:23.269959118Z /usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-12-10T02:19:23.269998216Z   import pkg_resources
2025-12-10T02:19:23.517047340Z /usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-12-10T02:19:23.517093158Z   import pkg_resources
2025-12-10T02:19:23.872780201Z /usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-12-10T02:19:23.872848254Z   import pkg_resources
2025-12-10T02:19:23.997502688Z /usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-12-10T02:19:23.997554116Z   import pkg_resources
2025-12-10T02:19:24.097217316Z /usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-12-10T02:19:24.097301314Z   import pkg_resources
2025-12-10T02:19:24.210809665Z /usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-12-10T02:19:24.210870687Z   import pkg_resources
2025-12-10T02:19:24.308412190Z /usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-12-10T02:19:24.308443306Z   import pkg_resources
2025-12-10T02:19:24.802577696Z /usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-12-10T02:19:24.802641973Z   import pkg_resources
2025-12-10T02:19:24.969074018Z /usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-12-10T02:19:24.969130763Z   import pkg_resources
2025-12-10T02:19:25.084515283Z /usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-12-10T02:19:25.084593592Z   import pkg_resources
2025-12-10T02:19:25.157319004Z 2025-12-10 02:19:25.156 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-12-10T02:19:25.157484724Z 2025-12-10 02:19:25.157 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-12-10T02:19:25.175019297Z 2025-12-10 02:19:25.174 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-12-10T02:19:25.175077565Z 2025-12-10 02:19:25.174 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-12-10T02:19:25.176048598Z 2025-12-10 02:19:25.175 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-12-10T02:19:25.176198014Z 2025-12-10 02:19:25.176 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-12-10T02:19:25.180996367Z 2025-12-10 02:19:25.179 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-12-10T02:19:25.181019742Z 2025-12-10 02:19:25.180 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-12-10T02:19:25.184380649Z 2025-12-10 02:19:25.183 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-12-10T02:19:25.184725619Z 2025-12-10 02:19:25.184 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-12-10T02:19:25.203889539Z 2025-12-10 02:19:25.203 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-12-10T02:19:25.204438155Z 2025-12-10 02:19:25.204 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-12-10T02:19:25.204447659Z 2025-12-10 02:19:25.204 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-12-10T02:19:25.205317200Z 2025-12-10 02:19:25.204 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-12-10T02:19:25.208427489Z 2025-12-10 02:19:25.208 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-12-10T02:19:25.209111009Z 2025-12-10 02:19:25.208 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-12-10T02:19:25.261745496Z 2025-12-10 02:19:25.261 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-12-10T02:19:25.261803983Z 2025-12-10 02:19:25.261 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-12-10T02:19:25.263865852Z 2025-12-10 02:19:25.263 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-12-10T02:19:25.263992993Z 2025-12-10 02:19:25.263 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-12-10T02:19:25.265238601Z 2025-12-10 02:19:25.264 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-12-10T02:19:25.265370040Z 2025-12-10 02:19:25.265 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-12-10T02:19:25.270283006Z 2025-12-10 02:19:25.255 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-12-10T02:19:25.270435175Z 2025-12-10 02:19:25.270 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-12-10T02:19:25.271480972Z 2025-12-10 02:19:25.258 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-12-10T02:19:25.271902477Z 2025-12-10 02:19:25.271 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-12-10T02:19:25.277240753Z 2025-12-10 02:19:25.275 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-12-10T02:19:25.277277179Z 2025-12-10 02:19:25.275 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-12-10T02:19:25.280601350Z 2025-12-10 02:19:25.280 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-12-10T02:19:25.280863124Z 2025-12-10 02:19:25.280 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-12-10T02:19:25.282811482Z 2025-12-10 02:19:25.282 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-12-10T02:19:25.282977252Z 2025-12-10 02:19:25.282 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-12-10T02:19:25.296860130Z 2025-12-10 02:19:25.296 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-12-10T02:19:25.297035043Z 2025-12-10 02:19:25.296 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-12-10T02:19:25.300085722Z 2025-12-10 02:19:25.283 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-12-10T02:19:25.300383852Z 2025-12-10 02:19:25.300 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-12-10T02:19:25.312766669Z 2025-12-10 02:19:25.312 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-12-10T02:19:25.315247008Z 2025-12-10 02:19:25.314 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-12-10T02:19:25.317041764Z 2025-12-10 02:19:25.316 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-12-10T02:19:25.317067041Z 2025-12-10 02:19:25.315 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-12-10T02:19:25.328477953Z 2025-12-10 02:19:25.327 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-12-10T02:19:25.330240781Z 2025-12-10 02:19:25.329 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-12-10T02:19:25.550712449Z [2025-12-10 02:19:25 +0000] [12] [INFO] Started server process [12]
2025-12-10T02:19:25.550786230Z [2025-12-10 02:19:25 +0000] [12] [INFO] Waiting for application startup.
2025-12-10T02:19:25.550790647Z [2025-12-10 02:19:25 +0000] [12] [INFO] Application startup complete.
2025-12-10T02:19:25.550793591Z [2025-12-10 02:19:25 +0000] [28] [INFO] Started server process [28]
2025-12-10T02:19:25.550796035Z [2025-12-10 02:19:25 +0000] [28] [INFO] Waiting for application startup.
2025-12-10T02:19:25.550798428Z [2025-12-10 02:19:25 +0000] [28] [INFO] Application startup complete.
2025-12-10T02:19:25.552307413Z [2025-12-10 02:19:25 +0000] [24] [INFO] Started server process [24]
2025-12-10T02:19:25.552379632Z [2025-12-10 02:19:25 +0000] [24] [INFO] Waiting for application startup.
2025-12-10T02:19:25.552657631Z [2025-12-10 02:19:25 +0000] [24] [INFO] Application startup complete.
2025-12-10T02:19:25.562347578Z [2025-12-10 02:19:25 +0000] [16] [INFO] Started server process [16]
2025-12-10T02:19:25.562407469Z [2025-12-10 02:19:25 +0000] [16] [INFO] Waiting for application startup.
2025-12-10T02:19:25.562656335Z [2025-12-10 02:19:25 +0000] [16] [INFO] Application startup complete.
2025-12-10T02:19:25.578915624Z [2025-12-10 02:19:25 +0000] [14] [INFO] Started server process [14]
2025-12-10T02:19:25.579008865Z [2025-12-10 02:19:25 +0000] [14] [INFO] Waiting for application startup.
2025-12-10T02:19:25.579376860Z [2025-12-10 02:19:25 +0000] [14] [INFO] Application startup complete.
2025-12-10T02:19:25.585793062Z [2025-12-10 02:19:25 +0000] [15] [INFO] Started server process [15]
2025-12-10T02:19:25.586267758Z [2025-12-10 02:19:25 +0000] [15] [INFO] Waiting for application startup.
2025-12-10T02:19:25.586879340Z [2025-12-10 02:19:25 +0000] [15] [INFO] Application startup complete.
2025-12-10T02:19:25.592495586Z [2025-12-10 02:19:25 +0000] [31] [INFO] Started server process [31]
2025-12-10T02:19:25.592754286Z [2025-12-10 02:19:25 +0000] [31] [INFO] Waiting for application startup.
2025-12-10T02:19:25.592875178Z [2025-12-10 02:19:25 +0000] [31] [INFO] Application startup complete.
2025-12-10T02:19:25.594182780Z [2025-12-10 02:19:25 +0000] [22] [INFO] Started server process [22]
2025-12-10T02:19:25.594204322Z [2025-12-10 02:19:25 +0000] [22] [INFO] Waiting for application startup.
2025-12-10T02:19:25.594599388Z [2025-12-10 02:19:25 +0000] [22] [INFO] Application startup complete.
2025-12-10T02:19:25.614137400Z [2025-12-10 02:19:25 +0000] [25] [INFO] Started server process [25]
2025-12-10T02:19:25.615532875Z [2025-12-10 02:19:25 +0000] [25] [INFO] Waiting for application startup.
2025-12-10T02:19:25.616001321Z [2025-12-10 02:19:25 +0000] [25] [INFO] Application startup complete.
2025-12-10T02:19:25.622314157Z [2025-12-10 02:19:25 +0000] [23] [INFO] Started server process [23]
2025-12-10T02:19:25.623085971Z [2025-12-10 02:19:25 +0000] [23] [INFO] Waiting for application startup.
2025-12-10T02:19:25.624673644Z [2025-12-10 02:19:25 +0000] [23] [INFO] Application startup complete.
2025-12-10T02:19:25.634554860Z /usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-12-10T02:19:25.634613628Z   import pkg_resources
2025-12-10T02:19:25.637164404Z [2025-12-10 02:19:25 +0000] [7] [INFO] Started server process [7]
2025-12-10T02:19:25.637214539Z [2025-12-10 02:19:25 +0000] [7] [INFO] Waiting for application startup.
2025-12-10T02:19:25.638004059Z [2025-12-10 02:19:25 +0000] [7] [INFO] Application startup complete.
2025-12-10T02:19:25.652611169Z [2025-12-10 02:19:25 +0000] [18] [INFO] Started server process [18]
2025-12-10T02:19:25.652653634Z [2025-12-10 02:19:25 +0000] [18] [INFO] Waiting for application startup.
2025-12-10T02:19:25.652657019Z [2025-12-10 02:19:25 +0000] [18] [INFO] Application startup complete.
2025-12-10T02:19:25.684045887Z 2025-12-10 02:19:25.683 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-12-10T02:19:25.684262003Z 2025-12-10 02:19:25.684 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-12-10T02:19:25.690493998Z [2025-12-10 02:19:25 +0000] [26] [INFO] Started server process [26]
2025-12-10T02:19:25.690540517Z [2025-12-10 02:19:25 +0000] [26] [INFO] Waiting for application startup.
2025-12-10T02:19:25.690543952Z [2025-12-10 02:19:25 +0000] [26] [INFO] Application startup complete.
2025-12-10T02:19:25.702001335Z [2025-12-10 02:19:25 +0000] [19] [INFO] Started server process [19]
2025-12-10T02:19:25.702357702Z [2025-12-10 02:19:25 +0000] [19] [INFO] Waiting for application startup.
2025-12-10T02:19:25.702933379Z [2025-12-10 02:19:25 +0000] [19] [INFO] Application startup complete.
2025-12-10T02:19:25.705889276Z [2025-12-10 02:19:25 +0000] [8] [INFO] Started server process [8]
2025-12-10T02:19:25.705914183Z [2025-12-10 02:19:25 +0000] [8] [INFO] Waiting for application startup.
2025-12-10T02:19:25.705917658Z [2025-12-10 02:19:25 +0000] [8] [INFO] Application startup complete.
2025-12-10T02:19:25.705920172Z [2025-12-10 02:19:25 +0000] [9] [INFO] Started server process [9]
2025-12-10T02:19:25.705922496Z [2025-12-10 02:19:25 +0000] [9] [INFO] Waiting for application startup.
2025-12-10T02:19:25.705924829Z [2025-12-10 02:19:25 +0000] [9] [INFO] Application startup complete.
2025-12-10T02:19:25.705927032Z [2025-12-10 02:19:25 +0000] [20] [INFO] Started server process [20]
2025-12-10T02:19:25.706486376Z [2025-12-10 02:19:25 +0000] [20] [INFO] Waiting for application startup.
2025-12-10T02:19:25.706517752Z [2025-12-10 02:19:25 +0000] [20] [INFO] Application startup complete.
2025-12-10T02:19:25.716373812Z [2025-12-10 02:19:25 +0000] [29] [INFO] Started server process [29]
2025-12-10T02:19:25.716480481Z [2025-12-10 02:19:25 +0000] [29] [INFO] Waiting for application startup.
2025-12-10T02:19:25.716937140Z [2025-12-10 02:19:25 +0000] [29] [INFO] Application startup complete.
2025-12-10T02:19:25.717888954Z [2025-12-10 02:19:25 +0000] [30] [INFO] Started server process [30]
2025-12-10T02:19:25.718011800Z [2025-12-10 02:19:25 +0000] [30] [INFO] Waiting for application startup.
2025-12-10T02:19:25.718203228Z [2025-12-10 02:19:25 +0000] [30] [INFO] Application startup complete.
2025-12-10T02:19:25.726124760Z [2025-12-10 02:19:25 +0000] [17] [INFO] Started server process [17]
2025-12-10T02:19:25.726718474Z [2025-12-10 02:19:25 +0000] [17] [INFO] Waiting for application startup.
2025-12-10T02:19:25.726730284Z [2025-12-10 02:19:25 +0000] [17] [INFO] Application startup complete.
2025-12-10T02:19:25.731227973Z [2025-12-10 02:19:25 +0000] [10] [INFO] Started server process [10]
2025-12-10T02:19:25.731270278Z [2025-12-10 02:19:25 +0000] [10] [INFO] Waiting for application startup.
2025-12-10T02:19:25.732497737Z [2025-12-10 02:19:25 +0000] [10] [INFO] Application startup complete.
2025-12-10T02:19:25.753258503Z 2025-12-10 02:19:25.752 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-12-10T02:19:25.753591826Z 2025-12-10 02:19:25.753 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-12-10T02:19:25.851089202Z [2025-12-10 02:19:25 +0000] [27] [INFO] Started server process [27]
2025-12-10T02:19:25.851145978Z [2025-12-10 02:19:25 +0000] [27] [INFO] Waiting for application startup.
2025-12-10T02:19:25.851149773Z [2025-12-10 02:19:25 +0000] [27] [INFO] Application startup complete.
2025-12-10T02:19:25.895709887Z [2025-12-10 02:19:25 +0000] [11] [INFO] Started server process [11]
2025-12-10T02:19:25.895760814Z [2025-12-10 02:19:25 +0000] [11] [INFO] Waiting for application startup.
2025-12-10T02:19:25.896023540Z [2025-12-10 02:19:25 +0000] [11] [INFO] Application startup complete.
2025-12-10T02:19:25.973464751Z 2025-12-10 02:19:25.972 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-12-10T02:19:25.973517020Z 2025-12-10 02:19:25.973 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-12-10T02:19:26.050290495Z 2025-12-10 02:19:26.049 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-12-10T02:19:26.050694294Z 2025-12-10 02:19:26.050 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-12-10T02:19:26.123935464Z [2025-12-10 02:19:26 +0000] [13] [INFO] Started server process [13]
2025-12-10T02:19:26.124206392Z [2025-12-10 02:19:26 +0000] [13] [INFO] Waiting for application startup.
2025-12-10T02:19:26.124216117Z [2025-12-10 02:19:26 +0000] [13] [INFO] Application startup complete.
2025-12-10T02:19:26.197296304Z [2025-12-10 02:19:26 +0000] [21] [INFO] Started server process [21]
2025-12-10T02:19:26.197421222Z [2025-12-10 02:19:26 +0000] [21] [INFO] Waiting for application startup.
2025-12-10T02:19:26.199142598Z [2025-12-10 02:19:26 +0000] [21] [INFO] Application startup complete.
2025-12-10T02:20:00.271146834Z {"text": "Received a GitHub webhook\n", "record": {"elapsed": {"repr": "0:00:35.342608", "seconds": 35.342608}, "exception": null, "extra": {}, "file": {"name": "github_app.py", "path": "/app/pr_agent/servers/github_app.py"}, "function": "handle_github_webhooks", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 45, "message": "Received a GitHub webhook", "module": "github_app", "name": "pr_agent.servers.github_app", "process": {"id": 13, "name": "MainProcess"}, "thread": {"id": 131770084559744, "name": "MainThread"}, "time": {"repr": "2025-12-10 02:20:00.270663+00:00", "timestamp": 1765333200.270663}}}
2025-12-10T02:20:00.287450062Z {"text": "Handling request with event: issue_comment, action: created\n", "record": {"elapsed": {"repr": "0:00:35.358981", "seconds": 35.358981}, "exception": null, "extra": {}, "file": {"name": "github_app.py", "path": "/app/pr_agent/servers/github_app.py"}, "function": "handle_request", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 321, "message": "Handling request with event: issue_comment, action: created", "module": "github_app", "name": "pr_agent.servers.github_app", "process": {"id": 13, "name": "MainProcess"}, "thread": {"id": 131770084559744, "name": "MainThread"}, "time": {"repr": "2025-12-10 02:20:00.287036+00:00", "timestamp": 1765333200.287036}}}
2025-12-10T02:20:00.288695228Z {"text": "Request body\n", "record": {"elapsed": {"repr": "0:00:35.359922", "seconds": 35.359922}, "exception": null, "extra": {"artifact": {"action": "created", "issue": {"url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/1", "repository_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend", "labels_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/1/labels{/name}", "comments_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/1/comments", "events_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/1/events", "html_url": "https://github.com/souravOD/nutri-b2c-frontend/pull/1", "id": 3527983986, "node_id": "PR_kwDOQEZhKM6uaI7J", "number": 1, "title": "Fix: Search UX and multi-filter logic (frontend)", "user": {"login": "NamanOdysseyts", "id": 238778617, "node_id": "U_kgDODjt4-Q", "avatar_url": "https://avatars.githubusercontent.com/u/238778617?v=4", "gravatar_id": "", "url": "https://api.github.com/users/NamanOdysseyts", "html_url": "https://github.com/NamanOdysseyts", "followers_url": "https://api.github.com/users/NamanOdysseyts/followers", "following_url": "https://api.github.com/users/NamanOdysseyts/following{/other_user}", "gists_url": "https://api.github.com/users/NamanOdysseyts/gists{/gist_id}", "starred_url": "https://api.github.com/users/NamanOdysseyts/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/NamanOdysseyts/subscriptions", "organizations_url": "https://api.github.com/users/NamanOdysseyts/orgs", "repos_url": "https://api.github.com/users/NamanOdysseyts/repos", "events_url": "https://api.github.com/users/NamanOdysseyts/events{/privacy}", "received_events_url": "https://api.github.com/users/NamanOdysseyts/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 9561404867, "node_id": "LA_kwDOQEZhKM8AAAACOed1ww", "url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/labels/Review%20effort%202/5", "name": "Review effort 2/5", "color": "d1bcf9", "default": false, "description": null}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 62, "created_at": "2025-10-18T02:45:21Z", "updated_at": "2025-12-10T02:19:58Z", "closed_at": null, "author_association": "COLLABORATOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "html_url": "https://github.com/souravOD/nutri-b2c-frontend/pull/1", "diff_url": "https://github.com/souravOD/nutri-b2c-frontend/pull/1.diff", "patch_url": "https://github.com/souravOD/nutri-b2c-frontend/pull/1.patch", "merged_at": null}, "body": "- Improved search bar UX in app/search/page.tsx:\r\n  - X icon clears input and refocuses\r\n  - Escape key clears input\r\n  - Enter key triggers search\r\n\r\n- Updated filter count logic:\r\n  - Accurately counts all active filters\r\n  - Apply button badge reflects true total", "reactions": {"url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/1/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/1/timeline", "performed_via_github_app": null, "state_reason": null}, "comment": {"url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/comments/3635070683", "html_url": "https://github.com/souravOD/nutri-b2c-frontend/pull/1#issuecomment-3635070683", "issue_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/1", "id": 3635070683, "node_id": "IC_kwDOQEZhKM7Yqsbb", "user": {"login": "souravOD", "id": 238303722, "node_id": "U_kgDODjQ56g", "avatar_url": "https://avatars.githubusercontent.com/u/238303722?v=4", "gravatar_id": "", "url": "https://api.github.com/users/souravOD", "html_url": "https://github.com/souravOD", "followers_url": "https://api.github.com/users/souravOD/followers", "following_url": "https://api.github.com/users/souravOD/following{/other_user}", "gists_url": "https://api.github.com/users/souravOD/gists{/gist_id}", "starred_url": "https://api.github.com/users/souravOD/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/souravOD/subscriptions", "organizations_url": "https://api.github.com/users/souravOD/orgs", "repos_url": "https://api.github.com/users/souravOD/repos", "events_url": "https://api.github.com/users/souravOD/events{/privacy}", "received_events_url": "https://api.github.com/users/souravOD/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "created_at": "2025-12-10T02:19:58Z", "updated_at": "2025-12-10T02:19:58Z", "body": "/review Can you please review this PR", "author_association": "OWNER", "reactions": {"url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/comments/3635070683/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "performed_via_github_app": null}, "repository": {"id": 1078354216, "node_id": "R_kgDOQEZhKA", "name": "nutri-b2c-frontend", "full_name": "souravOD/nutri-b2c-frontend", "private": false, "owner": {"login": "souravOD", "id": 238303722, "node_id": "U_kgDODjQ56g", "avatar_url": "https://avatars.githubusercontent.com/u/238303722?v=4", "gravatar_id": "", "url": "https://api.github.com/users/souravOD", "html_url": "https://github.com/souravOD", "followers_url": "https://api.github.com/users/souravOD/followers", "following_url": "https://api.github.com/users/souravOD/following{/other_user}", "gists_url": "https://api.github.com/users/souravOD/gists{/gist_id}", "starred_url": "https://api.github.com/users/souravOD/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/souravOD/subscriptions", "organizations_url": "https://api.github.com/users/souravOD/orgs", "repos_url": "https://api.github.com/users/souravOD/repos", "events_url": "https://api.github.com/users/souravOD/events{/privacy}", "received_events_url": "https://api.github.com/users/souravOD/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "html_url": "https://github.com/souravOD/nutri-b2c-frontend", "description": null, "fork": true, "url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend", "forks_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/forks", "keys_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/keys{/key_id}", "collaborators_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/collaborators{/collaborator}", "teams_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/teams", "hooks_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/hooks", "issue_events_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/events{/number}", "events_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/events", "assignees_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/assignees{/user}", "branches_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/branches{/branch}", "tags_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/tags", "blobs_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/git/blobs{/sha}", "git_tags_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/git/tags{/sha}", "git_refs_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/git/refs{/sha}", "trees_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/git/trees{/sha}", "statuses_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/statuses/{sha}", "languages_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/languages", "stargazers_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/stargazers", "contributors_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/contributors", "subscribers_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/subscribers", "subscription_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/subscription", "commits_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/commits{/sha}", "git_commits_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/git/commits{/sha}", "comments_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/comments{/number}", "issue_comment_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/comments{/number}", "contents_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/contents/{+path}", "compare_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/compare/{base}...{head}", "merges_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/merges", "archive_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/{archive_format}{/ref}", "downloads_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/downloads", "issues_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues{/number}", "pulls_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls{/number}", "milestones_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/milestones{/number}", "notifications_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/notifications{?since,all,participating}", "labels_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/labels{/name}", "releases_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/releases{/id}", "deployments_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/deployments", "created_at": "2025-10-17T15:44:00Z", "updated_at": "2025-11-14T04:02:00Z", "pushed_at": "2025-10-16T19:32:39Z", "git_url": "git://github.com/souravOD/nutri-b2c-frontend.git", "ssh_url": "git@github.com:souravOD/nutri-b2c-frontend.git", "clone_url": "https://github.com/souravOD/nutri-b2c-frontend.git", "svn_url": "https://github.com/souravOD/nutri-b2c-frontend", "homepage": "https://v0-next-js-app-requirements-omega.vercel.app", "size": 11387, "stargazers_count": 0, "watchers_count": 0, "language": null, "has_issues": false, "has_projects": true, "has_downloads": true, "has_wiki": false, "has_pages": false, "has_discussions": false, "forks_count": 1, "mirror_url": null, "archived": false, "disabled": false, "open_issues_count": 2, "license": null, "allow_forking": true, "is_template": false, "web_commit_signoff_required": false, "topics": [], "visibility": "public", "forks": 1, "open_issues": 2, "watchers": 0, "default_branch": "main"}, "sender": {"login": "souravOD", "id": 238303722, "node_id": "U_kgDODjQ56g", "avatar_url": "https://avatars.githubusercontent.com/u/238303722?v=4", "gravatar_id": "", "url": "https://api.github.com/users/souravOD", "html_url": "https://github.com/souravOD", "followers_url": "https://api.github.com/users/souravOD/followers", "following_url": "https://api.github.com/users/souravOD/following{/other_user}", "gists_url": "https://api.github.com/users/souravOD/gists{/gist_id}", "starred_url": "https://api.github.com/users/souravOD/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/souravOD/subscriptions", "organizations_url": "https://api.github.com/users/souravOD/orgs", "repos_url": "https://api.github.com/users/souravOD/repos", "events_url": "https://api.github.com/users/souravOD/events{/privacy}", "received_events_url": "https://api.github.com/users/souravOD/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "installation": {"id": 92375808, "node_id": "MDIzOkludGVncmF0aW9uSW5zdGFsbGF0aW9uOTIzNzU4MDg="}}, "event": "issue_comment"}, "file": {"name": "github_app.py", "path": "/app/pr_agent/servers/github_app.py"}, "function": "handle_request", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 342, "message": "Request body", "module": "github_app", "name": "pr_agent.servers.github_app", "process": {"id": 13, "name": "MainProcess"}, "thread": {"id": 131770084559744, "name": "MainThread"}, "time": {"repr": "2025-12-10 02:20:00.287977+00:00", "timestamp": 1765333200.287977}}}
2025-12-10T02:20:01.403555485Z {"text": "Processing comment on PR api_url='https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1', comment_body=/review Can you please review this PR\n", "record": {"elapsed": {"repr": "0:00:36.474635", "seconds": 36.474635}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "f7c570913c05466698e4b2771b7b02c2", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "github_app.py", "path": "/app/pr_agent/servers/github_app.py"}, "function": "handle_comments_on_pr", "level": {"icon": "â„¹ï¸", "name": "INFO", "no": 20}, "line": 118, "message": "Processing comment on PR api_url='https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1', comment_body=/review Can you please review this PR", "module": "github_app", "name": "pr_agent.servers.github_app", "process": {"id": 13, "name": "MainProcess"}, "thread": {"id": 131770084559744, "name": "MainThread"}, "time": {"repr": "2025-12-10 02:20:01.402690+00:00", "timestamp": 1765333201.40269}}}
2025-12-10T02:20:05.050813852Z {"text": "AI metadata is disabled for this command\n", "record": {"elapsed": {"repr": "0:00:40.122271", "seconds": 40.122271}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "f7c570913c05466698e4b2771b7b02c2", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "pr_reviewer.py", "path": "/app/pr_agent/tools/pr_reviewer.py"}, "function": "__init__", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 75, "message": "AI metadata is disabled for this command", "module": "pr_reviewer", "name": "pr_agent.tools.pr_reviewer", "process": {"id": 13, "name": "MainProcess"}, "thread": {"id": 131770084559744, "name": "MainThread"}, "time": {"repr": "2025-12-10 02:20:05.050326+00:00", "timestamp": 1765333205.050326}}}
2025-12-10T02:20:05.255731063Z {"text": "Reviewing PR: https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1 ...\n", "record": {"elapsed": {"repr": "0:00:40.327055", "seconds": 40.327055}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "f7c570913c05466698e4b2771b7b02c2", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "pr_reviewer.py", "path": "/app/pr_agent/tools/pr_reviewer.py"}, "function": "run", "level": {"icon": "â„¹ï¸", "name": "INFO", "no": 20}, "line": 134, "message": "Reviewing PR: https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1 ...", "module": "pr_reviewer", "name": "pr_agent.tools.pr_reviewer", "process": {"id": 13, "name": "MainProcess"}, "thread": {"id": 131770084559744, "name": "MainThread"}, "time": {"repr": "2025-12-10 02:20:05.255110+00:00", "timestamp": 1765333205.25511}}}
2025-12-10T02:20:05.256652683Z {"text": "Relevant configs\n", "record": {"elapsed": {"repr": "0:00:40.328110", "seconds": 40.32811}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "f7c570913c05466698e4b2771b7b02c2", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "artifacts": {"pr_reviewer": {"require_score_review": false, "require_tests_review": true, "require_estimate_effort_to_review": true, "require_can_be_split_review": false, "require_security_review": true, "require_estimate_contribution_time_cost": false, "require_todo_scan": false, "require_ticket_analysis_review": true, "publish_output_no_suggestions": true, "persistent_comment": true, "extra_instructions": "", "num_max_findings": 3, "final_update_message": true, "enable_review_labels_security": true, "enable_review_labels_effort": true, "require_all_thresholds_for_incremental_review": false, "minimal_commits_for_incremental_review": 0, "minimal_minutes_for_incremental_review": 0, "enable_intro_text": true, "enable_help_text": false}, "config": {"enable_ai_metadata": false, "temperature": 1, "model": "openai/gpt-5.1", "custom_model_max_tokens": 200000, "fallback_models": "[\\\"openai/gpt-5\\\",\\\"openai/gpt-5-nano\\\"]", "git_provider": "github", "publish_output": true, "publish_output_progress": true, "verbosity_level": 0, "use_extra_bad_extensions": false, "log_level": "DEBUG", "use_wiki_settings_file": true, "use_repo_settings_file": true, "use_global_settings_file": true, "disable_auto_feedback": false, "ai_timeout": 120, "skip_keys": [], "custom_reasoning_model": false, "response_language": "en-US", "max_description_tokens": 500, "max_commits_tokens": 500, "max_model_tokens": 32000, "model_token_count_estimate_factor": 0.3, "patch_extension_skip_types": [".md", ".txt"], "allow_dynamic_context": true, "max_extra_lines_before_dynamic_context": 10, "patch_extra_lines_before": 5, "patch_extra_lines_after": 1, "secret_provider": "", "cli_mode": false, "ai_disclaimer_title": "", "ai_disclaimer": "", "output_relevant_configurations": false, "large_patch_policy": "clip", "duplicate_prompt_examples": false, "seed": -1, "add_repo_metadata": false, "add_repo_metadata_file_list": ["AGENTS.MD", "CLAUDE.MD", "QODO.MD"], "ignore_pr_title": ["^\\[Auto\\]", "^Auto"], "ignore_pr_target_branches": [], "ignore_pr_source_branches": [], "ignore_pr_labels": [], "ignore_pr_authors": [], "ignore_repositories": [], "ignore_language_framework": [], "is_auto_command": false, "reasoning_effort": "medium", "enable_auto_approval": false, "auto_approve_for_low_review_effort": -1, "auto_approve_for_no_suggestions": false, "ensure_ticket_compliance": false, "enable_claude_extended_thinking": false, "extended_thinking_budget_tokens": 2048, "extended_thinking_max_output_tokens": 4096, "enable_custom_labels": false}}}, "file": {"name": "pr_reviewer.py", "path": "/app/pr_agent/tools/pr_reviewer.py"}, "function": "run", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 137, "message": "Relevant configs", "module": "pr_reviewer", "name": "pr_agent.tools.pr_reviewer", "process": {"id": 13, "name": "MainProcess"}, "thread": {"id": 131770084559744, "name": "MainThread"}, "time": {"repr": "2025-12-10 02:20:05.256165+00:00", "timestamp": 1765333205.256165}}}
2025-12-10T02:20:05.257363584Z {"text": "Existing description\n", "record": {"elapsed": {"repr": "0:00:40.328947", "seconds": 40.328947}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "f7c570913c05466698e4b2771b7b02c2", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "description": "- improved search bar ux in app/search/page.tsx:\r\n  - x icon clears input and refocuses\r\n  - escape key clears input\r\n  - enter key triggers search\r\n\r\n- updated filter count logic:\r\n  - accurately counts all active filters\r\n  - apply button badge reflects true total"}, "file": {"name": "git_provider.py", "path": "/app/pr_agent/git_providers/git_provider.py"}, "function": "get_user_description", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 225, "message": "Existing description", "module": "git_provider", "name": "pr_agent.git_providers.git_provider", "process": {"id": 13, "name": "MainProcess"}, "thread": {"id": 131770084559744, "name": "MainThread"}, "time": {"repr": "2025-12-10 02:20:05.257002+00:00", "timestamp": 1765333205.257002}}}
2025-12-10T02:20:05.257416584Z {"text": "Existing description was not generated by the pr-agent\n", "record": {"elapsed": {"repr": "0:00:40.329111", "seconds": 40.329111}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "f7c570913c05466698e4b2771b7b02c2", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "git_provider.py", "path": "/app/pr_agent/git_providers/git_provider.py"}, "function": "get_user_description", "level": {"icon": "â„¹ï¸", "name": "INFO", "no": 20}, "line": 229, "message": "Existing description was not generated by the pr-agent", "module": "git_provider", "name": "pr_agent.git_providers.git_provider", "process": {"id": 13, "name": "MainProcess"}, "thread": {"id": 131770084559744, "name": "MainThread"}, "time": {"repr": "2025-12-10 02:20:05.257166+00:00", "timestamp": 1765333205.257166}}}
2025-12-10T02:20:05.973593759Z {"text": "Generating prediction with openai/gpt-5.1\n", "record": {"elapsed": {"repr": "0:00:41.043978", "seconds": 41.043978}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "f7c570913c05466698e4b2771b7b02c2", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "pr_processing.py", "path": "/app/pr_agent/algo/pr_processing.py"}, "function": "retry_with_fallback_models", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 326, "message": "Generating prediction with openai/gpt-5.1", "module": "pr_processing", "name": "pr_agent.algo.pr_processing", "process": {"id": 13, "name": "MainProcess"}, "thread": {"id": 131770084559744, "name": "MainThread"}, "time": {"repr": "2025-12-10 02:20:05.972033+00:00", "timestamp": 1765333205.972033}}}
2025-12-10T02:20:07.095582093Z {"text": "PR main language: TypeScript\n", "record": {"elapsed": {"repr": "0:00:42.167148", "seconds": 42.167148}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "f7c570913c05466698e4b2771b7b02c2", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "pr_processing.py", "path": "/app/pr_agent/algo/pr_processing.py"}, "function": "get_pr_diff", "level": {"icon": "â„¹ï¸", "name": "INFO", "no": 20}, "line": 63, "message": "PR main language: TypeScript", "module": "pr_processing", "name": "pr_agent.algo.pr_processing", "process": {"id": 13, "name": "MainProcess"}, "thread": {"id": 131770084559744, "name": "MainThread"}, "time": {"repr": "2025-12-10 02:20:07.095203+00:00", "timestamp": 1765333207.095203}}}
2025-12-10T02:20:07.103640161Z {"text": "Tokens: 4738, total tokens under limit: 32000, returning full diff.\n", "record": {"elapsed": {"repr": "0:00:42.175248", "seconds": 42.175248}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "f7c570913c05466698e4b2771b7b02c2", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "pr_processing.py", "path": "/app/pr_agent/algo/pr_processing.py"}, "function": "get_pr_diff", "level": {"icon": "â„¹ï¸", "name": "INFO", "no": 20}, "line": 74, "message": "Tokens: 4738, total tokens under limit: 32000, returning full diff.", "module": "pr_processing", "name": "pr_agent.algo.pr_processing", "process": {"id": 13, "name": "MainProcess"}, "thread": {"id": 131770084559744, "name": "MainThread"}, "time": {"repr": "2025-12-10 02:20:07.103303+00:00", "timestamp": 1765333207.103303}}}
2025-12-10T02:20:07.104413787Z {"text": "PR diff\n", "record": {"elapsed": {"repr": "0:00:42.175455", "seconds": 42.175455}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "f7c570913c05466698e4b2771b7b02c2", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "diff": "\n\n## File: 'app/search/page.tsx'\n\n@@ -1,7 +1,8 @@\n__new hunk__\n1  \"use client\"\n2  \n3 +import { useState, useEffect, useMemo, useRef } from \"react\"\n4 +// import { X } from \"lucide-react\"\n5  import { useSearchParams, useRouter } from \"next/navigation\"\n6  import { useQuery } from \"@tanstack/react-query\"\n7  import { Input } from \"@/components/ui/input\"\n8  import { Button } from \"@/components/ui/button\"\n__old hunk__\n \"use client\"\n \n-import { useState, useEffect, useMemo } from \"react\"\n import { useSearchParams, useRouter } from \"next/navigation\"\n import { useQuery } from \"@tanstack/react-query\"\n import { Input } from \"@/components/ui/input\"\n import { Button } from \"@/components/ui/button\"\n\n@@ -41,11 +42,12 @@\n__new hunk__\n42  export default function SearchPage() {\n43    const searchParams = useSearchParams()\n44    const router = useRouter()\n45    const { filters, setFilters, resetFilters } = useFilters()\n46    const { settings } = useSettings()\n47  \n48    const [searchQuery, setSearchQuery] = useState(searchParams.get(\"q\") || filters.q || \"\")\n49 +  const inputRef = useRef<HTMLInputElement>(null);\n50    const [sortBy, setSortBy] = useState<SortOption>(settings.behavior.defaultSort || \"time\")\n51    const [filtersOpen, setFiltersOpen] = useState(false)\n52  \n53    // Update search query from URL params\n\n@@ -75,29 +77,54 @@ export default function SearchPage() {\n__new hunk__\n77        filters.fiberMin > 0 ||\n78        filters.sugarMax < 100 ||\n79        filters.sodiumMax < 4000 ||\n80        filters.maxTime < 120 ||\n81        !!filters.mealType\n82      )\n83    }, [filters])\n84  \n85 +  // const activeFilterCount = useMemo(() => {\n86 +  //   let count = 0\n87 +  //   if (filters.dietaryRestrictions.length > 0) count++\n88 +  //   if (filters.allergens.length > 0) count++\n89 +  //   if (filters.cuisines.length > 0) count++\n90 +  //   if (filters.majorConditions.length > 0) count++\n91 +  //   if (filters.calories[0] > 0 || filters.calories[1] < 1200) count++\n92 +  //   if (filters.proteinMin > 0) count++\n93 +  //   if (filters.carbsMin > 0) count++\n94 +  //   if (filters.fatMin > 0) count++\n95 +  //   if (filters.fiberMin > 0) count++\n96 +  //   if (filters.sugarMax < 100) count++\n97 +  //   if (filters.sodiumMax < 4000) count++\n98 +  //   if (filters.maxTime < 120) count++\n99 +  //   if (filters.mealType) count++\n100 +  //   return count\n101 +  // }, [filters])\n102    const activeFilterCount = useMemo(() => {\n103 +    let count = 0;\n104 +\n105 +  // Sum all selected array filters\n106 +    count += filters.dietaryRestrictions.length;\n107 +    count += filters.allergens.length;\n108 +    count += filters.cuisines.length;\n109 +    count += filters.majorConditions.length;\n110 +\n111 +    // Range and min/max filters\n112 +    if (filters.calories[0] > 0) count++; // Min calories\n113 +    if (filters.calories[1] < 1200) count++; // Max calories\n114 +    if (filters.proteinMin > 0) count++;\n115 +    if (filters.carbsMin > 0) count++;\n116 +    if (filters.fatMin > 0) count++;\n117 +    if (filters.fiberMin > 0) count++;\n118 +    if (filters.sugarMax < 100) count++;\n119 +    if (filters.sodiumMax < 4000) count++;\n120 +    if (filters.maxTime < 120) count++;\n121 +    \n122 +    // Single-value selection\n123 +    if (filters.mealType) count++;\n124 +\n125 +    return count;\n126 +  }, [filters]);\n127  \n128    const {\n129      data: searchResults = [],\n130      isLoading,\n__old hunk__\n       filters.fiberMin > 0 ||\n       filters.sugarMax < 100 ||\n       filters.sodiumMax < 4000 ||\n       filters.maxTime < 120 ||\n       !!filters.mealType\n     )\n   }, [filters])\n \n   const activeFilterCount = useMemo(() => {\n-    let count = 0\n-    if (filters.dietaryRestrictions.length > 0) count++\n-    if (filters.allergens.length > 0) count++\n-    if (filters.cuisines.length > 0) count++\n-    if (filters.majorConditions.length > 0) count++\n-    if (filters.calories[0] > 0 || filters.calories[1] < 1200) count++\n-    if (filters.proteinMin > 0) count++\n-    if (filters.carbsMin > 0) count++\n-    if (filters.fatMin > 0) count++\n-    if (filters.fiberMin > 0) count++\n-    if (filters.sugarMax < 100) count++\n-    if (filters.sodiumMax < 4000) count++\n-    if (filters.maxTime < 120) count++\n-    if (filters.mealType) count++\n-    return count\n-  }, [filters])\n \n   const {\n     data: searchResults = [],\n     isLoading,\n\n@@ -113,12 +140,22 @@ export default function SearchPage() {\n__new hunk__\n140          const rankedResults = rank(rawResults, settings)\n141          return rankedResults\n142        }\n143  \n144        return rawResults.map((recipe) => ({ ...recipe, score: 0 }))\n145      },\n146      enabled: !!(searchQuery || hasActiveFilters),\n147    })\n148 +  const handleSearchInputKeyDown = (e: React.KeyboardEvent<HTMLInputElement>) => {\n149 +    if (e.key === \"Escape\" && searchQuery) {\n150 +      setSearchQuery(\"\");\n151 +      inputRef.current?.focus();\n152 +    }\n153 +    if (e.key === \"Enter\") {\n154 +      handleSearch(searchQuery);\n155 +    }\n156 +  };\n157 +\n158  \n159    const handleSearch = (query: string) => {\n160      setSearchQuery(query)\n161      setFilters({ ...filters, q: query })\n\n@@ -182,13 +219,13 @@ export default function SearchPage() {\n__new hunk__\n219    return (\n220      <div className=\"container px-4 py-6 max-w-6xl\">\n221        <div className=\"space-y-6\">\n222          {/* Search Header */}\n223          <div className=\"space-y-4\">\n224            <h1 className=\"text-3xl font-bold\">Search Recipes</h1>\n225  \n226            {/* Search Input */}\n227 +          {/* <div className=\"relative\">\n228              <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n229              <Input\n230                role=\"search\"\n231                placeholder=\"Search recipes, ingredients, cuisines...\"\n__old hunk__\n   return (\n     <div className=\"container px-4 py-6 max-w-6xl\">\n       <div className=\"space-y-6\">\n         {/* Search Header */}\n         <div className=\"space-y-4\">\n           <h1 className=\"text-3xl font-bold\">Search Recipes</h1>\n \n           {/* Search Input */}\n-          <div className=\"relative\">\n             <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n             <Input\n               role=\"search\"\n               placeholder=\"Search recipes, ingredients, cuisines...\"\n\n@@ -192,14 +229,51 @@ export default function SearchPage() {\n__new hunk__\n229              <Input\n230                role=\"search\"\n231                placeholder=\"Search recipes, ingredients, cuisines...\"\n232                value={searchQuery}\n233                onChange={(e) => setSearchQuery(e.target.value)}\n234                onKeyDown={(e) => e.key === \"Enter\" && handleSearch(searchQuery)}\n235                className=\"pl-10 pr-4 h-12 text-lg\"\n236              />\n237 +          </div> */}\n238 +          <div style={{ position: \"relative\", display: \"inline-block\", width: \"100%\" }}>\n239 +            <Search style={{ position: \"absolute\", left: \"0.75rem\", top: \"50%\", transform: \"translateY(-50%)\", height: \"1rem\", width: \"1rem\", color: \"gray\" }} />\n240 +            <Input\n241 +              role=\"search\"\n242 +              ref={inputRef}\n243 +              placeholder=\"Search recipes, ingredients, cuisines...\"\n244 +              value={searchQuery}\n245 +              onChange={(e) => setSearchQuery(e.target.value)}\n246 +              onKeyDown={handleSearchInputKeyDown}\n247 +              style={{ paddingRight: searchQuery ? \"2rem\" : undefined, width: \"100%\" }}\n248 +              className=\"pl-10 pr-4 h-12 text-lg\"\n249 +            />\n250 +            {searchQuery && (\n251 +              <button\n252 +                type=\"button\"\n253 +                style={{\n254 +                  position: \"absolute\",\n255 +                  right: \"0.75rem\",\n256 +                  top: \"50%\",\n257 +                  transform: \"translateY(-50%)\",\n258 +                  background: \"none\",\n259 +                  border: \"none\",\n260 +                  cursor: \"pointer\",\n261 +                  padding: 0,\n262 +                  color: \"gray\",\n263 +                }}\n264 +                aria-label=\"Clear search\"\n265 +                onClick={() => {\n266 +                  setSearchQuery(\"\");\n267 +                  inputRef.current?.focus();\n268 +              }}\n269 +              >\n270 +                <X size={20} />\n271 +            </button>\n272 +          )}\n273            </div>\n274  \n275 +\n276            {/* Search Actions */}\n277            <div className=\"flex items-center gap-2\">\n278              <Button onClick={() => handleSearch(searchQuery)} size=\"sm\">\n279                Search\n\n\n## File: 'components/filter-panel.tsx'\n\n@@ -54,35 +54,58 @@\n__new hunk__\n54  export function FilterPanel({ open, onOpenChange, initialValues, onApply, onReset }: FilterPanelProps) {\n55    const form = useForm<FiltersFormInput>({\n56      resolver: zodResolver(schema),\n57      // provide full defaults (OUTPUT fits into INPUT just fine)\n58      defaultValues: schema.parse(initialValues ?? {}),\n59      mode: \"onChange\",\n60    })\n61  \n62     useEffect(() => {\n63      form.reset(schema.parse(initialValues ?? {}));\n64    }, [open, initialValues, form]);\n65  \n66 +  // function getActiveFiltersCount(): number {\n67 +  //   const values = form.getValues()\n68 +  //   let count = 0\n69 +  //   if ((values.dietaryRestrictions || []).length > 0) count++\n70 +  //   if ((values.allergens || []).length > 0) count++\n71 +  //   if ((values.cuisines || []).length > 0) count++\n72 +  //   if ((values.majorConditions || []).length > 0) count++\n73 +  //   if (values.calories && (values.calories[0] > 0 || values.calories[1] < 1200)) count++\n74 +  //   if ((values.proteinMin || 0) > 0) count++\n75 +  //   if ((values.carbsMin || 0) > 0) count++\n76 +  //   if ((values.fatMin || 0) > 0) count++\n77 +  //   if ((values.fiberMin || 0) > 0) count++\n78 +  //   if ((values.sugarMax || 100) < 100) count++\n79 +  //   if ((values.sodiumMax || 4000) < 4000) count++\n80 +  //   if ((values.maxTime || 120) < 120) count++\n81 +  //   if ((values.mealType || \"\") !== \"\") count++\n82 +  //   return count\n83 +  // }\n84    function getActiveFiltersCount(): number {\n85 +    const values = form.getValues();\n86 +    let count = 0;\n87 +\n88 +    // Count all selected array filters individually\n89 +    count += values.dietaryRestrictions.length;\n90 +    count += values.allergens.length;\n91 +    count += values.cuisines.length;\n92 +    count += values.majorConditions.length;\n93 +\n94 +    // Numeric and single-value filters\n95 +    if (values.calories[0] > 0) count++;           // Min calories\n96 +    if (values.calories[1] < 1200) count++;        // Max calories\n97 +    if (values.proteinMin > 0) count++;\n98 +    if (values.carbsMin > 0) count++;\n99 +    if (values.fatMin > 0) count++;\n100 +    if (values.fiberMin > 0) count++;\n101 +    if (values.sugarMax < 100) count++;\n102 +    if (values.sodiumMax < 4000) count++;\n103 +    if (values.maxTime < 120) count++;\n104 +    if (values.mealType) count++;\n105 +\n106 +    return count;\n107    }\n108    function handleApply() {\n109      const values = schema.parse(form.getValues())\n110      onApply(values)\n111      onOpenChange(false)\n__old hunk__\n export function FilterPanel({ open, onOpenChange, initialValues, onApply, onReset }: FilterPanelProps) {\n   const form = useForm<FiltersFormInput>({\n     resolver: zodResolver(schema),\n     // provide full defaults (OUTPUT fits into INPUT just fine)\n     defaultValues: schema.parse(initialValues ?? {}),\n     mode: \"onChange\",\n   })\n \n    useEffect(() => {\n     form.reset(schema.parse(initialValues ?? {}));\n   }, [open, initialValues, form]);\n \n   function getActiveFiltersCount(): number {\n-    const values = form.getValues()\n-    let count = 0\n-    if ((values.dietaryRestrictions || []).length > 0) count++\n-    if ((values.allergens || []).length > 0) count++\n-    if ((values.cuisines || []).length > 0) count++\n-    if ((values.majorConditions || []).length > 0) count++\n-    if (values.calories && (values.calories[0] > 0 || values.calories[1] < 1200)) count++\n-    if ((values.proteinMin || 0) > 0) count++\n-    if ((values.carbsMin || 0) > 0) count++\n-    if ((values.fatMin || 0) > 0) count++\n-    if ((values.fiberMin || 0) > 0) count++\n-    if ((values.sugarMax || 100) < 100) count++\n-    if ((values.sodiumMax || 4000) < 4000) count++\n-    if ((values.maxTime || 120) < 120) count++\n-    if ((values.mealType || \"\") !== \"\") count++\n-    return count\n   }\n-\n   function handleApply() {\n     const values = schema.parse(form.getValues())\n     onApply(values)\n     onOpenChange(false)"}, "file": {"name": "pr_reviewer.py", "path": "/app/pr_agent/tools/pr_reviewer.py"}, "function": "_prepare_prediction", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 197, "message": "PR diff", "module": "pr_reviewer", "name": "pr_agent.tools.pr_reviewer", "process": {"id": 13, "name": "MainProcess"}, "thread": {"id": 131770084559744, "name": "MainThread"}, "time": {"repr": "2025-12-10 02:20:07.103510+00:00", "timestamp": 1765333207.10351}}}
2025-12-10T02:20:07.116495119Z {"text": "Prompts\n", "record": {"elapsed": {"repr": "0:00:42.187478", "seconds": 42.187478}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "f7c570913c05466698e4b2771b7b02c2", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "artifact": {"system": "You are PR-Reviewer, a language model designed to review a Git Pull Request (PR).\nYour task is to provide constructive and concise feedback for the PR.\nThe review should focus on new code added in the PR code diff (lines starting with '+')\n\n\nThe format we will use to present the PR code diff:\n======\n## File: 'src/file1.py'\n\n\n@@ ... @@ def func1():\n__new hunk__\n11  unchanged code line0\n12  unchanged code line1\n13 +new code line2 added\n14  unchanged code line3\n__old hunk__\n unchanged code line0\n unchanged code line1\n-old code line2 removed\n unchanged code line3\n\n@@ ... @@ def func2():\n__new hunk__\n unchanged code line4\n+new code line5 added\n unchanged code line6\n\n## File: 'src/file2.py'\n...\n======\n\n- In the format above, the diff is organized into separate '__new hunk__' and '__old hunk__' sections for each code chunk. '__new hunk__' contains the updated code, while '__old hunk__' shows the removed code. If no code was removed in a specific chunk, the __old hunk__ section will be omitted.\n- We also added line numbers for the '__new hunk__' code, to help you refer to the code lines in your suggestions. These line numbers are not part of the actual code, and should only be used for reference.\n- Code lines are prefixed with symbols ('+', '-', ' '). The '+' symbol indicates new code added in the PR, the '-' symbol indicates code removed in the PR, and the ' ' symbol indicates unchanged code. The review should address new code added in the PR code diff (lines starting with '+').\n- When quoting variables, names or file paths from the code, use backticks (`) instead of single quote (').\n- Note that you only see changed code segments (diff hunks in a PR), not the entire codebase. Avoid suggestions that might duplicate existing functionality or questioning code elements (like variables declarations or import statements) that may be defined elsewhere in the codebase.\n- Also note that if the code ends at an opening brace or statement that begins a new scope (like 'if', 'for', 'try'), don't treat it as incomplete. Instead, acknowledge the visible scope boundary and analyze only the code shown.\n\n\nThe output must be a YAML object equivalent to type $PRReview, according to the following Pydantic definitions:\n=====\n\nclass KeyIssuesComponentLink(BaseModel):\n    relevant_file: str = Field(description=\"The full file path of the relevant file\")\n    issue_header: str = Field(description=\"One or two word title for the issue. For example: 'Possible Bug', etc.\")\n    issue_content: str = Field(description=\"A short and concise summary of what should be further inspected and validated during the PR review process for this issue. Do not mention line numbers in this field.\")\n    start_line: int = Field(description=\"The start line that corresponds to this issue in the relevant file\")\n    end_line: int = Field(description=\"The end line that corresponds to this issue in the relevant file\")\n\nclass Review(BaseModel):\n    estimated_effort_to_review_[1-5]: int = Field(description=\"Estimate, on a scale of 1-5 (inclusive), the time and effort required to review this PR by an experienced and knowledgeable developer. 1 means short and easy review , 5 means long and hard review. Take into account the size, complexity, quality, and the needed changes of the PR code diff.\")\n    relevant_tests: str = Field(description=\"yes/no question: does this PR have relevant tests added or updated ?\")\n    key_issues_to_review: List[KeyIssuesComponentLink] = Field(\"A short and diverse list (0-3 issues) of high-priority bugs, problems or performance concerns introduced in the PR code, which the PR reviewer should further focus on and validate during the review process.\")\n    security_concerns: str = Field(description=\"Does this PR code introduce vulnerabilities such as exposure of sensitive information (e.g., API keys, secrets, passwords), or security concerns like SQL injection, XSS, CSRF, and others ? Answer 'No' (without explaining why) if there are no possible issues. If there are security concerns or issues, start your answer with a short header, such as: 'Sensitive information exposure: ...', 'SQL injection: ...', etc. Explain your answer. Be specific and give examples if possible\")\n\nclass PRReview(BaseModel):\n    review: Review\n=====\n\n\nExample output:\n```yaml\nreview:\n  estimated_effort_to_review_[1-5]: |\n    3\n  relevant_tests: |\n    No\n  key_issues_to_review:\n    - relevant_file: |\n        directory/xxx.py\n      issue_header: |\n        Possible Bug\n      issue_content: |\n        ...\n      start_line: 12\n      end_line: 14\n    - ...\n  security_concerns: |\n    No\n```\n\nAnswer should be a valid YAML, and nothing else. Each YAML output MUST be after a newline, with proper indent, and block scalar indicator ('|')", "user": "\n\n\n--PR Info--\n\nToday's Date: 2025-12-10\n\nTitle: 'Fix: Search UX and multi-filter logic (frontend)'\n\nBranch: 'feature/initial-fixes'\n\nPR Description:\n======\n- Improved search bar UX in app/search/page.tsx:\r\n  - X icon clears input and refocuses\r\n  - Escape key clears input\r\n  - Enter key triggers search\r\n\r\n- Updated filter count logic:\r\n  - Accurately counts all active filters\r\n  - Apply button badge reflects true total\n======\n\n\nThe PR code diff:\n======\n## File: 'app/search/page.tsx'\n\n@@ -1,7 +1,8 @@\n__new hunk__\n1  \"use client\"\n2  \n3 +import { useState, useEffect, useMemo, useRef } from \"react\"\n4 +// import { X } from \"lucide-react\"\n5  import { useSearchParams, useRouter } from \"next/navigation\"\n6  import { useQuery } from \"@tanstack/react-query\"\n7  import { Input } from \"@/components/ui/input\"\n8  import { Button } from \"@/components/ui/button\"\n__old hunk__\n \"use client\"\n \n-import { useState, useEffect, useMemo } from \"react\"\n import { useSearchParams, useRouter } from \"next/navigation\"\n import { useQuery } from \"@tanstack/react-query\"\n import { Input } from \"@/components/ui/input\"\n import { Button } from \"@/components/ui/button\"\n\n@@ -41,11 +42,12 @@\n__new hunk__\n42  export default function SearchPage() {\n43    const searchParams = useSearchParams()\n44    const router = useRouter()\n45    const { filters, setFilters, resetFilters } = useFilters()\n46    const { settings } = useSettings()\n47  \n48    const [searchQuery, setSearchQuery] = useState(searchParams.get(\"q\") || filters.q || \"\")\n49 +  const inputRef = useRef<HTMLInputElement>(null);\n50    const [sortBy, setSortBy] = useState<SortOption>(settings.behavior.defaultSort || \"time\")\n51    const [filtersOpen, setFiltersOpen] = useState(false)\n52  \n53    // Update search query from URL params\n\n@@ -75,29 +77,54 @@ export default function SearchPage() {\n__new hunk__\n77        filters.fiberMin > 0 ||\n78        filters.sugarMax < 100 ||\n79        filters.sodiumMax < 4000 ||\n80        filters.maxTime < 120 ||\n81        !!filters.mealType\n82      )\n83    }, [filters])\n84  \n85 +  // const activeFilterCount = useMemo(() => {\n86 +  //   let count = 0\n87 +  //   if (filters.dietaryRestrictions.length > 0) count++\n88 +  //   if (filters.allergens.length > 0) count++\n89 +  //   if (filters.cuisines.length > 0) count++\n90 +  //   if (filters.majorConditions.length > 0) count++\n91 +  //   if (filters.calories[0] > 0 || filters.calories[1] < 1200) count++\n92 +  //   if (filters.proteinMin > 0) count++\n93 +  //   if (filters.carbsMin > 0) count++\n94 +  //   if (filters.fatMin > 0) count++\n95 +  //   if (filters.fiberMin > 0) count++\n96 +  //   if (filters.sugarMax < 100) count++\n97 +  //   if (filters.sodiumMax < 4000) count++\n98 +  //   if (filters.maxTime < 120) count++\n99 +  //   if (filters.mealType) count++\n100 +  //   return count\n101 +  // }, [filters])\n102    const activeFilterCount = useMemo(() => {\n103 +    let count = 0;\n104 +\n105 +  // Sum all selected array filters\n106 +    count += filters.dietaryRestrictions.length;\n107 +    count += filters.allergens.length;\n108 +    count += filters.cuisines.length;\n109 +    count += filters.majorConditions.length;\n110 +\n111 +    // Range and min/max filters\n112 +    if (filters.calories[0] > 0) count++; // Min calories\n113 +    if (filters.calories[1] < 1200) count++; // Max calories\n114 +    if (filters.proteinMin > 0) count++;\n115 +    if (filters.carbsMin > 0) count++;\n116 +    if (filters.fatMin > 0) count++;\n117 +    if (filters.fiberMin > 0) count++;\n118 +    if (filters.sugarMax < 100) count++;\n119 +    if (filters.sodiumMax < 4000) count++;\n120 +    if (filters.maxTime < 120) count++;\n121 +    \n122 +    // Single-value selection\n123 +    if (filters.mealType) count++;\n124 +\n125 +    return count;\n126 +  }, [filters]);\n127  \n128    const {\n129      data: searchResults = [],\n130      isLoading,\n__old hunk__\n       filters.fiberMin > 0 ||\n       filters.sugarMax < 100 ||\n       filters.sodiumMax < 4000 ||\n       filters.maxTime < 120 ||\n       !!filters.mealType\n     )\n   }, [filters])\n \n   const activeFilterCount = useMemo(() => {\n-    let count = 0\n-    if (filters.dietaryRestrictions.length > 0) count++\n-    if (filters.allergens.length > 0) count++\n-    if (filters.cuisines.length > 0) count++\n-    if (filters.majorConditions.length > 0) count++\n-    if (filters.calories[0] > 0 || filters.calories[1] < 1200) count++\n-    if (filters.proteinMin > 0) count++\n-    if (filters.carbsMin > 0) count++\n-    if (filters.fatMin > 0) count++\n-    if (filters.fiberMin > 0) count++\n-    if (filters.sugarMax < 100) count++\n-    if (filters.sodiumMax < 4000) count++\n-    if (filters.maxTime < 120) count++\n-    if (filters.mealType) count++\n-    return count\n-  }, [filters])\n \n   const {\n     data: searchResults = [],\n     isLoading,\n\n@@ -113,12 +140,22 @@ export default function SearchPage() {\n__new hunk__\n140          const rankedResults = rank(rawResults, settings)\n141          return rankedResults\n142        }\n143  \n144        return rawResults.map((recipe) => ({ ...recipe, score: 0 }))\n145      },\n146      enabled: !!(searchQuery || hasActiveFilters),\n147    })\n148 +  const handleSearchInputKeyDown = (e: React.KeyboardEvent<HTMLInputElement>) => {\n149 +    if (e.key === \"Escape\" && searchQuery) {\n150 +      setSearchQuery(\"\");\n151 +      inputRef.current?.focus();\n152 +    }\n153 +    if (e.key === \"Enter\") {\n154 +      handleSearch(searchQuery);\n155 +    }\n156 +  };\n157 +\n158  \n159    const handleSearch = (query: string) => {\n160      setSearchQuery(query)\n161      setFilters({ ...filters, q: query })\n\n@@ -182,13 +219,13 @@ export default function SearchPage() {\n__new hunk__\n219    return (\n220      <div className=\"container px-4 py-6 max-w-6xl\">\n221        <div className=\"space-y-6\">\n222          {/* Search Header */}\n223          <div className=\"space-y-4\">\n224            <h1 className=\"text-3xl font-bold\">Search Recipes</h1>\n225  \n226            {/* Search Input */}\n227 +          {/* <div className=\"relative\">\n228              <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n229              <Input\n230                role=\"search\"\n231                placeholder=\"Search recipes, ingredients, cuisines...\"\n__old hunk__\n   return (\n     <div className=\"container px-4 py-6 max-w-6xl\">\n       <div className=\"space-y-6\">\n         {/* Search Header */}\n         <div className=\"space-y-4\">\n           <h1 className=\"text-3xl font-bold\">Search Recipes</h1>\n \n           {/* Search Input */}\n-          <div className=\"relative\">\n             <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n             <Input\n               role=\"search\"\n               placeholder=\"Search recipes, ingredients, cuisines...\"\n\n@@ -192,14 +229,51 @@ export default function SearchPage() {\n__new hunk__\n229              <Input\n230                role=\"search\"\n231                placeholder=\"Search recipes, ingredients, cuisines...\"\n232                value={searchQuery}\n233                onChange={(e) => setSearchQuery(e.target.value)}\n234                onKeyDown={(e) => e.key === \"Enter\" && handleSearch(searchQuery)}\n235                className=\"pl-10 pr-4 h-12 text-lg\"\n236              />\n237 +          </div> */}\n238 +          <div style={{ position: \"relative\", display: \"inline-block\", width: \"100%\" }}>\n239 +            <Search style={{ position: \"absolute\", left: \"0.75rem\", top: \"50%\", transform: \"translateY(-50%)\", height: \"1rem\", width: \"1rem\", color: \"gray\" }} />\n240 +            <Input\n241 +              role=\"search\"\n242 +              ref={inputRef}\n243 +              placeholder=\"Search recipes, ingredients, cuisines...\"\n244 +              value={searchQuery}\n245 +              onChange={(e) => setSearchQuery(e.target.value)}\n246 +              onKeyDown={handleSearchInputKeyDown}\n247 +              style={{ paddingRight: searchQuery ? \"2rem\" : undefined, width: \"100%\" }}\n248 +              className=\"pl-10 pr-4 h-12 text-lg\"\n249 +            />\n250 +            {searchQuery && (\n251 +              <button\n252 +                type=\"button\"\n253 +                style={{\n254 +                  position: \"absolute\",\n255 +                  right: \"0.75rem\",\n256 +                  top: \"50%\",\n257 +                  transform: \"translateY(-50%)\",\n258 +                  background: \"none\",\n259 +                  border: \"none\",\n260 +                  cursor: \"pointer\",\n261 +                  padding: 0,\n262 +                  color: \"gray\",\n263 +                }}\n264 +                aria-label=\"Clear search\"\n265 +                onClick={() => {\n266 +                  setSearchQuery(\"\");\n267 +                  inputRef.current?.focus();\n268 +              }}\n269 +              >\n270 +                <X size={20} />\n271 +            </button>\n272 +          )}\n273            </div>\n274  \n275 +\n276            {/* Search Actions */}\n277            <div className=\"flex items-center gap-2\">\n278              <Button onClick={() => handleSearch(searchQuery)} size=\"sm\">\n279                Search\n\n\n## File: 'components/filter-panel.tsx'\n\n@@ -54,35 +54,58 @@\n__new hunk__\n54  export function FilterPanel({ open, onOpenChange, initialValues, onApply, onReset }: FilterPanelProps) {\n55    const form = useForm<FiltersFormInput>({\n56      resolver: zodResolver(schema),\n57      // provide full defaults (OUTPUT fits into INPUT just fine)\n58      defaultValues: schema.parse(initialValues ?? {}),\n59      mode: \"onChange\",\n60    })\n61  \n62     useEffect(() => {\n63      form.reset(schema.parse(initialValues ?? {}));\n64    }, [open, initialValues, form]);\n65  \n66 +  // function getActiveFiltersCount(): number {\n67 +  //   const values = form.getValues()\n68 +  //   let count = 0\n69 +  //   if ((values.dietaryRestrictions || []).length > 0) count++\n70 +  //   if ((values.allergens || []).length > 0) count++\n71 +  //   if ((values.cuisines || []).length > 0) count++\n72 +  //   if ((values.majorConditions || []).length > 0) count++\n73 +  //   if (values.calories && (values.calories[0] > 0 || values.calories[1] < 1200)) count++\n74 +  //   if ((values.proteinMin || 0) > 0) count++\n75 +  //   if ((values.carbsMin || 0) > 0) count++\n76 +  //   if ((values.fatMin || 0) > 0) count++\n77 +  //   if ((values.fiberMin || 0) > 0) count++\n78 +  //   if ((values.sugarMax || 100) < 100) count++\n79 +  //   if ((values.sodiumMax || 4000) < 4000) count++\n80 +  //   2025-12-10T02:20:07.116495119Z if ((values.maxTime || 120) < 120) count++\n81 +  //   if ((values.mealType || \"\") !== \"\") count++\n82 +  //   return count\n83 +  // }\n84    function getActiveFiltersCount(): number {\n85 +    const values = form.getValues();\n86 +    let count = 0;\n87 +\n88 +    // Count all selected array filters individually\n89 +    count += values.dietaryRestrictions.length;\n90 +    count += values.allergens.length;\n91 +    count += values.cuisines.length;\n92 +    count += values.majorConditions.length;\n93 +\n94 +    // Numeric and single-value filters\n95 +    if (values.calories[0] > 0) count++;           // Min calories\n96 +    if (values.calories[1] < 1200) count++;        // Max calories\n97 +    if (values.proteinMin > 0) count++;\n98 +    if (values.carbsMin > 0) count++;\n99 +    if (values.fatMin > 0) count++;\n100 +    if (values.fiberMin > 0) count++;\n101 +    if (values.sugarMax < 100) count++;\n102 +    if (values.sodiumMax < 4000) count++;\n103 +    if (values.maxTime < 120) count++;\n104 +    if (values.mealType) count++;\n105 +\n106 +    return count;\n107    }\n108    function handleApply() {\n109      const values = schema.parse(form.getValues())\n110      onApply(values)\n111      onOpenChange(false)\n__old hunk__\n export function FilterPanel({ open, onOpenChange, initialValues, onApply, onReset }: FilterPanelProps) {\n   const form = useForm<FiltersFormInput>({\n     resolver: zodResolver(schema),\n     // provide full defaults (OUTPUT fits into INPUT just fine)\n     defaultValues: schema.parse(initialValues ?? {}),\n     mode: \"onChange\",\n   })\n \n    useEffect(() => {\n     form.reset(schema.parse(initialValues ?? {}));\n   }, [open, initialValues, form]);\n \n   function getActiveFiltersCount(): number {\n-    const values = form.getValues()\n-    let count = 0\n-    if ((values.dietaryRestrictions || []).length > 0) count++\n-    if ((values.allergens || []).length > 0) count++\n-    if ((values.cuisines || []).length > 0) count++\n-    if ((values.majorConditions || []).length > 0) count++\n-    if (values.calories && (values.calories[0] > 0 || values.calories[1] < 1200)) count++\n-    if ((values.proteinMin || 0) > 0) count++\n-    if ((values.carbsMin || 0) > 0) count++\n-    if ((values.fatMin || 0) > 0) count++\n-    if ((values.fiberMin || 0) > 0) count++\n-    if ((values.sugarMax || 100) < 100) count++\n-    if ((values.sodiumMax || 4000) < 4000) count++\n-    if ((values.maxTime || 120) < 120) count++\n-    if ((values.mealType || \"\") !== \"\") count++\n-    return count\n   }\n-\n   function handleApply() {\n     const values = schema.parse(form.getValues())\n     onApply(values)\n     onOpenChange(false)\n======\n\n\nResponse (should be a valid YAML, and nothing else):\n```yaml"}}, "file": {"name": "litellm_ai_handler.py", "path": "/app/pr_agent/algo/ai_handlers/litellm_ai_handler.py"}, "function": "chat_completion", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 388, "message": "Prompts", "module": "litellm_ai_handler", "name": "pr_agent.algo.ai_handlers.litellm_ai_handler", "process": {"id": 13, "name": "MainProcess"}, "thread": {"id": 131770084559744, "name": "MainThread"}, "time": {"repr": "2025-12-10 02:20:07.115533+00:00", "timestamp": 1765333207.115533}}}
2025-12-10T02:20:07.841681376Z {"text": "Received a GitHub webhook\n", "record": {"elapsed": {"repr": "0:00:42.912933", "seconds": 42.912933}, "exception": null, "extra": {}, "file": {"name": "github_app.py", "path": "/app/pr_agent/servers/github_app.py"}, "function": "handle_github_webhooks", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 45, "message": "Received a GitHub webhook", "module": "github_app", "name": "pr_agent.servers.github_app", "process": {"id": 13, "name": "MainProcess"}, "thread": {"id": 131770084559744, "name": "MainThread"}, "time": {"repr": "2025-12-10 02:20:07.840988+00:00", "timestamp": 1765333207.840988}}}
2025-12-10T02:20:07.863947811Z {"text": "Handling request with event: issue_comment, action: created\n", "record": {"elapsed": {"repr": "0:00:42.935538", "seconds": 42.935538}, "exception": null, "extra": {}, "file": {"name": "github_app.py", "path": "/app/pr_agent/servers/github_app.py"}, "function": "handle_request", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 321, "message": "Handling request with event: issue_comment, action: created", "module": "github_app", "name": "pr_agent.servers.github_app", "process": {"id": 13, "name": "MainProcess"}, "thread": {"id": 131770084559744, "name": "MainThread"}, "time": {"repr": "2025-12-10 02:20:07.863593+00:00", "timestamp": 1765333207.863593}}}
2025-12-10T02:20:07.865492771Z {"text": "Request body\n", "record": {"elapsed": {"repr": "0:00:42.936612", "seconds": 42.936612}, "exception": null, "extra": {"artifact": {"action": "created", "issue": {"url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/1", "repository_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend", "labels_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/1/labels{/name}", "comments_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/1/comments", "events_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/1/events", "html_url": "https://github.com/souravOD/nutri-b2c-frontend/pull/1", "id": 3527983986, "node_id": "PR_kwDOQEZhKM6uaI7J", "number": 1, "title": "Fix: Search UX and multi-filter logic (frontend)", "user": {"login": "NamanOdysseyts", "id": 238778617, "node_id": "U_kgDODjt4-Q", "avatar_url": "https://avatars.githubusercontent.com/u/238778617?v=4", "gravatar_id": "", "url": "https://api.github.com/users/NamanOdysseyts", "html_url": "https://github.com/NamanOdysseyts", "followers_url": "https://api.github.com/users/NamanOdysseyts/followers", "following_url": "https://api.github.com/users/NamanOdysseyts/following{/other_user}", "gists_url": "https://api.github.com/users/NamanOdysseyts/gists{/gist_id}", "starred_url": "https://api.github.com/users/NamanOdysseyts/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/NamanOdysseyts/subscriptions", "organizations_url": "https://api.github.com/users/NamanOdysseyts/orgs", "repos_url": "https://api.github.com/users/NamanOdysseyts/repos", "events_url": "https://api.github.com/users/NamanOdysseyts/events{/privacy}", "received_events_url": "https://api.github.com/users/NamanOdysseyts/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 9561404867, "node_id": "LA_kwDOQEZhKM8AAAACOed1ww", "url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/labels/Review%20effort%202/5", "name": "Review effort 2/5", "color": "d1bcf9", "default": false, "description": null}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 63, "created_at": "2025-10-18T02:45:21Z", "updated_at": "2025-12-10T02:20:05Z", "closed_at": null, "author_association": "COLLABORATOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "html_url": "https://github.com/souravOD/nutri-b2c-frontend/pull/1", "diff_url": "https://github.com/souravOD/nutri-b2c-frontend/pull/1.diff", "patch_url": "https://github.com/souravOD/nutri-b2c-frontend/pull/1.patch", "merged_at": null}, "body": "- Improved search bar UX in app/search/page.tsx:\r\n  - X icon clears input and refocuses\r\n  - Escape key clears input\r\n  - Enter key triggers search\r\n\r\n- Updated filter count logic:\r\n  - Accurately counts all active filters\r\n  - Apply button badge reflects true total", "reactions": {"url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/1/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/1/timeline", "performed_via_github_app": null, "state_reason": null}, "comment": {"url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/comments/3635070881", "html_url": "https://github.com/souravOD/nutri-b2c-frontend/pull/1#issuecomment-3635070881", "issue_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/1", "id": 3635070881, "node_id": "IC_kwDOQEZhKM7Yqseh", "user": {"login": "confersolutions-pr-agent-testing[bot]", "id": 241213316, "node_id": "BOT_kgDODmCfhA", "avatar_url": "https://avatars.githubusercontent.com/u/238303722?v=4", "gravatar_id": "", "url": "https://api.github.com/users/confersolutions-pr-agent-testing%5Bbot%5D", "html_url": "https://github.com/apps/confersolutions-pr-agent-testing", "followers_url": "https://api.github.com/users/confersolutions-pr-agent-testing%5Bbot%5D/followers", "following_url": "https://api.github.com/users/confersolutions-pr-agent-testing%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/confersolutions-pr-agent-testing%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/confersolutions-pr-agent-testing%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/confersolutions-pr-agent-testing%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/confersolutions-pr-agent-testing%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/confersolutions-pr-agent-testing%5Bbot%5D/repos", "events_url": "https://api.github.com/users/confersolutions-pr-agent-testing%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/confersolutions-pr-agent-testing%5Bbot%5D/received_events", "type": "Bot", "user_view_type": "public", "site_admin": false}, "created_at": "2025-12-10T02:20:05Z", "updated_at": "2025-12-10T02:20:05Z", "body": "Preparing review...", "author_association": "NONE", "reactions": {"url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/comments/3635070881/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "performed_via_github_app": {"id": 2209305, "client_id": "Iv23li7bKiGgGVtVjmWH", "slug": "confersolutions-pr-agent-testing", "node_id": "A_kwDODjQ56s4AIbYZ", "owner": {"login": "souravOD", "id": 238303722, "node_id": "U_kgDODjQ56g", "avatar_url": "https://avatars.githubusercontent.com/u/238303722?v=4", "gravatar_id": "", "url": "https://api.github.com/users/souravOD", "html_url": "https://github.com/souravOD", "followers_url": "https://api.github.com/users/souravOD/followers", "following_url": "https://api.github.com/users/souravOD/following{/other_user}", "gists_url": "https://api.github.com/users/souravOD/gists{/gist_id}", "starred_url": "https://api.github.com/users/souravOD/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/souravOD/subscriptions", "organizations_url": "https://api.github.com/users/souravOD/orgs", "repos_url": "https://api.github.com/users/souravOD/repos", "events_url": "https://api.github.com/users/souravOD/events{/privacy}", "received_events_url": "https://api.github.com/users/souravOD/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "name": "confersolutions-pr-agent-testing", "description": "", "external_url": "https://app.affine.pro/workspace/5faca6c6-75a5-4a38-a457-467462b9e9bd/4tBJ2igTRqph8VLY69JYh", "html_url": "https://github.com/apps/confersolutions-pr-agent-testing", "created_at": "2025-10-30T23:17:56Z", "updated_at": "2025-12-04T21:49:27Z", "permissions": {"actions": "read", "checks": "read", "contents": "read", "issues": "write", "metadata": "read", "pull_requests": "write", "statuses": "read"}, "events": ["commit_comment", "issues", "issue_comment", "merge_queue_entry", "pull_request", "pull_request_review", "pull_request_review_comment", "pull_request_review_thread", "push"]}}, "repository": {"id": 1078354216, "node_id": "R_kgDOQEZhKA", "name": "nutri-b2c-frontend", "full_name": "souravOD/nutri-b2c-frontend", "private": false, "owner": {"login": "souravOD", "id": 238303722, "node_id": "U_kgDODjQ56g", "avatar_url": "https://avatars.githubusercontent.com/u/238303722?v=4", "gravatar_id": "", "url": "https://api.github.com/users/souravOD", "html_url": "https://github.com/souravOD", "followers_url": "https://api.github.com/users/souravOD/followers", "following_url": "https://api.github.com/users/souravOD/following{/other_user}", "gists_url": "https://api.github.com/users/souravOD/gists{/gist_id}", "starred_url": "https://api.github.com/users/souravOD/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/souravOD/subscriptions", "organizations_url": "https://api.github.com/users/souravOD/orgs", "repos_url": "https://api.github.com/users/souravOD/repos", "events_url": "https://api.github.com/users/souravOD/events{/privacy}", "received_events_url": "https://api.github.com/users/souravOD/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "html_url": "https://github.com/souravOD/nutri-b2c-frontend", "description": null, "fork": true, "url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend", "forks_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/forks", "keys_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/keys{/key_id}", "collaborators_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/collaborators{/collaborator}", "teams_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/teams", "hooks_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/hooks", "issue_events_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/events{/number}", "events_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/events", "assignees_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/assignees{/user}", "branches_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/branches{/branch}", "tags_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/tags", "blobs_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/git/blobs{/sha}", "git_tags_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/git/tags{/sha}", "git_refs_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/git/refs{/sha}", "trees_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/git/trees{/sha}", "statuses_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/statuses/{sha}", "languages_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/languages", "stargazers_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/stargazers", "contributors_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/contributors", "subscribers_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/subscribers", "subscription_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/subscription", "commits_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/commits{/sha}", "git_commits_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/git/commits{/sha}", "comments_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/comments{/number}", "issue_comment_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/comments{/number}", "contents_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/contents/{+path}", "compare_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/compare/{base}...{head}", "merges_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/merges", "archive_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/{archive_format}{/ref}", "downloads_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/downloads", "issues_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues{/number}", "pulls_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls{/number}", "milestones_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/milestones{/number}", "notifications_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/notifications{?since,all,participating}", "labels_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/labels{/name}", "releases_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/releases{/id}", "deployments_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/deployments", "created_at": "2025-10-17T15:44:00Z", "updated_at": "2025-11-14T04:02:00Z", "pushed_at": "2025-10-16T19:32:39Z", "git_url": "git://github.com/souravOD/nutri-b2c-frontend.git", "ssh_url": "git@github.com:souravOD/nutri-b2c-frontend.git", "clone_url": "https://github.com/souravOD/nutri-b2c-frontend.git", "svn_url": "https://github.com/souravOD/nutri-b2c-frontend", "homepage": "https://v0-next-js-app-requirements-omega.vercel.app", "size": 11387, "stargazers_count": 0, "watchers_count": 0, "language": null, "has_issues": false, "has_projects": true, "has_downloads": true, "has_wiki": false, "has_pages": false, "has_discussions": false, "forks_count": 1, "mirror_url": null, "archived": false, "disabled": false, "open_issues_count": 2, "license": null, "allow_forking": true, "is_template": false, "web_commit_signoff_required": false, "topics": [], "visibility": "public", "forks": 1, "open_issues": 2, "watchers": 0, "default_branch": "main"}, "sender": {"login": "confersolutions-pr-agent-testing[bot]", "id": 241213316, "node_id": "BOT_kgDODmCfhA", "avatar_url": "https://avatars.githubusercontent.com/u/238303722?v=4", "gravatar_id": "", "url": "https://api.github.com/users/confersolutions-pr-agent-testing%5Bbot%5D", "html_url": "https://github.com/apps/confersolutions-pr-agent-testing", "followers_url": "https://api.github.com/users/confersolutions-pr-agent-testing%5Bbot%5D/followers", "following_url": "https://api.github.com/users/confersolutions-pr-agent-testing%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/confersolutions-pr-agent-testing%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/confersolutions-pr-agent-testing%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/confersolutions-pr-agent-testing%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/confersolutions-pr-agent-testing%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/confersolutions-pr-agent-testing%5Bbot%5D/repos", "events_url": "https://api.github.com/users/confersolutions-pr-agent-testing%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/confersolutions-pr-agent-testing%5Bbot%5D/received_events", "type": "Bot", "user_view_type": "public", "site_admin": false}, "installation": {"id": 92375808, "node_id": "MDIzOkludGVncmF0aW9uSW5zdGFsbGF0aW9uOTIzNzU4MDg="}}, "event": "issue_comment"}, "file": {"name": "github_app.py", "path": "/app/pr_agent/servers/github_app.py"}, "function": "handle_request", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 342, "message": "Request body", "module": "github_app", "name": "pr_agent.servers.github_app", "process": {"id": 13, "name": "MainProcess"}, "thread": {"id": 131770084559744, "name": "MainThread"}, "time": {"repr": "2025-12-10 02:20:07.864667+00:00", "timestamp": 1765333207.864667}}}
2025-12-10T02:20:07.865620474Z {"text": "Ignoring comment not starting with /\n", "record": {"elapsed": {"repr": "0:00:42.937048", "seconds": 42.937048}, "exception": null, "extra": {}, "file": {"name": "github_app.py", "path": "/app/pr_agent/servers/github_app.py"}, "function": "handle_comments_on_pr", "level": {"icon": "â„¹ï¸", "name": "INFO", "no": 20}, "line": 96, "message": "Ignoring comment not starting with /", "module": "github_app", "name": "pr_agent.servers.github_app", "process": {"id": 13, "name": "MainProcess"}, "thread": {"id": 131770084559744, "name": "MainThread"}, "time": {"repr": "2025-12-10 02:20:07.865103+00:00", "timestamp": 1765333207.865103}}}
2025-12-10T02:20:07.937861526Z 
2025-12-10T02:20:07.937912774Z Give Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new
2025-12-10T02:20:07.937947847Z LiteLLM.Info: If you need to debug this error, use `litellm._turn_on_debug()'.
2025-12-10T02:20:07.937950981Z 
2025-12-10T02:20:07.937957521Z {"text": "Error during LLM inference: litellm.AuthenticationError: AuthenticationError: OpenAIException - team not allowed to access model. This team can only access models=['openai/gpt-5.1', 'openai/gpt-5', 'openai/gpt-5-mini', 'openai/gpt-5-nano']. Tried to access gpt-5.1\n", "record": {"elapsed": {"repr": "0:00:43.009022", "seconds": 43.009022}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "f7c570913c05466698e4b2771b7b02c2", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "litellm_ai_handler.py", "path": "/app/pr_agent/algo/ai_handlers/litellm_ai_handler.py"}, "function": "chat_completion", "level": {"icon": "âš ï¸", "name": "WARNING", "no": 30}, "line": 401, "message": "Error during LLM inference: litellm.AuthenticationError: AuthenticationError: OpenAIException - team not allowed to access model. This team can only access models=['openai/gpt-5.1', 'openai/gpt-5', 'openai/gpt-5-mini', 'openai/gpt-5-nano']. Tried to access gpt-5.1", "module": "litellm_ai_handler", "name": "pr_agent.algo.ai_handlers.litellm_ai_handler", "process": {"id": 13, "name": "MainProcess"}, "thread": {"id": 131770084559744, "name": "MainThread"}, "time": {"repr": "2025-12-10 02:20:07.937077+00:00", "timestamp": 1765333207.937077}}}
2025-12-10T02:20:07.941453992Z {"text": "Prompts\n", "record": {"elapsed": {"repr": "0:00:43.011784", "seconds": 43.011784}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "f7c570913c05466698e4b2771b7b02c2", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "artifact": {"system": "You are PR-Reviewer, a language model designed to review a Git Pull Request (PR).\nYour task is to provide constructive and concise feedback for the PR.\nThe review should focus on new code added in the PR code diff (lines starting with '+')\n\n\nThe format we will use to present the PR code diff:\n======\n## File: 'src/file1.py'\n\n\n@@ ... @@ def func1():\n__new hunk__\n11  unchanged code line0\n12  unchanged code line1\n13 +new code line2 added\n14  unchanged code line3\n__old hunk__\n unchanged code line0\n unchanged code line1\n-old code line2 removed\n unchanged code line3\n\n@@ ... @@ def func2():\n__new hunk__\n unchanged code line4\n+new code line5 added\n unchanged code line6\n\n## File: 'src/file2.py'\n...\n======\n\n- In the format above, the diff is organized into separate '__new hunk__' and '__old hunk__' sections for each code chunk. '__new hunk__' contains the updated code, while '__old hunk__' shows the removed code. If no code was removed in a specific chunk, the __old hunk__ section will be omitted.\n- We also added line numbers for the '__new hunk__' code, to help you refer to the code lines in your suggestions. These line numbers are not part of the actual code, and should only be used for reference.\n- Code lines are prefixed with symbols ('+', '-', ' '). The '+' symbol indicates new code added in the PR, the '-' symbol indicates code removed in the PR, and the ' ' symbol indicates unchanged code. The review should address new code added in the PR code diff (lines starting with '+').\n- When quoting variables, names or file paths from the code, use backticks (`) instead of single quote (').\n- Note that you only see changed code segments (diff hunks in a PR), not the entire codebase. Avoid suggestions that might duplicate existing functionality or questioning code elements (like variables declarations or import statements) that may be defined elsewhere in the codebase.\n- Also note that if the code ends at an opening brace or statement that begins a new scope (like 'if', 'for', 'try'), don't treat it as incomplete. Instead, acknowledge the visible scope boundary and analyze only the code shown.\n\n\nThe output must be a YAML object equivalent to type $PRReview, according to the following Pydantic definitions:\n=====\n\nclass KeyIssuesComponentLink(BaseModel):\n    relevant_file: str = Field(description=\"The full file path of the relevant file\")\n    issue_header: str = Field(description=\"One or two word title for the issue. For example: 'Possible Bug', etc.\")\n    issue_content: str = Field(description=\"A short and concise summary of what should be further inspected and validated during the PR review process for this issue. Do not mention line numbers in this field.\")\n    start_line: int = Field(description=\"The start line that corresponds to this issue in the relevant file\")\n    end_line: int = Field(description=\"The end line that corresponds to this issue in the relevant file\")\n\nclass Review(BaseModel):\n    estimated_effort_to_review_[1-5]: int = Field(description=\"Estimate, on a scale of 1-5 (inclusive), the time and effort required to review this PR by an experienced and knowledgeable developer. 1 means short and easy review , 5 means long and hard review. Take into account the size, complexity, quality, and the needed changes of the PR code diff.\")\n    relevant_tests: str = Field(description=\"yes/no question: does this PR have relevant tests added or updated ?\")\n    key_issues_to_review: List[KeyIssuesComponentLink] = Field(\"A short and diverse list (0-3 issues) of high-priority bugs, problems or performance concerns introduced in the PR code, which the PR reviewer should further focus on and validate during the review process.\")\n    security_concerns: str = Field(description=\"Does this PR code introduce vulnerabilities such as exposure of sensitive information (e.g., API keys, secrets, passwords), or security concerns like SQL injection, XSS, CSRF, and others ? Answer 'No' (without explaining why) if there are no possible issues. If there are security concerns or issues, start your answer with a short header, such as: 'Sensitive information exposure: ...', 'SQL injection: ...', etc. Explain your answer. Be specific and give examples if possible\")\n\nclass PRReview(BaseModel):\n    review: Review\n=====\n\n\nExample output:\n```yaml\nreview:\n  estimated_effort_to_review_[1-5]: |\n    3\n  relevant_tests: |\n    No\n  key_issues_to_review:\n    - relevant_file: |\n        directory/xxx.py\n      issue_header: |\n        Possible Bug\n      issue_content: |\n        ...\n      start_line: 12\n      end_line: 14\n    - ...\n  security_concerns: |\n    No\n```\n\nAnswer should be a valid YAML, and nothing else. Each YAML output MUST be after a newline, with proper indent, and block scalar indicator ('|')", "user": "\n\n\n--PR Info--\n\nToday's Date: 2025-12-10\n\nTitle: 'Fix: Search UX and multi-filter logic (frontend)'\n\nBranch: 'feature/initial-fixes'\n\nPR Description:\n======\n- Improved search bar UX in app/search/page.tsx:\r\n  - X icon clears input and refocuses\r\n  - Escape key clears input\r\n  - Enter key triggers search\r\n\r\n- Updated filter count logic:\r\n  - Accurately counts all active filters\r\n  - Apply button badge reflects true total\n======\n\n\nThe PR code diff:\n======\n## File: 'app/search/page.tsx'\n\n@@ -1,7 +1,8 @@\n__new hunk__\n1  \"use client\"\n2  \n3 +import { useState, useEffect, useMemo, useRef } from \"react\"\n4 +// import { X } from \"lucide-react\"\n5  import { useSearchParams, useRouter } from \"next/navigation\"\n6  import { useQuery } from \"@tanstack/react-query\"\n7  import { Input } from \"@/components/ui/input\"\n8  import { Button } from \"@/components/ui/button\"\n__old hunk__\n \"use client\"\n \n-import { useState, useEffect, useMemo } from \"react\"\n import { useSearchParams, useRouter } from \"next/navigation\"\n import { useQuery } from \"@tanstack/react-query\"\n import { Input } from \"@/components/ui/input\"\n import { Button } from \"@/components/ui/button\"\n\n@@ -41,11 +42,12 @@\n__new hunk__\n42  export default function SearchPage() {\n43    const searchParams = useSearchParams()\n44    const router = useRouter()\n45    const { filters, setFilters, resetFilters } = useFilters()\n46    const { settings } = useSettings()\n47  \n48    const [searchQuery, setSearchQuery] = useState(searchParams.get(\"q\") || filters.q || \"\")\n49 +  const inputRef = useRef<HTMLInputElement>(null);\n50    const [sortBy, setSortBy] = useState<SortOption>(settings.behavior.defaultSort || \"time\")\n51    const [filtersOpen, setFiltersOpen] = useState(false)\n52  \n53    // Update search query from URL params\n\n@@ -75,29 +77,54 @@ export default function SearchPage() {\n__new hunk__\n77        filters.fiberMin > 0 ||\n78        filters.sugarMax < 100 ||\n79        filters.sodiumMax < 4000 ||\n80        filters.maxTime < 120 ||\n81        !!filters.mealType\n82      )\n83    }, [filters])\n84  \n85 +  // const activeFilterCount = useMemo(() => {\n86 +  //   let count = 0\n87 +  //   if (filters.dietaryRestrictions.length > 0) count++\n88 +  //   if (filters.allergens.length > 0) count++\n89 +  //   if (filters.cuisines.length > 0) count++\n90 +  //   if (filters.majorConditions.length > 0) count++\n91 +  //   if (filters.calories[0] > 0 || filters.calories[1] < 1200) count++\n92 +  //   if (filters.proteinMin > 0) count++\n93 +  //   if (filters.carbsMin > 0) count++\n94 +  //   if (filters.fatMin > 0) count++\n95 +  //   if (filters.fiberMin > 0) count++\n96 +  //   if (filters.sugarMax < 100) count++\n97 +  //   if (filters.sodiumMax < 4000) count++\n98 +  //   if (filters.maxTime < 120) count++\n99 +  //   if (filters.mealType) count++\n100 +  //   return count\n101 +  // }, [filters])\n102    const activeFilterCount = useMemo(() => {\n103 +    let count = 0;\n104 +\n105 +  // Sum all selected array filters\n106 +    count += filters.dietaryRestrictions.length;\n107 +    count += filters.allergens.length;\n108 +    count += filters.cuisines.length;\n109 +    count += filters.majorConditions.length;\n110 +\n111 +    // Range and min/max filters\n112 +    if (filters.calories[0] > 0) count++; // Min calories\n113 +    if (filters.calories[1] < 1200) count++; // Max calories\n114 +    if (filters.proteinMin > 0) count++;\n115 +    if (filters.carbsMin > 0) count++;\n116 +    if (filters.fatMin > 0) count++;\n117 +    if (filters.fiberMin > 0) count++;\n118 +    if (filters.sugarMax < 100) count++;\n119 +    if (filters.sodiumMax < 4000) count++;\n120 +    if (filters.maxTime < 120) count++;\n121 +    \n122 +    // Single-value selection\n123 +    if (filters.mealType) count++;\n124 +\n125 +    return count;\n126 +  }, [filters]);\n127  \n128    const {\n129      data: searchResults = [],\n130      isLoading,\n__old hunk__\n       filters.fiberMin > 0 ||\n       filters.sugarMax < 100 ||\n       filters.sodiumMax < 4000 ||\n       filters.maxTime < 120 ||\n       !!filters.mealType\n     )\n   }, [filters])\n \n   const activeFilterCount = useMemo(() => {\n-    let count = 0\n-    if (filters.dietaryRestrictions.length > 0) count++\n-    if (filters.allergens.length > 0) count++\n-    if (filters.cuisines.length > 0) count++\n-    if (filters.majorConditions.length > 0) count++\n-    if (filters.calories[0] > 0 || filters.calories[1] < 1200) count++\n-    if (filters.proteinMin > 0) count++\n-    if (filters.carbsMin > 0) count++\n-    if (filters.fatMin > 0) count++\n-    if (filters.fiberMin > 0) count++\n-    if (filters.sugarMax < 100) count++\n-    if (filters.sodiumMax < 4000) count++\n-    if (filters.maxTime < 120) count++\n-    if (filters.mealType) count++\n-    return count\n-  }, [filters])\n \n   const {\n     data: searchResults = [],\n     isLoading,\n\n@@ -113,12 +140,22 @@ export default function SearchPage() {\n__new hunk__\n140          const rankedResults = rank(rawResults, settings)\n141          return rankedResults\n142        }\n143  \n144        return rawResults.map((recipe) => ({ ...recipe, score: 0 }))\n145      },\n146      enabled: !!(searchQuery || hasActiveFilters),\n147    })\n148 +  const handleSearchInputKeyDown = (e: React.KeyboardEvent<HTMLInputElement>) => {\n149 +    if (e.key === \"Escape\" && searchQuery) {\n150 +      setSearchQuery(\"\");\n151 +      inputRef.current?.focus();\n152 +    }\n153 +    if (e.key === \"Enter\") {\n154 +      handleSearch(searchQuery);\n155 +    }\n156 +  };\n157 +\n158  \n159    const handleSearch = (query: string) => {\n160      setSearchQuery(query)\n161      setFilters({ ...filters, q: query })\n\n@@ -182,13 +219,13 @@ export default function SearchPage() {\n__new hunk__\n219    return (\n220      <div className=\"container px-4 py-6 max-w-6xl\">\n221        <div className=\"space-y-6\">\n222          {/* Search Header */}\n223          <div className=\"space-y-4\">\n224            <h1 className=\"text-3xl font-bold\">Search Recipes</h1>\n225  \n226            {/* Search Input */}\n227 +          {/* <div className=\"relative\">\n228              <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n229              <Input\n230                role=\"search\"\n231                placeholder=\"Search recipes, ingredients, cuisines...\"\n__old hunk__\n   return (\n     <div className=\"container px-4 py-6 max-w-6xl\">\n       <div className=\"space-y-6\">\n         {/* Search Header */}\n         <div className=\"space-y-4\">\n           <h1 className=\"text-3xl font-bold\">Search Recipes</h1>\n \n           {/* Search Input */}\n-          <div className=\"relative\">\n             <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n             <Input\n               role=\"search\"\n               placeholder=\"Search recipes, ingredients, cuisines...\"\n\n@@ -192,14 +229,51 @@ export default function SearchPage() {\n__new hunk__\n229              <Input\n230                role=\"search\"\n231                placeholder=\"Search recipes, ingredients, cuisines...\"\n232                value={searchQuery}\n233                onChange={(e) => setSearchQuery(e.target.value)}\n234                onKeyDown={(e) => e.key === \"Enter\" && handleSearch(searchQuery)}\n235                className=\"pl-10 pr-4 h-12 text-lg\"\n236              />\n237 +          </div> */}\n238 +          <div style={{ position: \"relative\", display: \"inline-block\", width: \"100%\" }}>\n239 +            <Search style={{ position: \"absolute\", left: \"0.75rem\", top: \"50%\", transform: \"translateY(-50%)\", height: \"1rem\", width: \"1rem\", color: \"gray\" }} />\n240 +            <Input\n241 +              role=\"search\"\n242 +              ref={inputRef}\n243 +              placeholder=\"Search recipes, ingredients, cuisines...\"\n244 +              value={searchQuery}\n245 +              onChange={(e) => setSearchQuery(e.target.value)}\n246 +              onKeyDown={handleSearchInputKeyDown}\n247 +              style={{ paddingRight: searchQuery ? \"2rem\" : undefined, width: \"100%\" }}\n248 +              className=\"pl-10 pr-4 h-12 text-lg\"\n249 +            />\n250 +            {searchQuery && (\n251 +              <button\n252 +                type=\"button\"\n253 +                style={{\n254 +                  position: \"absolute\",\n255 +                  right: \"0.75rem\",\n256 +                  top: \"50%\",\n257 +                  transform: \"translateY(-50%)\",\n258 +                  background: \"none\",\n259 +                  border: \"none\",\n260 +                  cursor: \"pointer\",\n261 +                  padding: 0,\n262 +                  color: \"gray\",\n263 +                }}\n264 +                aria-label=\"Clear search\"\n265 +                onClick={() => {\n266 +                  setSearchQuery(\"\");\n267 +                  inputRef.current?.focus();\n268 +              }}\n269 +              >\n270 +                <X size={20} />\n271 +            </button>\n272 +          )}\n273            </div>\n274  \n275 +\n276            {/* Search Actions */}\n277            <div className=\"flex items-center gap-2\">\n278              <Button onClick={() => handleSearch(searchQuery)} size=\"sm\">\n279                Search\n\n\n## File: 'components/filter-panel.tsx'\n\n@@ -54,35 +54,58 @@\n__new hunk__\n54  export function FilterPanel({ open, onOpenChange, initialValues, onApply, onReset }: FilterPanelProps) {\n55    const form = useForm<FiltersFormInput>({\n56      resolver: zodResolver(schema),\n57      // provide full defaults (OUTPUT fits into INPUT just fine)\n58      defaultValues: schema.parse(initialValues ?? {}),\n59      mode: \"onChange\",\n60    })\n61  \n62     useEffect(() => {\n63      form.reset(schema.parse(initialValues ?? {}));\n64    }, [open, initialValues, form]);\n65  \n66 +  // function getActiveFiltersCount(): number {\n67 +  //   const values = form.getValues()\n68 +  //   let count = 0\n69 +  //   if ((values.dietaryRestrictions || []).length > 0) count++\n70 +  //   if ((values.allergens || []).length > 0) count++\n71 +  //   if ((values.cuisines || []).length > 0) count++\n72 +  //   if ((values.majorConditions || []).length > 0) count++\n73 +  //   if (values.calories && (values.calories[0] > 0 || values.calories[1] < 1200)) count++\n74 +  //   if ((values.proteinMin || 0) > 0) count++\n75 +  //   if ((values.carbsMin || 0) > 0) count++\n76 +  //   if ((values.fatMin || 0) > 0) count++\n77 +  //   if ((values.fiberMin || 0) > 0) count++\n78 +  //   if ((values.sugarMax || 100) < 100) count++\n79 +  //   if ((values.sodiumMax || 4000) < 4000) count++\n80 +  //   2025-12-10T02:20:07.941453992Z if ((values.maxTime || 120) < 120) count++\n81 +  //   if ((values.mealType || \"\") !== \"\") count++\n82 +  //   return count\n83 +  // }\n84    function getActiveFiltersCount(): number {\n85 +    const values = form.getValues();\n86 +    let count = 0;\n87 +\n88 +    // Count all selected array filters individually\n89 +    count += values.dietaryRestrictions.length;\n90 +    count += values.allergens.length;\n91 +    count += values.cuisines.length;\n92 +    count += values.majorConditions.length;\n93 +\n94 +    // Numeric and single-value filters\n95 +    if (values.calories[0] > 0) count++;           // Min calories\n96 +    if (values.calories[1] < 1200) count++;        // Max calories\n97 +    if (values.proteinMin > 0) count++;\n98 +    if (values.carbsMin > 0) count++;\n99 +    if (values.fatMin > 0) count++;\n100 +    if (values.fiberMin > 0) count++;\n101 +    if (values.sugarMax < 100) count++;\n102 +    if (values.sodiumMax < 4000) count++;\n103 +    if (values.maxTime < 120) count++;\n104 +    if (values.mealType) count++;\n105 +\n106 +    return count;\n107    }\n108    function handleApply() {\n109      const values = schema.parse(form.getValues())\n110      onApply(values)\n111      onOpenChange(false)\n__old hunk__\n export function FilterPanel({ open, onOpenChange, initialValues, onApply, onReset }: FilterPanelProps) {\n   const form = useForm<FiltersFormInput>({\n     resolver: zodResolver(schema),\n     // provide full defaults (OUTPUT fits into INPUT just fine)\n     defaultValues: schema.parse(initialValues ?? {}),\n     mode: \"onChange\",\n   })\n \n    useEffect(() => {\n     form.reset(schema.parse(initialValues ?? {}));\n   }, [open, initialValues, form]);\n \n   function getActiveFiltersCount(): number {\n-    const values = form.getValues()\n-    let count = 0\n-    if ((values.dietaryRestrictions || []).length > 0) count++\n-    if ((values.allergens || []).length > 0) count++\n-    if ((values.cuisines || []).length > 0) count++\n-    if ((values.majorConditions || []).length > 0) count++\n-    if (values.calories && (values.calories[0] > 0 || values.calories[1] < 1200)) count++\n-    if ((values.proteinMin || 0) > 0) count++\n-    if ((values.carbsMin || 0) > 0) count++\n-    if ((values.fatMin || 0) > 0) count++\n-    if ((values.fiberMin || 0) > 0) count++\n-    if ((values.sugarMax || 100) < 100) count++\n-    if ((values.sodiumMax || 4000) < 4000) count++\n-    if ((values.maxTime || 120) < 120) count++\n-    if ((values.mealType || \"\") !== \"\") count++\n-    return count\n   }\n-\n   function handleApply() {\n     const values = schema.parse(form.getValues())\n     onApply(values)\n     onOpenChange(false)\n======\n\n\nResponse (should be a valid YAML, and nothing else):\n```yaml"}}, "file": {"name": "litellm_ai_handler.py", "path": "/app/pr_agent/algo/ai_handlers/litellm_ai_handler.py"}, "function": "chat_completion", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 388, "message": "Prompts", "module": "litellm_ai_handler", "name": "pr_agent.algo.ai_handlers.litellm_ai_handler", "process": {"id": 13, "name": "MainProcess"}, "thread": {"id": 131770084559744, "name": "MainThread"}, "time": {"repr": "2025-12-10 02:20:07.939839+00:00", "timestamp": 1765333207.939839}}}
2025-12-10T02:20:07.996983272Z 
2025-12-10T02:20:07.997033377Z Give Feedback / Get Help: https://github.com/BerriAI/litellm/issues/new
2025-12-10T02:20:07.997037374Z LiteLLM.Info: If you need to debug this error, use `litellm._turn_on_debug()'.
2025-12-10T02:20:07.997039967Z 
2025-12-10T02:20:07.997042602Z {"text": "Error during LLM inference: litellm.AuthenticationError: AuthenticationError: OpenAIException - team not allowed to access model. This team can only access models=['openai/gpt-5.1', 'openai/gpt-5', 'openai/gpt-5-mini', 'openai/gpt-5-nano']. Tried to access gpt-5.1\n", "record": {"elapsed": {"repr": "0:00:43.067220", "seconds": 43.06722}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "f7c570913c05466698e4b2771b7b02c2", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "litellm_ai_handler.py", "path": "/app/pr_agent/algo/ai_handlers/litellm_ai_handler.py"}, "function": "chat_completion", "level": {"icon": "âš ï¸", "name": "WARNING", "no": 30}, "line": 401, "message": "Error during LLM inference: litellm.AuthenticationError: AuthenticationError: OpenAIException - team not allowed to access model. This team can only access models=['openai/gpt-5.1', 'openai/gpt-5', 'openai/gpt-5-mini', 'openai/gpt-5-nano']. Tried to access gpt-5.1", "module": "litellm_ai_handler", "name": "pr_agent.algo.ai_handlers.litellm_ai_handler", "process": {"id": 13, "name": "MainProcess"}, "thread": {"id": 131770084559744, "name": "MainThread"}, "time": {"repr": "2025-12-10 02:20:07.995275+00:00", "timestamp": 1765333207.995275}}}
2025-12-10T02:20:07.997072777Z {"text": "Failed to generate prediction with openai/gpt-5.1\n", "record": {"elapsed": {"repr": "0:00:43.067547", "seconds": 43.067547}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "f7c570913c05466698e4b2771b7b02c2", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "artifact": {"error": "RetryError[<Future at 0x77d81239da90 state=finished raised AuthenticationError>]"}}, "file": {"name": "pr_processing.py", "path": "/app/pr_agent/algo/pr_processing.py"}, "function": "retry_with_fallback_models", "level": {"icon": "âš ï¸", "name": "WARNING", "no": 30}, "line": 333, "message": "Failed to generate prediction with openai/gpt-5.1", "module": "pr_processing", "name": "pr_agent.algo.pr_processing", "process": {"id": 13, "name": "MainProcess"}, "thread": {"id": 131770084559744, "name": "MainThread"}, "time": {"repr": "2025-12-10 02:20:07.995602+00:00", "timestamp": 1765333207.995602}}}
2025-12-10T02:20:07.997080098Z {"text": "Generating prediction with \\openai/gpt-5\\\n", "record": {"elapsed": {"repr": "0:00:43.067638", "seconds": 43.067638}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "f7c570913c05466698e4b2771b7b02c2", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "pr_processing.py", "path": "/app/pr_agent/algo/pr_processing.py"}, "function": "retry_with_fallback_models", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 326, "message": "Generating prediction with \\openai/gpt-5\\", "module": "pr_processing", "name": "pr_agent.algo.pr_processing", "process": {"id": 13, "name": "MainProcess"}, "thread": {"id": 131770084559744, "name": "MainThread"}, "time": {"repr": "2025-12-10 02:20:07.995693+00:00", "timestamp": 1765333207.995693}}}
2025-12-10T02:20:08.153366880Z {"text": "PR main language: TypeScript\n", "record": {"elapsed": {"repr": "0:00:43.224884", "seconds": 43.224884}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "f7c570913c05466698e4b2771b7b02c2", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "pr_processing.py", "path": "/app/pr_agent/algo/pr_processing.py"}, "function": "get_pr_diff", "level": {"icon": "â„¹ï¸", "name": "INFO", "no": 20}, "line": 63, "message": "PR main language: TypeScript", "module": "pr_processing", "name": "pr_agent.algo.pr_processing", "process": {"id": 13, "name": "MainProcess"}, "thread": {"id": 131770084559744, "name": "MainThread"}, "time": {"repr": "2025-12-10 02:20:08.152939+00:00", "timestamp": 1765333208.152939}}}
2025-12-10T02:20:08.162356011Z {"text": "Tokens: 4738, total tokens under limit: 32000, returning full diff.\n", "record": {"elapsed": {"repr": "0:00:43.233698", "seconds": 43.233698}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "f7c570913c05466698e4b2771b7b02c2", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "pr_processing.py", "path": "/app/pr_agent/algo/pr_processing.py"}, "function": "get_pr_diff", "level": {"icon": "â„¹ï¸", "name": "INFO", "no": 20}, "line": 74, "message": "Tokens: 4738, total tokens under limit: 32000, returning full diff.", "module": "pr_processing", "name": "pr_agent.algo.pr_processing", "process": {"id": 13, "name": "MainProcess"}, "thread": {"id": 131770084559744, "name": "MainThread"}, "time": {"repr": "2025-12-10 02:20:08.161753+00:00", "timestamp": 1765333208.161753}}}
2025-12-10T02:20:08.162429612Z {"text": "PR diff\n", "record": {"elapsed": {"repr": "0:00:43.233978", "seconds": 43.233978}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "f7c570913c05466698e4b2771b7b02c2", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "diff": "\n\n## File: 'app/search/page.tsx'\n\n@@ -1,7 +1,8 @@\n__new hunk__\n1  \"use client\"\n2  \n3 +import { useState, useEffect, useMemo, useRef } from \"react\"\n4 +// import { X } from \"lucide-react\"\n5  import { useSearchParams, useRouter } from \"next/navigation\"\n6  import { useQuery } from \"@tanstack/react-query\"\n7  import { Input } from \"@/components/ui/input\"\n8  import { Button } from \"@/components/ui/button\"\n__old hunk__\n \"use client\"\n \n-import { useState, useEffect, useMemo } from \"react\"\n import { useSearchParams, useRouter } from \"next/navigation\"\n import { useQuery } from \"@tanstack/react-query\"\n import { Input } from \"@/components/ui/input\"\n import { Button } from \"@/components/ui/button\"\n\n@@ -41,11 +42,12 @@\n__new hunk__\n42  export default function SearchPage() {\n43    const searchParams = useSearchParams()\n44    const router = useRouter()\n45    const { filters, setFilters, resetFilters } = useFilters()\n46    const { settings } = useSettings()\n47  \n48    const [searchQuery, setSearchQuery] = useState(searchParams.get(\"q\") || filters.q || \"\")\n49 +  const inputRef = useRef<HTMLInputElement>(null);\n50    const [sortBy, setSortBy] = useState<SortOption>(settings.behavior.defaultSort || \"time\")\n51    const [filtersOpen, setFiltersOpen] = useState(false)\n52  \n53    // Update search query from URL params\n\n@@ -75,29 +77,54 @@ export default function SearchPage() {\n__new hunk__\n77        filters.fiberMin > 0 ||\n78        filters.sugarMax < 100 ||\n79        filters.sodiumMax < 4000 ||\n80        filters.maxTime < 120 ||\n81        !!filters.mealType\n82      )\n83    }, [filters])\n84  \n85 +  // const activeFilterCount = useMemo(() => {\n86 +  //   let count = 0\n87 +  //   if (filters.dietaryRestrictions.length > 0) count++\n88 +  //   if (filters.allergens.length > 0) count++\n89 +  //   if (filters.cuisines.length > 0) count++\n90 +  //   if (filters.majorConditions.length > 0) count++\n91 +  //   if (filters.calories[0] > 0 || filters.calories[1] < 1200) count++\n92 +  //   if (filters.proteinMin > 0) count++\n93 +  //   if (filters.carbsMin > 0) count++\n94 +  //   if (filters.fatMin > 0) count++\n95 +  //   if (filters.fiberMin > 0) count++\n96 +  //   if (filters.sugarMax < 100) count++\n97 +  //   if (filters.sodiumMax < 4000) count++\n98 +  //   if (filters.maxTime < 120) count++\n99 +  //   if (filters.mealType) count++\n100 +  //   return count\n101 +  // }, [filters])\n102    const activeFilterCount = useMemo(() => {\n103 +    let count = 0;\n104 +\n105 +  // Sum all selected array filters\n106 +    count += filters.dietaryRestrictions.length;\n107 +    count += filters.allergens.length;\n108 +    count += filters.cuisines.length;\n109 +    count += filters.majorConditions.length;\n110 +\n111 +    // Range and min/max filters\n112 +    if (filters.calories[0] > 0) count++; // Min calories\n113 +    if (filters.calories[1] < 1200) count++; // Max calories\n114 +    if (filters.proteinMin > 0) count++;\n115 +    if (filters.carbsMin > 0) count++;\n116 +    if (filters.fatMin > 0) count++;\n117 +    if (filters.fiberMin > 0) count++;\n118 +    if (filters.sugarMax < 100) count++;\n119 +    if (filters.sodiumMax < 4000) count++;\n120 +    if (filters.maxTime < 120) count++;\n121 +    \n122 +    // Single-value selection\n123 +    if (filters.mealType) count++;\n124 +\n125 +    return count;\n126 +  }, [filters]);\n127  \n128    const {\n129      data: searchResults = [],\n130      isLoading,\n__old hunk__\n       filters.fiberMin > 0 ||\n       filters.sugarMax < 100 ||\n       filters.sodiumMax < 4000 ||\n       filters.maxTime < 120 ||\n       !!filters.mealType\n     )\n   }, [filters])\n \n   const activeFilterCount = useMemo(() => {\n-    let count = 0\n-    if (filters.dietaryRestrictions.length > 0) count++\n-    if (filters.allergens.length > 0) count++\n-    if (filters.cuisines.length > 0) count++\n-    if (filters.majorConditions.length > 0) count++\n-    if (filters.calories[0] > 0 || filters.calories[1] < 1200) count++\n-    if (filters.proteinMin > 0) count++\n-    if (filters.carbsMin > 0) count++\n-    if (filters.fatMin > 0) count++\n-    if (filters.fiberMin > 0) count++\n-    if (filters.sugarMax < 100) count++\n-    if (filters.sodiumMax < 4000) count++\n-    if (filters.maxTime < 120) count++\n-    if (filters.mealType) count++\n-    return count\n-  }, [filters])\n \n   const {\n     data: searchResults = [],\n     isLoading,\n\n@@ -113,12 +140,22 @@ export default function SearchPage() {\n__new hunk__\n140          const rankedResults = rank(rawResults, settings)\n141          return rankedResults\n142        }\n143  \n144        return rawResults.map((recipe) => ({ ...recipe, score: 0 }))\n145      },\n146      enabled: !!(searchQuery || hasActiveFilters),\n147    })\n148 +  const handleSearchInputKeyDown = (e: React.KeyboardEvent<HTMLInputElement>) => {\n149 +    if (e.key === \"Escape\" && searchQuery) {\n150 +      setSearchQuery(\"\");\n151 +      inputRef.current?.focus();\n152 +    }\n153 +    if (e.key === \"Enter\") {\n154 +      handleSearch(searchQuery);\n155 +    }\n156 +  };\n157 +\n158  \n159    const handleSearch = (query: string) => {\n160      setSearchQuery(query)\n161      setFilters({ ...filters, q: query })\n\n@@ -182,13 +219,13 @@ export default function SearchPage() {\n__new hunk__\n219    return (\n220      <div className=\"container px-4 py-6 max-w-6xl\">\n221        <div className=\"space-y-6\">\n222          {/* Search Header */}\n223          <div className=\"space-y-4\">\n224            <h1 className=\"text-3xl font-bold\">Search Recipes</h1>\n225  \n226            {/* Search Input */}\n227 +          {/* <div className=\"relative\">\n228              <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n229              <Input\n230                role=\"search\"\n231                placeholder=\"Search recipes, ingredients, cuisines...\"\n__old hunk__\n   return (\n     <div className=\"container px-4 py-6 max-w-6xl\">\n       <div className=\"space-y-6\">\n         {/* Search Header */}\n         <div className=\"space-y-4\">\n           <h1 className=\"text-3xl font-bold\">Search Recipes</h1>\n \n           {/* Search Input */}\n-          <div className=\"relative\">\n             <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n             <Input\n               role=\"search\"\n               placeholder=\"Search recipes, ingredients, cuisines...\"\n\n@@ -192,14 +229,51 @@ export default function SearchPage() {\n__new hunk__\n229              <Input\n230                role=\"search\"\n231                placeholder=\"Search recipes, ingredients, cuisines...\"\n232                value={searchQuery}\n233                onChange={(e) => setSearchQuery(e.target.value)}\n234                onKeyDown={(e) => e.key === \"Enter\" && handleSearch(searchQuery)}\n235                className=\"pl-10 pr-4 h-12 text-lg\"\n236              />\n237 +          </div> */}\n238 +          <div style={{ position: \"relative\", display: \"inline-block\", width: \"100%\" }}>\n239 +            <Search style={{ position: \"absolute\", left: \"0.75rem\", top: \"50%\", transform: \"translateY(-50%)\", height: \"1rem\", width: \"1rem\", color: \"gray\" }} />\n240 +            <Input\n241 +              role=\"search\"\n242 +              ref={inputRef}\n243 +              placeholder=\"Search recipes, ingredients, cuisines...\"\n244 +              value={searchQuery}\n245 +              onChange={(e) => setSearchQuery(e.target.value)}\n246 +              onKeyDown={handleSearchInputKeyDown}\n247 +              style={{ paddingRight: searchQuery ? \"2rem\" : undefined, width: \"100%\" }}\n248 +              className=\"pl-10 pr-4 h-12 text-lg\"\n249 +            />\n250 +            {searchQuery && (\n251 +              <button\n252 +                type=\"button\"\n253 +                style={{\n254 +                  position: \"absolute\",\n255 +                  right: \"0.75rem\",\n256 +                  top: \"50%\",\n257 +                  transform: \"translateY(-50%)\",\n258 +                  background: \"none\",\n259 +                  border: \"none\",\n260 +                  cursor: \"pointer\",\n261 +                  padding: 0,\n262 +                  color: \"gray\",\n263 +                }}\n264 +                aria-label=\"Clear search\"\n265 +                onClick={() => {\n266 +                  setSearchQuery(\"\");\n267 +                  inputRef.current?.focus();\n268 +              }}\n269 +              >\n270 +                <X size={20} />\n271 +            </button>\n272 +          )}\n273            </div>\n274  \n275 +\n276            {/* Search Actions */}\n277            <div className=\"flex items-center gap-2\">\n278              <Button onClick={() => handleSearch(searchQuery)} size=\"sm\">\n279                Search\n\n\n## File: 'components/filter-panel.tsx'\n\n@@ -54,35 +54,58 @@\n__new hunk__\n54  export function FilterPanel({ open, onOpenChange, initialValues, onApply, onReset }: FilterPanelProps) {\n55    const form = useForm<FiltersFormInput>({\n56      resolver: zodResolver(schema),\n57      // provide full defaults (OUTPUT fits into INPUT just fine)\n58      defaultValues: schema.parse(initialValues ?? {}),\n59      mode: \"onChange\",\n60    })\n61  \n62     useEffect(() => {\n63      form.reset(schema.parse(initialValues ?? {}));\n64    }, [open, initialValues, form]);\n65  \n66 +  // function getActiveFiltersCount(): number {\n67 +  //   const values = form.getValues()\n68 +  //   let count = 0\n69 +  //   if ((values.dietaryRestrictions || []).length > 0) count++\n70 +  //   if ((values.allergens || []).length > 0) count++\n71 +  //   if ((values.cuisines || []).length > 0) count++\n72 +  //   if ((values.majorConditions || []).length > 0) count++\n73 +  //   if (values.calories && (values.calories[0] > 0 || values.calories[1] < 1200)) count++\n74 +  //   if ((values.proteinMin || 0) > 0) count++\n75 +  //   if ((values.carbsMin || 0) > 0) count++\n76 +  //   if ((values.fatMin || 0) > 0) count++\n77 +  //   if ((values.fiberMin || 0) > 0) count++\n78 +  //   if ((values.sugarMax || 100) < 100) count++\n79 +  //   if ((values.sodiumMax || 4000) < 4000) count++\n80 +  //   if ((values.maxTime || 120) < 120) count++\n81 +  //   if ((values.mealType || \"\") !== \"\") count++\n82 +  //   return count\n83 +  // }\n84    function getActiveFiltersCount(): number {\n85 +    const values = form.getValues();\n86 +    let count = 0;\n87 +\n88 +    // Count all selected array filters individually\n89 +    count += values.dietaryRestrictions.length;\n90 +    count += values.allergens.length;\n91 +    count += values.cuisines.length;\n92 +    count += values.majorConditions.length;\n93 +\n94 +    // Numeric and single-value filters\n95 +    if (values.calories[0] > 0) count++;           // Min calories\n96 +    if (values.calories[1] < 1200) count++;        // Max calories\n97 +    if (values.proteinMin > 0) count++;\n98 +    if (values.carbsMin > 0) count++;\n99 +    if (values.fatMin > 0) count++;\n100 +    if (values.fiberMin > 0) count++;\n101 +    if (values.sugarMax < 100) count++;\n102 +    if (values.sodiumMax < 4000) count++;\n103 +    if (values.maxTime < 120) count++;\n104 +    if (values.mealType) count++;\n105 +\n106 +    return count;\n107    }\n108    function handleApply() {\n109      const values = schema.parse(form.getValues())\n110      onApply(values)\n111      onOpenChange(false)\n__old hunk__\n export function FilterPanel({ open, onOpenChange, initialValues, onApply, onReset }: FilterPanelProps) {\n   const form = useForm<FiltersFormInput>({\n     resolver: zodResolver(schema),\n     // provide full defaults (OUTPUT fits into INPUT just fine)\n     defaultValues: schema.parse(initialValues ?? {}),\n     mode: \"onChange\",\n   })\n \n    useEffect(() => {\n     form.reset(schema.parse(initialValues ?? {}));\n   }, [open, initialValues, form]);\n \n   function getActiveFiltersCount(): number {\n-    const values = form.getValues()\n-    let count = 0\n-    if ((values.dietaryRestrictions || []).length > 0) count++\n-    if ((values.allergens || []).length > 0) count++\n-    if ((values.cuisines || []).length > 0) count++\n-    if ((values.majorConditions || []).length > 0) count++\n-    if (values.calories && (values.calories[0] > 0 || values.calories[1] < 1200)) count++\n-    if ((values.proteinMin || 0) > 0) count++\n-    if ((values.carbsMin || 0) > 0) count++\n-    if ((values.fatMin || 0) > 0) count++\n-    if ((values.fiberMin || 0) > 0) count++\n-    if ((values.sugarMax || 100) < 100) count++\n-    if ((values.sodiumMax || 4000) < 4000) count++\n-    if ((values.maxTime || 120) < 120) count++\n-    if ((values.mealType || \"\") !== \"\") count++\n-    return count\n   }\n-\n   function handleApply() {\n     const values = schema.parse(form.getValues())\n     onApply(values)\n     onOpenChange(false)"}, "file": {"name": "pr_reviewer.py", "path": "/app/pr_agent/tools/pr_reviewer.py"}, "function": "_prepare_prediction", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 197, "message": "PR diff", "module": "pr_reviewer", "name": "pr_agent.tools.pr_reviewer", "process": {"id": 13, "name": "MainProcess"}, "thread": {"id": 131770084559744, "name": "MainThread"}, "time": {"repr": "2025-12-10 02:20:08.162033+00:00", "timestamp": 1765333208.162033}}}
2025-12-10T02:20:08.176486222Z {"text": "Prompts\n", "record": {"elapsed": {"repr": "0:00:43.247830", "seconds": 43.24783}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "f7c570913c05466698e4b2771b7b02c2", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "artifact": {"system": "You are PR-Reviewer, a language model designed to review a Git Pull Request (PR).\nYour task is to provide constructive and concise feedback for the PR.\nThe review should focus on new code added in the PR code diff (lines starting with '+')\n\n\nThe format we will use to present the PR code diff:\n======\n## File: 'src/file1.py'\n\n\n@@ ... @@ def func1():\n__new hunk__\n11  unchanged code line0\n12  unchanged code line1\n13 +new code line2 added\n14  unchanged code line3\n__old hunk__\n unchanged code line0\n unchanged code line1\n-old code line2 removed\n unchanged code line3\n\n@@ ... @@ def func2():\n__new hunk__\n unchanged code line4\n+new code line5 added\n unchanged code line6\n\n## File: 'src/file2.py'\n...\n======\n\n- In the format above, the diff is organized into separate '__new hunk__' and '__old hunk__' sections for each code chunk. '__new hunk__' contains the updated code, while '__old hunk__' shows the removed code. If no code was removed in a specific chunk, the __old hunk__ section will be omitted.\n- We also added line numbers for the '__new hunk__' code, to help you refer to the code lines in your suggestions. These line numbers are not part of the actual code, and should only be used for reference.\n- Code lines are prefixed with symbols ('+', '-', ' '). The '+' symbol indicates new code added in the PR, the '-' symbol indicates code removed in the PR, and the ' ' symbol indicates unchanged code. The review should address new code added in the PR code diff (lines starting with '+').\n- When quoting variables, names or file paths from the code, use backticks (`) instead of single quote (').\n- Note that you only see changed code segments (diff hunks in a PR), not the entire codebase. Avoid suggestions that might duplicate existing functionality or questioning code elements (like variables declarations or import statements) that may be defined elsewhere in the codebase.\n- Also note that if the code ends at an opening brace or statement that begins a new scope (like 'if', 'for', 'try'), don't treat it as incomplete. Instead, acknowledge the visible scope boundary and analyze only the code shown.\n\n\nThe output must be a YAML object equivalent to type $PRReview, according to the following Pydantic definitions:\n=====\n\nclass KeyIssuesComponentLink(BaseModel):\n    relevant_file: str = Field(description=\"The full file path of the relevant file\")\n    issue_header: str = Field(description=\"One or two word title for the issue. For example: 'Possible Bug', etc.\")\n    issue_content: str = Field(description=\"A short and concise summary of what should be further inspected and validated during the PR review process for this issue. Do not mention line numbers in this field.\")\n    start_line: int = Field(description=\"The start line that corresponds to this issue in the relevant file\")\n    end_line: int = Field(description=\"The end line that corresponds to this issue in the relevant file\")\n\nclass Review(BaseModel):\n    estimated_effort_to_review_[1-5]: int = Field(description=\"Estimate, on a scale of 1-5 (inclusive), the time and effort required to review this PR by an experienced and knowledgeable developer. 1 means short and easy review , 5 means long and hard review. Take into account the size, complexity, quality, and the needed changes of the PR code diff.\")\n    relevant_tests: str = Field(description=\"yes/no question: does this PR have relevant tests added or updated ?\")\n    key_issues_to_review: List[KeyIssuesComponentLink] = Field(\"A short and diverse list (0-3 issues) of high-priority bugs, problems or performance concerns introduced in the PR code, which the PR reviewer should further focus on and validate during the review process.\")\n    security_concerns: str = Field(description=\"Does this PR code introduce vulnerabilities such as exposure of sensitive information (e.g., API keys, secrets, passwords), or security concerns like SQL injection, XSS, CSRF, and others ? Answer 'No' (without explaining why) if there are no possible issues. If there are security concerns or issues, start your answer with a short header, such as: 'Sensitive information exposure: ...', 'SQL injection: ...', etc. Explain your answer. Be specific and give examples if possible\")\n\nclass PRReview(BaseModel):\n    review: Review\n=====\n\n\nExample output:\n```yaml\nreview:\n  estimated_effort_to_review_[1-5]: |\n    3\n  relevant_tests: |\n    No\n  key_issues_to_review:\n    - relevant_file: |\n        directory/xxx.py\n      issue_header: |\n        Possible Bug\n      issue_content: |\n        ...\n      start_line: 12\n      end_line: 14\n    - ...\n  security_concerns: |\n    No\n```\n\nAnswer should be a valid YAML, and nothing else. Each YAML output MUST be after a newline, with proper indent, and block scalar indicator ('|')", "user": "\n\n\n--PR Info--\n\nToday's Date: 2025-12-10\n\nTitle: 'Fix: Search UX and multi-filter logic (frontend)'\n\nBranch: 'feature/initial-fixes'\n\nPR Description:\n======\n- Improved search bar UX in app/search/page.tsx:\r\n  - X icon clears input and refocuses\r\n  - Escape key clears input\r\n  - Enter key triggers search\r\n\r\n- Updated filter count logic:\r\n  - Accurately counts all active filters\r\n  - Apply button badge reflects true total\n======\n\n\nThe PR code diff:\n======\n## File: 'app/search/page.tsx'\n\n@@ -1,7 +1,8 @@\n__new hunk__\n1  \"use client\"\n2  \n3 +import { useState, useEffect, useMemo, useRef } from \"react\"\n4 +// import { X } from \"lucide-react\"\n5  import { useSearchParams, useRouter } from \"next/navigation\"\n6  import { useQuery } from \"@tanstack/react-query\"\n7  import { Input } from \"@/components/ui/input\"\n8  import { Button } from \"@/components/ui/button\"\n__old hunk__\n \"use client\"\n \n-import { useState, useEffect, useMemo } from \"react\"\n import { useSearchParams, useRouter } from \"next/navigation\"\n import { useQuery } from \"@tanstack/react-query\"\n import { Input } from \"@/components/ui/input\"\n import { Button } from \"@/components/ui/button\"\n\n@@ -41,11 +42,12 @@\n__new hunk__\n42  export default function SearchPage() {\n43    const searchParams = useSearchParams()\n44    const router = useRouter()\n45    const { filters, setFilters, resetFilters } = useFilters()\n46    const { settings } = useSettings()\n47  \n48    const [searchQuery, setSearchQuery] = useState(searchParams.get(\"q\") || filters.q || \"\")\n49 +  const inputRef = useRef<HTMLInputElement>(null);\n50    const [sortBy, setSortBy] = useState<SortOption>(settings.behavior.defaultSort || \"time\")\n51    const [filtersOpen, setFiltersOpen] = useState(false)\n52  \n53    // Update search query from URL params\n\n@@ -75,29 +77,54 @@ export default function SearchPage() {\n__new hunk__\n77        filters.fiberMin > 0 ||\n78        filters.sugarMax < 100 ||\n79        filters.sodiumMax < 4000 ||\n80        filters.maxTime < 120 ||\n81        !!filters.mealType\n82      )\n83    }, [filters])\n84  \n85 +  // const activeFilterCount = useMemo(() => {\n86 +  //   let count = 0\n87 +  //   if (filters.dietaryRestrictions.length > 0) count++\n88 +  //   if (filters.allergens.length > 0) count++\n89 +  //   if (filters.cuisines.length > 0) count++\n90 +  //   if (filters.majorConditions.length > 0) count++\n91 +  //   if (filters.calories[0] > 0 || filters.calories[1] < 1200) count++\n92 +  //   if (filters.proteinMin > 0) count++\n93 +  //   if (filters.carbsMin > 0) count++\n94 +  //   if (filters.fatMin > 0) count++\n95 +  //   if (filters.fiberMin > 0) count++\n96 +  //   if (filters.sugarMax < 100) count++\n97 +  //   if (filters.sodiumMax < 4000) count++\n98 +  //   if (filters.maxTime < 120) count++\n99 +  //   if (filters.mealType) count++\n100 +  //   return count\n101 +  // }, [filters])\n102    const activeFilterCount = useMemo(() => {\n103 +    let count = 0;\n104 +\n105 +  // Sum all selected array filters\n106 +    count += filters.dietaryRestrictions.length;\n107 +    count += filters.allergens.length;\n108 +    count += filters.cuisines.length;\n109 +    count += filters.majorConditions.length;\n110 +\n111 +    // Range and min/max filters\n112 +    if (filters.calories[0] > 0) count++; // Min calories\n113 +    if (filters.calories[1] < 1200) count++; // Max calories\n114 +    if (filters.proteinMin > 0) count++;\n115 +    if (filters.carbsMin > 0) count++;\n116 +    if (filters.fatMin > 0) count++;\n117 +    if (filters.fiberMin > 0) count++;\n118 +    if (filters.sugarMax < 100) count++;\n119 +    if (filters.sodiumMax < 4000) count++;\n120 +    if (filters.maxTime < 120) count++;\n121 +    \n122 +    // Single-value selection\n123 +    if (filters.mealType) count++;\n124 +\n125 +    return count;\n126 +  }, [filters]);\n127  \n128    const {\n129      data: searchResults = [],\n130      isLoading,\n__old hunk__\n       filters.fiberMin > 0 ||\n       filters.sugarMax < 100 ||\n       filters.sodiumMax < 4000 ||\n       filters.maxTime < 120 ||\n       !!filters.mealType\n     )\n   }, [filters])\n \n   const activeFilterCount = useMemo(() => {\n-    let count = 0\n-    if (filters.dietaryRestrictions.length > 0) count++\n-    if (filters.allergens.length > 0) count++\n-    if (filters.cuisines.length > 0) count++\n-    if (filters.majorConditions.length > 0) count++\n-    if (filters.calories[0] > 0 || filters.calories[1] < 1200) count++\n-    if (filters.proteinMin > 0) count++\n-    if (filters.carbsMin > 0) count++\n-    if (filters.fatMin > 0) count++\n-    if (filters.fiberMin > 0) count++\n-    if (filters.sugarMax < 100) count++\n-    if (filters.sodiumMax < 4000) count++\n-    if (filters.maxTime < 120) count++\n-    if (filters.mealType) count++\n-    return count\n-  }, [filters])\n \n   const {\n     data: searchResults = [],\n     isLoading,\n\n@@ -113,12 +140,22 @@ export default function SearchPage() {\n__new hunk__\n140          const rankedResults = rank(rawResults, settings)\n141          return rankedResults\n142        }\n143  \n144        return rawResults.map((recipe) => ({ ...recipe, score: 0 }))\n145      },\n146      enabled: !!(searchQuery || hasActiveFilters),\n147    })\n148 +  const handleSearchInputKeyDown = (e: React.KeyboardEvent<HTMLInputElement>) => {\n149 +    if (e.key === \"Escape\" && searchQuery) {\n150 +      setSearchQuery(\"\");\n151 +      inputRef.current?.focus();\n152 +    }\n153 +    if (e.key === \"Enter\") {\n154 +      handleSearch(searchQuery);\n155 +    }\n156 +  };\n157 +\n158  \n159    const handleSearch = (query: string) => {\n160      setSearchQuery(query)\n161      setFilters({ ...filters, q: query })\n\n@@ -182,13 +219,13 @@ export default function SearchPage() {\n__new hunk__\n219    return (\n220      <div className=\"container px-4 py-6 max-w-6xl\">\n221        <div className=\"space-y-6\">\n222          {/* Search Header */}\n223          <div className=\"space-y-4\">\n224            <h1 className=\"text-3xl font-bold\">Search Recipes</h1>\n225  \n226            {/* Search Input */}\n227 +          {/* <div className=\"relative\">\n228              <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n229              <Input\n230                role=\"search\"\n231                placeholder=\"Search recipes, ingredients, cuisines...\"\n__old hunk__\n   return (\n     <div className=\"container px-4 py-6 max-w-6xl\">\n       <div className=\"space-y-6\">\n         {/* Search Header */}\n         <div className=\"space-y-4\">\n           <h1 className=\"text-3xl font-bold\">Search Recipes</h1>\n \n           {/* Search Input */}\n-          <div className=\"relative\">\n             <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n             <Input\n               role=\"search\"\n               placeholder=\"Search recipes, ingredients, cuisines...\"\n\n@@ -192,14 +229,51 @@ export default function SearchPage() {\n__new hunk__\n229              <Input\n230                role=\"search\"\n231                placeholder=\"Search recipes, ingredients, cuisines...\"\n232                value={searchQuery}\n233                onChange={(e) => setSearchQuery(e.target.value)}\n234                onKeyDown={(e) => e.key === \"Enter\" && handleSearch(searchQuery)}\n235                className=\"pl-10 pr-4 h-12 text-lg\"\n236              />\n237 +          </div> */}\n238 +          <div style={{ position: \"relative\", display: \"inline-block\", width: \"100%\" }}>\n239 +            <Search style={{ position: \"absolute\", left: \"0.75rem\", top: \"50%\", transform: \"translateY(-50%)\", height: \"1rem\", width: \"1rem\", color: \"gray\" }} />\n240 +            <Input\n241 +              role=\"search\"\n242 +              ref={inputRef}\n243 +              placeholder=\"Search recipes, ingredients, cuisines...\"\n244 +              value={searchQuery}\n245 +              onChange={(e) => setSearchQuery(e.target.value)}\n246 +              onKeyDown={handleSearchInputKeyDown}\n247 +              style={{ paddingRight: searchQuery ? \"2rem\" : undefined, width: \"100%\" }}\n248 +              className=\"pl-10 pr-4 h-12 text-lg\"\n249 +            />\n250 +            {searchQuery && (\n251 +              <button\n252 +                type=\"button\"\n253 +                style={{\n254 +                  position: \"absolute\",\n255 +                  right: \"0.75rem\",\n256 +                  top: \"50%\",\n257 +                  transform: \"translateY(-50%)\",\n258 +                  background: \"none\",\n259 +                  border: \"none\",\n260 +                  cursor: \"pointer\",\n261 +                  padding: 0,\n262 +                  color: \"gray\",\n263 +                }}\n264 +                aria-label=\"Clear search\"\n265 +                onClick={() => {\n266 +                  setSearchQuery(\"\");\n267 +                  inputRef.current?.focus();\n268 +              }}\n269 +              >\n270 +                <X size={20} />\n271 +            </button>\n272 +          )}\n273            </div>\n274  \n275 +\n276            {/* Search Actions */}\n277            <div className=\"flex items-center gap-2\">\n278              <Button onClick={() => handleSearch(searchQuery)} size=\"sm\">\n279                Search\n\n\n## File: 'components/filter-panel.tsx'\n\n@@ -54,35 +54,58 @@\n__new hunk__\n54  export function FilterPanel({ open, onOpenChange, initialValues, onApply, onReset }: FilterPanelProps) {\n55    const form = useForm<FiltersFormInput>({\n56      resolver: zodResolver(schema),\n57      // provide full defaults (OUTPUT fits into INPUT just fine)\n58      defaultValues: schema.parse(initialValues ?? {}),\n59      mode: \"onChange\",\n60    })\n61  \n62     useEffect(() => {\n63      form.reset(schema.parse(initialValues ?? {}));\n64    }, [open, initialValues, form]);\n65  \n66 +  // function getActiveFiltersCount(): number {\n67 +  //   const values = form.getValues()\n68 +  //   let count = 0\n69 +  //   if ((values.dietaryRestrictions || []).length > 0) count++\n70 +  //   if ((values.allergens || []).length > 0) count++\n71 +  //   if ((values.cuisines || []).length > 0) count++\n72 +  //   if ((values.majorConditions || []).length > 0) count++\n73 +  //   if (values.calories && (values.calories[0] > 0 || values.calories[1] < 1200)) count++\n74 +  //   if ((values.proteinMin || 0) > 0) count++\n75 +  //   if ((values.carbsMin || 0) > 0) count++\n76 +  //   if ((values.fatMin || 0) > 0) count++\n77 +  //   if ((values.fiberMin || 0) > 0) count++\n78 +  //   if ((values.sugarMax || 100) < 100) count++\n79 +  //   if ((values.sodiumMax || 4000) < 4000) count++\n80 +  //   i2025-12-10T02:20:08.176486222Z f ((values.maxTime || 120) < 120) count++\n81 +  //   if ((values.mealType || \"\") !== \"\") count++\n82 +  //   return count\n83 +  // }\n84    function getActiveFiltersCount(): number {\n85 +    const values = form.getValues();\n86 +    let count = 0;\n87 +\n88 +    // Count all selected array filters individually\n89 +    count += values.dietaryRestrictions.length;\n90 +    count += values.allergens.length;\n91 +    count += values.cuisines.length;\n92 +    count += values.majorConditions.length;\n93 +\n94 +    // Numeric and single-value filters\n95 +    if (values.calories[0] > 0) count++;           // Min calories\n96 +    if (values.calories[1] < 1200) count++;        // Max calories\n97 +    if (values.proteinMin > 0) count++;\n98 +    if (values.carbsMin > 0) count++;\n99 +    if (values.fatMin > 0) count++;\n100 +    if (values.fiberMin > 0) count++;\n101 +    if (values.sugarMax < 100) count++;\n102 +    if (values.sodiumMax < 4000) count++;\n103 +    if (values.maxTime < 120) count++;\n104 +    if (values.mealType) count++;\n105 +\n106 +    return count;\n107    }\n108    function handleApply() {\n109      const values = schema.parse(form.getValues())\n110      onApply(values)\n111      onOpenChange(false)\n__old hunk__\n export function FilterPanel({ open, onOpenChange, initialValues, onApply, onReset }: FilterPanelProps) {\n   const form = useForm<FiltersFormInput>({\n     resolver: zodResolver(schema),\n     // provide full defaults (OUTPUT fits into INPUT just fine)\n     defaultValues: schema.parse(initialValues ?? {}),\n     mode: \"onChange\",\n   })\n \n    useEffect(() => {\n     form.reset(schema.parse(initialValues ?? {}));\n   }, [open, initialValues, form]);\n \n   function getActiveFiltersCount(): number {\n-    const values = form.getValues()\n-    let count = 0\n-    if ((values.dietaryRestrictions || []).length > 0) count++\n-    if ((values.allergens || []).length > 0) count++\n-    if ((values.cuisines || []).length > 0) count++\n-    if ((values.majorConditions || []).length > 0) count++\n-    if (values.calories && (values.calories[0] > 0 || values.calories[1] < 1200)) count++\n-    if ((values.proteinMin || 0) > 0) count++\n-    if ((values.carbsMin || 0) > 0) count++\n-    if ((values.fatMin || 0) > 0) count++\n-    if ((values.fiberMin || 0) > 0) count++\n-    if ((values.sugarMax || 100) < 100) count++\n-    if ((values.sodiumMax || 4000) < 4000) count++\n-    if ((values.maxTime || 120) < 120) count++\n-    if ((values.mealType || \"\") !== \"\") count++\n-    return count\n   }\n-\n   function handleApply() {\n     const values = schema.parse(form.getValues())\n     onApply(values)\n     onOpenChange(false)\n======\n\n\nResponse (should be a valid YAML, and nothing else):\n```yaml"}}, "file": {"name": "litellm_ai_handler.py", "path": "/app/pr_agent/algo/ai_handlers/litellm_ai_handler.py"}, "function": "chat_completion", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 388, "message": "Prompts", "module": "litellm_ai_handler", "name": "pr_agent.algo.ai_handlers.litellm_ai_handler", "process": {"id": 13, "name": "MainProcess"}, "thread": {"id": 131770084559744, "name": "MainThread"}, "time": {"repr": "2025-12-10 02:20:08.175885+00:00", "timestamp": 1765333208.175885}}}
2025-12-10T02:20:08.184147972Z 
2025-12-10T02:20:08.184196747Z Provider List: https://docs.litellm.ai/docs/providers
2025-12-10T02:20:08.184201013Z 
2025-12-10T02:20:08.184203837Z {"text": "Error during LLM inference: litellm.BadRequestError: LLM Provider NOT provided. Pass in the LLM provider you are trying to call. You passed model=\\openai/gpt-5\\\n Pass model as E.g. For 'Huggingface' inference endpoints pass in `completion(model='huggingface/starcoder',..)` Learn more: https://docs.litellm.ai/docs/providers\n", "record": {"elapsed": {"repr": "0:00:43.255640", "seconds": 43.25564}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "f7c570913c05466698e4b2771b7b02c2", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "litellm_ai_handler.py", "path": "/app/pr_agent/algo/ai_handlers/litellm_ai_handler.py"}, "function": "chat_completion", "level": {"icon": "âš ï¸", "name": "WARNING", "no": 30}, "line": 401, "message": "Error during LLM inference: litellm.BadRequestError: LLM Provider NOT provided. Pass in the LLM provider you are trying to call. You passed model=\\openai/gpt-5\\\n Pass model as E.g. For 'Huggingface' inference endpoints pass in `completion(model='huggingface/starcoder',..)` Learn more: https://docs.litellm.ai/docs/providers", "module": "litellm_ai_handler", "name": "pr_agent.algo.ai_handlers.litellm_ai_handler", "process": {"id": 13, "name": "MainProcess"}, "thread": {"id": 131770084559744, "name": "MainThread"}, "time": {"repr": "2025-12-10 02:20:08.183695+00:00", "timestamp": 1765333208.183695}}}
2025-12-10T02:20:08.187224029Z {"text": "Prompts\n", "record": {"elapsed": {"repr": "0:00:43.258646", "seconds": 43.258646}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "f7c570913c05466698e4b2771b7b02c2", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "artifact": {"system": "You are PR-Reviewer, a language model designed to review a Git Pull Request (PR).\nYour task is to provide constructive and concise feedback for the PR.\nThe review should focus on new code added in the PR code diff (lines starting with '+')\n\n\nThe format we will use to present the PR code diff:\n======\n## File: 'src/file1.py'\n\n\n@@ ... @@ def func1():\n__new hunk__\n11  unchanged code line0\n12  unchanged code line1\n13 +new code line2 added\n14  unchanged code line3\n__old hunk__\n unchanged code line0\n unchanged code line1\n-old code line2 removed\n unchanged code line3\n\n@@ ... @@ def func2():\n__new hunk__\n unchanged code line4\n+new code line5 added\n unchanged code line6\n\n## File: 'src/file2.py'\n...\n======\n\n- In the format above, the diff is organized into separate '__new hunk__' and '__old hunk__' sections for each code chunk. '__new hunk__' contains the updated code, while '__old hunk__' shows the removed code. If no code was removed in a specific chunk, the __old hunk__ section will be omitted.\n- We also added line numbers for the '__new hunk__' code, to help you refer to the code lines in your suggestions. These line numbers are not part of the actual code, and should only be used for reference.\n- Code lines are prefixed with symbols ('+', '-', ' '). The '+' symbol indicates new code added in the PR, the '-' symbol indicates code removed in the PR, and the ' ' symbol indicates unchanged code. The review should address new code added in the PR code diff (lines starting with '+').\n- When quoting variables, names or file paths from the code, use backticks (`) instead of single quote (').\n- Note that you only see changed code segments (diff hunks in a PR), not the entire codebase. Avoid suggestions that might duplicate existing functionality or questioning code elements (like variables declarations or import statements) that may be defined elsewhere in the codebase.\n- Also note that if the code ends at an opening brace or statement that begins a new scope (like 'if', 'for', 'try'), don't treat it as incomplete. Instead, acknowledge the visible scope boundary and analyze only the code shown.\n\n\nThe output must be a YAML object equivalent to type $PRReview, according to the following Pydantic definitions:\n=====\n\nclass KeyIssuesComponentLink(BaseModel):\n    relevant_file: str = Field(description=\"The full file path of the relevant file\")\n    issue_header: str = Field(description=\"One or two word title for the issue. For example: 'Possible Bug', etc.\")\n    issue_content: str = Field(description=\"A short and concise summary of what should be further inspected and validated during the PR review process for this issue. Do not mention line numbers in this field.\")\n    start_line: int = Field(description=\"The start line that corresponds to this issue in the relevant file\")\n    end_line: int = Field(description=\"The end line that corresponds to this issue in the relevant file\")\n\nclass Review(BaseModel):\n    estimated_effort_to_review_[1-5]: int = Field(description=\"Estimate, on a scale of 1-5 (inclusive), the time and effort required to review this PR by an experienced and knowledgeable developer. 1 means short and easy review , 5 means long and hard review. Take into account the size, complexity, quality, and the needed changes of the PR code diff.\")\n    relevant_tests: str = Field(description=\"yes/no question: does this PR have relevant tests added or updated ?\")\n    key_issues_to_review: List[KeyIssuesComponentLink] = Field(\"A short and diverse list (0-3 issues) of high-priority bugs, problems or performance concerns introduced in the PR code, which the PR reviewer should further focus on and validate during the review process.\")\n    security_concerns: str = Field(description=\"Does this PR code introduce vulnerabilities such as exposure of sensitive information (e.g., API keys, secrets, passwords), or security concerns like SQL injection, XSS, CSRF, and others ? Answer 'No' (without explaining why) if there are no possible issues. If there are security concerns or issues, start your answer with a short header, such as: 'Sensitive information exposure: ...', 'SQL injection: ...', etc. Explain your answer. Be specific and give examples if possible\")\n\nclass PRReview(BaseModel):\n    review: Review\n=====\n\n\nExample output:\n```yaml\nreview:\n  estimated_effort_to_review_[1-5]: |\n    3\n  relevant_tests: |\n    No\n  key_issues_to_review:\n    - relevant_file: |\n        directory/xxx.py\n      issue_header: |\n        Possible Bug\n      issue_content: |\n        ...\n      start_line: 12\n      end_line: 14\n    - ...\n  security_concerns: |\n    No\n```\n\nAnswer should be a valid YAML, and nothing else. Each YAML output MUST be after a newline, with proper indent, and block scalar indicator ('|')", "user": "\n\n\n--PR Info--\n\nToday's Date: 2025-12-10\n\nTitle: 'Fix: Search UX and multi-filter logic (frontend)'\n\nBranch: 'feature/initial-fixes'\n\nPR Description:\n======\n- Improved search bar UX in app/search/page.tsx:\r\n  - X icon clears input and refocuses\r\n  - Escape key clears input\r\n  - Enter key triggers search\r\n\r\n- Updated filter count logic:\r\n  - Accurately counts all active filters\r\n  - Apply button badge reflects true total\n======\n\n\nThe PR code diff:\n======\n## File: 'app/search/page.tsx'\n\n@@ -1,7 +1,8 @@\n__new hunk__\n1  \"use client\"\n2  \n3 +import { useState, useEffect, useMemo, useRef } from \"react\"\n4 +// import { X } from \"lucide-react\"\n5  import { useSearchParams, useRouter } from \"next/navigation\"\n6  import { useQuery } from \"@tanstack/react-query\"\n7  import { Input } from \"@/components/ui/input\"\n8  import { Button } from \"@/components/ui/button\"\n__old hunk__\n \"use client\"\n \n-import { useState, useEffect, useMemo } from \"react\"\n import { useSearchParams, useRouter } from \"next/navigation\"\n import { useQuery } from \"@tanstack/react-query\"\n import { Input } from \"@/components/ui/input\"\n import { Button } from \"@/components/ui/button\"\n\n@@ -41,11 +42,12 @@\n__new hunk__\n42  export default function SearchPage() {\n43    const searchParams = useSearchParams()\n44    const router = useRouter()\n45    const { filters, setFilters, resetFilters } = useFilters()\n46    const { settings } = useSettings()\n47  \n48    const [searchQuery, setSearchQuery] = useState(searchParams.get(\"q\") || filters.q || \"\")\n49 +  const inputRef = useRef<HTMLInputElement>(null);\n50    const [sortBy, setSortBy] = useState<SortOption>(settings.behavior.defaultSort || \"time\")\n51    const [filtersOpen, setFiltersOpen] = useState(false)\n52  \n53    // Update search query from URL params\n\n@@ -75,29 +77,54 @@ export default function SearchPage() {\n__new hunk__\n77        filters.fiberMin > 0 ||\n78        filters.sugarMax < 100 ||\n79        filters.sodiumMax < 4000 ||\n80        filters.maxTime < 120 ||\n81        !!filters.mealType\n82      )\n83    }, [filters])\n84  \n85 +  // const activeFilterCount = useMemo(() => {\n86 +  //   let count = 0\n87 +  //   if (filters.dietaryRestrictions.length > 0) count++\n88 +  //   if (filters.allergens.length > 0) count++\n89 +  //   if (filters.cuisines.length > 0) count++\n90 +  //   if (filters.majorConditions.length > 0) count++\n91 +  //   if (filters.calories[0] > 0 || filters.calories[1] < 1200) count++\n92 +  //   if (filters.proteinMin > 0) count++\n93 +  //   if (filters.carbsMin > 0) count++\n94 +  //   if (filters.fatMin > 0) count++\n95 +  //   if (filters.fiberMin > 0) count++\n96 +  //   if (filters.sugarMax < 100) count++\n97 +  //   if (filters.sodiumMax < 4000) count++\n98 +  //   if (filters.maxTime < 120) count++\n99 +  //   if (filters.mealType) count++\n100 +  //   return count\n101 +  // }, [filters])\n102    const activeFilterCount = useMemo(() => {\n103 +    let count = 0;\n104 +\n105 +  // Sum all selected array filters\n106 +    count += filters.dietaryRestrictions.length;\n107 +    count += filters.allergens.length;\n108 +    count += filters.cuisines.length;\n109 +    count += filters.majorConditions.length;\n110 +\n111 +    // Range and min/max filters\n112 +    if (filters.calories[0] > 0) count++; // Min calories\n113 +    if (filters.calories[1] < 1200) count++; // Max calories\n114 +    if (filters.proteinMin > 0) count++;\n115 +    if (filters.carbsMin > 0) count++;\n116 +    if (filters.fatMin > 0) count++;\n117 +    if (filters.fiberMin > 0) count++;\n118 +    if (filters.sugarMax < 100) count++;\n119 +    if (filters.sodiumMax < 4000) count++;\n120 +    if (filters.maxTime < 120) count++;\n121 +    \n122 +    // Single-value selection\n123 +    if (filters.mealType) count++;\n124 +\n125 +    return count;\n126 +  }, [filters]);\n127  \n128    const {\n129      data: searchResults = [],\n130      isLoading,\n__old hunk__\n       filters.fiberMin > 0 ||\n       filters.sugarMax < 100 ||\n       filters.sodiumMax < 4000 ||\n       filters.maxTime < 120 ||\n       !!filters.mealType\n     )\n   }, [filters])\n \n   const activeFilterCount = useMemo(() => {\n-    let count = 0\n-    if (filters.dietaryRestrictions.length > 0) count++\n-    if (filters.allergens.length > 0) count++\n-    if (filters.cuisines.length > 0) count++\n-    if (filters.majorConditions.length > 0) count++\n-    if (filters.calories[0] > 0 || filters.calories[1] < 1200) count++\n-    if (filters.proteinMin > 0) count++\n-    if (filters.carbsMin > 0) count++\n-    if (filters.fatMin > 0) count++\n-    if (filters.fiberMin > 0) count++\n-    if (filters.sugarMax < 100) count++\n-    if (filters.sodiumMax < 4000) count++\n-    if (filters.maxTime < 120) count++\n-    if (filters.mealType) count++\n-    return count\n-  }, [filters])\n \n   const {\n     data: searchResults = [],\n     isLoading,\n\n@@ -113,12 +140,22 @@ export default function SearchPage() {\n__new hunk__\n140          const rankedResults = rank(rawResults, settings)\n141          return rankedResults\n142        }\n143  \n144        return rawResults.map((recipe) => ({ ...recipe, score: 0 }))\n145      },\n146      enabled: !!(searchQuery || hasActiveFilters),\n147    })\n148 +  const handleSearchInputKeyDown = (e: React.KeyboardEvent<HTMLInputElement>) => {\n149 +    if (e.key === \"Escape\" && searchQuery) {\n150 +      setSearchQuery(\"\");\n151 +      inputRef.current?.focus();\n152 +    }\n153 +    if (e.key === \"Enter\") {\n154 +      handleSearch(searchQuery);\n155 +    }\n156 +  };\n157 +\n158  \n159    const handleSearch = (query: string) => {\n160      setSearchQuery(query)\n161      setFilters({ ...filters, q: query })\n\n@@ -182,13 +219,13 @@ export default function SearchPage() {\n__new hunk__\n219    return (\n220      <div className=\"container px-4 py-6 max-w-6xl\">\n221        <div className=\"space-y-6\">\n222          {/* Search Header */}\n223          <div className=\"space-y-4\">\n224            <h1 className=\"text-3xl font-bold\">Search Recipes</h1>\n225  \n226            {/* Search Input */}\n227 +          {/* <div className=\"relative\">\n228              <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n229              <Input\n230                role=\"search\"\n231                placeholder=\"Search recipes, ingredients, cuisines...\"\n__old hunk__\n   return (\n     <div className=\"container px-4 py-6 max-w-6xl\">\n       <div className=\"space-y-6\">\n         {/* Search Header */}\n         <div className=\"space-y-4\">\n           <h1 className=\"text-3xl font-bold\">Search Recipes</h1>\n \n           {/* Search Input */}\n-          <div className=\"relative\">\n             <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n             <Input\n               role=\"search\"\n               placeholder=\"Search recipes, ingredients, cuisines...\"\n\n@@ -192,14 +229,51 @@ export default function SearchPage() {\n__new hunk__\n229              <Input\n230                role=\"search\"\n231                placeholder=\"Search recipes, ingredients, cuisines...\"\n232                value={searchQuery}\n233                onChange={(e) => setSearchQuery(e.target.value)}\n234                onKeyDown={(e) => e.key === \"Enter\" && handleSearch(searchQuery)}\n235                className=\"pl-10 pr-4 h-12 text-lg\"\n236              />\n237 +          </div> */}\n238 +          <div style={{ position: \"relative\", display: \"inline-block\", width: \"100%\" }}>\n239 +            <Search style={{ position: \"absolute\", left: \"0.75rem\", top: \"50%\", transform: \"translateY(-50%)\", height: \"1rem\", width: \"1rem\", color: \"gray\" }} />\n240 +            <Input\n241 +              role=\"search\"\n242 +              ref={inputRef}\n243 +              placeholder=\"Search recipes, ingredients, cuisines...\"\n244 +              value={searchQuery}\n245 +              onChange={(e) => setSearchQuery(e.target.value)}\n246 +              onKeyDown={handleSearchInputKeyDown}\n247 +              style={{ paddingRight: searchQuery ? \"2rem\" : undefined, width: \"100%\" }}\n248 +              className=\"pl-10 pr-4 h-12 text-lg\"\n249 +            />\n250 +            {searchQuery && (\n251 +              <button\n252 +                type=\"button\"\n253 +                style={{\n254 +                  position: \"absolute\",\n255 +                  right: \"0.75rem\",\n256 +                  top: \"50%\",\n257 +                  transform: \"translateY(-50%)\",\n258 +                  background: \"none\",\n259 +                  border: \"none\",\n260 +                  cursor: \"pointer\",\n261 +                  padding: 0,\n262 +                  color: \"gray\",\n263 +                }}\n264 +                aria-label=\"Clear search\"\n265 +                onClick={() => {\n266 +                  setSearchQuery(\"\");\n267 +                  inputRef.current?.focus();\n268 +              }}\n269 +              >\n270 +                <X size={20} />\n271 +            </button>\n272 +          )}\n273            </div>\n274  \n275 +\n276            {/* Search Actions */}\n277            <div className=\"flex items-center gap-2\">\n278              <Button onClick={() => handleSearch(searchQuery)} size=\"sm\">\n279                Search\n\n\n## File: 'components/filter-panel.tsx'\n\n@@ -54,35 +54,58 @@\n__new hunk__\n54  export function FilterPanel({ open, onOpenChange, initialValues, onApply, onReset }: FilterPanelProps) {\n55    const form = useForm<FiltersFormInput>({\n56      resolver: zodResolver(schema),\n57      // provide full defaults (OUTPUT fits into INPUT just fine)\n58      defaultValues: schema.parse(initialValues ?? {}),\n59      mode: \"onChange\",\n60    })\n61  \n62     useEffect(() => {\n63      form.reset(schema.parse(initialValues ?? {}));\n64    }, [open, initialValues, form]);\n65  \n66 +  // function getActiveFiltersCount(): number {\n67 +  //   const values = form.getValues()\n68 +  //   let count = 0\n69 +  //   if ((values.dietaryRestrictions || []).length > 0) count++\n70 +  //   if ((values.allergens || []).length > 0) count++\n71 +  //   if ((values.cuisines || []).length > 0) count++\n72 +  //   if ((values.majorConditions || []).length > 0) count++\n73 +  //   if (values.calories && (values.calories[0] > 0 || values.calories[1] < 1200)) count++\n74 +  //   if ((values.proteinMin || 0) > 0) count++\n75 +  //   if ((values.carbsMin || 0) > 0) count++\n76 +  //   if ((values.fatMin || 0) > 0) count++\n77 +  //   if ((values.fiberMin || 0) > 0) count++\n78 +  //   if ((values.sugarMax || 100) < 100) count++\n79 +  //   if ((values.sodiumMax || 4000) < 4000) count++\n80 +  //   2025-12-10T02:20:08.187224029Z if ((values.maxTime || 120) < 120) count++\n81 +  //   if ((values.mealType || \"\") !== \"\") count++\n82 +  //   return count\n83 +  // }\n84    function getActiveFiltersCount(): number {\n85 +    const values = form.getValues();\n86 +    let count = 0;\n87 +\n88 +    // Count all selected array filters individually\n89 +    count += values.dietaryRestrictions.length;\n90 +    count += values.allergens.length;\n91 +    count += values.cuisines.length;\n92 +    count += values.majorConditions.length;\n93 +\n94 +    // Numeric and single-value filters\n95 +    if (values.calories[0] > 0) count++;           // Min calories\n96 +    if (values.calories[1] < 1200) count++;        // Max calories\n97 +    if (values.proteinMin > 0) count++;\n98 +    if (values.carbsMin > 0) count++;\n99 +    if (values.fatMin > 0) count++;\n100 +    if (values.fiberMin > 0) count++;\n101 +    if (values.sugarMax < 100) count++;\n102 +    if (values.sodiumMax < 4000) count++;\n103 +    if (values.maxTime < 120) count++;\n104 +    if (values.mealType) count++;\n105 +\n106 +    return count;\n107    }\n108    function handleApply() {\n109      const values = schema.parse(form.getValues())\n110      onApply(values)\n111      onOpenChange(false)\n__old hunk__\n export function FilterPanel({ open, onOpenChange, initialValues, onApply, onReset }: FilterPanelProps) {\n   const form = useForm<FiltersFormInput>({\n     resolver: zodResolver(schema),\n     // provide full defaults (OUTPUT fits into INPUT just fine)\n     defaultValues: schema.parse(initialValues ?? {}),\n     mode: \"onChange\",\n   })\n \n    useEffect(() => {\n     form.reset(schema.parse(initialValues ?? {}));\n   }, [open, initialValues, form]);\n \n   function getActiveFiltersCount(): number {\n-    const values = form.getValues()\n-    let count = 0\n-    if ((values.dietaryRestrictions || []).length > 0) count++\n-    if ((values.allergens || []).length > 0) count++\n-    if ((values.cuisines || []).length > 0) count++\n-    if ((values.majorConditions || []).length > 0) count++\n-    if (values.calories && (values.calories[0] > 0 || values.calories[1] < 1200)) count++\n-    if ((values.proteinMin || 0) > 0) count++\n-    if ((values.carbsMin || 0) > 0) count++\n-    if ((values.fatMin || 0) > 0) count++\n-    if ((values.fiberMin || 0) > 0) count++\n-    if ((values.sugarMax || 100) < 100) count++\n-    if ((values.sodiumMax || 4000) < 4000) count++\n-    if ((values.maxTime || 120) < 120) count++\n-    if ((values.mealType || \"\") !== \"\") count++\n-    return count\n   }\n-\n   function handleApply() {\n     const values = schema.parse(form.getValues())\n     onApply(values)\n     onOpenChange(false)\n======\n\n\nResponse (should be a valid YAML, and nothing else):\n```yaml"}}, "file": {"name": "litellm_ai_handler.py", "path": "/app/pr_agent/algo/ai_handlers/litellm_ai_handler.py"}, "function": "chat_completion", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 388, "message": "Prompts", "module": "litellm_ai_handler", "name": "pr_agent.algo.ai_handlers.litellm_ai_handler", "process": {"id": 13, "name": "MainProcess"}, "thread": {"id": 131770084559744, "name": "MainThread"}, "time": {"repr": "2025-12-10 02:20:08.186701+00:00", "timestamp": 1765333208.186701}}}
2025-12-10T02:20:08.191325473Z 
2025-12-10T02:20:08.191375978Z Provider List: https://docs.litellm.ai/docs/providers
2025-12-10T02:20:08.191379955Z 
2025-12-10T02:20:08.191382599Z {"text": "Error during LLM inference: litellm.BadRequestError: LLM Provider NOT provided. Pass in the LLM provider you are trying to call. You passed model=\\openai/gpt-5\\\n Pass model as E.g. For 'Huggingface' inference endpoints pass in `completion(model='huggingface/starcoder',..)` Learn more: https://docs.litellm.ai/docs/providers\n", "record": {"elapsed": {"repr": "0:00:43.262934", "seconds": 43.262934}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "f7c570913c05466698e4b2771b7b02c2", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "litellm_ai_handler.py", "path": "/app/pr_agent/algo/ai_handlers/litellm_ai_handler.py"}, "function": "chat_completion", "level": {"icon": "âš ï¸", "name": "WARNING", "no": 30}, "line": 401, "message": "Error during LLM inference: litellm.BadRequestError: LLM Provider NOT provided. Pass in the LLM provider you are trying to call. You passed model=\\openai/gpt-5\\\n Pass model as E.g. For 'Huggingface' inference endpoints pass in `completion(model='huggingface/starcoder',..)` Learn more: https://docs.litellm.ai/docs/providers", "module": "litellm_ai_handler", "name": "pr_agent.algo.ai_handlers.litellm_ai_handler", "process": {"id": 13, "name": "MainProcess"}, "thread": {"id": 131770084559744, "name": "MainThread"}, "time": {"repr": "2025-12-10 02:20:08.190989+00:00", "timestamp": 1765333208.190989}}}
2025-12-10T02:20:08.191445574Z {"text": "Failed to generate prediction with \\openai/gpt-5\\\n", "record": {"elapsed": {"repr": "0:00:43.263212", "seconds": 43.263212}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "f7c570913c05466698e4b2771b7b02c2", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "artifact": {"error": "RetryError[<Future at 0x77d81239fdd0 state=finished raised BadRequestError>]"}}, "file": {"name": "pr_processing.py", "path": "/app/pr_agent/algo/pr_processing.py"}, "function": "retry_with_fallback_models", "level": {"icon": "âš ï¸", "name": "WARNING", "no": 30}, "line": 333, "message": "Failed to generate prediction with \\openai/gpt-5\\", "module": "pr_processing", "name": "pr_agent.algo.pr_processing", "process": {"id": 13, "name": "MainProcess"}, "thread": {"id": 131770084559744, "name": "MainThread"}, "time": {"repr": "2025-12-10 02:20:08.191267+00:00", "timestamp": 1765333208.191267}}}
2025-12-10T02:20:08.191857525Z {"text": "Generating prediction with \\openai/gpt-5-nano\\\n", "record": {"elapsed": {"repr": "0:00:43.263322", "seconds": 43.263322}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "f7c570913c05466698e4b2771b7b02c2", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "pr_processing.py", "path": "/app/pr_agent/algo/pr_processing.py"}, "function": "retry_with_fallback_models", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 326, "message": "Generating prediction with \\openai/gpt-5-nano\\", "module": "pr_processing", "name": "pr_agent.algo.pr_processing", "process": {"id": 13, "name": "MainProcess"}, "thread": {"id": 131770084559744, "name": "MainThread"}, "time": {"repr": "2025-12-10 02:20:08.191377+00:00", "timestamp": 1765333208.191377}}}
2025-12-10T02:20:08.317918641Z {"text": "PR main language: TypeScript\n", "record": {"elapsed": {"repr": "0:00:43.389333", "seconds": 43.389333}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "f7c570913c05466698e4b2771b7b02c2", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "pr_processing.py", "path": "/app/pr_agent/algo/pr_processing.py"}, "function": "get_pr_diff", "level": {"icon": "â„¹ï¸", "name": "INFO", "no": 20}, "line": 63, "message": "PR main language: TypeScript", "module": "pr_processing", "name": "pr_agent.algo.pr_processing", "process": {"id": 13, "name": "MainProcess"}, "thread": {"id": 131770084559744, "name": "MainThread"}, "time": {"repr": "2025-12-10 02:20:08.317388+00:00", "timestamp": 1765333208.317388}}}
2025-12-10T02:20:08.326106394Z {"text": "Tokens: 4738, total tokens under limit: 32000, returning full diff.\n", "record": {"elapsed": {"repr": "0:00:43.397688", "seconds": 43.397688}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "f7c570913c05466698e4b2771b7b02c2", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "pr_processing.py", "path": "/app/pr_agent/algo/pr_processing.py"}, "function": "get_pr_diff", "level": {"icon": "â„¹ï¸", "name": "INFO", "no": 20}, "line": 74, "message": "Tokens: 4738, total tokens under limit: 32000, returning full diff.", "module": "pr_processing", "name": "pr_agent.algo.pr_processing", "process": {"id": 13, "name": "MainProcess"}, "thread": {"id": 131770084559744, "name": "MainThread"}, "time": {"repr": "2025-12-10 02:20:08.325743+00:00", "timestamp": 1765333208.325743}}}
2025-12-10T02:20:08.326286927Z {"text": "PR diff\n", "record": {"elapsed": {"repr": "0:00:43.397933", "seconds": 43.397933}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "f7c570913c05466698e4b2771b7b02c2", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "diff": "\n\n## File: 'app/search/page.tsx'\n\n@@ -1,7 +1,8 @@\n__new hunk__\n1  \"use client\"\n2  \n3 +import { useState, useEffect, useMemo, useRef } from \"react\"\n4 +// import { X } from \"lucide-react\"\n5  import { useSearchParams, useRouter } from \"next/navigation\"\n6  import { useQuery } from \"@tanstack/react-query\"\n7  import { Input } from \"@/components/ui/input\"\n8  import { Button } from \"@/components/ui/button\"\n__old hunk__\n \"use client\"\n \n-import { useState, useEffect, useMemo } from \"react\"\n import { useSearchParams, useRouter } from \"next/navigation\"\n import { useQuery } from \"@tanstack/react-query\"\n import { Input } from \"@/components/ui/input\"\n import { Button } from \"@/components/ui/button\"\n\n@@ -41,11 +42,12 @@\n__new hunk__\n42  export default function SearchPage() {\n43    const searchParams = useSearchParams()\n44    const router = useRouter()\n45    const { filters, setFilters, resetFilters } = useFilters()\n46    const { settings } = useSettings()\n47  \n48    const [searchQuery, setSearchQuery] = useState(searchParams.get(\"q\") || filters.q || \"\")\n49 +  const inputRef = useRef<HTMLInputElement>(null);\n50    const [sortBy, setSortBy] = useState<SortOption>(settings.behavior.defaultSort || \"time\")\n51    const [filtersOpen, setFiltersOpen] = useState(false)\n52  \n53    // Update search query from URL params\n\n@@ -75,29 +77,54 @@ export default function SearchPage() {\n__new hunk__\n77        filters.fiberMin > 0 ||\n78        filters.sugarMax < 100 ||\n79        filters.sodiumMax < 4000 ||\n80        filters.maxTime < 120 ||\n81        !!filters.mealType\n82      )\n83    }, [filters])\n84  \n85 +  // const activeFilterCount = useMemo(() => {\n86 +  //   let count = 0\n87 +  //   if (filters.dietaryRestrictions.length > 0) count++\n88 +  //   if (filters.allergens.length > 0) count++\n89 +  //   if (filters.cuisines.length > 0) count++\n90 +  //   if (filters.majorConditions.length > 0) count++\n91 +  //   if (filters.calories[0] > 0 || filters.calories[1] < 1200) count++\n92 +  //   if (filters.proteinMin > 0) count++\n93 +  //   if (filters.carbsMin > 0) count++\n94 +  //   if (filters.fatMin > 0) count++\n95 +  //   if (filters.fiberMin > 0) count++\n96 +  //   if (filters.sugarMax < 100) count++\n97 +  //   if (filters.sodiumMax < 4000) count++\n98 +  //   if (filters.maxTime < 120) count++\n99 +  //   if (filters.mealType) count++\n100 +  //   return count\n101 +  // }, [filters])\n102    const activeFilterCount = useMemo(() => {\n103 +    let count = 0;\n104 +\n105 +  // Sum all selected array filters\n106 +    count += filters.dietaryRestrictions.length;\n107 +    count += filters.allergens.length;\n108 +    count += filters.cuisines.length;\n109 +    count += filters.majorConditions.length;\n110 +\n111 +    // Range and min/max filters\n112 +    if (filters.calories[0] > 0) count++; // Min calories\n113 +    if (filters.calories[1] < 1200) count++; // Max calories\n114 +    if (filters.proteinMin > 0) count++;\n115 +    if (filters.carbsMin > 0) count++;\n116 +    if (filters.fatMin > 0) count++;\n117 +    if (filters.fiberMin > 0) count++;\n118 +    if (filters.sugarMax < 100) count++;\n119 +    if (filters.sodiumMax < 4000) count++;\n120 +    if (filters.maxTime < 120) count++;\n121 +    \n122 +    // Single-value selection\n123 +    if (filters.mealType) count++;\n124 +\n125 +    return count;\n126 +  }, [filters]);\n127  \n128    const {\n129      data: searchResults = [],\n130      isLoading,\n__old hunk__\n       filters.fiberMin > 0 ||\n       filters.sugarMax < 100 ||\n       filters.sodiumMax < 4000 ||\n       filters.maxTime < 120 ||\n       !!filters.mealType\n     )\n   }, [filters])\n \n   const activeFilterCount = useMemo(() => {\n-    let count = 0\n-    if (filters.dietaryRestrictions.length > 0) count++\n-    if (filters.allergens.length > 0) count++\n-    if (filters.cuisines.length > 0) count++\n-    if (filters.majorConditions.length > 0) count++\n-    if (filters.calories[0] > 0 || filters.calories[1] < 1200) count++\n-    if (filters.proteinMin > 0) count++\n-    if (filters.carbsMin > 0) count++\n-    if (filters.fatMin > 0) count++\n-    if (filters.fiberMin > 0) count++\n-    if (filters.sugarMax < 100) count++\n-    if (filters.sodiumMax < 4000) count++\n-    if (filters.maxTime < 120) count++\n-    if (filters.mealType) count++\n-    return count\n-  }, [filters])\n \n   const {\n     data: searchResults = [],\n     isLoading,\n\n@@ -113,12 +140,22 @@ export default function SearchPage() {\n__new hunk__\n140          const rankedResults = rank(rawResults, settings)\n141          return rankedResults\n142        }\n143  \n144        return rawResults.map((recipe) => ({ ...recipe, score: 0 }))\n145      },\n146      enabled: !!(searchQuery || hasActiveFilters),\n147    })\n148 +  const handleSearchInputKeyDown = (e: React.KeyboardEvent<HTMLInputElement>) => {\n149 +    if (e.key === \"Escape\" && searchQuery) {\n150 +      setSearchQuery(\"\");\n151 +      inputRef.current?.focus();\n152 +    }\n153 +    if (e.key === \"Enter\") {\n154 +      handleSearch(searchQuery);\n155 +    }\n156 +  };\n157 +\n158  \n159    const handleSearch = (query: string) => {\n160      setSearchQuery(query)\n161      setFilters({ ...filters, q: query })\n\n@@ -182,13 +219,13 @@ export default function SearchPage() {\n__new hunk__\n219    return (\n220      <div className=\"container px-4 py-6 max-w-6xl\">\n221        <div className=\"space-y-6\">\n222          {/* Search Header */}\n223          <div className=\"space-y-4\">\n224            <h1 className=\"text-3xl font-bold\">Search Recipes</h1>\n225  \n226            {/* Search Input */}\n227 +          {/* <div className=\"relative\">\n228              <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n229              <Input\n230                role=\"search\"\n231                placeholder=\"Search recipes, ingredients, cuisines...\"\n__old hunk__\n   return (\n     <div className=\"container px-4 py-6 max-w-6xl\">\n       <div className=\"space-y-6\">\n         {/* Search Header */}\n         <div className=\"space-y-4\">\n           <h1 className=\"text-3xl font-bold\">Search Recipes</h1>\n \n           {/* Search Input */}\n-          <div className=\"relative\">\n             <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n             <Input\n               role=\"search\"\n               placeholder=\"Search recipes, ingredients, cuisines...\"\n\n@@ -192,14 +229,51 @@ export default function SearchPage() {\n__new hunk__\n229              <Input\n230                role=\"search\"\n231                placeholder=\"Search recipes, ingredients, cuisines...\"\n232                value={searchQuery}\n233                onChange={(e) => setSearchQuery(e.target.value)}\n234                onKeyDown={(e) => e.key === \"Enter\" && handleSearch(searchQuery)}\n235                className=\"pl-10 pr-4 h-12 text-lg\"\n236              />\n237 +          </div> */}\n238 +          <div style={{ position: \"relative\", display: \"inline-block\", width: \"100%\" }}>\n239 +            <Search style={{ position: \"absolute\", left: \"0.75rem\", top: \"50%\", transform: \"translateY(-50%)\", height: \"1rem\", width: \"1rem\", color: \"gray\" }} />\n240 +            <Input\n241 +              role=\"search\"\n242 +              ref={inputRef}\n243 +              placeholder=\"Search recipes, ingredients, cuisines...\"\n244 +              value={searchQuery}\n245 +              onChange={(e) => setSearchQuery(e.target.value)}\n246 +              onKeyDown={handleSearchInputKeyDown}\n247 +              style={{ paddingRight: searchQuery ? \"2rem\" : undefined, width: \"100%\" }}\n248 +              className=\"pl-10 pr-4 h-12 text-lg\"\n249 +            />\n250 +            {searchQuery && (\n251 +              <button\n252 +                type=\"button\"\n253 +                style={{\n254 +                  position: \"absolute\",\n255 +                  right: \"0.75rem\",\n256 +                  top: \"50%\",\n257 +                  transform: \"translateY(-50%)\",\n258 +                  background: \"none\",\n259 +                  border: \"none\",\n260 +                  cursor: \"pointer\",\n261 +                  padding: 0,\n262 +                  color: \"gray\",\n263 +                }}\n264 +                aria-label=\"Clear search\"\n265 +                onClick={() => {\n266 +                  setSearchQuery(\"\");\n267 +                  inputRef.current?.focus();\n268 +              }}\n269 +              >\n270 +                <X size={20} />\n271 +            </button>\n272 +          )}\n273            </div>\n274  \n275 +\n276            {/* Search Actions */}\n277            <div className=\"flex items-center gap-2\">\n278              <Button onClick={() => handleSearch(searchQuery)} size=\"sm\">\n279                Search\n\n\n## File: 'components/filter-panel.tsx'\n\n@@ -54,35 +54,58 @@\n__new hunk__\n54  export function FilterPanel({ open, onOpenChange, initialValues, onApply, onReset }: FilterPanelProps) {\n55    const form = useForm<FiltersFormInput>({\n56      resolver: zodResolver(schema),\n57      // provide full defaults (OUTPUT fits into INPUT just fine)\n58      defaultValues: schema.parse(initialValues ?? {}),\n59      mode: \"onChange\",\n60    })\n61  \n62     useEffect(() => {\n63      form.reset(schema.parse(initialValues ?? {}));\n64    }, [open, initialValues, form]);\n65  \n66 +  // function getActiveFiltersCount(): number {\n67 +  //   const values = form.getValues()\n68 +  //   let count = 0\n69 +  //   if ((values.dietaryRestrictions || []).length > 0) count++\n70 +  //   if ((values.allergens || []).length > 0) count++\n71 +  //   if ((values.cuisines || []).length > 0) count++\n72 +  //   if ((values.majorConditions || []).length > 0) count++\n73 +  //   if (values.calories && (values.calories[0] > 0 || values.calories[1] < 1200)) count++\n74 +  //   if ((values.proteinMin || 0) > 0) count++\n75 +  //   if ((values.carbsMin || 0) > 0) count++\n76 +  //   if ((values.fatMin || 0) > 0) count++\n77 +  //   if ((values.fiberMin || 0) > 0) count++\n78 +  //   if ((values.sugarMax || 100) < 100) count++\n79 +  //   if ((values.sodiumMax || 4000) < 4000) count++\n80 +  //   if ((values.maxTime || 120) < 120) count++\n81 +  //   if ((values.mealType || \"\") !== \"\") count++\n82 +  //   return count\n83 +  // }\n84    function getActiveFiltersCount(): number {\n85 +    const values = form.getValues();\n86 +    let count = 0;\n87 +\n88 +    // Count all selected array filters individually\n89 +    count += values.dietaryRestrictions.length;\n90 +    count += values.allergens.length;\n91 +    count += values.cuisines.length;\n92 +    count += values.majorConditions.length;\n93 +\n94 +    // Numeric and single-value filters\n95 +    if (values.calories[0] > 0) count++;           // Min calories\n96 +    if (values.calories[1] < 1200) count++;        // Max calories\n97 +    if (values.proteinMin > 0) count++;\n98 +    if (values.carbsMin > 0) count++;\n99 +    if (values.fatMin > 0) count++;\n100 +    if (values.fiberMin > 0) count++;\n101 +    if (values.sugarMax < 100) count++;\n102 +    if (values.sodiumMax < 4000) count++;\n103 +    if (values.maxTime < 120) count++;\n104 +    if (values.mealType) count++;\n105 +\n106 +    return count;\n107    }\n108    function handleApply() {\n109      const values = schema.parse(form.getValues())\n110      onApply(values)\n111      onOpenChange(false)\n__old hunk__\n export function FilterPanel({ open, onOpenChange, initialValues, onApply, onReset }: FilterPanelProps) {\n   const form = useForm<FiltersFormInput>({\n     resolver: zodResolver(schema),\n     // provide full defaults (OUTPUT fits into INPUT just fine)\n     defaultValues: schema.parse(initialValues ?? {}),\n     mode: \"onChange\",\n   })\n \n    useEffect(() => {\n     form.reset(schema.parse(initialValues ?? {}));\n   }, [open, initialValues, form]);\n \n   function getActiveFiltersCount(): number {\n-    const values = form.getValues()\n-    let count = 0\n-    if ((values.dietaryRestrictions || []).length > 0) count++\n-    if ((values.allergens || []).length > 0) count++\n-    if ((values.cuisines || []).length > 0) count++\n-    if ((values.majorConditions || []).length > 0) count++\n-    if (values.calories && (values.calories[0] > 0 || values.calories[1] < 1200)) count++\n-    if ((values.proteinMin || 0) > 0) count++\n-    if ((values.carbsMin || 0) > 0) count++\n-    if ((values.fatMin || 0) > 0) count++\n-    if ((values.fiberMin || 0) > 0) count++\n-    if ((values.sugarMax || 100) < 100) count++\n-    if ((values.sodiumMax || 4000) < 4000) count++\n-    if ((values.maxTime || 120) < 120) count++\n-    if ((values.mealType || \"\") !== \"\") count++\n-    return count\n   }\n-\n   function handleApply() {\n     const values = schema.parse(form.getValues())\n     onApply(values)\n     onOpenChange(false)"}, "file": {"name": "pr_reviewer.py", "path": "/app/pr_agent/tools/pr_reviewer.py"}, "function": "_prepare_prediction", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 197, "message": "PR diff", "module": "pr_reviewer", "name": "pr_agent.tools.pr_reviewer", "process": {"id": 13, "name": "MainProcess"}, "thread": {"id": 131770084559744, "name": "MainThread"}, "time": {"repr": "2025-12-10 02:20:08.325988+00:00", "timestamp": 1765333208.325988}}}
2025-12-10T02:20:08.341044774Z {"text": "Prompts\n", "record": {"elapsed": {"repr": "0:00:43.412306", "seconds": 43.412306}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "f7c570913c05466698e4b2771b7b02c2", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "artifact": {"system": "You are PR-Reviewer, a language model designed to review a Git Pull Request (PR).\nYour task is to provide constructive and concise feedback for the PR.\nThe review should focus on new code added in the PR code diff (lines starting with '+')\n\n\nThe format we will use to present the PR code diff:\n======\n## File: 'src/file1.py'\n\n\n@@ ... @@ def func1():\n__new hunk__\n11  unchanged code line0\n12  unchanged code line1\n13 +new code line2 added\n14  unchanged code line3\n__old hunk__\n unchanged code line0\n unchanged code line1\n-old code line2 removed\n unchanged code line3\n\n@@ ... @@ def func2():\n__new hunk__\n unchanged code line4\n+new code line5 added\n unchanged code line6\n\n## File: 'src/file2.py'\n...\n======\n\n- In the format above, the diff is organized into separate '__new hunk__' and '__old hunk__' sections for each code chunk. '__new hunk__' contains the updated code, while '__old hunk__' shows the removed code. If no code was removed in a specific chunk, the __old hunk__ section will be omitted.\n- We also added line numbers for the '__new hunk__' code, to help you refer to the code lines in your suggestions. These line numbers are not part of the actual code, and should only be used for reference.\n- Code lines are prefixed with symbols ('+', '-', ' '). The '+' symbol indicates new code added in the PR, the '-' symbol indicates code removed in the PR, and the ' ' symbol indicates unchanged code. The review should address new code added in the PR code diff (lines starting with '+').\n- When quoting variables, names or file paths from the code, use backticks (`) instead of single quote (').\n- Note that you only see changed code segments (diff hunks in a PR), not the entire codebase. Avoid suggestions that might duplicate existing functionality or questioning code elements (like variables declarations or import statements) that may be defined elsewhere in the codebase.\n- Also note that if the code ends at an opening brace or statement that begins a new scope (like 'if', 'for', 'try'), don't treat it as incomplete. Instead, acknowledge the visible scope boundary and analyze only the code shown.\n\n\nThe output must be a YAML object equivalent to type $PRReview, according to the following Pydantic definitions:\n=====\n\nclass KeyIssuesComponentLink(BaseModel):\n    relevant_file: str = Field(description=\"The full file path of the relevant file\")\n    issue_header: str = Field(description=\"One or two word title for the issue. For example: 'Possible Bug', etc.\")\n    issue_content: str = Field(description=\"A short and concise summary of what should be further inspected and validated during the PR review process for this issue. Do not mention line numbers in this field.\")\n    start_line: int = Field(description=\"The start line that corresponds to this issue in the relevant file\")\n    end_line: int = Field(description=\"The end line that corresponds to this issue in the relevant file\")\n\nclass Review(BaseModel):\n    estimated_effort_to_review_[1-5]: int = Field(description=\"Estimate, on a scale of 1-5 (inclusive), the time and effort required to review this PR by an experienced and knowledgeable developer. 1 means short and easy review , 5 means long and hard review. Take into account the size, complexity, quality, and the needed changes of the PR code diff.\")\n    relevant_tests: str = Field(description=\"yes/no question: does this PR have relevant tests added or updated ?\")\n    key_issues_to_review: List[KeyIssuesComponentLink] = Field(\"A short and diverse list (0-3 issues) of high-priority bugs, problems or performance concerns introduced in the PR code, which the PR reviewer should further focus on and validate during the review process.\")\n    security_concerns: str = Field(description=\"Does this PR code introduce vulnerabilities such as exposure of sensitive information (e.g., API keys, secrets, passwords), or security concerns like SQL injection, XSS, CSRF, and others ? Answer 'No' (without explaining why) if there are no possible issues. If there are security concerns or issues, start your answer with a short header, such as: 'Sensitive information exposure: ...', 'SQL injection: ...', etc. Explain your answer. Be specific and give examples if possible\")\n\nclass PRReview(BaseModel):\n    review: Review\n=====\n\n\nExample output:\n```yaml\nreview:\n  estimated_effort_to_review_[1-5]: |\n    3\n  relevant_tests: |\n    No\n  key_issues_to_review:\n    - relevant_file: |\n        directory/xxx.py\n      issue_header: |\n        Possible Bug\n      issue_content: |\n        ...\n      start_line: 12\n      end_line: 14\n    - ...\n  security_concerns: |\n    No\n```\n\nAnswer should be a valid YAML, and nothing else. Each YAML output MUST be after a newline, with proper indent, and block scalar indicator ('|')", "user": "\n\n\n--PR Info--\n\nToday's Date: 2025-12-10\n\nTitle: 'Fix: Search UX and multi-filter logic (frontend)'\n\nBranch: 'feature/initial-fixes'\n\nPR Description:\n======\n- Improved search bar UX in app/search/page.tsx:\r\n  - X icon clears input and refocuses\r\n  - Escape key clears input\r\n  - Enter key triggers search\r\n\r\n- Updated filter count logic:\r\n  - Accurately counts all active filters\r\n  - Apply button badge reflects true total\n======\n\n\nThe PR code diff:\n======\n## File: 'app/search/page.tsx'\n\n@@ -1,7 +1,8 @@\n__new hunk__\n1  \"use client\"\n2  \n3 +import { useState, useEffect, useMemo, useRef } from \"react\"\n4 +// import { X } from \"lucide-react\"\n5  import { useSearchParams, useRouter } from \"next/navigation\"\n6  import { useQuery } from \"@tanstack/react-query\"\n7  import { Input } from \"@/components/ui/input\"\n8  import { Button } from \"@/components/ui/button\"\n__old hunk__\n \"use client\"\n \n-import { useState, useEffect, useMemo } from \"react\"\n import { useSearchParams, useRouter } from \"next/navigation\"\n import { useQuery } from \"@tanstack/react-query\"\n import { Input } from \"@/components/ui/input\"\n import { Button } from \"@/components/ui/button\"\n\n@@ -41,11 +42,12 @@\n__new hunk__\n42  export default function SearchPage() {\n43    const searchParams = useSearchParams()\n44    const router = useRouter()\n45    const { filters, setFilters, resetFilters } = useFilters()\n46    const { settings } = useSettings()\n47  \n48    const [searchQuery, setSearchQuery] = useState(searchParams.get(\"q\") || filters.q || \"\")\n49 +  const inputRef = useRef<HTMLInputElement>(null);\n50    const [sortBy, setSortBy] = useState<SortOption>(settings.behavior.defaultSort || \"time\")\n51    const [filtersOpen, setFiltersOpen] = useState(false)\n52  \n53    // Update search query from URL params\n\n@@ -75,29 +77,54 @@ export default function SearchPage() {\n__new hunk__\n77        filters.fiberMin > 0 ||\n78        filters.sugarMax < 100 ||\n79        filters.sodiumMax < 4000 ||\n80        filters.maxTime < 120 ||\n81        !!filters.mealType\n82      )\n83    }, [filters])\n84  \n85 +  // const activeFilterCount = useMemo(() => {\n86 +  //   let count = 0\n87 +  //   if (filters.dietaryRestrictions.length > 0) count++\n88 +  //   if (filters.allergens.length > 0) count++\n89 +  //   if (filters.cuisines.length > 0) count++\n90 +  //   if (filters.majorConditions.length > 0) count++\n91 +  //   if (filters.calories[0] > 0 || filters.calories[1] < 1200) count++\n92 +  //   if (filters.proteinMin > 0) count++\n93 +  //   if (filters.carbsMin > 0) count++\n94 +  //   if (filters.fatMin > 0) count++\n95 +  //   if (filters.fiberMin > 0) count++\n96 +  //   if (filters.sugarMax < 100) count++\n97 +  //   if (filters.sodiumMax < 4000) count++\n98 +  //   if (filters.maxTime < 120) count++\n99 +  //   if (filters.mealType) count++\n100 +  //   return count\n101 +  // }, [filters])\n102    const activeFilterCount = useMemo(() => {\n103 +    let count = 0;\n104 +\n105 +  // Sum all selected array filters\n106 +    count += filters.dietaryRestrictions.length;\n107 +    count += filters.allergens.length;\n108 +    count += filters.cuisines.length;\n109 +    count += filters.majorConditions.length;\n110 +\n111 +    // Range and min/max filters\n112 +    if (filters.calories[0] > 0) count++; // Min calories\n113 +    if (filters.calories[1] < 1200) count++; // Max calories\n114 +    if (filters.proteinMin > 0) count++;\n115 +    if (filters.carbsMin > 0) count++;\n116 +    if (filters.fatMin > 0) count++;\n117 +    if (filters.fiberMin > 0) count++;\n118 +    if (filters.sugarMax < 100) count++;\n119 +    if (filters.sodiumMax < 4000) count++;\n120 +    if (filters.maxTime < 120) count++;\n121 +    \n122 +    // Single-value selection\n123 +    if (filters.mealType) count++;\n124 +\n125 +    return count;\n126 +  }, [filters]);\n127  \n128    const {\n129      data: searchResults = [],\n130      isLoading,\n__old hunk__\n       filters.fiberMin > 0 ||\n       filters.sugarMax < 100 ||\n       filters.sodiumMax < 4000 ||\n       filters.maxTime < 120 ||\n       !!filters.mealType\n     )\n   }, [filters])\n \n   const activeFilterCount = useMemo(() => {\n-    let count = 0\n-    if (filters.dietaryRestrictions.length > 0) count++\n-    if (filters.allergens.length > 0) count++\n-    if (filters.cuisines.length > 0) count++\n-    if (filters.majorConditions.length > 0) count++\n-    if (filters.calories[0] > 0 || filters.calories[1] < 1200) count++\n-    if (filters.proteinMin > 0) count++\n-    if (filters.carbsMin > 0) count++\n-    if (filters.fatMin > 0) count++\n-    if (filters.fiberMin > 0) count++\n-    if (filters.sugarMax < 100) count++\n-    if (filters.sodiumMax < 4000) count++\n-    if (filters.maxTime < 120) count++\n-    if (filters.mealType) count++\n-    return count\n-  }, [filters])\n \n   const {\n     data: searchResults = [],\n     isLoading,\n\n@@ -113,12 +140,22 @@ export default function SearchPage() {\n__new hunk__\n140          const rankedResults = rank(rawResults, settings)\n141          return rankedResults\n142        }\n143  \n144        return rawResults.map((recipe) => ({ ...recipe, score: 0 }))\n145      },\n146      enabled: !!(searchQuery || hasActiveFilters),\n147    })\n148 +  const handleSearchInputKeyDown = (e: React.KeyboardEvent<HTMLInputElement>) => {\n149 +    if (e.key === \"Escape\" && searchQuery) {\n150 +      setSearchQuery(\"\");\n151 +      inputRef.current?.focus();\n152 +    }\n153 +    if (e.key === \"Enter\") {\n154 +      handleSearch(searchQuery);\n155 +    }\n156 +  };\n157 +\n158  \n159    const handleSearch = (query: string) => {\n160      setSearchQuery(query)\n161      setFilters({ ...filters, q: query })\n\n@@ -182,13 +219,13 @@ export default function SearchPage() {\n__new hunk__\n219    return (\n220      <div className=\"container px-4 py-6 max-w-6xl\">\n221        <div className=\"space-y-6\">\n222          {/* Search Header */}\n223          <div className=\"space-y-4\">\n224            <h1 className=\"text-3xl font-bold\">Search Recipes</h1>\n225  \n226            {/* Search Input */}\n227 +          {/* <div className=\"relative\">\n228              <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n229              <Input\n230                role=\"search\"\n231                placeholder=\"Search recipes, ingredients, cuisines...\"\n__old hunk__\n   return (\n     <div className=\"container px-4 py-6 max-w-6xl\">\n       <div className=\"space-y-6\">\n         {/* Search Header */}\n         <div className=\"space-y-4\">\n           <h1 className=\"text-3xl font-bold\">Search Recipes</h1>\n \n           {/* Search Input */}\n-          <div className=\"relative\">\n             <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n             <Input\n               role=\"search\"\n               placeholder=\"Search recipes, ingredients, cuisines...\"\n\n@@ -192,14 +229,51 @@ export default function SearchPage() {\n__new hunk__\n229              <Input\n230                role=\"search\"\n231                placeholder=\"Search recipes, ingredients, cuisines...\"\n232                value={searchQuery}\n233                onChange={(e) => setSearchQuery(e.target.value)}\n234                onKeyDown={(e) => e.key === \"Enter\" && handleSearch(searchQuery)}\n235                className=\"pl-10 pr-4 h-12 text-lg\"\n236              />\n237 +          </div> */}\n238 +          <div style={{ position: \"relative\", display: \"inline-block\", width: \"100%\" }}>\n239 +            <Search style={{ position: \"absolute\", left: \"0.75rem\", top: \"50%\", transform: \"translateY(-50%)\", height: \"1rem\", width: \"1rem\", color: \"gray\" }} />\n240 +            <Input\n241 +              role=\"search\"\n242 +              ref={inputRef}\n243 +              placeholder=\"Search recipes, ingredients, cuisines...\"\n244 +              value={searchQuery}\n245 +              onChange={(e) => setSearchQuery(e.target.value)}\n246 +              onKeyDown={handleSearchInputKeyDown}\n247 +              style={{ paddingRight: searchQuery ? \"2rem\" : undefined, width: \"100%\" }}\n248 +              className=\"pl-10 pr-4 h-12 text-lg\"\n249 +            />\n250 +            {searchQuery && (\n251 +              <button\n252 +                type=\"button\"\n253 +                style={{\n254 +                  position: \"absolute\",\n255 +                  right: \"0.75rem\",\n256 +                  top: \"50%\",\n257 +                  transform: \"translateY(-50%)\",\n258 +                  background: \"none\",\n259 +                  border: \"none\",\n260 +                  cursor: \"pointer\",\n261 +                  padding: 0,\n262 +                  color: \"gray\",\n263 +                }}\n264 +                aria-label=\"Clear search\"\n265 +                onClick={() => {\n266 +                  setSearchQuery(\"\");\n267 +                  inputRef.current?.focus();\n268 +              }}\n269 +              >\n270 +                <X size={20} />\n271 +            </button>\n272 +          )}\n273            </div>\n274  \n275 +\n276            {/* Search Actions */}\n277            <div className=\"flex items-center gap-2\">\n278              <Button onClick={() => handleSearch(searchQuery)} size=\"sm\">\n279                Search\n\n\n## File: 'components/filter-panel.tsx'\n\n@@ -54,35 +54,58 @@\n__new hunk__\n54  export function FilterPanel({ open, onOpenChange, initialValues, onApply, onReset }: FilterPanelProps) {\n55    const form = useForm<FiltersFormInput>({\n56      resolver: zodResolver(schema),\n57      // provide full defaults (OUTPUT fits into INPUT just fine)\n58      defaultValues: schema.parse(initialValues ?? {}),\n59      mode: \"onChange\",\n60    })\n61  \n62     useEffect(() => {\n63      form.reset(schema.parse(initialValues ?? {}));\n64    }, [open, initialValues, form]);\n65  \n66 +  // function getActiveFiltersCount(): number {\n67 +  //   const values = form.getValues()\n68 +  //   let count = 0\n69 +  //   if ((values.dietaryRestrictions || []).length > 0) count++\n70 +  //   if ((values.allergens || []).length > 0) count++\n71 +  //   if ((values.cuisines || []).length > 0) count++\n72 +  //   if ((values.majorConditions || []).length > 0) count++\n73 +  //   if (values.calories && (values.calories[0] > 0 || values.calories[1] < 1200)) count++\n74 +  //   if ((values.proteinMin || 0) > 0) count++\n75 +  //   if ((values.carbsMin || 0) > 0) count++\n76 +  //   if ((values.fatMin || 0) > 0) count++\n77 +  //   if ((values.fiberMin || 0) > 0) count++\n78 +  //   if ((values.sugarMax || 100) < 100) count++\n79 +  //   if ((values.sodiumMax || 4000) < 4000) count++\n80 +  //   2025-12-10T02:20:08.341044774Z if ((values.maxTime || 120) < 120) count++\n81 +  //   if ((values.mealType || \"\") !== \"\") count++\n82 +  //   return count\n83 +  // }\n84    function getActiveFiltersCount(): number {\n85 +    const values = form.getValues();\n86 +    let count = 0;\n87 +\n88 +    // Count all selected array filters individually\n89 +    count += values.dietaryRestrictions.length;\n90 +    count += values.allergens.length;\n91 +    count += values.cuisines.length;\n92 +    count += values.majorConditions.length;\n93 +\n94 +    // Numeric and single-value filters\n95 +    if (values.calories[0] > 0) count++;           // Min calories\n96 +    if (values.calories[1] < 1200) count++;        // Max calories\n97 +    if (values.proteinMin > 0) count++;\n98 +    if (values.carbsMin > 0) count++;\n99 +    if (values.fatMin > 0) count++;\n100 +    if (values.fiberMin > 0) count++;\n101 +    if (values.sugarMax < 100) count++;\n102 +    if (values.sodiumMax < 4000) count++;\n103 +    if (values.maxTime < 120) count++;\n104 +    if (values.mealType) count++;\n105 +\n106 +    return count;\n107    }\n108    function handleApply() {\n109      const values = schema.parse(form.getValues())\n110      onApply(values)\n111      onOpenChange(false)\n__old hunk__\n export function FilterPanel({ open, onOpenChange, initialValues, onApply, onReset }: FilterPanelProps) {\n   const form = useForm<FiltersFormInput>({\n     resolver: zodResolver(schema),\n     // provide full defaults (OUTPUT fits into INPUT just fine)\n     defaultValues: schema.parse(initialValues ?? {}),\n     mode: \"onChange\",\n   })\n \n    useEffect(() => {\n     form.reset(schema.parse(initialValues ?? {}));\n   }, [open, initialValues, form]);\n \n   function getActiveFiltersCount(): number {\n-    const values = form.getValues()\n-    let count = 0\n-    if ((values.dietaryRestrictions || []).length > 0) count++\n-    if ((values.allergens || []).length > 0) count++\n-    if ((values.cuisines || []).length > 0) count++\n-    if ((values.majorConditions || []).length > 0) count++\n-    if (values.calories && (values.calories[0] > 0 || values.calories[1] < 1200)) count++\n-    if ((values.proteinMin || 0) > 0) count++\n-    if ((values.carbsMin || 0) > 0) count++\n-    if ((values.fatMin || 0) > 0) count++\n-    if ((values.fiberMin || 0) > 0) count++\n-    if ((values.sugarMax || 100) < 100) count++\n-    if ((values.sodiumMax || 4000) < 4000) count++\n-    if ((values.maxTime || 120) < 120) count++\n-    if ((values.mealType || \"\") !== \"\") count++\n-    return count\n   }\n-\n   function handleApply() {\n     const values = schema.parse(form.getValues())\n     onApply(values)\n     onOpenChange(false)\n======\n\n\nResponse (should be a valid YAML, and nothing else):\n```yaml"}}, "file": {"name": "litellm_ai_handler.py", "path": "/app/pr_agent/algo/ai_handlers/litellm_ai_handler.py"}, "function": "chat_completion", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 388, "message": "Prompts", "module": "litellm_ai_handler", "name": "pr_agent.algo.ai_handlers.litellm_ai_handler", "process": {"id": 13, "name": "MainProcess"}, "thread": {"id": 131770084559744, "name": "MainThread"}, "time": {"repr": "2025-12-10 02:20:08.340361+00:00", "timestamp": 1765333208.340361}}}
2025-12-10T02:20:08.345060638Z 
2025-12-10T02:20:08.345132596Z Provider List: https://docs.litellm.ai/docs/providers
2025-12-10T02:20:08.345137114Z 
2025-12-10T02:20:08.345139988Z {"text": "Error during LLM inference: litellm.BadRequestError: LLM Provider NOT provided. Pass in the LLM provider you are trying to call. You passed model=\\openai/gpt-5-nano\\\n Pass model as E.g. For 'Huggingface' inference endpoints pass in `completion(model='huggingface/starcoder',..)` Learn more: https://docs.litellm.ai/docs/providers\n", "record": {"elapsed": {"repr": "0:00:43.416497", "seconds": 43.416497}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "f7c570913c05466698e4b2771b7b02c2", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "litellm_ai_handler.py", "path": "/app/pr_agent/algo/ai_handlers/litellm_ai_handler.py"}, "function": "chat_completion", "level": {"icon": "âš ï¸", "name": "WARNING", "no": 30}, "line": 401, "message": "Error during LLM inference: litellm.BadRequestError: LLM Provider NOT provided. Pass in the LLM provider you are trying to call. You passed model=\\openai/gpt-5-nano\\\n Pass model as E.g. For 'Huggingface' inference endpoints pass in `completion(model='huggingface/starcoder',..)` Learn more: https://docs.litellm.ai/docs/providers", "module": "litellm_ai_handler", "name": "pr_agent.algo.ai_handlers.litellm_ai_handler", "process": {"id": 13, "name": "MainProcess"}, "thread": {"id": 131770084559744, "name": "MainThread"}, "time": {"repr": "2025-12-10 02:20:08.344552+00:00", "timestamp": 1765333208.344552}}}
2025-12-10T02:20:08.347641138Z {"text": "Prompts\n", "record": {"elapsed": {"repr": "0:00:43.418945", "seconds": 43.418945}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "f7c570913c05466698e4b2771b7b02c2", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "artifact": {"system": "You are PR-Reviewer, a language model designed to review a Git Pull Request (PR).\nYour task is to provide constructive and concise feedback for the PR.\nThe review should focus on new code added in the PR code diff (lines starting with '+')\n\n\nThe format we will use to present the PR code diff:\n======\n## File: 'src/file1.py'\n\n\n@@ ... @@ def func1():\n__new hunk__\n11  unchanged code line0\n12  unchanged code line1\n13 +new code line2 added\n14  unchanged code line3\n__old hunk__\n unchanged code line0\n unchanged code line1\n-old code line2 removed\n unchanged code line3\n\n@@ ... @@ def func2():\n__new hunk__\n unchanged code line4\n+new code line5 added\n unchanged code line6\n\n## File: 'src/file2.py'\n...\n======\n\n- In the format above, the diff is organized into separate '__new hunk__' and '__old hunk__' sections for each code chunk. '__new hunk__' contains the updated code, while '__old hunk__' shows the removed code. If no code was removed in a specific chunk, the __old hunk__ section will be omitted.\n- We also added line numbers for the '__new hunk__' code, to help you refer to the code lines in your suggestions. These line numbers are not part of the actual code, and should only be used for reference.\n- Code lines are prefixed with symbols ('+', '-', ' '). The '+' symbol indicates new code added in the PR, the '-' symbol indicates code removed in the PR, and the ' ' symbol indicates unchanged code. The review should address new code added in the PR code diff (lines starting with '+').\n- When quoting variables, names or file paths from the code, use backticks (`) instead of single quote (').\n- Note that you only see changed code segments (diff hunks in a PR), not the entire codebase. Avoid suggestions that might duplicate existing functionality or questioning code elements (like variables declarations or import statements) that may be defined elsewhere in the codebase.\n- Also note that if the code ends at an opening brace or statement that begins a new scope (like 'if', 'for', 'try'), don't treat it as incomplete. Instead, acknowledge the visible scope boundary and analyze only the code shown.\n\n\nThe output must be a YAML object equivalent to type $PRReview, according to the following Pydantic definitions:\n=====\n\nclass KeyIssuesComponentLink(BaseModel):\n    relevant_file: str = Field(description=\"The full file path of the relevant file\")\n    issue_header: str = Field(description=\"One or two word title for the issue. For example: 'Possible Bug', etc.\")\n    issue_content: str = Field(description=\"A short and concise summary of what should be further inspected and validated during the PR review process for this issue. Do not mention line numbers in this field.\")\n    start_line: int = Field(description=\"The start line that corresponds to this issue in the relevant file\")\n    end_line: int = Field(description=\"The end line that corresponds to this issue in the relevant file\")\n\nclass Review(BaseModel):\n    estimated_effort_to_review_[1-5]: int = Field(description=\"Estimate, on a scale of 1-5 (inclusive), the time and effort required to review this PR by an experienced and knowledgeable developer. 1 means short and easy review , 5 means long and hard review. Take into account the size, complexity, quality, and the needed changes of the PR code diff.\")\n    relevant_tests: str = Field(description=\"yes/no question: does this PR have relevant tests added or updated ?\")\n    key_issues_to_review: List[KeyIssuesComponentLink] = Field(\"A short and diverse list (0-3 issues) of high-priority bugs, problems or performance concerns introduced in the PR code, which the PR reviewer should further focus on and validate during the review process.\")\n    security_concerns: str = Field(description=\"Does this PR code introduce vulnerabilities such as exposure of sensitive information (e.g., API keys, secrets, passwords), or security concerns like SQL injection, XSS, CSRF, and others ? Answer 'No' (without explaining why) if there are no possible issues. If there are security concerns or issues, start your answer with a short header, such as: 'Sensitive information exposure: ...', 'SQL injection: ...', etc. Explain your answer. Be specific and give examples if possible\")\n\nclass PRReview(BaseModel):\n    review: Review\n=====\n\n\nExample output:\n```yaml\nreview:\n  estimated_effort_to_review_[1-5]: |\n    3\n  relevant_tests: |\n    No\n  key_issues_to_review:\n    - relevant_file: |\n        directory/xxx.py\n      issue_header: |\n        Possible Bug\n      issue_content: |\n        ...\n      start_line: 12\n      end_line: 14\n    - ...\n  security_concerns: |\n    No\n```\n\nAnswer should be a valid YAML, and nothing else. Each YAML output MUST be after a newline, with proper indent, and block scalar indicator ('|')", "user": "\n\n\n--PR Info--\n\nToday's Date: 2025-12-10\n\nTitle: 'Fix: Search UX and multi-filter logic (frontend)'\n\nBranch: 'feature/initial-fixes'\n\nPR Description:\n======\n- Improved search bar UX in app/search/page.tsx:\r\n  - X icon clears input and refocuses\r\n  - Escape key clears input\r\n  - Enter key triggers search\r\n\r\n- Updated filter count logic:\r\n  - Accurately counts all active filters\r\n  - Apply button badge reflects true total\n======\n\n\nThe PR code diff:\n======\n## File: 'app/search/page.tsx'\n\n@@ -1,7 +1,8 @@\n__new hunk__\n1  \"use client\"\n2  \n3 +import { useState, useEffect, useMemo, useRef } from \"react\"\n4 +// import { X } from \"lucide-react\"\n5  import { useSearchParams, useRouter } from \"next/navigation\"\n6  import { useQuery } from \"@tanstack/react-query\"\n7  import { Input } from \"@/components/ui/input\"\n8  import { Button } from \"@/components/ui/button\"\n__old hunk__\n \"use client\"\n \n-import { useState, useEffect, useMemo } from \"react\"\n import { useSearchParams, useRouter } from \"next/navigation\"\n import { useQuery } from \"@tanstack/react-query\"\n import { Input } from \"@/components/ui/input\"\n import { Button } from \"@/components/ui/button\"\n\n@@ -41,11 +42,12 @@\n__new hunk__\n42  export default function SearchPage() {\n43    const searchParams = useSearchParams()\n44    const router = useRouter()\n45    const { filters, setFilters, resetFilters } = useFilters()\n46    const { settings } = useSettings()\n47  \n48    const [searchQuery, setSearchQuery] = useState(searchParams.get(\"q\") || filters.q || \"\")\n49 +  const inputRef = useRef<HTMLInputElement>(null);\n50    const [sortBy, setSortBy] = useState<SortOption>(settings.behavior.defaultSort || \"time\")\n51    const [filtersOpen, setFiltersOpen] = useState(false)\n52  \n53    // Update search query from URL params\n\n@@ -75,29 +77,54 @@ export default function SearchPage() {\n__new hunk__\n77        filters.fiberMin > 0 ||\n78        filters.sugarMax < 100 ||\n79        filters.sodiumMax < 4000 ||\n80        filters.maxTime < 120 ||\n81        !!filters.mealType\n82      )\n83    }, [filters])\n84  \n85 +  // const activeFilterCount = useMemo(() => {\n86 +  //   let count = 0\n87 +  //   if (filters.dietaryRestrictions.length > 0) count++\n88 +  //   if (filters.allergens.length > 0) count++\n89 +  //   if (filters.cuisines.length > 0) count++\n90 +  //   if (filters.majorConditions.length > 0) count++\n91 +  //   if (filters.calories[0] > 0 || filters.calories[1] < 1200) count++\n92 +  //   if (filters.proteinMin > 0) count++\n93 +  //   if (filters.carbsMin > 0) count++\n94 +  //   if (filters.fatMin > 0) count++\n95 +  //   if (filters.fiberMin > 0) count++\n96 +  //   if (filters.sugarMax < 100) count++\n97 +  //   if (filters.sodiumMax < 4000) count++\n98 +  //   if (filters.maxTime < 120) count++\n99 +  //   if (filters.mealType) count++\n100 +  //   return count\n101 +  // }, [filters])\n102    const activeFilterCount = useMemo(() => {\n103 +    let count = 0;\n104 +\n105 +  // Sum all selected array filters\n106 +    count += filters.dietaryRestrictions.length;\n107 +    count += filters.allergens.length;\n108 +    count += filters.cuisines.length;\n109 +    count += filters.majorConditions.length;\n110 +\n111 +    // Range and min/max filters\n112 +    if (filters.calories[0] > 0) count++; // Min calories\n113 +    if (filters.calories[1] < 1200) count++; // Max calories\n114 +    if (filters.proteinMin > 0) count++;\n115 +    if (filters.carbsMin > 0) count++;\n116 +    if (filters.fatMin > 0) count++;\n117 +    if (filters.fiberMin > 0) count++;\n118 +    if (filters.sugarMax < 100) count++;\n119 +    if (filters.sodiumMax < 4000) count++;\n120 +    if (filters.maxTime < 120) count++;\n121 +    \n122 +    // Single-value selection\n123 +    if (filters.mealType) count++;\n124 +\n125 +    return count;\n126 +  }, [filters]);\n127  \n128    const {\n129      data: searchResults = [],\n130      isLoading,\n__old hunk__\n       filters.fiberMin > 0 ||\n       filters.sugarMax < 100 ||\n       filters.sodiumMax < 4000 ||\n       filters.maxTime < 120 ||\n       !!filters.mealType\n     )\n   }, [filters])\n \n   const activeFilterCount = useMemo(() => {\n-    let count = 0\n-    if (filters.dietaryRestrictions.length > 0) count++\n-    if (filters.allergens.length > 0) count++\n-    if (filters.cuisines.length > 0) count++\n-    if (filters.majorConditions.length > 0) count++\n-    if (filters.calories[0] > 0 || filters.calories[1] < 1200) count++\n-    if (filters.proteinMin > 0) count++\n-    if (filters.carbsMin > 0) count++\n-    if (filters.fatMin > 0) count++\n-    if (filters.fiberMin > 0) count++\n-    if (filters.sugarMax < 100) count++\n-    if (filters.sodiumMax < 4000) count++\n-    if (filters.maxTime < 120) count++\n-    if (filters.mealType) count++\n-    return count\n-  }, [filters])\n \n   const {\n     data: searchResults = [],\n     isLoading,\n\n@@ -113,12 +140,22 @@ export default function SearchPage() {\n__new hunk__\n140          const rankedResults = rank(rawResults, settings)\n141          return rankedResults\n142        }\n143  \n144        return rawResults.map((recipe) => ({ ...recipe, score: 0 }))\n145      },\n146      enabled: !!(searchQuery || hasActiveFilters),\n147    })\n148 +  const handleSearchInputKeyDown = (e: React.KeyboardEvent<HTMLInputElement>) => {\n149 +    if (e.key === \"Escape\" && searchQuery) {\n150 +      setSearchQuery(\"\");\n151 +      inputRef.current?.focus();\n152 +    }\n153 +    if (e.key === \"Enter\") {\n154 +      handleSearch(searchQuery);\n155 +    }\n156 +  };\n157 +\n158  \n159    const handleSearch = (query: string) => {\n160      setSearchQuery(query)\n161      setFilters({ ...filters, q: query })\n\n@@ -182,13 +219,13 @@ export default function SearchPage() {\n__new hunk__\n219    return (\n220      <div className=\"container px-4 py-6 max-w-6xl\">\n221        <div className=\"space-y-6\">\n222          {/* Search Header */}\n223          <div className=\"space-y-4\">\n224            <h1 className=\"text-3xl font-bold\">Search Recipes</h1>\n225  \n226            {/* Search Input */}\n227 +          {/* <div className=\"relative\">\n228              <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n229              <Input\n230                role=\"search\"\n231                placeholder=\"Search recipes, ingredients, cuisines...\"\n__old hunk__\n   return (\n     <div className=\"container px-4 py-6 max-w-6xl\">\n       <div className=\"space-y-6\">\n         {/* Search Header */}\n         <div className=\"space-y-4\">\n           <h1 className=\"text-3xl font-bold\">Search Recipes</h1>\n \n           {/* Search Input */}\n-          <div className=\"relative\">\n             <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n             <Input\n               role=\"search\"\n               placeholder=\"Search recipes, ingredients, cuisines...\"\n\n@@ -192,14 +229,51 @@ export default function SearchPage() {\n__new hunk__\n229              <Input\n230                role=\"search\"\n231                placeholder=\"Search recipes, ingredients, cuisines...\"\n232                value={searchQuery}\n233                onChange={(e) => setSearchQuery(e.target.value)}\n234                onKeyDown={(e) => e.key === \"Enter\" && handleSearch(searchQuery)}\n235                className=\"pl-10 pr-4 h-12 text-lg\"\n236              />\n237 +          </div> */}\n238 +          <div style={{ position: \"relative\", display: \"inline-block\", width: \"100%\" }}>\n239 +            <Search style={{ position: \"absolute\", left: \"0.75rem\", top: \"50%\", transform: \"translateY(-50%)\", height: \"1rem\", width: \"1rem\", color: \"gray\" }} />\n240 +            <Input\n241 +              role=\"search\"\n242 +              ref={inputRef}\n243 +              placeholder=\"Search recipes, ingredients, cuisines...\"\n244 +              value={searchQuery}\n245 +              onChange={(e) => setSearchQuery(e.target.value)}\n246 +              onKeyDown={handleSearchInputKeyDown}\n247 +              style={{ paddingRight: searchQuery ? \"2rem\" : undefined, width: \"100%\" }}\n248 +              className=\"pl-10 pr-4 h-12 text-lg\"\n249 +            />\n250 +            {searchQuery && (\n251 +              <button\n252 +                type=\"button\"\n253 +                style={{\n254 +                  position: \"absolute\",\n255 +                  right: \"0.75rem\",\n256 +                  top: \"50%\",\n257 +                  transform: \"translateY(-50%)\",\n258 +                  background: \"none\",\n259 +                  border: \"none\",\n260 +                  cursor: \"pointer\",\n261 +                  padding: 0,\n262 +                  color: \"gray\",\n263 +                }}\n264 +                aria-label=\"Clear search\"\n265 +                onClick={() => {\n266 +                  setSearchQuery(\"\");\n267 +                  inputRef.current?.focus();\n268 +              }}\n269 +              >\n270 +                <X size={20} />\n271 +            </button>\n272 +          )}\n273            </div>\n274  \n275 +\n276            {/* Search Actions */}\n277            <div className=\"flex items-center gap-2\">\n278              <Button onClick={() => handleSearch(searchQuery)} size=\"sm\">\n279                Search\n\n\n## File: 'components/filter-panel.tsx'\n\n@@ -54,35 +54,58 @@\n__new hunk__\n54  export function FilterPanel({ open, onOpenChange, initialValues, onApply, onReset }: FilterPanelProps) {\n55    const form = useForm<FiltersFormInput>({\n56      resolver: zodResolver(schema),\n57      // provide full defaults (OUTPUT fits into INPUT just fine)\n58      defaultValues: schema.parse(initialValues ?? {}),\n59      mode: \"onChange\",\n60    })\n61  \n62     useEffect(() => {\n63      form.reset(schema.parse(initialValues ?? {}));\n64    }, [open, initialValues, form]);\n65  \n66 +  // function getActiveFiltersCount(): number {\n67 +  //   const values = form.getValues()\n68 +  //   let count = 0\n69 +  //   if ((values.dietaryRestrictions || []).length > 0) count++\n70 +  //   if ((values.allergens || []).length > 0) count++\n71 +  //   if ((values.cuisines || []).length > 0) count++\n72 +  //   if ((values.majorConditions || []).length > 0) count++\n73 +  //   if (values.calories && (values.calories[0] > 0 || values.calories[1] < 1200)) count++\n74 +  //   if ((values.proteinMin || 0) > 0) count++\n75 +  //   if ((values.carbsMin || 0) > 0) count++\n76 +  //   if ((values.fatMin || 0) > 0) count++\n77 +  //   if ((values.fiberMin || 0) > 0) count++\n78 +  //   if ((values.sugarMax || 100) < 100) count++\n79 +  //   if ((values.sodiumMax || 4000) < 4000) count++\n80 +  //   2025-12-10T02:20:08.347641138Z if ((values.maxTime || 120) < 120) count++\n81 +  //   if ((values.mealType || \"\") !== \"\") count++\n82 +  //   return count\n83 +  // }\n84    function getActiveFiltersCount(): number {\n85 +    const values = form.getValues();\n86 +    let count = 0;\n87 +\n88 +    // Count all selected array filters individually\n89 +    count += values.dietaryRestrictions.length;\n90 +    count += values.allergens.length;\n91 +    count += values.cuisines.length;\n92 +    count += values.majorConditions.length;\n93 +\n94 +    // Numeric and single-value filters\n95 +    if (values.calories[0] > 0) count++;           // Min calories\n96 +    if (values.calories[1] < 1200) count++;        // Max calories\n97 +    if (values.proteinMin > 0) count++;\n98 +    if (values.carbsMin > 0) count++;\n99 +    if (values.fatMin > 0) count++;\n100 +    if (values.fiberMin > 0) count++;\n101 +    if (values.sugarMax < 100) count++;\n102 +    if (values.sodiumMax < 4000) count++;\n103 +    if (values.maxTime < 120) count++;\n104 +    if (values.mealType) count++;\n105 +\n106 +    return count;\n107    }\n108    function handleApply() {\n109      const values = schema.parse(form.getValues())\n110      onApply(values)\n111      onOpenChange(false)\n__old hunk__\n export function FilterPanel({ open, onOpenChange, initialValues, onApply, onReset }: FilterPanelProps) {\n   const form = useForm<FiltersFormInput>({\n     resolver: zodResolver(schema),\n     // provide full defaults (OUTPUT fits into INPUT just fine)\n     defaultValues: schema.parse(initialValues ?? {}),\n     mode: \"onChange\",\n   })\n \n    useEffect(() => {\n     form.reset(schema.parse(initialValues ?? {}));\n   }, [open, initialValues, form]);\n \n   function getActiveFiltersCount(): number {\n-    const values = form.getValues()\n-    let count = 0\n-    if ((values.dietaryRestrictions || []).length > 0) count++\n-    if ((values.allergens || []).length > 0) count++\n-    if ((values.cuisines || []).length > 0) count++\n-    if ((values.majorConditions || []).length > 0) count++\n-    if (values.calories && (values.calories[0] > 0 || values.calories[1] < 1200)) count++\n-    if ((values.proteinMin || 0) > 0) count++\n-    if ((values.carbsMin || 0) > 0) count++\n-    if ((values.fatMin || 0) > 0) count++\n-    if ((values.fiberMin || 0) > 0) count++\n-    if ((values.sugarMax || 100) < 100) count++\n-    if ((values.sodiumMax || 4000) < 4000) count++\n-    if ((values.maxTime || 120) < 120) count++\n-    if ((values.mealType || \"\") !== \"\") count++\n-    return count\n   }\n-\n   function handleApply() {\n     const values = schema.parse(form.getValues())\n     onApply(values)\n     onOpenChange(false)\n======\n\n\nResponse (should be a valid YAML, and nothing else):\n```yaml"}}, "file": {"name": "litellm_ai_handler.py", "path": "/app/pr_agent/algo/ai_handlers/litellm_ai_handler.py"}, "function": "chat_completion", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 388, "message": "Prompts", "module": "litellm_ai_handler", "name": "pr_agent.algo.ai_handlers.litellm_ai_handler", "process": {"id": 13, "name": "MainProcess"}, "thread": {"id": 131770084559744, "name": "MainThread"}, "time": {"repr": "2025-12-10 02:20:08.347000+00:00", "timestamp": 1765333208.347}}}
2025-12-10T02:20:08.351559996Z 
2025-12-10T02:20:08.351785506Z Provider List: https://docs.litellm.ai/docs/providers
2025-12-10T02:20:08.351790353Z 
2025-12-10T02:20:08.351793167Z {"text": "Error during LLM inference: litellm.BadRequestError: LLM Provider NOT provided. Pass in the LLM provider you are trying to call. You passed model=\\openai/gpt-5-nano\\\n Pass model as E.g. For 'Huggingface' inference endpoints pass in `completion(model='huggingface/starcoder',..)` Learn more: https://docs.litellm.ai/docs/providers\n", "record": {"elapsed": {"repr": "0:00:43.422938", "seconds": 43.422938}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "f7c570913c05466698e4b2771b7b02c2", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "litellm_ai_handler.py", "path": "/app/pr_agent/algo/ai_handlers/litellm_ai_handler.py"}, "function": "chat_completion", "level": {"icon": "âš ï¸", "name": "WARNING", "no": 30}, "line": 401, "message": "Error during LLM inference: litellm.BadRequestError: LLM Provider NOT provided. Pass in the LLM provider you are trying to call. You passed model=\\openai/gpt-5-nano\\\n Pass model as E.g. For 'Huggingface' inference endpoints pass in `completion(model='huggingface/starcoder',..)` Learn more: https://docs.litellm.ai/docs/providers", "module": "litellm_ai_handler", "name": "pr_agent.algo.ai_handlers.litellm_ai_handler", "process": {"id": 13, "name": "MainProcess"}, "thread": {"id": 131770084559744, "name": "MainThread"}, "time": {"repr": "2025-12-10 02:20:08.350993+00:00", "timestamp": 1765333208.350993}}}
2025-12-10T02:20:08.351804945Z {"text": "Failed to generate prediction with \\openai/gpt-5-nano\\\n", "record": {"elapsed": {"repr": "0:00:43.423258", "seconds": 43.423258}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "f7c570913c05466698e4b2771b7b02c2", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "artifact": {"error": "RetryError[<Future at 0x77d8159b0140 state=finished raised BadRequestError>]"}}, "file": {"name": "pr_processing.py", "path": "/app/pr_agent/algo/pr_processing.py"}, "function": "retry_with_fallback_models", "level": {"icon": "âš ï¸", "name": "WARNING", "no": 30}, "line": 333, "message": "Failed to generate prediction with \\openai/gpt-5-nano\\", "module": "pr_processing", "name": "pr_agent.algo.pr_processing", "process": {"id": 13, "name": "MainProcess"}, "thread": {"id": 131770084559744, "name": "MainThread"}, "time": {"repr": "2025-12-10 02:20:08.351313+00:00", "timestamp": 1765333208.351313}}}
2025-12-10T02:20:08.351855110Z {"text": "Failed to review PR: Failed to generate prediction with any model of ['openai/gpt-5.1', '\\\\openai/gpt-5\\\\', '\\\\openai/gpt-5-nano\\\\']\n", "record": {"elapsed": {"repr": "0:00:43.423388", "seconds": 43.423388}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "f7c570913c05466698e4b2771b7b02c2", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "pr_reviewer.py", "path": "/app/pr_agent/tools/pr_reviewer.py"}, "function": "run", "level": {"icon": "âŒ", "name": "ERROR", "no": 40}, "line": 184, "message": "Failed to review PR: Failed to generate prediction with any model of ['openai/gpt-5.1', '\\\\openai/gpt-5\\\\', '\\\\openai/gpt-5-nano\\\\']", "module": "pr_reviewer", "name": "pr_agent.tools.pr_reviewer", "process": {"id": 13, "name": "MainProcess"}, "thread": {"id": 131770084559744, "name": "MainThread"}, "time": {"repr": "2025-12-10 02:20:08.351443+00:00", "timestamp": 1765333208.351443}}}