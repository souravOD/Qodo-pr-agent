
2025-12-10T00:22:36.133978839Z [2025-12-10 00:22:36 +0000] [1] [INFO] Starting gunicorn 23.0.0
2025-12-10T00:22:36.134288435Z [2025-12-10 00:22:36 +0000] [1] [INFO] Listening at: http://0.0.0.0:3000 (1)
2025-12-10T00:22:36.134421897Z [2025-12-10 00:22:36 +0000] [1] [INFO] Using worker: uvicorn.workers.UvicornWorker
2025-12-10T00:22:36.141513883Z [2025-12-10 00:22:36 +0000] [7] [INFO] Booting worker with pid: 7
2025-12-10T00:22:36.227972297Z [2025-12-10 00:22:36 +0000] [8] [INFO] Booting worker with pid: 8
2025-12-10T00:22:36.243957925Z [2025-12-10 00:22:36 +0000] [9] [INFO] Booting worker with pid: 9
2025-12-10T00:22:36.308974508Z [2025-12-10 00:22:36 +0000] [10] [INFO] Booting worker with pid: 10
2025-12-10T00:22:36.364706921Z [2025-12-10 00:22:36 +0000] [11] [INFO] Booting worker with pid: 11
2025-12-10T00:22:36.453978855Z [2025-12-10 00:22:36 +0000] [12] [INFO] Booting worker with pid: 12
2025-12-10T00:22:36.470075551Z [2025-12-10 00:22:36 +0000] [13] [INFO] Booting worker with pid: 13
2025-12-10T00:22:36.552704323Z [2025-12-10 00:22:36 +0000] [14] [INFO] Booting worker with pid: 14
2025-12-10T00:22:36.641322802Z [2025-12-10 00:22:36 +0000] [15] [INFO] Booting worker with pid: 15
2025-12-10T00:22:36.689960934Z [2025-12-10 00:22:36 +0000] [16] [INFO] Booting worker with pid: 16
2025-12-10T00:22:36.785930410Z [2025-12-10 00:22:36 +0000] [17] [INFO] Booting worker with pid: 17
2025-12-10T00:22:36.832213384Z [2025-12-10 00:22:36 +0000] [18] [INFO] Booting worker with pid: 18
2025-12-10T00:22:36.842196086Z [2025-12-10 00:22:36 +0000] [19] [INFO] Booting worker with pid: 19
2025-12-10T00:22:36.917308242Z [2025-12-10 00:22:36 +0000] [20] [INFO] Booting worker with pid: 20
2025-12-10T00:22:37.025993950Z [2025-12-10 00:22:37 +0000] [21] [INFO] Booting worker with pid: 21
2025-12-10T00:22:37.063327969Z [2025-12-10 00:22:37 +0000] [22] [INFO] Booting worker with pid: 22
2025-12-10T00:22:37.146451016Z [2025-12-10 00:22:37 +0000] [23] [INFO] Booting worker with pid: 23
2025-12-10T00:22:37.226436927Z [2025-12-10 00:22:37 +0000] [24] [INFO] Booting worker with pid: 24
2025-12-10T00:22:37.266116741Z [2025-12-10 00:22:37 +0000] [25] [INFO] Booting worker with pid: 25
2025-12-10T00:22:37.319984884Z [2025-12-10 00:22:37 +0000] [26] [INFO] Booting worker with pid: 26
2025-12-10T00:22:37.416219479Z [2025-12-10 00:22:37 +0000] [27] [INFO] Booting worker with pid: 27
2025-12-10T00:22:37.548390907Z [2025-12-10 00:22:37 +0000] [28] [INFO] Booting worker with pid: 28
2025-12-10T00:22:37.636002258Z [2025-12-10 00:22:37 +0000] [29] [INFO] Booting worker with pid: 29
2025-12-10T00:22:37.725939565Z [2025-12-10 00:22:37 +0000] [30] [INFO] Booting worker with pid: 30
2025-12-10T00:22:37.814436180Z [2025-12-10 00:22:37 +0000] [31] [INFO] Booting worker with pid: 31
2025-12-10T00:22:49.444984522Z /usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-12-10T00:22:49.445135549Z   import pkg_resources
2025-12-10T00:22:49.671569576Z /usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-12-10T00:22:49.671620061Z   import pkg_resources
2025-12-10T00:22:49.713557587Z /usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-12-10T00:22:49.713597057Z   import pkg_resources
2025-12-10T00:22:50.439954964Z /usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-12-10T00:22:50.440009727Z   import pkg_resources
2025-12-10T00:22:50.446069629Z /usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-12-10T00:22:50.446140245Z   import pkg_resources
2025-12-10T00:22:50.745573394Z /usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-12-10T00:22:50.745637572Z   import pkg_resources
2025-12-10T00:22:50.750247338Z /usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-12-10T00:22:50.750294899Z   import pkg_resources
2025-12-10T00:22:50.952396479Z 2025-12-10 00:22:50.949 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-12-10T00:22:50.952877784Z 2025-12-10 00:22:50.952 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-12-10T00:22:51.090046105Z 2025-12-10 00:22:51.082 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-12-10T00:22:51.090099937Z 2025-12-10 00:22:51.082 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-12-10T00:22:51.175643613Z 2025-12-10 00:22:51.174 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-12-10T00:22:51.175696223Z 2025-12-10 00:22:51.174 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-12-10T00:22:51.471580084Z [2025-12-10 00:22:51 +0000] [8] [INFO] Started server process [8]
2025-12-10T00:22:51.471621217Z [2025-12-10 00:22:51 +0000] [8] [INFO] Waiting for application startup.
2025-12-10T00:22:51.471624611Z [2025-12-10 00:22:51 +0000] [8] [INFO] Application startup complete.
2025-12-10T00:22:51.495963408Z 2025-12-10 00:22:51.477 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-12-10T00:22:51.496599516Z 2025-12-10 00:22:51.495 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-12-10T00:22:51.534850047Z /usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-12-10T00:22:51.534892290Z   import pkg_resources
2025-12-10T00:22:51.639006210Z [2025-12-10 00:22:51 +0000] [25] [INFO] Started server process [25]
2025-12-10T00:22:51.639090077Z [2025-12-10 00:22:51 +0000] [25] [INFO] Waiting for application startup.
2025-12-10T00:22:51.639094063Z [2025-12-10 00:22:51 +0000] [25] [INFO] Application startup complete.
2025-12-10T00:22:51.710797515Z /usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-12-10T00:22:51.710848992Z   import pkg_resources
2025-12-10T00:22:51.792287722Z 2025-12-10 00:22:51.757 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-12-10T00:22:51.792476808Z 2025-12-10 00:22:51.792 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-12-10T00:22:51.834107361Z [2025-12-10 00:22:51 +0000] [15] [INFO] Started server process [15]
2025-12-10T00:22:51.834152661Z [2025-12-10 00:22:51 +0000] [15] [INFO] Waiting for application startup.
2025-12-10T00:22:51.834156266Z [2025-12-10 00:22:51 +0000] [15] [INFO] Application startup complete.
2025-12-10T00:22:52.022966286Z /usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-12-10T00:22:52.023014879Z   import pkg_resources
2025-12-10T00:22:52.029089613Z /usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-12-10T00:22:52.029168462Z   import pkg_resources
2025-12-10T00:22:52.067019931Z 2025-12-10 00:22:52.066 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-12-10T00:22:52.067066301Z 2025-12-10 00:22:52.066 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-12-10T00:22:52.192852780Z [2025-12-10 00:22:52 +0000] [19] [INFO] Started server process [19]
2025-12-10T00:22:52.193032652Z [2025-12-10 00:22:52 +0000] [19] [INFO] Waiting for application startup.
2025-12-10T00:22:52.193040043Z [2025-12-10 00:22:52 +0000] [19] [INFO] Application startup complete.
2025-12-10T00:22:52.202331835Z [2025-12-10 00:22:52 +0000] [10] [INFO] Started server process [10]
2025-12-10T00:22:52.202364844Z [2025-12-10 00:22:52 +0000] [10] [INFO] Waiting for application startup.
2025-12-10T00:22:52.202520860Z [2025-12-10 00:22:52 +0000] [10] [INFO] Application startup complete.
2025-12-10T00:22:52.384392355Z /usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-12-10T00:22:52.384456060Z   import pkg_resources
2025-12-10T00:22:52.433637844Z 2025-12-10 00:22:52.433 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-12-10T00:22:52.433962513Z 2025-12-10 00:22:52.433 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-12-10T00:22:52.490265106Z /usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-12-10T00:22:52.490344535Z   import pkg_resources
2025-12-10T00:22:52.619898152Z /usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-12-10T00:22:52.619981648Z   import pkg_resources
2025-12-10T00:22:52.626214430Z /usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-12-10T00:22:52.626266458Z   import pkg_resources
2025-12-10T00:22:52.631420484Z [2025-12-10 00:22:52 +0000] [24] [INFO] Started server process [24]
2025-12-10T00:22:52.631880349Z [2025-12-10 00:22:52 +0000] [24] [INFO] Waiting for application startup.
2025-12-10T00:22:52.632316435Z [2025-12-10 00:22:52 +0000] [24] [INFO] Application startup complete.
2025-12-10T00:22:52.655310866Z 2025-12-10 00:22:52.654 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-12-10T00:22:52.655525920Z 2025-12-10 00:22:52.655 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-12-10T00:22:52.701445767Z [2025-12-10 00:22:52 +0000] [7] [INFO] Started server process [7]
2025-12-10T00:22:52.705158482Z [2025-12-10 00:22:52 +0000] [7] [INFO] Waiting for application startup.
2025-12-10T00:22:52.708464374Z [2025-12-10 00:22:52 +0000] [7] [INFO] Application startup complete.
2025-12-10T00:22:52.747082358Z 2025-12-10 00:22:52.746 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-12-10T00:22:52.747188608Z 2025-12-10 00:22:52.747 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-12-10T00:22:52.799530723Z [2025-12-10 00:22:52 +0000] [22] [INFO] Started server process [22]
2025-12-10T00:22:52.799582311Z [2025-12-10 00:22:52 +0000] [22] [INFO] Waiting for application startup.
2025-12-10T00:22:52.799877605Z [2025-12-10 00:22:52 +0000] [22] [INFO] Application startup complete.
2025-12-10T00:22:52.800414024Z /usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-12-10T00:22:52.800425211Z   import pkg_resources
2025-12-10T00:22:52.826376698Z /usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-12-10T00:22:52.826422927Z   import pkg_resources
2025-12-10T00:22:52.860691998Z /usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-12-10T00:22:52.860742434Z   import pkg_resources
2025-12-10T00:22:53.019404824Z 2025-12-10 00:22:53.018 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-12-10T00:22:53.019682373Z 2025-12-10 00:22:53.019 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-12-10T00:22:53.019769695Z 2025-12-10 00:22:53.019 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-12-10T00:22:53.019905119Z 2025-12-10 00:22:53.019 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-12-10T00:22:53.030040993Z [2025-12-10 00:22:53 +0000] [18] [INFO] Started server process [18]
2025-12-10T00:22:53.034059708Z 2025-12-10 00:22:53.032 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-12-10T00:22:53.034115703Z [2025-12-10 00:22:53 +0000] [18] [INFO] Waiting for application startup.
2025-12-10T00:22:53.034425119Z [2025-12-10 00:22:53 +0000] [18] [INFO] Application startup complete.
2025-12-10T00:22:53.037406772Z 2025-12-10 00:22:53.037 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-12-10T00:22:53.051825190Z /usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-12-10T00:22:53.051864188Z   import pkg_resources
2025-12-10T00:22:53.121472271Z 2025-12-10 00:22:53.120 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-12-10T00:22:53.121681247Z 2025-12-10 00:22:53.121 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-12-10T00:22:53.157782338Z [2025-12-10 00:22:53 +0000] [12] [INFO] Waiting for application startup.
2025-12-10T00:22:53.158150133Z [2025-12-10 00:22:53 +0000] [12] [INFO] Application startup complete.
2025-12-10T00:22:53.190038826Z 2025-12-10 00:22:53.189 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-12-10T00:22:53.191846671Z 2025-12-10 00:22:53.191 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-12-10T00:22:53.207261189Z [2025-12-10 00:22:53 +0000] [17] [INFO] Started server process [17]
2025-12-10T00:22:53.207395261Z [2025-12-10 00:22:53 +0000] [17] [INFO] Waiting for application startup.
2025-12-10T00:22:53.208173203Z [2025-12-10 00:22:53 +0000] [17] [INFO] Application startup complete.
2025-12-10T00:22:53.234472334Z [2025-12-10 00:22:53 +0000] [26] [INFO] Started server process [26]
2025-12-10T00:22:53.234622380Z [2025-12-10 00:22:53 +0000] [26] [INFO] Waiting for application startup.
2025-12-10T00:22:53.234962112Z [2025-12-10 00:22:53 +0000] [26] [INFO] Application startup complete.
2025-12-10T00:22:53.262531596Z 2025-12-10 00:22:53.260 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-12-10T00:22:53.262575543Z 2025-12-10 00:22:53.261 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-12-10T00:22:53.307288312Z [2025-12-10 00:22:53 +0000] [29] [INFO] Started server process [29]
2025-12-10T00:22:53.307325067Z [2025-12-10 00:22:53 +0000] [29] [INFO] Waiting for application startup.
2025-12-10T00:22:53.307747573Z [2025-12-10 00:22:53 +0000] [29] [INFO] Application startup complete.
2025-12-10T00:22:53.406784443Z [2025-12-10 00:22:53 +0000] [30] [INFO] Started server process [30]
2025-12-10T00:22:53.406849592Z [2025-12-10 00:22:53 +0000] [30] [INFO] Waiting for application startup.
2025-12-10T00:22:53.406855921Z [2025-12-10 00:22:53 +0000] [30] [INFO] Application startup complete.
2025-12-10T00:22:53.411602434Z [2025-12-10 00:22:53 +0000] [31] [INFO] Started server process [31]
2025-12-10T00:22:53.411648373Z [2025-12-10 00:22:53 +0000] [31] [INFO] Waiting for application startup.
2025-12-10T00:22:53.411651548Z [2025-12-10 00:22:53 +0000] [31] [INFO] Application startup complete.
2025-12-10T00:22:53.421923107Z 2025-12-10 00:22:53.421 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-12-10T00:22:53.422581418Z 2025-12-10 00:22:53.421 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-12-10T00:22:53.457194237Z 2025-12-10 00:22:53.456 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-12-10T00:22:53.457348941Z 2025-12-10 00:22:53.457 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-12-10T00:22:53.519356561Z /usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-12-10T00:22:53.519400497Z   import pkg_resources
2025-12-10T00:22:53.520072319Z /usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-12-10T00:22:53.520092099Z   import pkg_resources
2025-12-10T00:22:53.597807600Z [2025-12-10 00:22:53 +0000] [20] [INFO] Started server process [20]
2025-12-10T00:22:53.597864175Z [2025-12-10 00:22:53 +0000] [20] [INFO] Waiting for application startup.
2025-12-10T00:22:53.598335906Z [2025-12-10 00:22:53 +0000] [20] [INFO] Application startup complete.
2025-12-10T00:22:53.635318265Z 2025-12-10 00:22:53.634 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-12-10T00:22:53.635408201Z 2025-12-10 00:22:53.634 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-12-10T00:22:53.654126687Z [2025-12-10 00:22:53 +0000] [28] [INFO] Started server process [28]
2025-12-10T00:22:53.654187609Z [2025-12-10 00:22:53 +0000] [28] [INFO] Waiting for application startup.
2025-12-10T00:22:53.654190965Z [2025-12-10 00:22:53 +0000] [28] [INFO] Application startup complete.
2025-12-10T00:22:53.707947983Z 2025-12-10 00:22:53.706 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-12-10T00:22:53.707984798Z 2025-12-10 00:22:53.706 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-12-10T00:22:53.773953447Z /usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-12-10T00:22:53.773997093Z   import pkg_resources
2025-12-10T00:22:53.778719629Z [2025-12-10 00:22:53 +0000] [11] [INFO] Started server process [11]
2025-12-10T00:22:53.778767992Z [2025-12-10 00:22:53 +0000] [11] [INFO] Waiting for application startup.
2025-12-10T00:22:53.778778307Z [2025-12-10 00:22:53 +0000] [11] [INFO] Application startup complete.
2025-12-10T00:22:53.844448027Z [2025-12-10 00:22:53 +0000] [23] [INFO] Started server process [23]
2025-12-10T00:22:53.844492603Z [2025-12-10 00:22:53 +0000] [23] [INFO] Waiting for application startup.
2025-12-10T00:22:53.845624068Z [2025-12-10 00:22:53 +0000] [23] [INFO] Application startup complete.
2025-12-10T00:22:53.931879839Z /usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-12-10T00:22:53.931954742Z   import pkg_resources
2025-12-10T00:22:54.032002085Z 2025-12-10 00:22:54.031 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-12-10T00:22:54.032607617Z 2025-12-10 00:22:54.032 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-12-10T00:22:54.047438075Z 2025-12-10 00:22:54.046 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-12-10T00:22:54.047647711Z 2025-12-10 00:22:54.047 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-12-10T00:22:54.093978077Z /usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-12-10T00:22:54.094014703Z   import pkg_resources
2025-12-10T00:22:54.172126350Z [2025-12-10 00:22:54 +0000] [14] [INFO] Started server process [14]
2025-12-10T00:22:54.172178248Z [2025-12-10 00:22:54 +0000] [14] [INFO] Waiting for application startup.
2025-12-10T00:22:54.172201835Z [2025-12-10 00:22:54 +0000] [14] [INFO] Application startup complete.
2025-12-10T00:22:54.173166036Z [2025-12-10 00:22:54 +0000] [13] [INFO] Started server process [13]
2025-12-10T00:22:54.173181571Z [2025-12-10 00:22:54 +0000] [13] [INFO] Waiting for application startup.
2025-12-10T00:22:54.174234867Z [2025-12-10 00:22:54 +0000] [13] [INFO] Application startup complete.
2025-12-10T00:22:54.196620040Z 2025-12-10 00:22:54.195 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-12-10T00:22:54.196659500Z 2025-12-10 00:22:54.196 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-12-10T00:22:54.226023990Z /usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-12-10T00:22:54.226072523Z   import pkg_resources
2025-12-10T00:22:54.327530151Z [2025-12-10 00:22:54 +0000] [27] [INFO] Started server process [27]
2025-12-10T00:22:54.327573907Z [2025-12-10 00:22:54 +0000] [27] [INFO] Waiting for application startup.
2025-12-10T00:22:54.328564660Z [2025-12-10 00:22:54 +0000] [27] [INFO] Application startup complete.
2025-12-10T00:22:54.376223228Z 2025-12-10 00:22:54.375 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-12-10T00:22:54.376269938Z 2025-12-10 00:22:54.375 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-12-10T00:22:54.505248227Z [2025-12-10 00:22:54 +0000] [16] [INFO] Started server process [16]
2025-12-10T00:22:54.505294228Z [2025-12-10 00:22:54 +0000] [16] [INFO] Waiting for application startup.
2025-12-10T00:22:54.505297462Z [2025-12-10 00:22:54 +0000] [16] [INFO] Application startup complete.
2025-12-10T00:22:54.515264572Z 2025-12-10 00:22:54.514 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-12-10T00:22:54.515881291Z 2025-12-10 00:22:54.515 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-12-10T00:22:54.645687448Z [2025-12-10 00:22:54 +0000] [9] [INFO] Started server process [9]
2025-12-10T00:22:54.645726287Z [2025-12-10 00:22:54 +0000] [9] [INFO] Waiting for application startup.
2025-12-10T00:22:54.645729672Z [2025-12-10 00:22:54 +0000] [9] [INFO] Application startup complete.
2025-12-10T00:22:54.657686961Z 2025-12-10 00:22:54.656 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-12-10T00:22:54.658220245Z 2025-12-10 00:22:54.657 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-12-10T00:22:54.820761782Z [2025-12-10 00:22:54 +0000] [21] [INFO] Started server process [21]
2025-12-10T00:22:54.820871626Z [2025-12-10 00:22:54 +0000] [21] [INFO] Waiting for application startup.
2025-12-10T00:22:54.821505683Z [2025-12-10 00:22:54 +0000] [21] [INFO] Application startup complete.
2025-12-10T00:23:43.623116287Z {"text": "Received a GitHub webhook\n", "record": {"elapsed": {"repr": "0:00:49.586672", "seconds": 49.586672}, "exception": null, "extra": {}, "file": {"name": "github_app.py", "path": "/app/pr_agent/servers/github_app.py"}, "function": "handle_github_webhooks", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 45, "message": "Received a GitHub webhook", "module": "github_app", "name": "pr_agent.servers.github_app", "process": {"id": 9, "name": "MainProcess"}, "thread": {"id": 132164652559232, "name": "MainThread"}, "time": {"repr": "2025-12-10 00:23:43.622635+00:00", "timestamp": 1765326223.622635}}}
2025-12-10T00:23:43.646110469Z {"text": "Handling request with event: issue_comment, action: created\n", "record": {"elapsed": {"repr": "0:00:49.609691", "seconds": 49.609691}, "exception": null, "extra": {}, "file": {"name": "github_app.py", "path": "/app/pr_agent/servers/github_app.py"}, "function": "handle_request", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 321, "message": "Handling request with event: issue_comment, action: created", "module": "github_app", "name": "pr_agent.servers.github_app", "process": {"id": 9, "name": "MainProcess"}, "thread": {"id": 132164652559232, "name": "MainThread"}, "time": {"repr": "2025-12-10 00:23:43.645654+00:00", "timestamp": 1765326223.645654}}}
2025-12-10T00:23:43.647058117Z {"text": "Request body\n", "record": {"elapsed": {"repr": "0:00:49.610683", "seconds": 49.610683}, "exception": null, "extra": {"artifact": {"action": "created", "issue": {"url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/1", "repository_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend", "labels_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/1/labels{/name}", "comments_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/1/comments", "events_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/1/events", "html_url": "https://github.com/souravOD/nutri-b2c-frontend/pull/1", "id": 3527983986, "node_id": "PR_kwDOQEZhKM6uaI7J", "number": 1, "title": "Fix: Search UX and multi-filter logic (frontend)", "user": {"login": "NamanOdysseyts", "id": 238778617, "node_id": "U_kgDODjt4-Q", "avatar_url": "https://avatars.githubusercontent.com/u/238778617?v=4", "gravatar_id": "", "url": "https://api.github.com/users/NamanOdysseyts", "html_url": "https://github.com/NamanOdysseyts", "followers_url": "https://api.github.com/users/NamanOdysseyts/followers", "following_url": "https://api.github.com/users/NamanOdysseyts/following{/other_user}", "gists_url": "https://api.github.com/users/NamanOdysseyts/gists{/gist_id}", "starred_url": "https://api.github.com/users/NamanOdysseyts/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/NamanOdysseyts/subscriptions", "organizations_url": "https://api.github.com/users/NamanOdysseyts/orgs", "repos_url": "https://api.github.com/users/NamanOdysseyts/repos", "events_url": "https://api.github.com/users/NamanOdysseyts/events{/privacy}", "received_events_url": "https://api.github.com/users/NamanOdysseyts/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 9561404867, "node_id": "LA_kwDOQEZhKM8AAAACOed1ww", "url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/labels/Review%20effort%202/5", "name": "Review effort 2/5", "color": "d1bcf9", "default": false, "description": null}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 48, "created_at": "2025-10-18T02:45:21Z", "updated_at": "2025-12-10T00:23:41Z", "closed_at": null, "author_association": "COLLABORATOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "html_url": "https://github.com/souravOD/nutri-b2c-frontend/pull/1", "diff_url": "https://github.com/souravOD/nutri-b2c-frontend/pull/1.diff", "patch_url": "https://github.com/souravOD/nutri-b2c-frontend/pull/1.patch", "merged_at": null}, "body": "- Improved search bar UX in app/search/page.tsx:\r\n  - X icon clears input and refocuses\r\n  - Escape key clears input\r\n  - Enter key triggers search\r\n\r\n- Updated filter count logic:\r\n  - Accurately counts all active filters\r\n  - Apply button badge reflects true total", "reactions": {"url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/1/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/1/timeline", "performed_via_github_app": null, "state_reason": null}, "comment": {"url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/comments/3634834358", "html_url": "https://github.com/souravOD/nutri-b2c-frontend/pull/1#issuecomment-3634834358", "issue_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/1", "id": 3634834358, "node_id": "IC_kwDOQEZhKM7Ypyu2", "user": {"login": "souravOD", "id": 238303722, "node_id": "U_kgDODjQ56g", "avatar_url": "https://avatars.githubusercontent.com/u/238303722?v=4", "gravatar_id": "", "url": "https://api.github.com/users/souravOD", "html_url": "https://github.com/souravOD", "followers_url": "https://api.github.com/users/souravOD/followers", "following_url": "https://api.github.com/users/souravOD/following{/other_user}", "gists_url": "https://api.github.com/users/souravOD/gists{/gist_id}", "starred_url": "https://api.github.com/users/souravOD/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/souravOD/subscriptions", "organizations_url": "https://api.github.com/users/souravOD/orgs", "repos_url": "https://api.github.com/users/souravOD/repos", "events_url": "https://api.github.com/users/souravOD/events{/privacy}", "received_events_url": "https://api.github.com/users/souravOD/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "created_at": "2025-12-10T00:23:41Z", "updated_at": "2025-12-10T00:23:41Z", "body": "/review Can you please review this PR", "author_association": "OWNER", "reactions": {"url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/comments/3634834358/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "performed_via_github_app": null}, "repository": {"id": 1078354216, "node_id": "R_kgDOQEZhKA", "name": "nutri-b2c-frontend", "full_name": "souravOD/nutri-b2c-frontend", "private": false, "owner": {"login": "souravOD", "id": 238303722, "node_id": "U_kgDODjQ56g", "avatar_url": "https://avatars.githubusercontent.com/u/238303722?v=4", "gravatar_id": "", "url": "https://api.github.com/users/souravOD", "html_url": "https://github.com/souravOD", "followers_url": "https://api.github.com/users/souravOD/followers", "following_url": "https://api.github.com/users/souravOD/following{/other_user}", "gists_url": "https://api.github.com/users/souravOD/gists{/gist_id}", "starred_url": "https://api.github.com/users/souravOD/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/souravOD/subscriptions", "organizations_url": "https://api.github.com/users/souravOD/orgs", "repos_url": "https://api.github.com/users/souravOD/repos", "events_url": "https://api.github.com/users/souravOD/events{/privacy}", "received_events_url": "https://api.github.com/users/souravOD/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "html_url": "https://github.com/souravOD/nutri-b2c-frontend", "description": null, "fork": true, "url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend", "forks_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/forks", "keys_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/keys{/key_id}", "collaborators_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/collaborators{/collaborator}", "teams_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/teams", "hooks_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/hooks", "issue_events_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/events{/number}", "events_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/events", "assignees_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/assignees{/user}", "branches_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/branches{/branch}", "tags_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/tags", "blobs_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/git/blobs{/sha}", "git_tags_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/git/tags{/sha}", "git_refs_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/git/refs{/sha}", "trees_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/git/trees{/sha}", "statuses_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/statuses/{sha}", "languages_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/languages", "stargazers_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/stargazers", "contributors_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/contributors", "subscribers_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/subscribers", "subscription_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/subscription", "commits_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/commits{/sha}", "git_commits_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/git/commits{/sha}", "comments_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/comments{/number}", "issue_comment_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/comments{/number}", "contents_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/contents/{+path}", "compare_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/compare/{base}...{head}", "merges_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/merges", "archive_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/{archive_format}{/ref}", "downloads_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/downloads", "issues_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues{/number}", "pulls_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls{/number}", "milestones_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/milestones{/number}", "notifications_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/notifications{?since,all,participating}", "labels_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/labels{/name}", "releases_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/releases{/id}", "deployments_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/deployments", "created_at": "2025-10-17T15:44:00Z", "updated_at": "2025-11-14T04:02:00Z", "pushed_at": "2025-10-16T19:32:39Z", "git_url": "git://github.com/souravOD/nutri-b2c-frontend.git", "ssh_url": "git@github.com:souravOD/nutri-b2c-frontend.git", "clone_url": "https://github.com/souravOD/nutri-b2c-frontend.git", "svn_url": "https://github.com/souravOD/nutri-b2c-frontend", "homepage": "https://v0-next-js-app-requirements-omega.vercel.app", "size": 11387, "stargazers_count": 0, "watchers_count": 0, "language": null, "has_issues": false, "has_projects": true, "has_downloads": true, "has_wiki": false, "has_pages": false, "has_discussions": false, "forks_count": 1, "mirror_url": null, "archived": false, "disabled": false, "open_issues_count": 2, "license": null, "allow_forking": true, "is_template": false, "web_commit_signoff_required": false, "topics": [], "visibility": "public", "forks": 1, "open_issues": 2, "watchers": 0, "default_branch": "main"}, "sender": {"login": "souravOD", "id": 238303722, "node_id": "U_kgDODjQ56g", "avatar_url": "https://avatars.githubusercontent.com/u/238303722?v=4", "gravatar_id": "", "url": "https://api.github.com/users/souravOD", "html_url": "https://github.com/souravOD", "followers_url": "https://api.github.com/users/souravOD/followers", "following_url": "https://api.github.com/users/souravOD/following{/other_user}", "gists_url": "https://api.github.com/users/souravOD/gists{/gist_id}", "starred_url": "https://api.github.com/users/souravOD/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/souravOD/subscriptions", "organizations_url": "https://api.github.com/users/souravOD/orgs", "repos_url": "https://api.github.com/users/souravOD/repos", "events_url": "https://api.github.com/users/souravOD/events{/privacy}", "received_events_url": "https://api.github.com/users/souravOD/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "installation": {"id": 92375808, "node_id": "MDIzOkludGVncmF0aW9uSW5zdGFsbGF0aW9uOTIzNzU4MDg="}}, "event": "issue_comment"}, "file": {"name": "github_app.py", "path": "/app/pr_agent/servers/github_app.py"}, "function": "handle_request", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 342, "message": "Request body", "module": "github_app", "name": "pr_agent.servers.github_app", "process": {"id": 9, "name": "MainProcess"}, "thread": {"id": 132164652559232, "name": "MainThread"}, "time": {"repr": "2025-12-10 00:23:43.646646+00:00", "timestamp": 1765326223.646646}}}
2025-12-10T00:23:44.818421070Z {"text": "Processing comment on PR api_url='https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1', comment_body=/review Can you please review this PR\n", "record": {"elapsed": {"repr": "0:00:50.777053", "seconds": 50.777053}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "81c2cab3ca9d4c39a8e2ec1a2a3402bb", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "github_app.py", "path": "/app/pr_agent/servers/github_app.py"}, "function": "handle_comments_on_pr", "level": {"icon": "â„¹ï¸", "name": "INFO", "no": 20}, "line": 118, "message": "Processing comment on PR api_url='https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1', comment_body=/review Can you please review this PR", "module": "github_app", "name": "pr_agent.servers.github_app", "process": {"id": 9, "name": "MainProcess"}, "thread": {"id": 132164652559232, "name": "MainThread"}, "time": {"repr": "2025-12-10 00:23:44.813016+00:00", "timestamp": 1765326224.813016}}}
2025-12-10T00:23:48.375615652Z {"text": "AI metadata is disabled for this command\n", "record": {"elapsed": {"repr": "0:00:54.339110", "seconds": 54.33911}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "81c2cab3ca9d4c39a8e2ec1a2a3402bb", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "pr_reviewer.py", "path": "/app/pr_agent/tools/pr_reviewer.py"}, "function": "__init__", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 75, "message": "AI metadata is disabled for this command", "module": "pr_reviewer", "name": "pr_agent.tools.pr_reviewer", "process": {"id": 9, "name": "MainProcess"}, "thread": {"id": 132164652559232, "name": "MainThread"}, "time": {"repr": "2025-12-10 00:23:48.375073+00:00", "timestamp": 1765326228.375073}}}
2025-12-10T00:23:48.611809073Z {"text": "Reviewing PR: https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1 ...\n", "record": {"elapsed": {"repr": "0:00:54.575414", "seconds": 54.575414}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "81c2cab3ca9d4c39a8e2ec1a2a3402bb", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "pr_reviewer.py", "path": "/app/pr_agent/tools/pr_reviewer.py"}, "function": "run", "level": {"icon": "â„¹ï¸", "name": "INFO", "no": 20}, "line": 134, "message": "Reviewing PR: https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1 ...", "module": "pr_reviewer", "name": "pr_agent.tools.pr_reviewer", "process": {"id": 9, "name": "MainProcess"}, "thread": {"id": 132164652559232, "name": "MainThread"}, "time": {"repr": "2025-12-10 00:23:48.611377+00:00", "timestamp": 1765326228.611377}}}
2025-12-10T00:23:48.613148882Z {"text": "Relevant configs\n", "record": {"elapsed": {"repr": "0:00:54.576665", "seconds": 54.576665}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "81c2cab3ca9d4c39a8e2ec1a2a3402bb", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "artifacts": {"pr_reviewer": {"require_score_review": false, "require_tests_review": true, "require_estimate_effort_to_review": true, "require_can_be_split_review": false, "require_security_review": true, "require_estimate_contribution_time_cost": false, "require_todo_scan": false, "require_ticket_analysis_review": true, "publish_output_no_suggestions": true, "persistent_comment": true, "extra_instructions": "", "num_max_findings": 3, "final_update_message": true, "enable_review_labels_security": true, "enable_review_labels_effort": true, "require_all_thresholds_for_incremental_review": false, "minimal_commits_for_incremental_review": 0, "minimal_minutes_for_incremental_review": 0, "enable_intro_text": true, "enable_help_text": false}, "config": {"enable_ai_metadata": false, "custom_model_max_tokens": 200000, "model": "openai/gpt-5", "fallback_models": "openai/gpt-5-mini,openai/gpt-5-nano", "git_provider": "github", "publish_output": true, "publish_output_progress": true, "verbosity_level": 0, "use_extra_bad_extensions": false, "log_level": "DEBUG", "use_wiki_settings_file": true, "use_repo_settings_file": true, "use_global_settings_file": true, "disable_auto_feedback": false, "ai_timeout": 120, "skip_keys": [], "custom_reasoning_model": false, "response_language": "en-US", "max_description_tokens": 500, "max_commits_tokens": 500, "max_model_tokens": 32000, "model_token_count_estimate_factor": 0.3, "patch_extension_skip_types": [".md", ".txt"], "allow_dynamic_context": true, "max_extra_lines_before_dynamic_context": 10, "patch_extra_lines_before": 5, "patch_extra_lines_after": 1, "secret_provider": "", "cli_mode": false, "ai_disclaimer_title": "", "ai_disclaimer": "", "output_relevant_configurations": false, "large_patch_policy": "clip", "duplicate_prompt_examples": false, "seed": -1, "temperature": 0.2, "add_repo_metadata": false, "add_repo_metadata_file_list": ["AGENTS.MD", "CLAUDE.MD", "QODO.MD"], "ignore_pr_title": ["^\\[Auto\\]", "^Auto"], "ignore_pr_target_branches": [], "ignore_pr_source_branches": [], "ignore_pr_labels": [], "ignore_pr_authors": [], "ignore_repositories": [], "ignore_language_framework": [], "is_auto_command": false, "reasoning_effort": "medium", "enable_auto_approval": false, "auto_approve_for_low_review_effort": -1, "auto_approve_for_no_suggestions": false, "ensure_ticket_compliance": false, "enable_claude_extended_thinking": false, "extended_thinking_budget_tokens": 2048, "extended_thinking_max_output_tokens": 4096, "enable_custom_labels": false}}}, "file": {"name": "pr_reviewer.py", "path": "/app/pr_agent/tools/pr_reviewer.py"}, "function": "run", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 137, "message": "Relevant configs", "module": "pr_reviewer", "name": "pr_agent.tools.pr_reviewer", "process": {"id": 9, "name": "MainProcess"}, "thread": {"id": 132164652559232, "name": "MainThread"}, "time": {"repr": "2025-12-10 00:23:48.612628+00:00", "timestamp": 1765326228.612628}}}
2025-12-10T00:23:48.613786533Z {"text": "Existing description\n", "record": {"elapsed": {"repr": "0:00:54.577305", "seconds": 54.577305}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "81c2cab3ca9d4c39a8e2ec1a2a3402bb", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "description": "- improved search bar ux in app/search/page.tsx:\r\n  - x icon clears input and refocuses\r\n  - escape key clears input\r\n  - enter key triggers search\r\n\r\n- updated filter count logic:\r\n  - accurately counts all active filters\r\n  - apply button badge reflects true total"}, "file": {"name": "git_provider.py", "path": "/app/pr_agent/git_providers/git_provider.py"}, "function": "get_user_description", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 225, "message": "Existing description", "module": "git_provider", "name": "pr_agent.git_providers.git_provider", "process": {"id": 9, "name": "MainProcess"}, "thread": {"id": 132164652559232, "name": "MainThread"}, "time": {"repr": "2025-12-10 00:23:48.613268+00:00", "timestamp": 1765326228.613268}}}
2025-12-10T00:23:48.614942605Z {"text": "Existing description was not generated by the pr-agent\n", "record": {"elapsed": {"repr": "0:00:54.577435", "seconds": 54.577435}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "81c2cab3ca9d4c39a8e2ec1a2a3402bb", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "git_provider.py", "path": "/app/pr_agent/git_providers/git_provider.py"}, "function": "get_user_description", "level": {"icon": "â„¹ï¸", "name": "INFO", "no": 20}, "line": 229, "message": "Existing description was not generated by the pr-agent", "module": "git_provider", "name": "pr_agent.git_providers.git_provider", "process": {"id": 9, "name": "MainProcess"}, "thread": {"id": 132164652559232, "name": "MainThread"}, "time": {"repr": "2025-12-10 00:23:48.613398+00:00", "timestamp": 1765326228.613398}}}
2025-12-10T00:23:49.644439274Z {"text": "Generating prediction with openai/gpt-5\n", "record": {"elapsed": {"repr": "0:00:55.608132", "seconds": 55.608132}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "81c2cab3ca9d4c39a8e2ec1a2a3402bb", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "pr_processing.py", "path": "/app/pr_agent/algo/pr_processing.py"}, "function": "retry_with_fallback_models", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 326, "message": "Generating prediction with openai/gpt-5", "module": "pr_processing", "name": "pr_agent.algo.pr_processing", "process": {"id": 9, "name": "MainProcess"}, "thread": {"id": 132164652559232, "name": "MainThread"}, "time": {"repr": "2025-12-10 00:23:49.644095+00:00", "timestamp": 1765326229.644095}}}
2025-12-10T00:23:50.658477922Z {"text": "PR main language: TypeScript\n", "record": {"elapsed": {"repr": "0:00:56.621711", "seconds": 56.621711}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "81c2cab3ca9d4c39a8e2ec1a2a3402bb", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "pr_processing.py", "path": "/app/pr_agent/algo/pr_processing.py"}, "function": "get_pr_diff", "level": {"icon": "â„¹ï¸", "name": "INFO", "no": 20}, "line": 63, "message": "PR main language: TypeScript", "module": "pr_processing", "name": "pr_agent.algo.pr_processing", "process": {"id": 9, "name": "MainProcess"}, "thread": {"id": 132164652559232, "name": "MainThread"}, "time": {"repr": "2025-12-10 00:23:50.657674+00:00", "timestamp": 1765326230.657674}}}
2025-12-10T00:23:50.667434540Z {"text": "Tokens: 4738, total tokens under limit: 32000, returning full diff.\n", "record": {"elapsed": {"repr": "0:00:56.630800", "seconds": 56.6308}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "81c2cab3ca9d4c39a8e2ec1a2a3402bb", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "pr_processing.py", "path": "/app/pr_agent/algo/pr_processing.py"}, "function": "get_pr_diff", "level": {"icon": "â„¹ï¸", "name": "INFO", "no": 20}, "line": 74, "message": "Tokens: 4738, total tokens under limit: 32000, returning full diff.", "module": "pr_processing", "name": "pr_agent.algo.pr_processing", "process": {"id": 9, "name": "MainProcess"}, "thread": {"id": 132164652559232, "name": "MainThread"}, "time": {"repr": "2025-12-10 00:23:50.666763+00:00", "timestamp": 1765326230.666763}}}
2025-12-10T00:23:50.668681388Z {"text": "PR diff\n", "record": {"elapsed": {"repr": "0:00:56.631110", "seconds": 56.63111}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "81c2cab3ca9d4c39a8e2ec1a2a3402bb", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "diff": "\n\n## File: 'app/search/page.tsx'\n\n@@ -1,7 +1,8 @@\n__new hunk__\n1  \"use client\"\n2  \n3 +import { useState, useEffect, useMemo, useRef } from \"react\"\n4 +// import { X } from \"lucide-react\"\n5  import { useSearchParams, useRouter } from \"next/navigation\"\n6  import { useQuery } from \"@tanstack/react-query\"\n7  import { Input } from \"@/components/ui/input\"\n8  import { Button } from \"@/components/ui/button\"\n__old hunk__\n \"use client\"\n \n-import { useState, useEffect, useMemo } from \"react\"\n import { useSearchParams, useRouter } from \"next/navigation\"\n import { useQuery } from \"@tanstack/react-query\"\n import { Input } from \"@/components/ui/input\"\n import { Button } from \"@/components/ui/button\"\n\n@@ -41,11 +42,12 @@\n__new hunk__\n42  export default function SearchPage() {\n43    const searchParams = useSearchParams()\n44    const router = useRouter()\n45    const { filters, setFilters, resetFilters } = useFilters()\n46    const { settings } = useSettings()\n47  \n48    const [searchQuery, setSearchQuery] = useState(searchParams.get(\"q\") || filters.q || \"\")\n49 +  const inputRef = useRef<HTMLInputElement>(null);\n50    const [sortBy, setSortBy] = useState<SortOption>(settings.behavior.defaultSort || \"time\")\n51    const [filtersOpen, setFiltersOpen] = useState(false)\n52  \n53    // Update search query from URL params\n\n@@ -75,29 +77,54 @@ export default function SearchPage() {\n__new hunk__\n77        filters.fiberMin > 0 ||\n78        filters.sugarMax < 100 ||\n79        filters.sodiumMax < 4000 ||\n80        filters.maxTime < 120 ||\n81        !!filters.mealType\n82      )\n83    }, [filters])\n84  \n85 +  // const activeFilterCount = useMemo(() => {\n86 +  //   let count = 0\n87 +  //   if (filters.dietaryRestrictions.length > 0) count++\n88 +  //   if (filters.allergens.length > 0) count++\n89 +  //   if (filters.cuisines.length > 0) count++\n90 +  //   if (filters.majorConditions.length > 0) count++\n91 +  //   if (filters.calories[0] > 0 || filters.calories[1] < 1200) count++\n92 +  //   if (filters.proteinMin > 0) count++\n93 +  //   if (filters.carbsMin > 0) count++\n94 +  //   if (filters.fatMin > 0) count++\n95 +  //   if (filters.fiberMin > 0) count++\n96 +  //   if (filters.sugarMax < 100) count++\n97 +  //   if (filters.sodiumMax < 4000) count++\n98 +  //   if (filters.maxTime < 120) count++\n99 +  //   if (filters.mealType) count++\n100 +  //   return count\n101 +  // }, [filters])\n102    const activeFilterCount = useMemo(() => {\n103 +    let count = 0;\n104 +\n105 +  // Sum all selected array filters\n106 +    count += filters.dietaryRestrictions.length;\n107 +    count += filters.allergens.length;\n108 +    count += filters.cuisines.length;\n109 +    count += filters.majorConditions.length;\n110 +\n111 +    // Range and min/max filters\n112 +    if (filters.calories[0] > 0) count++; // Min calories\n113 +    if (filters.calories[1] < 1200) count++; // Max calories\n114 +    if (filters.proteinMin > 0) count++;\n115 +    if (filters.carbsMin > 0) count++;\n116 +    if (filters.fatMin > 0) count++;\n117 +    if (filters.fiberMin > 0) count++;\n118 +    if (filters.sugarMax < 100) count++;\n119 +    if (filters.sodiumMax < 4000) count++;\n120 +    if (filters.maxTime < 120) count++;\n121 +    \n122 +    // Single-value selection\n123 +    if (filters.mealType) count++;\n124 +\n125 +    return count;\n126 +  }, [filters]);\n127  \n128    const {\n129      data: searchResults = [],\n130      isLoading,\n__old hunk__\n       filters.fiberMin > 0 ||\n       filters.sugarMax < 100 ||\n       filters.sodiumMax < 4000 ||\n       filters.maxTime < 120 ||\n       !!filters.mealType\n     )\n   }, [filters])\n \n   const activeFilterCount = useMemo(() => {\n-    let count = 0\n-    if (filters.dietaryRestrictions.length > 0) count++\n-    if (filters.allergens.length > 0) count++\n-    if (filters.cuisines.length > 0) count++\n-    if (filters.majorConditions.length > 0) count++\n-    if (filters.calories[0] > 0 || filters.calories[1] < 1200) count++\n-    if (filters.proteinMin > 0) count++\n-    if (filters.carbsMin > 0) count++\n-    if (filters.fatMin > 0) count++\n-    if (filters.fiberMin > 0) count++\n-    if (filters.sugarMax < 100) count++\n-    if (filters.sodiumMax < 4000) count++\n-    if (filters.maxTime < 120) count++\n-    if (filters.mealType) count++\n-    return count\n-  }, [filters])\n \n   const {\n     data: searchResults = [],\n     isLoading,\n\n@@ -113,12 +140,22 @@ export default function SearchPage() {\n__new hunk__\n140          const rankedResults = rank(rawResults, settings)\n141          return rankedResults\n142        }\n143  \n144        return rawResults.map((recipe) => ({ ...recipe, score: 0 }))\n145      },\n146      enabled: !!(searchQuery || hasActiveFilters),\n147    })\n148 +  const handleSearchInputKeyDown = (e: React.KeyboardEvent<HTMLInputElement>) => {\n149 +    if (e.key === \"Escape\" && searchQuery) {\n150 +      setSearchQuery(\"\");\n151 +      inputRef.current?.focus();\n152 +    }\n153 +    if (e.key === \"Enter\") {\n154 +      handleSearch(searchQuery);\n155 +    }\n156 +  };\n157 +\n158  \n159    const handleSearch = (query: string) => {\n160      setSearchQuery(query)\n161      setFilters({ ...filters, q: query })\n\n@@ -182,13 +219,13 @@ export default function SearchPage() {\n__new hunk__\n219    return (\n220      <div className=\"container px-4 py-6 max-w-6xl\">\n221        <div className=\"space-y-6\">\n222          {/* Search Header */}\n223          <div className=\"space-y-4\">\n224            <h1 className=\"text-3xl font-bold\">Search Recipes</h1>\n225  \n226            {/* Search Input */}\n227 +          {/* <div className=\"relative\">\n228              <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n229              <Input\n230                role=\"search\"\n231                placeholder=\"Search recipes, ingredients, cuisines...\"\n__old hunk__\n   return (\n     <div className=\"container px-4 py-6 max-w-6xl\">\n       <div className=\"space-y-6\">\n         {/* Search Header */}\n         <div className=\"space-y-4\">\n           <h1 className=\"text-3xl font-bold\">Search Recipes</h1>\n \n           {/* Search Input */}\n-          <div className=\"relative\">\n             <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n             <Input\n               role=\"search\"\n               placeholder=\"Search recipes, ingredients, cuisines...\"\n\n@@ -192,14 +229,51 @@ export default function SearchPage() {\n__new hunk__\n229              <Input\n230                role=\"search\"\n231                placeholder=\"Search recipes, ingredients, cuisines...\"\n232                value={searchQuery}\n233                onChange={(e) => setSearchQuery(e.target.value)}\n234                onKeyDown={(e) => e.key === \"Enter\" && handleSearch(searchQuery)}\n235                className=\"pl-10 pr-4 h-12 text-lg\"\n236              />\n237 +          </div> */}\n238 +          <div style={{ position: \"relative\", display: \"inline-block\", width: \"100%\" }}>\n239 +            <Search style={{ position: \"absolute\", left: \"0.75rem\", top: \"50%\", transform: \"translateY(-50%)\", height: \"1rem\", width: \"1rem\", color: \"gray\" }} />\n240 +            <Input\n241 +              role=\"search\"\n242 +              ref={inputRef}\n243 +              placeholder=\"Search recipes, ingredients, cuisines...\"\n244 +              value={searchQuery}\n245 +              onChange={(e) => setSearchQuery(e.target.value)}\n246 +              onKeyDown={handleSearchInputKeyDown}\n247 +              style={{ paddingRight: searchQuery ? \"2rem\" : undefined, width: \"100%\" }}\n248 +              className=\"pl-10 pr-4 h-12 text-lg\"\n249 +            />\n250 +            {searchQuery && (\n251 +              <button\n252 +                type=\"button\"\n253 +                style={{\n254 +                  position: \"absolute\",\n255 +                  right: \"0.75rem\",\n256 +                  top: \"50%\",\n257 +                  transform: \"translateY(-50%)\",\n258 +                  background: \"none\",\n259 +                  border: \"none\",\n260 +                  cursor: \"pointer\",\n261 +                  padding: 0,\n262 +                  color: \"gray\",\n263 +                }}\n264 +                aria-label=\"Clear search\"\n265 +                onClick={() => {\n266 +                  setSearchQuery(\"\");\n267 +                  inputRef.current?.focus();\n268 +              }}\n269 +              >\n270 +                <X size={20} />\n271 +            </button>\n272 +          )}\n273            </div>\n274  \n275 +\n276            {/* Search Actions */}\n277            <div className=\"flex items-center gap-2\">\n278              <Button onClick={() => handleSearch(searchQuery)} size=\"sm\">\n279                Search\n\n\n## File: 'components/filter-panel.tsx'\n\n@@ -54,35 +54,58 @@\n__new hunk__\n54  export function FilterPanel({ open, onOpenChange, initialValues, onApply, onReset }: FilterPanelProps) {\n55    const form = useForm<FiltersFormInput>({\n56      resolver: zodResolver(schema),\n57      // provide full defaults (OUTPUT fits into INPUT just fine)\n58      defaultValues: schema.parse(initialValues ?? {}),\n59      mode: \"onChange\",\n60    })\n61  \n62     useEffect(() => {\n63      form.reset(schema.parse(initialValues ?? {}));\n64    }, [open, initialValues, form]);\n65  \n66 +  // function getActiveFiltersCount(): number {\n67 +  //   const values = form.getValues()\n68 +  //   let count = 0\n69 +  //   if ((values.dietaryRestrictions || []).length > 0) count++\n70 +  //   if ((values.allergens || []).length > 0) count++\n71 +  //   if ((values.cuisines || []).length > 0) count++\n72 +  //   if ((values.majorConditions || []).length > 0) count++\n73 +  //   if (values.calories && (values.calories[0] > 0 || values.calories[1] < 1200)) count++\n74 +  //   if ((values.proteinMin || 0) > 0) count++\n75 +  //   if ((values.carbsMin || 0) > 0) count++\n76 +  //   if ((values.fatMin || 0) > 0) count++\n77 +  //   if ((values.fiberMin || 0) > 0) count++\n78 +  //   if ((values.sugarMax || 100) < 100) count++\n79 +  //   if ((values.sodiumMax || 4000) < 4000) count++\n80 +  //   if ((values.maxTime || 120) < 120) count++\n81 +  //   if ((values.mealType || \"\") !== \"\") count++\n82 +  //   return count\n83 +  // }\n84    function getActiveFiltersCount(): number {\n85 +    const values = form.getValues();\n86 +    let count = 0;\n87 +\n88 +    // Count all selected array filters individually\n89 +    count += values.dietaryRestrictions.length;\n90 +    count += values.allergens.length;\n91 +    count += values.cuisines.length;\n92 +    count += values.majorConditions.length;\n93 +\n94 +    // Numeric and single-value filters\n95 +    if (values.calories[0] > 0) count++;           // Min calories\n96 +    if (values.calories[1] < 1200) count++;        // Max calories\n97 +    if (values.proteinMin > 0) count++;\n98 +    if (values.carbsMin > 0) count++;\n99 +    if (values.fatMin > 0) count++;\n100 +    if (values.fiberMin > 0) count++;\n101 +    if (values.sugarMax < 100) count++;\n102 +    if (values.sodiumMax < 4000) count++;\n103 +    if (values.maxTime < 120) count++;\n104 +    if (values.mealType) count++;\n105 +\n106 +    return count;\n107    }\n108    function handleApply() {\n109      const values = schema.parse(form.getValues())\n110      onApply(values)\n111      onOpenChange(false)\n__old hunk__\n export function FilterPanel({ open, onOpenChange, initialValues, onApply, onReset }: FilterPanelProps) {\n   const form = useForm<FiltersFormInput>({\n     resolver: zodResolver(schema),\n     // provide full defaults (OUTPUT fits into INPUT just fine)\n     defaultValues: schema.parse(initialValues ?? {}),\n     mode: \"onChange\",\n   })\n \n    useEffect(() => {\n     form.reset(schema.parse(initialValues ?? {}));\n   }, [open, initialValues, form]);\n \n   function getActiveFiltersCount(): number {\n-    const values = form.getValues()\n-    let count = 0\n-    if ((values.dietaryRestrictions || []).length > 0) count++\n-    if ((values.allergens || []).length > 0) count++\n-    if ((values.cuisines || []).length > 0) count++\n-    if ((values.majorConditions || []).length > 0) count++\n-    if (values.calories && (values.calories[0] > 0 || values.calories[1] < 1200)) count++\n-    if ((values.proteinMin || 0) > 0) count++\n-    if ((values.carbsMin || 0) > 0) count++\n-    if ((values.fatMin || 0) > 0) count++\n-    if ((values.fiberMin || 0) > 0) count++\n-    if ((values.sugarMax || 100) < 100) count++\n-    if ((values.sodiumMax || 4000) < 4000) count++\n-    if ((values.maxTime || 120) < 120) count++\n-    if ((values.mealType || \"\") !== \"\") count++\n-    return count\n   }\n-\n   function handleApply() {\n     const values = schema.parse(form.getValues())\n     onApply(values)\n     onOpenChange(false)"}, "file": {"name": "pr_reviewer.py", "path": "/app/pr_agent/tools/pr_reviewer.py"}, "function": "_prepare_prediction", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 197, "message": "PR diff", "module": "pr_reviewer", "name": "pr_agent.tools.pr_reviewer", "process": {"id": 9, "name": "MainProcess"}, "thread": {"id": 132164652559232, "name": "MainThread"}, "time": {"repr": "2025-12-10 00:23:50.667073+00:00", "timestamp": 1765326230.667073}}}
2025-12-10T00:23:50.682337168Z {"text": "Prompts\n", "record": {"elapsed": {"repr": "0:00:56.645769", "seconds": 56.645769}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "81c2cab3ca9d4c39a8e2ec1a2a3402bb", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "artifact": {"system": "You are PR-Reviewer, a language model designed to review a Git Pull Request (PR).\nYour task is to provide constructive and concise feedback for the PR.\nThe review should focus on new code added in the PR code diff (lines starting with '+')\n\n\nThe format we will use to present the PR code diff:\n======\n## File: 'src/file1.py'\n\n\n@@ ... @@ def func1():\n__new hunk__\n11  unchanged code line0\n12  unchanged code line1\n13 +new code line2 added\n14  unchanged code line3\n__old hunk__\n unchanged code line0\n unchanged code line1\n-old code line2 removed\n unchanged code line3\n\n@@ ... @@ def func2():\n__new hunk__\n unchanged code line4\n+new code line5 added\n unchanged code line6\n\n## File: 'src/file2.py'\n...\n======\n\n- In the format above, the diff is organized into separate '__new hunk__' and '__old hunk__' sections for each code chunk. '__new hunk__' contains the updated code, while '__old hunk__' shows the removed code. If no code was removed in a specific chunk, the __old hunk__ section will be omitted.\n- We also added line numbers for the '__new hunk__' code, to help you refer to the code lines in your suggestions. These line numbers are not part of the actual code, and should only be used for reference.\n- Code lines are prefixed with symbols ('+', '-', ' '). The '+' symbol indicates new code added in the PR, the '-' symbol indicates code removed in the PR, and the ' ' symbol indicates unchanged code. The review should address new code added in the PR code diff (lines starting with '+').\n- When quoting variables, names or file paths from the code, use backticks (`) instead of single quote (').\n- Note that you only see changed code segments (diff hunks in a PR), not the entire codebase. Avoid suggestions that might duplicate existing functionality or questioning code elements (like variables declarations or import statements) that may be defined elsewhere in the codebase.\n- Also note that if the code ends at an opening brace or statement that begins a new scope (like 'if', 'for', 'try'), don't treat it as incomplete. Instead, acknowledge the visible scope boundary and analyze only the code shown.\n\n\nThe output must be a YAML object equivalent to type $PRReview, according to the following Pydantic definitions:\n=====\n\nclass KeyIssuesComponentLink(BaseModel):\n    relevant_file: str = Field(description=\"The full file path of the relevant file\")\n    issue_header: str = Field(description=\"One or two word title for the issue. For example: 'Possible Bug', etc.\")\n    issue_content: str = Field(description=\"A short and concise summary of what should be further inspected and validated during the PR review process for this issue. Do not mention line numbers in this field.\")\n    start_line: int = Field(description=\"The start line that corresponds to this issue in the relevant file\")\n    end_line: int = Field(description=\"The end line that corresponds to this issue in the relevant file\")\n\nclass Review(BaseModel):\n    estimated_effort_to_review_[1-5]: int = Field(description=\"Estimate, on a scale of 1-5 (inclusive), the time and effort required to review this PR by an experienced and knowledgeable developer. 1 means short and easy review , 5 means long and hard review. Take into account the size, complexity, quality, and the needed changes of the PR code diff.\")\n    relevant_tests: str = Field(description=\"yes/no question: does this PR have relevant tests added or updated ?\")\n    key_issues_to_review: List[KeyIssuesComponentLink] = Field(\"A short and diverse list (0-3 issues) of high-priority bugs, problems or performance concerns introduced in the PR code, which the PR reviewer should further focus on and validate during the review process.\")\n    security_concerns: str = Field(description=\"Does this PR code introduce vulnerabilities such as exposure of sensitive information (e.g., API keys, secrets, passwords), or security concerns like SQL injection, XSS, CSRF, and others ? Answer 'No' (without explaining why) if there are no possible issues. If there are security concerns or issues, start your answer with a short header, such as: 'Sensitive information exposure: ...', 'SQL injection: ...', etc. Explain your answer. Be specific and give examples if possible\")\n\nclass PRReview(BaseModel):\n    review: Review\n=====\n\n\nExample output:\n```yaml\nreview:\n  estimated_effort_to_review_[1-5]: |\n    3\n  relevant_tests: |\n    No\n  key_issues_to_review:\n    - relevant_file: |\n        directory/xxx.py\n      issue_header: |\n        Possible Bug\n      issue_content: |\n        ...\n      start_line: 12\n      end_line: 14\n    - ...\n  security_concerns: |\n    No\n```\n\nAnswer should be a valid YAML, and nothing else. Each YAML output MUST be after a newline, with proper indent, and block scalar indicator ('|')", "user": "\n\n\n--PR Info--\n\nToday's Date: 2025-12-10\n\nTitle: 'Fix: Search UX and multi-filter logic (frontend)'\n\nBranch: 'feature/initial-fixes'\n\nPR Description:\n======\n- Improved search bar UX in app/search/page.tsx:\r\n  - X icon clears input and refocuses\r\n  - Escape key clears input\r\n  - Enter key triggers search\r\n\r\n- Updated filter count logic:\r\n  - Accurately counts all active filters\r\n  - Apply button badge reflects true total\n======\n\n\nThe PR code diff:\n======\n## File: 'app/search/page.tsx'\n\n@@ -1,7 +1,8 @@\n__new hunk__\n1  \"use client\"\n2  \n3 +import { useState, useEffect, useMemo, useRef } from \"react\"\n4 +// import { X } from \"lucide-react\"\n5  import { useSearchParams, useRouter } from \"next/navigation\"\n6  import { useQuery } from \"@tanstack/react-query\"\n7  import { Input } from \"@/components/ui/input\"\n8  import { Button } from \"@/components/ui/button\"\n__old hunk__\n \"use client\"\n \n-import { useState, useEffect, useMemo } from \"react\"\n import { useSearchParams, useRouter } from \"next/navigation\"\n import { useQuery } from \"@tanstack/react-query\"\n import { Input } from \"@/components/ui/input\"\n import { Button } from \"@/components/ui/button\"\n\n@@ -41,11 +42,12 @@\n__new hunk__\n42  export default function SearchPage() {\n43    const searchParams = useSearchParams()\n44    const router = useRouter()\n45    const { filters, setFilters, resetFilters } = useFilters()\n46    const { settings } = useSettings()\n47  \n48    const [searchQuery, setSearchQuery] = useState(searchParams.get(\"q\") || filters.q || \"\")\n49 +  const inputRef = useRef<HTMLInputElement>(null);\n50    const [sortBy, setSortBy] = useState<SortOption>(settings.behavior.defaultSort || \"time\")\n51    const [filtersOpen, setFiltersOpen] = useState(false)\n52  \n53    // Update search query from URL params\n\n@@ -75,29 +77,54 @@ export default function SearchPage() {\n__new hunk__\n77        filters.fiberMin > 0 ||\n78        filters.sugarMax < 100 ||\n79        filters.sodiumMax < 4000 ||\n80        filters.maxTime < 120 ||\n81        !!filters.mealType\n82      )\n83    }, [filters])\n84  \n85 +  // const activeFilterCount = useMemo(() => {\n86 +  //   let count = 0\n87 +  //   if (filters.dietaryRestrictions.length > 0) count++\n88 +  //   if (filters.allergens.length > 0) count++\n89 +  //   if (filters.cuisines.length > 0) count++\n90 +  //   if (filters.majorConditions.length > 0) count++\n91 +  //   if (filters.calories[0] > 0 || filters.calories[1] < 1200) count++\n92 +  //   if (filters.proteinMin > 0) count++\n93 +  //   if (filters.carbsMin > 0) count++\n94 +  //   if (filters.fatMin > 0) count++\n95 +  //   if (filters.fiberMin > 0) count++\n96 +  //   if (filters.sugarMax < 100) count++\n97 +  //   if (filters.sodiumMax < 4000) count++\n98 +  //   if (filters.maxTime < 120) count++\n99 +  //   if (filters.mealType) count++\n100 +  //   return count\n101 +  // }, [filters])\n102    const activeFilterCount = useMemo(() => {\n103 +    let count = 0;\n104 +\n105 +  // Sum all selected array filters\n106 +    count += filters.dietaryRestrictions.length;\n107 +    count += filters.allergens.length;\n108 +    count += filters.cuisines.length;\n109 +    count += filters.majorConditions.length;\n110 +\n111 +    // Range and min/max filters\n112 +    if (filters.calories[0] > 0) count++; // Min calories\n113 +    if (filters.calories[1] < 1200) count++; // Max calories\n114 +    if (filters.proteinMin > 0) count++;\n115 +    if (filters.carbsMin > 0) count++;\n116 +    if (filters.fatMin > 0) count++;\n117 +    if (filters.fiberMin > 0) count++;\n118 +    if (filters.sugarMax < 100) count++;\n119 +    if (filters.sodiumMax < 4000) count++;\n120 +    if (filters.maxTime < 120) count++;\n121 +    \n122 +    // Single-value selection\n123 +    if (filters.mealType) count++;\n124 +\n125 +    return count;\n126 +  }, [filters]);\n127  \n128    const {\n129      data: searchResults = [],\n130      isLoading,\n__old hunk__\n       filters.fiberMin > 0 ||\n       filters.sugarMax < 100 ||\n       filters.sodiumMax < 4000 ||\n       filters.maxTime < 120 ||\n       !!filters.mealType\n     )\n   }, [filters])\n \n   const activeFilterCount = useMemo(() => {\n-    let count = 0\n-    if (filters.dietaryRestrictions.length > 0) count++\n-    if (filters.allergens.length > 0) count++\n-    if (filters.cuisines.length > 0) count++\n-    if (filters.majorConditions.length > 0) count++\n-    if (filters.calories[0] > 0 || filters.calories[1] < 1200) count++\n-    if (filters.proteinMin > 0) count++\n-    if (filters.carbsMin > 0) count++\n-    if (filters.fatMin > 0) count++\n-    if (filters.fiberMin > 0) count++\n-    if (filters.sugarMax < 100) count++\n-    if (filters.sodiumMax < 4000) count++\n-    if (filters.maxTime < 120) count++\n-    if (filters.mealType) count++\n-    return count\n-  }, [filters])\n \n   const {\n     data: searchResults = [],\n     isLoading,\n\n@@ -113,12 +140,22 @@ export default function SearchPage() {\n__new hunk__\n140          const rankedResults = rank(rawResults, settings)\n141          return rankedResults\n142        }\n143  \n144        return rawResults.map((recipe) => ({ ...recipe, score: 0 }))\n145      },\n146      enabled: !!(searchQuery || hasActiveFilters),\n147    })\n148 +  const handleSearchInputKeyDown = (e: React.KeyboardEvent<HTMLInputElement>) => {\n149 +    if (e.key === \"Escape\" && searchQuery) {\n150 +      setSearchQuery(\"\");\n151 +      inputRef.current?.focus();\n152 +    }\n153 +    if (e.key === \"Enter\") {\n154 +      handleSearch(searchQuery);\n155 +    }\n156 +  };\n157 +\n158  \n159    const handleSearch = (query: string) => {\n160      setSearchQuery(query)\n161      setFilters({ ...filters, q: query })\n\n@@ -182,13 +219,13 @@ export default function SearchPage() {\n__new hunk__\n219    return (\n220      <div className=\"container px-4 py-6 max-w-6xl\">\n221        <div className=\"space-y-6\">\n222          {/* Search Header */}\n223          <div className=\"space-y-4\">\n224            <h1 className=\"text-3xl font-bold\">Search Recipes</h1>\n225  \n226            {/* Search Input */}\n227 +          {/* <div className=\"relative\">\n228              <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n229              <Input\n230                role=\"search\"\n231                placeholder=\"Search recipes, ingredients, cuisines...\"\n__old hunk__\n   return (\n     <div className=\"container px-4 py-6 max-w-6xl\">\n       <div className=\"space-y-6\">\n         {/* Search Header */}\n         <div className=\"space-y-4\">\n           <h1 className=\"text-3xl font-bold\">Search Recipes</h1>\n \n           {/* Search Input */}\n-          <div className=\"relative\">\n             <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n             <Input\n               role=\"search\"\n               placeholder=\"Search recipes, ingredients, cuisines...\"\n\n@@ -192,14 +229,51 @@ export default function SearchPage() {\n__new hunk__\n229              <Input\n230                role=\"search\"\n231                placeholder=\"Search recipes, ingredients, cuisines...\"\n232                value={searchQuery}\n233                onChange={(e) => setSearchQuery(e.target.value)}\n234                onKeyDown={(e) => e.key === \"Enter\" && handleSearch(searchQuery)}\n235                className=\"pl-10 pr-4 h-12 text-lg\"\n236              />\n237 +          </div> */}\n238 +          <div style={{ position: \"relative\", display: \"inline-block\", width: \"100%\" }}>\n239 +            <Search style={{ position: \"absolute\", left: \"0.75rem\", top: \"50%\", transform: \"translateY(-50%)\", height: \"1rem\", width: \"1rem\", color: \"gray\" }} />\n240 +            <Input\n241 +              role=\"search\"\n242 +              ref={inputRef}\n243 +              placeholder=\"Search recipes, ingredients, cuisines...\"\n244 +              value={searchQuery}\n245 +              onChange={(e) => setSearchQuery(e.target.value)}\n246 +              onKeyDown={handleSearchInputKeyDown}\n247 +              style={{ paddingRight: searchQuery ? \"2rem\" : undefined, width: \"100%\" }}\n248 +              className=\"pl-10 pr-4 h-12 text-lg\"\n249 +            />\n250 +            {searchQuery && (\n251 +              <button\n252 +                type=\"button\"\n253 +                style={{\n254 +                  position: \"absolute\",\n255 +                  right: \"0.75rem\",\n256 +                  top: \"50%\",\n257 +                  transform: \"translateY(-50%)\",\n258 +                  background: \"none\",\n259 +                  border: \"none\",\n260 +                  cursor: \"pointer\",\n261 +                  padding: 0,\n262 +                  color: \"gray\",\n263 +                }}\n264 +                aria-label=\"Clear search\"\n265 +                onClick={() => {\n266 +                  setSearchQuery(\"\");\n267 +                  inputRef.current?.focus();\n268 +              }}\n269 +              >\n270 +                <X size={20} />\n271 +            </button>\n272 +          )}\n273            </div>\n274  \n275 +\n276            {/* Search Actions */}\n277            <div className=\"flex items-center gap-2\">\n278              <Button onClick={() => handleSearch(searchQuery)} size=\"sm\">\n279                Search\n\n\n## File: 'components/filter-panel.tsx'\n\n@@ -54,35 +54,58 @@\n__new hunk__\n54  export function FilterPanel({ open, onOpenChange, initialValues, onApply, onReset }: FilterPanelProps) {\n55    const form = useForm<FiltersFormInput>({\n56      resolver: zodResolver(schema),\n57      // provide full defaults (OUTPUT fits into INPUT just fine)\n58      defaultValues: schema.parse(initialValues ?? {}),\n59      mode: \"onChange\",\n60    })\n61  \n62     useEffect(() => {\n63      form.reset(schema.parse(initialValues ?? {}));\n64    }, [open, initialValues, form]);\n65  \n66 +  // function getActiveFiltersCount(): number {\n67 +  //   const values = form.getValues()\n68 +  //   let count = 0\n69 +  //   if ((values.dietaryRestrictions || []).length > 0) count++\n70 +  //   if ((values.allergens || []).length > 0) count++\n71 +  //   if ((values.cuisines || []).length > 0) count++\n72 +  //   if ((values.majorConditions || []).length > 0) count++\n73 +  //   if (values.calories && (values.calories[0] > 0 || values.calories[1] < 1200)) count++\n74 +  //   if ((values.proteinMin || 0) > 0) count++\n75 +  //   if ((values.carbsMin || 0) > 0) count++\n76 +  //   if ((values.fatMin || 0) > 0) count++\n77 +  //   if ((values.fiberMin || 0) > 0) count++\n78 +  //   if ((values.sugarMax || 100) < 100) count++\n79 +  //   if ((values.sodiumMax || 4000) < 4000) count++\n80 +  //   2025-12-10T00:23:50.682337168Z if ((values.maxTime || 120) < 120) count++\n81 +  //   if ((values.mealType || \"\") !== \"\") count++\n82 +  //   return count\n83 +  // }\n84    function getActiveFiltersCount(): number {\n85 +    const values = form.getValues();\n86 +    let count = 0;\n87 +\n88 +    // Count all selected array filters individually\n89 +    count += values.dietaryRestrictions.length;\n90 +    count += values.allergens.length;\n91 +    count += values.cuisines.length;\n92 +    count += values.majorConditions.length;\n93 +\n94 +    // Numeric and single-value filters\n95 +    if (values.calories[0] > 0) count++;           // Min calories\n96 +    if (values.calories[1] < 1200) count++;        // Max calories\n97 +    if (values.proteinMin > 0) count++;\n98 +    if (values.carbsMin > 0) count++;\n99 +    if (values.fatMin > 0) count++;\n100 +    if (values.fiberMin > 0) count++;\n101 +    if (values.sugarMax < 100) count++;\n102 +    if (values.sodiumMax < 4000) count++;\n103 +    if (values.maxTime < 120) count++;\n104 +    if (values.mealType) count++;\n105 +\n106 +    return count;\n107    }\n108    function handleApply() {\n109      const values = schema.parse(form.getValues())\n110      onApply(values)\n111      onOpenChange(false)\n__old hunk__\n export function FilterPanel({ open, onOpenChange, initialValues, onApply, onReset }: FilterPanelProps) {\n   const form = useForm<FiltersFormInput>({\n     resolver: zodResolver(schema),\n     // provide full defaults (OUTPUT fits into INPUT just fine)\n     defaultValues: schema.parse(initialValues ?? {}),\n     mode: \"onChange\",\n   })\n \n    useEffect(() => {\n     form.reset(schema.parse(initialValues ?? {}));\n   }, [open, initialValues, form]);\n \n   function getActiveFiltersCount(): number {\n-    const values = form.getValues()\n-    let count = 0\n-    if ((values.dietaryRestrictions || []).length > 0) count++\n-    if ((values.allergens || []).length > 0) count++\n-    if ((values.cuisines || []).length > 0) count++\n-    if ((values.majorConditions || []).length > 0) count++\n-    if (values.calories && (values.calories[0] > 0 || values.calories[1] < 1200)) count++\n-    if ((values.proteinMin || 0) > 0) count++\n-    if ((values.carbsMin || 0) > 0) count++\n-    if ((values.fatMin || 0) > 0) count++\n-    if ((values.fiberMin || 0) > 0) count++\n-    if ((values.sugarMax || 100) < 100) count++\n-    if ((values.sodiumMax || 4000) < 4000) count++\n-    if ((values.maxTime || 120) < 120) count++\n-    if ((values.mealType || \"\") !== \"\") count++\n-    return count\n   }\n-\n   function handleApply() {\n     const values = schema.parse(form.getValues())\n     onApply(values)\n     onOpenChange(false)\n======\n\n\nResponse (should be a valid YAML, and nothing else):\n```yaml"}}, "file": {"name": "litellm_ai_handler.py", "path": "/app/pr_agent/algo/ai_handlers/litellm_ai_handler.py"}, "function": "chat_completion", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 383, "message": "Prompts", "module": "litellm_ai_handler", "name": "pr_agent.algo.ai_handlers.litellm_ai_handler", "process": {"id": 9, "name": "MainProcess"}, "thread": {"id": 132164652559232, "name": "MainThread"}, "time": {"repr": "2025-12-10 00:23:50.681732+00:00", "timestamp": 1765326230.681732}}}
2025-12-10T00:23:50.946634171Z {"text": "Error during LLM inference: litellm.UnsupportedParamsError: gpt-5 models (including gpt-5-codex) don't support temperature=0.2. Only temperature=1 is supported. To drop unsupported params set `litellm.drop_params = True`\n", "record": {"elapsed": {"repr": "0:00:56.910088", "seconds": 56.910088}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "81c2cab3ca9d4c39a8e2ec1a2a3402bb", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "litellm_ai_handler.py", "path": "/app/pr_agent/algo/ai_handlers/litellm_ai_handler.py"}, "function": "chat_completion", "level": {"icon": "âš ï¸", "name": "WARNING", "no": 30}, "line": 396, "message": "Error during LLM inference: litellm.UnsupportedParamsError: gpt-5 models (including gpt-5-codex) don't support temperature=0.2. Only temperature=1 is supported. To drop unsupported params set `litellm.drop_params = True`", "module": "litellm_ai_handler", "name": "pr_agent.algo.ai_handlers.litellm_ai_handler", "process": {"id": 9, "name": "MainProcess"}, "thread": {"id": 132164652559232, "name": "MainThread"}, "time": {"repr": "2025-12-10 00:23:50.946051+00:00", "timestamp": 1765326230.946051}}}
2025-12-10T00:23:50.950774711Z {"text": "Prompts\n", "record": {"elapsed": {"repr": "0:00:56.913180", "seconds": 56.91318}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "81c2cab3ca9d4c39a8e2ec1a2a3402bb", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "artifact": {"system": "You are PR-Reviewer, a language model designed to review a Git Pull Request (PR).\nYour task is to provide constructive and concise feedback for the PR.\nThe review should focus on new code added in the PR code diff (lines starting with '+')\n\n\nThe format we will use to present the PR code diff:\n======\n## File: 'src/file1.py'\n\n\n@@ ... @@ def func1():\n__new hunk__\n11  unchanged code line0\n12  unchanged code line1\n13 +new code line2 added\n14  unchanged code line3\n__old hunk__\n unchanged code line0\n unchanged code line1\n-old code line2 removed\n unchanged code line3\n\n@@ ... @@ def func2():\n__new hunk__\n unchanged code line4\n+new code line5 added\n unchanged code line6\n\n## File: 'src/file2.py'\n...\n======\n\n- In the format above, the diff is organized into separate '__new hunk__' and '__old hunk__' sections for each code chunk. '__new hunk__' contains the updated code, while '__old hunk__' shows the removed code. If no code was removed in a specific chunk, the __old hunk__ section will be omitted.\n- We also added line numbers for the '__new hunk__' code, to help you refer to the code lines in your suggestions. These line numbers are not part of the actual code, and should only be used for reference.\n- Code lines are prefixed with symbols ('+', '-', ' '). The '+' symbol indicates new code added in the PR, the '-' symbol indicates code removed in the PR, and the ' ' symbol indicates unchanged code. The review should address new code added in the PR code diff (lines starting with '+').\n- When quoting variables, names or file paths from the code, use backticks (`) instead of single quote (').\n- Note that you only see changed code segments (diff hunks in a PR), not the entire codebase. Avoid suggestions that might duplicate existing functionality or questioning code elements (like variables declarations or import statements) that may be defined elsewhere in the codebase.\n- Also note that if the code ends at an opening brace or statement that begins a new scope (like 'if', 'for', 'try'), don't treat it as incomplete. Instead, acknowledge the visible scope boundary and analyze only the code shown.\n\n\nThe output must be a YAML object equivalent to type $PRReview, according to the following Pydantic definitions:\n=====\n\nclass KeyIssuesComponentLink(BaseModel):\n    relevant_file: str = Field(description=\"The full file path of the relevant file\")\n    issue_header: str = Field(description=\"One or two word title for the issue. For example: 'Possible Bug', etc.\")\n    issue_content: str = Field(descriptio2025-12-10T00:22:53.157712803Z [2025-12-10 00:22:53 +0000] [12] [INFO] Started server process [12]
2025-12-10T00:23:50.964263508Z {"text": "Error during LLM inference: litellm.UnsupportedParamsError: gpt-5 models (including gpt-5-codex) don't support temperature=0.2. Only temperature=1 is supported. To drop unsupported params set `litellm.drop_params = True`\n", "record": {"elapsed": {"repr": "0:00:56.927562", "seconds": 56.927562}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "81c2cab3ca9d4c39a8e2ec1a2a3402bb", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "litellm_ai_handler.py", "path": "/app/pr_agent/algo/ai_handlers/litellm_ai_handler.py"}, "function": "chat_completion", "level": {"icon": "âš ï¸", "name": "WARNING", "no": 30}, "line": 396, "message": "Error during LLM inference: litellm.UnsupportedParamsError: gpt-5 models (including gpt-5-codex) don't support temperature=0.2. Only temperature=1 is supported. To drop unsupported params set `litellm.drop_params = True`", "module": "litellm_ai_handler", "name": "pr_agent.algo.ai_handlers.litellm_ai_handler", "process": {"id": 9, "name": "MainProcess"}, "thread": {"id": 132164652559232, "name": "MainThread"}, "time": {"repr": "2025-12-10 00:23:50.963525+00:00", "timestamp": 1765326230.963525}}}
2025-12-10T00:23:50.964323509Z {"text": "Failed to generate prediction with openai/gpt-5\n", "record": {"elapsed": {"repr": "0:00:56.928008", "seconds": 56.928008}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "81c2cab3ca9d4c39a8e2ec1a2a3402bb", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "artifact": {"error": "RetryError[<Future at 0x7833f2ea5910 state=finished raised UnsupportedParamsError>]"}}, "file": {"name": "pr_processing.py", "path": "/app/pr_agent/algo/pr_processing.py"}, "function": "retry_with_fallback_models", "level": {"icon": "âš ï¸", "name": "WARNING", "no": 30}, "line": 333, "message": "Failed to generate prediction with openai/gpt-5", "module": "pr_processing", "name": "pr_agent.algo.pr_processing", "process": {"id": 9, "name": "MainProcess"}, "thread": {"id": 132164652559232, "name": "MainThread"}, "time": {"repr": "2025-12-10 00:23:50.963971+00:00", "timestamp": 1765326230.963971}}}
2025-12-10T00:23:50.964332132Z {"text": "Generating prediction with openai/gpt-5-mini\n", "record": {"elapsed": {"repr": "0:00:56.928173", "seconds": 56.928173}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "81c2cab3ca9d4c39a8e2ec1a2a3402bb", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "pr_processing.py", "path": "/app/pr_agent/algo/pr_processing.py"}, "function": "retry_with_fallback_models", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 326, "message": "Generating prediction with openai/gpt-5-mini", "module": "pr_processing", "name": "pr_agent.algo.pr_processing", "process": {"id": 9, "name": "MainProcess"}, "thread": {"id": 132164652559232, "name": "MainThread"}, "time": {"repr": "2025-12-10 00:23:50.964136+00:00", "timestamp": 1765326230.964136}}}
2025-12-10T00:23:51.216079102Z {"text": "PR main language: TypeScript\n", "record": {"elapsed": {"repr": "0:00:57.179600", "seconds": 57.1796}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "81c2cab3ca9d4c39a8e2ec1a2a3402bb", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "pr_processing.py", "path": "/app/pr_agent/algo/pr_processing.py"}, "function": "get_pr_diff", "level": {"icon": "â„¹ï¸", "name": "INFO", "no": 20}, "line": 63, "message": "PR main language: TypeScript", "module": "pr_processing", "name": "pr_agent.algo.pr_processing", "process": {"id": 9, "name": "MainProcess"}, "thread": {"id": 132164652559232, "name": "MainThread"}, "time": {"repr": "2025-12-10 00:23:51.215563+00:00", "timestamp": 1765326231.215563}}}
2025-12-10T00:23:51.226449610Z {"text": "Tokens: 4738, total tokens under limit: 32000, returning full diff.\n", "record": {"elapsed": {"repr": "0:00:57.189984", "seconds": 57.189984}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "81c2cab3ca9d4c39a8e2ec1a2a3402bb", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "pr_processing.py", "path": "/app/pr_agent/algo/pr_processing.py"}, "function": "get_pr_diff", "level": {"icon": "â„¹ï¸", "name": "INFO", "no": 20}, "line": 74, "message": "Tokens: 4738, total tokens under limit: 32000, returning full diff.", "module": "pr_processing", "name": "pr_agent.algo.pr_processing", "process": {"id": 9, "name": "MainProcess"}, "thread": {"id": 132164652559232, "name": "MainThread"}, "time": {"repr": "2025-12-10 00:23:51.225947+00:00", "timestamp": 1765326231.225947}}}
2025-12-10T00:23:51.226635940Z {"text": "PR diff\n", "record": {"elapsed": {"repr": "0:00:57.190300", "seconds": 57.1903}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "81c2cab3ca9d4c39a8e2ec1a2a3402bb", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "diff": "\n\n## File: 'app/search/page.tsx'\n\n@@ -1,7 +1,8 @@\n__new hunk__\n1  \"use client\"\n2  \n3 +import { useState, useEffect, useMemo, useRef } from \"react\"\n4 +// import { X } from \"lucide-react\"\n5  import { useSearchParams, useRouter } from \"next/navigation\"\n6  import { useQuery } from \"@tanstack/react-query\"\n7  import { Input } from \"@/components/ui/input\"\n8  import { Button } from \"@/components/ui/button\"\n__old hunk__\n \"use client\"\n \n-import { useState, useEffect, useMemo } from \"react\"\n import { useSearchParams, useRouter } from \"next/navigation\"\n import { useQuery } from \"@tanstack/react-query\"\n import { Input } from \"@/components/ui/input\"\n import { Button } from \"@/components/ui/button\"\n\n@@ -41,11 +42,12 @@\n__new hunk__\n42  export default function SearchPage() {\n43    const searchParams = useSearchParams()\n44    const router = useRouter()\n45    const { filters, setFilters, resetFilters } = useFilters()\n46    const { settings } = useSettings()\n47  \n48    const [searchQuery, setSearchQuery] = useState(searchParams.get(\"q\") || filters.q || \"\")\n49 +  const inputRef = useRef<HTMLInputElement>(null);\n50    const [sortBy, setSortBy] = useState<SortOption>(settings.behavior.defaultSort || \"time\")\n51    const [filtersOpen, setFiltersOpen] = useState(false)\n52  \n53    // Update search query from URL params\n\n@@ -75,29 +77,54 @@ export default function SearchPage() {\n__new hunk__\n77        filters.fiberMin > 0 ||\n78        filters.sugarMax < 100 ||\n79        filters.sodiumMax < 4000 ||\n80        filters.maxTime < 120 ||\n81        !!filters.mealType\n82      )\n83    }, [filters])\n84  \n85 +  // const activeFilterCount = useMemo(() => {\n86 +  //   let count = 0\n87 +  //   if (filters.dietaryRestrictions.length > 0) count++\n88 +  //   if (filters.allergens.length > 0) count++\n89 +  //   if (filters.cuisines.length > 0) count++\n90 +  //   if (filters.majorConditions.length > 0) count++\n91 +  //   if (filters.calories[0] > 0 || filters.calories[1] < 1200) count++\n92 +  //   if (filters.proteinMin > 0) count++\n93 +  //   if (filters.carbsMin > 0) count++\n94 +  //   if (filters.fatMin > 0) count++\n95 +  //   if (filters.fiberMin > 0) count++\n96 +  //   if (filters.sugarMax < 100) count++\n97 +  //   if (filters.sodiumMax < 4000) count++\n98 +  //   if (filters.maxTime < 120) count++\n99 +  //   if (filters.mealType) count++\n100 +  //   return count\n101 +  // }, [filters])\n102    const activeFilterCount = useMemo(() => {\n103 +    let count = 0;\n104 +\n105 +  // Sum all selected array filters\n106 +    count += filters.dietaryRestrictions.length;\n107 +    count += filters.allergens.length;\n108 +    count += filters.cuisines.length;\n109 +    count += filters.majorConditions.length;\n110 +\n111 +    // Range and min/max filters\n112 +    if (filters.calories[0] > 0) count++; // Min calories\n113 +    if (filters.calories[1] < 1200) count++; // Max calories\n114 +    if (filters.proteinMin > 0) count++;\n115 +    if (filters.carbsMin > 0) count++;\n116 +    if (filters.fatMin > 0) count++;\n117 +    if (filters.fiberMin > 0) count++;\n118 +    if (filters.sugarMax < 100) count++;\n119 +    if (filters.sodiumMax < 4000) count++;\n120 +    if (filters.maxTime < 120) count++;\n121 +    \n122 +    // Single-value selection\n123 +    if (filters.mealType) count++;\n124 +\n125 +    return count;\n126 +  }, [filters]);\n127  \n128    const {\n129      data: searchResults = [],\n130      isLoading,\n__old hunk__\n       filters.fiberMin > 0 ||\n       filters.sugarMax < 100 ||\n       filters.sodiumMax < 4000 ||\n       filters.maxTime < 120 ||\n       !!filters.mealType\n     )\n   }, [filters])\n \n   const activeFilterCount = useMemo(() => {\n-    let count = 0\n-    if (filters.dietaryRestrictions.length > 0) count++\n-    if (filters.allergens.length > 0) count++\n-    if (filters.cuisines.length > 0) count++\n-    if (filters.majorConditions.length > 0) count++\n-    if (filters.calories[0] > 0 || filters.calories[1] < 1200) count++\n-    if (filters.proteinMin > 0) count++\n-    if (filters.carbsMin > 0) count++\n-    if (filters.fatMin > 0) count++\n-    if (filters.fiberMin > 0) count++\n-    if (filters.sugarMax < 100) count++\n-    if (filters.sodiumMax < 4000) count++\n-    if (filters.maxTime < 120) count++\n-    if (filters.mealType) count++\n-    return count\n-  }, [filters])\n \n   const {\n     data: searchResults = [],\n     isLoading,\n\n@@ -113,12 +140,22 @@ export default function SearchPage() {\n__new hunk__\n140          const rankedResults = rank(rawResults, settings)\n141          return rankedResults\n142        }\n143  \n144        return rawResults.map((recipe) => ({ ...recipe, score: 0 }))\n145      },\n146      enabled: !!(searchQuery || hasActiveFilters),\n147    })\n148 +  const handleSearchInputKeyDown = (e: React.KeyboardEvent<HTMLInputElement>) => {\n149 +    if (e.key === \"Escape\" && searchQuery) {\n150 +      setSearchQuery(\"\");\n151 +      inputRef.current?.focus();\n152 +    }\n153 +    if (e.key === \"Enter\") {\n154 +      handleSearch(searchQuery);\n155 +    }\n156 +  };\n157 +\n158  \n159    const handleSearch = (query: string) => {\n160      setSearchQuery(query)\n161      setFilters({ ...filters, q: query })\n\n@@ -182,13 +219,13 @@ export default function SearchPage() {\n__new hunk__\n219    return (\n220      <div className=\"container px-4 py-6 max-w-6xl\">\n221        <div className=\"space-y-6\">\n222          {/* Search Header */}\n223          <div className=\"space-y-4\">\n224            <h1 className=\"text-3xl font-bold\">Search Recipes</h1>\n225  \n226            {/* Search Input */}\n227 +          {/* <div className=\"relative\">\n228              <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n229              <Input\n230                role=\"search\"\n231                placeholder=\"Search recipes, ingredients, cuisines...\"\n__old hunk__\n   return (\n     <div className=\"container px-4 py-6 max-w-6xl\">\n       <div className=\"space-y-6\">\n         {/* Search Header */}\n         <div className=\"space-y-4\">\n           <h1 className=\"text-3xl font-bold\">Search Recipes</h1>\n \n           {/* Search Input */}\n-          <div className=\"relative\">\n             <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n             <Input\n               role=\"search\"\n               placeholder=\"Search recipes, ingredients, cuisines...\"\n\n@@ -192,14 +229,51 @@ export default function SearchPage() {\n__new hunk__\n229              <Input\n230                role=\"search\"\n231                placeholder=\"Search recipes, ingredients, cuisines...\"\n232                value={searchQuery}\n233                onChange={(e) => setSearchQuery(e.target.value)}\n234                onKeyDown={(e) => e.key === \"Enter\" && handleSearch(searchQuery)}\n235                className=\"pl-10 pr-4 h-12 text-lg\"\n236              />\n237 +          </div> */}\n238 +          <div style={{ position: \"relative\", display: \"inline-block\", width: \"100%\" }}>\n239 +            <Search style={{ position: \"absolute\", left: \"0.75rem\", top: \"50%\", transform: \"translateY(-50%)\", height: \"1rem\", width: \"1rem\", color: \"gray\" }} />\n240 +            <Input\n241 +              role=\"search\"\n242 +              ref={inputRef}\n243 +              placeholder=\"Search recipes, ingredients, cuisines...\"\n244 +              value={searchQuery}\n245 +              onChange={(e) => setSearchQuery(e.target.value)}\n246 +              onKeyDown={handleSearchInputKeyDown}\n247 +              style={{ paddingRight: searchQuery ? \"2rem\" : undefined, width: \"100%\" }}\n248 +              className=\"pl-10 pr-4 h-12 text-lg\"\n249 +            />\n250 +            {searchQuery && (\n251 +              <button\n252 +                type=\"button\"\n253 +                style={{\n254 +                  position: \"absolute\",\n255 +                  right: \"0.75rem\",\n256 +                  top: \"50%\",\n257 +                  transform: \"translateY(-50%)\",\n258 +                  background: \"none\",\n259 +                  border: \"none\",\n260 +                  cursor: \"pointer\",\n261 +                  padding: 0,\n262 +                  color: \"gray\",\n263 +                }}\n264 +                aria-label=\"Clear search\"\n265 +                onClick={() => {\n266 +                  setSearchQuery(\"\");\n267 +                  inputRef.current?.focus();\n268 +              }}\n269 +              >\n270 +                <X size={20} />\n271 +            </button>\n272 +          )}\n273            </div>\n274  \n275 +\n276            {/* Search Actions */}\n277            <div className=\"flex items-center gap-2\">\n278              <Button onClick={() => handleSearch(searchQuery)} size=\"sm\">\n279                Search\n\n\n## File: 'components/filter-panel.tsx'\n\n@@ -54,35 +54,58 @@\n__new hunk__\n54  export function FilterPanel({ open, onOpenChange, initialValues, onApply, onReset }: FilterPanelProps) {\n55    const form = useForm<FiltersFormInput>({\n56      resolver: zodResolver(schema),\n57      // provide full defaults (OUTPUT fits into INPUT just fine)\n58      defaultValues: schema.parse(initialValues ?? {}),\n59      mode: \"onChange\",\n60    })\n61  \n62     useEffect(() => {\n63      form.reset(schema.parse(initialValues ?? {}));\n64    }, [open, initialValues, form]);\n65  \n66 +  // function getActiveFiltersCount(): number {\n67 +  //   const values = form.getValues()\n68 +  //   let count = 0\n69 +  //   if ((values.dietaryRestrictions || []).length > 0) count++\n70 +  //   if ((values.allergens || []).length > 0) count++\n71 +  //   if ((values.cuisines || []).length > 0) count++\n72 +  //   if ((values.majorConditions || []).length > 0) count++\n73 +  //   if (values.calories && (values.calories[0] > 0 || values.calories[1] < 1200)) count++\n74 +  //   if ((values.proteinMin || 0) > 0) count++\n75 +  //   if ((values.carbsMin || 0) > 0) count++\n76 +  //   if ((values.fatMin || 0) > 0) count++\n77 +  //   if ((values.fiberMin || 0) > 0) count++\n78 +  //   if ((values.sugarMax || 100) < 100) count++\n79 +  //   if ((values.sodiumMax || 4000) < 4000) count++\n80 +  //   if ((values.maxTime || 120) < 120) count++\n81 +  //   if ((values.mealType || \"\") !== \"\") count++\n82 +  //   return count\n83 +  // }\n84    function getActiveFiltersCount(): number {\n85 +    const values = form.getValues();\n86 +    let count = 0;\n87 +\n88 +    // Count all selected array filters individually\n89 +    count += values.dietaryRestrictions.length;\n90 +    count += values.allergens.length;\n91 +    count += values.cuisines.length;\n92 +    count += values.majorConditions.length;\n93 +\n94 +    // Numeric and single-value filters\n95 +    if (values.calories[0] > 0) count++;           // Min calories\n96 +    if (values.calories[1] < 1200) count++;        // Max calories\n97 +    if (values.proteinMin > 0) count++;\n98 +    if (values.carbsMin > 0) count++;\n99 +    if (values.fatMin > 0) count++;\n100 +    if (values.fiberMin > 0) count++;\n101 +    if (values.sugarMax < 100) count++;\n102 +    if (values.sodiumMax < 4000) count++;\n103 +    if (values.maxTime < 120) count++;\n104 +    if (values.mealType) count++;\n105 +\n106 +    return count;\n107    }\n108    function handleApply() {\n109      const values = schema.parse(form.getValues())\n110      onApply(values)\n111      onOpenChange(false)\n__old hunk__\n export function FilterPanel({ open, onOpenChange, initialValues, onApply, onReset }: FilterPanelProps) {\n   const form = useForm<FiltersFormInput>({\n     resolver: zodResolver(schema),\n     // provide full defaults (OUTPUT fits into INPUT just fine)\n     defaultValues: schema.parse(initialValues ?? {}),\n     mode: \"onChange\",\n   })\n \n    useEffect(() => {\n     form.reset(schema.parse(initialValues ?? {}));\n   }, [open, initialValues, form]);\n \n   function getActiveFiltersCount(): number {\n-    const values = form.getValues()\n-    let count = 0\n-    if ((values.dietaryRestrictions || []).length > 0) count++\n-    if ((values.allergens || []).length > 0) count++\n-    if ((values.cuisines || []).length > 0) count++\n-    if ((values.majorConditions || []).length > 0) count++\n-    if (values.calories && (values.calories[0] > 0 || values.calories[1] < 1200)) count++\n-    if ((values.proteinMin || 0) > 0) count++\n-    if ((values.carbsMin || 0) > 0) count++\n-    if ((values.fatMin || 0) > 0) count++\n-    if ((values.fiberMin || 0) > 0) count++\n-    if ((values.sugarMax || 100) < 100) count++\n-    if ((values.sodiumMax || 4000) < 4000) count++\n-    if ((values.maxTime || 120) < 120) count++\n-    if ((values.mealType || \"\") !== \"\") count++\n-    return count\n   }\n-\n   function handleApply() {\n     const values = schema.parse(form.getValues())\n     onApply(values)\n     onOpenChange(false)"}, "file": {"name": "pr_reviewer.py", "path": "/app/pr_agent/tools/pr_reviewer.py"}, "function": "_prepare_prediction", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 197, "message": "PR diff", "module": "pr_reviewer", "name": "pr_agent.tools.pr_reviewer", "process": {"id": 9, "name": "MainProcess"}, "thread": {"id": 132164652559232, "name": "MainThread"}, "time": {"repr": "2025-12-10 00:23:51.226263+00:00", "timestamp": 1765326231.226263}}}
2025-12-10T00:23:51.243045409Z {"text": "Prompts\n", "record": {"elapsed": {"repr": "0:00:57.206267", "seconds": 57.206267}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "81c2cab3ca9d4c39a8e2ec1a2a3402bb", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "artifact": {"system": "You are PR-Reviewer, a language model designed to review a Git Pull Request (PR).\nYour task is to provide constructive and concise feedback for the PR.\nThe review should focus on new code added in the PR code diff (lines starting with '+')\n\n\nThe format we will use to present the PR code diff:\n======\n## File: 'src/file1.py'\n\n\n@@ ... @@ def func1():\n__new hunk__\n11  unchanged code line0\n12  unchanged code line1\n13 +new code line2 added\n14  unchanged code line3\n__old hunk__\n unchanged code line0\n unchanged code line1\n-old code line2 removed\n unchanged code line3\n\n@@ ... @@ def func2():\n__new hunk__\n unchanged code line4\n+new code line5 added\n unchanged code line6\n\n## File: 'src/file2.py'\n...\n======\n\n- In the format above, the diff is organized into separate '__new hunk__' and '__old hunk__' sections for each code chunk. '__new hunk__' contains the updated code, while '__old hunk__' shows the removed code. If no code was removed in a specific chunk, the __old hunk__ section will be omitted.\n- We also added line numbers for the '__new hunk__' code, to help you refer to the code lines in your suggestions. These line numbers are not part of the actual code, and should only be used for reference.\n- Code lines are prefixed with symbols ('+', '-', ' '). The '+' symbol indicates new code added in the PR, the '-' symbol indicates code removed in the PR, and the ' ' symbol indicates unchanged code. The review should address new code added in the PR code diff (lines starting with '+').\n- When quoting variables, names or file paths from the code, use backticks (`) instead of single quote (').\n- Note that you only see changed code segments (diff hunks in a PR), not the entire codebase. Avoid suggestions that might duplicate existing functionality or questioning code elements (like variables declarations or import statements) that may be defined elsewhere in the codebase.\n- Also note that if the code ends at an opening brace or statement that begins a new scope (like 'if', 'for', 'try'), don't treat it as incomplete. Instead, acknowledge the visible scope boundary and analyze only the code shown.\n\n\nThe output must be a YAML object equivalent to type $PRReview, according to the following Pydantic definitions:\n=====\n\nclass KeyIssuesComponentLink(BaseModel):\n    relevant_file: str = Field(description=\"The full file path of the relevant file\")\n    issue_header: str = Field(description=\"One or two word title for the issue. For example: 'Possible Bug', etc.\")\n    issue_content: str = Field(description=\"A short and concise summary of what should be further inspected and validated during the PR review process for this issue. Do not mention line numbers in this field.\")\n    start_line: int = Field(description=\"The start line that corresponds to this issue in the relevant file\")\n    end_line: int = Field(description=\"The end line that corresponds to this issue in the relevant file\")\n\nclass Review(BaseModel):\n    estimated_effort_to_review_[1-5]: int = Field(description=\"Estimate, on a scale of 1-5 (inclusive), the time and effort required to review this PR by an experienced and knowledgeable developer. 1 means short and easy review , 5 means long and hard review. Take into account the size, complexity, quality, and the needed changes of the PR code diff.\")\n    relevant_tests: str = Field(description=\"yes/no question: does this PR have relevant tests added or updated ?\")\n    key_issues_to_review: List[KeyIssuesComponentLink] = Field(\"A short and diverse list (0-3 issues) of high-priority bugs, problems or performance concerns introduced in the PR code, which the PR reviewer should further focus on and validate during the review process.\")\n    security_concerns: str = Field(description=\"Does this PR code introduce vulnerabilities such as exposure of sensitive information (e.g., API keys, secrets, passwords), or security concerns like SQL injection, XSS, CSRF, and others ? Answer 'No' (without explaining why) if there are no possible issues. If there are security concerns or issues, start your answer with a short header, such as: 'Sensitive information exposure: ...', 'SQL injection: ...', etc. Explain your answer. Be specific and give examples if possible\")\n\nclass PRReview(BaseModel):\n    review: Review\n=====\n\n\nExample output:\n```yaml\nreview:\n  estimated_effort_to_review_[1-5]: |\n    3\n  relevant_tests: |\n    No\n  key_issues_to_review:\n    - relevant_file: |\n        directory/xxx.py\n      issue_header: |\n        Possible Bug\n      issue_content: |\n        ...\n      start_line: 12\n      end_line: 14\n    - ...\n  security_concerns: |\n    No\n```\n\nAnswer should be a valid YAML, and nothing else. Each YAML output MUST be after a newline, with proper indent, and block scalar indicator ('|')", "user": "\n\n\n--PR Info--\n\nToday's Date: 2025-12-10\n\nTitle: 'Fix: Search UX and multi-filter logic (frontend)'\n\nBranch: 'feature/initial-fixes'\n\nPR Description:\n======\n- Improved search bar UX in app/search/page.tsx:\r\n  - X icon clears input and refocuses\r\n  - Escape key clears input\r\n  - Enter key triggers search\r\n\r\n- Updated filter count logic:\r\n  - Accurately counts all active filters\r\n  - Apply button badge reflects true total\n======\n\n\nThe PR code diff:\n======\n## File: 'app/search/page.tsx'\n\n@@ -1,7 +1,8 @@\n__new hunk__\n1  \"use client\"\n2  \n3 +import { useState, useEffect, useMemo, useRef } from \"react\"\n4 +// import { X } from \"lucide-react\"\n5  import { useSearchParams, useRouter } from \"next/navigation\"\n6  import { useQuery } from \"@tanstack/react-query\"\n7  import { Input } from \"@/components/ui/input\"\n8  import { Button } from \"@/components/ui/button\"\n__old hunk__\n \"use client\"\n \n-import { useState, useEffect, useMemo } from \"react\"\n import { useSearchParams, useRouter } from \"next/navigation\"\n import { useQuery } from \"@tanstack/react-query\"\n import { Input } from \"@/components/ui/input\"\n import { Button } from \"@/components/ui/button\"\n\n@@ -41,11 +42,12 @@\n__new hunk__\n42  export default function SearchPage() {\n43    const searchParams = useSearchParams()\n44    const router = useRouter()\n45    const { filters, setFilters, resetFilters } = useFilters()\n46    const { settings } = useSettings()\n47  \n48    const [searchQuery, setSearchQuery] = useState(searchParams.get(\"q\") || filters.q || \"\")\n49 +  const inputRef = useRef<HTMLInputElement>(null);\n50    const [sortBy, setSortBy] = useState<SortOption>(settings.behavior.defaultSort || \"time\")\n51    const [filtersOpen, setFiltersOpen] = useState(false)\n52  \n53    // Update search query from URL params\n\n@@ -75,29 +77,54 @@ export default function SearchPage() {\n__new hunk__\n77        filters.fiberMin > 0 ||\n78        filters.sugarMax < 100 ||\n79        filters.sodiumMax < 4000 ||\n80        filters.maxTime < 120 ||\n81        !!filters.mealType\n82      )\n83    }, [filters])\n84  \n85 +  // const activeFilterCount = useMemo(() => {\n86 +  //   let count = 0\n87 +  //   if (filters.dietaryRestrictions.length > 0) count++\n88 +  //   if (filters.allergens.length > 0) count++\n89 +  //   if (filters.cuisines.length > 0) count++\n90 +  //   if (filters.majorConditions.length > 0) count++\n91 +  //   if (filters.calories[0] > 0 || filters.calories[1] < 1200) count++\n92 +  //   if (filters.proteinMin > 0) count++\n93 +  //   if (filters.carbsMin > 0) count++\n94 +  //   if (filters.fatMin > 0) count++\n95 +  //   if (filters.fiberMin > 0) count++\n96 +  //   if (filters.sugarMax < 100) count++\n97 +  //   if (filters.sodiumMax < 4000) count++\n98 +  //   if (filters.maxTime < 120) count++\n99 +  //   if (filters.mealType) count++\n100 +  //   return count\n101 +  // }, [filters])\n102    const activeFilterCount = useMemo(() => {\n103 +    let count = 0;\n104 +\n105 +  // Sum all selected array filters\n106 +    count += filters.dietaryRestrictions.length;\n107 +    count += filters.allergens.length;\n108 +    count += filters.cuisines.length;\n109 +    count += filters.majorConditions.length;\n110 +\n111 +    // Range and min/max filters\n112 +    if (filters.calories[0] > 0) count++; // Min calories\n113 +    if (filters.calories[1] < 1200) count++; // Max calories\n114 +    if (filters.proteinMin > 0) count++;\n115 +    if (filters.carbsMin > 0) count++;\n116 +    if (filters.fatMin > 0) count++;\n117 +    if (filters.fiberMin > 0) count++;\n118 +    if (filters.sugarMax < 100) count++;\n119 +    if (filters.sodiumMax < 4000) count++;\n120 +    if (filters.maxTime < 120) count++;\n121 +    \n122 +    // Single-value selection\n123 +    if (filters.mealType) count++;\n124 +\n125 +    return count;\n126 +  }, [filters]);\n127  \n128    const {\n129      data: searchResults = [],\n130      isLoading,\n__old hunk__\n       filters.fiberMin > 0 ||\n       filters.sugarMax < 100 ||\n       filters.sodiumMax < 4000 ||\n       filters.maxTime < 120 ||\n       !!filters.mealType\n     )\n   }, [filters])\n \n   const activeFilterCount = useMemo(() => {\n-    let count = 0\n-    if (filters.dietaryRestrictions.length > 0) count++\n-    if (filters.allergens.length > 0) count++\n-    if (filters.cuisines.length > 0) count++\n-    if (filters.majorConditions.length > 0) count++\n-    if (filters.calories[0] > 0 || filters.calories[1] < 1200) count++\n-    if (filters.proteinMin > 0) count++\n-    if (filters.carbsMin > 0) count++\n-    if (filters.fatMin > 0) count++\n-    if (filters.fiberMin > 0) count++\n-    if (filters.sugarMax < 100) count++\n-    if (filters.sodiumMax < 4000) count++\n-    if (filters.maxTime < 120) count++\n-    if (filters.mealType) count++\n-    return count\n-  }, [filters])\n \n   const {\n     data: searchResults = [],\n     isLoading,\n\n@@ -113,12 +140,22 @@ export default function SearchPage() {\n__new hunk__\n140          const rankedResults = rank(rawResults, settings)\n141          return rankedResults\n142        }\n143  \n144        return rawResults.map((recipe) => ({ ...recipe, score: 0 }))\n145      },\n146      enabled: !!(searchQuery || hasActiveFilters),\n147    })\n148 +  const handleSearchInputKeyDown = (e: React.KeyboardEvent<HTMLInputElement>) => {\n149 +    if (e.key === \"Escape\" && searchQuery) {\n150 +      setSearchQuery(\"\");\n151 +      inputRef.current?.focus();\n152 +    }\n153 +    if (e.key === \"Enter\") {\n154 +      handleSearch(searchQuery);\n155 +    }\n156 +  };\n157 +\n158  \n159    const handleSearch = (query: string) => {\n160      setSearchQuery(query)\n161      setFilters({ ...filters, q: query })\n\n@@ -182,13 +219,13 @@ export default function SearchPage() {\n__new hunk__\n219    return (\n220      <div className=\"container px-4 py-6 max-w-6xl\">\n221        <div className=\"space-y-6\">\n222          {/* Search Header */}\n223          <div className=\"space-y-4\">\n224            <h1 className=\"text-3xl font-bold\">Search Recipes</h1>\n225  \n226            {/* Search Input */}\n227 +          {/* <div className=\"relative\">\n228              <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n229              <Input\n230                role=\"search\"\n231                placeholder=\"Search recipes, ingredients, cuisines...\"\n__old hunk__\n   return (\n     <div className=\"container px-4 py-6 max-w-6xl\">\n       <div className=\"space-y-6\">\n         {/* Search Header */}\n         <div className=\"space-y-4\">\n           <h1 className=\"text-3xl font-bold\">Search Recipes</h1>\n \n           {/* Search Input */}\n-          <div className=\"relative\">\n             <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n             <Input\n               role=\"search\"\n               placeholder=\"Search recipes, ingredients, cuisines...\"\n\n@@ -192,14 +229,51 @@ export default function SearchPage() {\n__new hunk__\n229              <Input\n230                role=\"search\"\n231                placeholder=\"Search recipes, ingredients, cuisines...\"\n232                value={searchQuery}\n233                onChange={(e) => setSearchQuery(e.target.value)}\n234                onKeyDown={(e) => e.key === \"Enter\" && handleSearch(searchQuery)}\n235                className=\"pl-10 pr-4 h-12 text-lg\"\n236              />\n237 +          </div> */}\n238 +          <div style={{ position: \"relative\", display: \"inline-block\", width: \"100%\" }}>\n239 +            <Search style={{ position: \"absolute\", left: \"0.75rem\", top: \"50%\", transform: \"translateY(-50%)\", height: \"1rem\", width: \"1rem\", color: \"gray\" }} />\n240 +            <Input\n241 +              role=\"search\"\n242 +              ref={inputRef}\n243 +              placeholder=\"Search recipes, ingredients, cuisines...\"\n244 +              value={searchQuery}\n245 +              onChange={(e) => setSearchQuery(e.target.value)}\n246 +              onKeyDown={handleSearchInputKeyDown}\n247 +              style={{ paddingRight: searchQuery ? \"2rem\" : undefined, width: \"100%\" }}\n248 +              className=\"pl-10 pr-4 h-12 text-lg\"\n249 +            />\n250 +            {searchQuery && (\n251 +              <button\n252 +                type=\"button\"\n253 +                style={{\n254 +                  position: \"absolute\",\n255 +                  right: \"0.75rem\",\n256 +                  top: \"50%\",\n257 +                  transform: \"translateY(-50%)\",\n258 +                  background: \"none\",\n259 +                  border: \"none\",\n260 +                  cursor: \"pointer\",\n261 +                  padding: 0,\n262 +                  color: \"gray\",\n263 +                }}\n264 +                aria-label=\"Clear search\"\n265 +                onClick={() => {\n266 +                  setSearchQuery(\"\");\n267 +                  inputRef.current?.focus();\n268 +              }}\n269 +              >\n270 +                <X size={20} />\n271 +            </button>\n272 +          )}\n273            </div>\n274  \n275 +\n276            {/* Search Actions */}\n277            <div className=\"flex items-center gap-2\">\n278              <Button onClick={() => handleSearch(searchQuery)} size=\"sm\">\n279                Search\n\n\n## File: 'components/filter-panel.tsx'\n\n@@ -54,35 +54,58 @@\n__new hunk__\n54  export function FilterPanel({ open, onOpenChange, initialValues, onApply, onReset }: FilterPanelProps) {\n55    const form = useForm<FiltersFormInput>({\n56      resolver: zodResolver(schema),\n57      // provide full defaults (OUTPUT fits into INPUT just fine)\n58      defaultValues: schema.parse(initialValues ?? {}),\n59      mode: \"onChange\",\n60    })\n61  \n62     useEffect(() => {\n63      form.reset(schema.parse(initialValues ?? {}));\n64    }, [open, initialValues, form]);\n65  \n66 +  // function getActiveFiltersCount(): number {\n67 +  //   const values = form.getValues()\n68 +  //   let count = 0\n69 +  //   if ((values.dietaryRestrictions || []).length > 0) count++\n70 +  //   if ((values.allergens || []).length > 0) count++\n71 +  //   if ((values.cuisines || []).length > 0) count++\n72 +  //   if ((values.majorConditions || []).length > 0) count++\n73 +  //   if (values.calories && (values.calories[0] > 0 || values.calories[1] < 1200)) count++\n74 +  //   if ((values.proteinMin || 0) > 0) count++\n75 +  //   if ((values.carbsMin || 0) > 0) count++\n76 +  //   if ((values.fatMin || 0) > 0) count++\n77 +  //   if ((values.fiberMin || 0) > 0) count++\n78 +  //   if ((values.sugarMax || 100) < 100) count++\n79 +  //   if ((values.sodiumMax || 4000) < 4000) count++\n80 +  //   2025-12-10T00:23:51.243045409Z if ((values.maxTime || 120) < 120) count++\n81 +  //   if ((values.mealType || \"\") !== \"\") count++\n82 +  //   return count\n83 +  // }\n84    function getActiveFiltersCount(): number {\n85 +    const values = form.getValues();\n86 +    let count = 0;\n87 +\n88 +    // Count all selected array filters individually\n89 +    count += values.dietaryRestrictions.length;\n90 +    count += values.allergens.length;\n91 +    count += values.cuisines.length;\n92 +    count += values.majorConditions.length;\n93 +\n94 +    // Numeric and single-value filters\n95 +    if (values.calories[0] > 0) count++;           // Min calories\n96 +    if (values.calories[1] < 1200) count++;        // Max calories\n97 +    if (values.proteinMin > 0) count++;\n98 +    if (values.carbsMin > 0) count++;\n99 +    if (values.fatMin > 0) count++;\n100 +    if (values.fiberMin > 0) count++;\n101 +    if (values.sugarMax < 100) count++;\n102 +    if (values.sodiumMax < 4000) count++;\n103 +    if (values.maxTime < 120) count++;\n104 +    if (values.mealType) count++;\n105 +\n106 +    return count;\n107    }\n108    function handleApply() {\n109      const values = schema.parse(form.getValues())\n110      onApply(values)\n111      onOpenChange(false)\n__old hunk__\n export function FilterPanel({ open, onOpenChange, initialValues, onApply, onReset }: FilterPanelProps) {\n   const form = useForm<FiltersFormInput>({\n     resolver: zodResolver(schema),\n     // provide full defaults (OUTPUT fits into INPUT just fine)\n     defaultValues: schema.parse(initialValues ?? {}),\n     mode: \"onChange\",\n   })\n \n    useEffect(() => {\n     form.reset(schema.parse(initialValues ?? {}));\n   }, [open, initialValues, form]);\n \n   function getActiveFiltersCount(): number {\n-    const values = form.getValues()\n-    let count = 0\n-    if ((values.dietaryRestrictions || []).length > 0) count++\n-    if ((values.allergens || []).length > 0) count++\n-    if ((values.cuisines || []).length > 0) count++\n-    if ((values.majorConditions || []).length > 0) count++\n-    if (values.calories && (values.calories[0] > 0 || values.calories[1] < 1200)) count++\n-    if ((values.proteinMin || 0) > 0) count++\n-    if ((values.carbsMin || 0) > 0) count++\n-    if ((values.fatMin || 0) > 0) count++\n-    if ((values.fiberMin || 0) > 0) count++\n-    if ((values.sugarMax || 100) < 100) count++\n-    if ((values.sodiumMax || 4000) < 4000) count++\n-    if ((values.maxTime || 120) < 120) count++\n-    if ((values.mealType || \"\") !== \"\") count++\n-    return count\n   }\n-\n   function handleApply() {\n     const values = schema.parse(form.getValues())\n     onApply(values)\n     onOpenChange(false)\n======\n\n\nResponse (should be a valid YAML, and nothing else):\n```yaml"}}, "file": {"name": "litellm_ai_handler.py", "path": "/app/pr_agent/algo/ai_handlers/litellm_ai_handler.py"}, "function": "chat_completion", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 383, "message": "Prompts", "module": "litellm_ai_handler", "name": "pr_agent.algo.ai_handlers.litellm_ai_handler", "process": {"id": 9, "name": "MainProcess"}, "thread": {"id": 132164652559232, "name": "MainThread"}, "time": {"repr": "2025-12-10 00:23:51.242230+00:00", "timestamp": 1765326231.24223}}}
2025-12-10T00:23:51.254766803Z {"text": "Error during LLM inference: litellm.UnsupportedParamsError: gpt-5 models (including gpt-5-codex) don't support temperature=0.2. Only temperature=1 is supported. To drop unsupported params set `litellm.drop_params = True`\n", "record": {"elapsed": {"repr": "0:00:57.218344", "seconds": 57.218344}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "81c2cab3ca9d4c39a8e2ec1a2a3402bb", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "litellm_ai_handler.py", "path": "/app/pr_agent/algo/ai_handlers/litellm_ai_handler.py"}, "function": "chat_completion", "level": {"icon": "âš ï¸", "name": "WARNING", "no": 30}, "line": 396, "message": "Error during LLM inference: litellm.UnsupportedParamsError: gpt-5 models (including gpt-5-codex) don't support temperature=0.2. Only temperature=1 is supported. To drop unsupported params set `litellm.drop_params = True`", "module": "litellm_ai_handler", "name": "pr_agent.algo.ai_handlers.litellm_ai_handler", "process": {"id": 9, "name": "MainProcess"}, "thread": {"id": 132164652559232, "name": "MainThread"}, "time": {"repr": "2025-12-10 00:23:51.254307+00:00", "timestamp": 1765326231.254307}}}
2025-12-10T00:23:51.257895689Z {"text": "Prompts\n", "record": {"elapsed": {"repr": "0:00:57.220573", "seconds": 57.220573}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "81c2cab3ca9d4c39a8e2ec1a2a3402bb", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "artifact": {"system": "You are PR-Reviewer, a language model designed to review a Git Pull Request (PR).\nYour task is to provide constructive and concise feedback for the PR.\nThe review should focus on new code added in the PR code diff (lines starting with '+')\n\n\nThe format we will use to present the PR code diff:\n======\n## File: 'src/file1.py'\n\n\n@@ ... @@ def func1():\n__new hunk__\n11  unchanged code line0\n12  unchanged code line1\n13 +new code line2 added\n14  unchanged code line3\n__old hunk__\n unchanged code line0\n unchanged code line1\n-old code line2 removed\n unchanged code line3\n\n@@ ... @@ def func2():\n__new hunk__\n unchanged code line4\n+new code line5 added\n unchanged code line6\n\n## File: 'src/file2.py'\n...\n======\n\n- In the format above, the diff is organized into separate '__new hunk__' and '__old hunk__' sections for each code chunk. '__new hunk__' contains the updated code, while '__old hunk__' shows the removed code. If no code was removed in a specific chunk, the __old hunk__ section will be omitted.\n- We also added line numbers for the '__new hunk__' code, to help you refer to the code lines in your suggestions. These line numbers are not part of the actual code, and should only be used for reference.\n- Code lines are prefixed with symbols ('+', '-', ' '). The '+' symbol indicates new code added in the PR, the '-' symbol indicates code removed in the PR, and the ' ' symbol indicates unchanged code. The review should address new code added in the PR code diff (lines starting with '+').\n- When quoting variables, names or file paths from the code, use backticks (`) instead of single quote (').\n- Note that you only see changed code segments (diff hunks in a PR), not the entire codebase. Avoid suggestions that might duplicate existing functionality or questioning code elements (like variables declarations or import statements) that may be defined elsewhere in the codebase.\n- Also note that if the code ends at an opening brace or statement that begins a new scope (like 'if', 'for', 'try'), don't treat it as incomplete. Instead, acknowledge the visible scope boundary and analyze only the code shown.\n\n\nThe output must be a YAML object equivalent to type $PRReview, according to the following Pydantic definitions:\n=====\n\nclass KeyIssuesComponentLink(BaseModel):\n    relevant_file: str = Field(description=\"The full file path of the relevant file\")\n    issue_header: str = Field(description=\"One or two word title for the issue. For example: 'Possible Bug', etc.\")\n    issue_content: str = Field(description=\"A short and concise summary of what should be further inspected and validated during the PR review process for this issue. Do not mention line numbers in this field.\")\n    start_line: int = Field(description=\"The start line that corresponds to this issue in the relevant file\")\n    end_line: int = Field(description=\"The end line that corresponds to this issue in the relevant file\")\n\nclass Review(BaseModel):\n    estimated_effort_to_review_[1-5]: int = Field(description=\"Estimate, on a scale of 1-5 (inclusive), the time and effort required to review this PR by an experienced and knowledgeable developer. 1 means short and easy review , 5 means long and hard review. Take into account the size, complexity, quality, and the needed changes of the PR code diff.\")\n    relevant_tests: str = Field(description=\"yes/no question: does this PR have relevant tests added or updated ?\")\n    key_issues_to_review: List[KeyIssuesComponentLink] = Field(\"A short and diverse list (0-3 issues) of high-priority bugs, problems or performance concerns introduced in the PR code, which the PR reviewer should further focus on and validate during the review process.\")\n    security_concerns: str = Field(description=\"Does this PR code introduce vulnerabilities such as exposure of sensitive information (e.g., API keys, secrets, passwords), or security concerns like SQL injection, XSS, CSRF, and others ? Answer 'No' (without explaining why) if there are no possible issues. If there are security concerns or issues, start your answer with a short header, such as: 'Sensitive information exposure: ...', 'SQL injection: ...', etc. Explain your answer. Be specific and give examples if possible\")\n\nclass PRReview(BaseModel):\n    review: Review\n=====\n\n\nExample output:\n```yaml\nreview:\n  estimated_effort_to_review_[1-5]: |\n    3\n  relevant_tests: |\n    No\n  key_issues_to_review:\n    - relevant_file: |\n        directory/xxx.py\n      issue_header: |\n        Possible Bug\n      issue_content: |\n        ...\n      start_line: 12\n      end_line: 14\n    - ...\n  security_concerns: |\n    No\n```\n\nAnswer should be a valid YAML, and nothing else. Each YAML output MUST be after a newline, with proper indent, and block scalar indicator ('|')", "user": "\n\n\n--PR Info--\n\nToday's Date: 2025-12-10\n\nTitle: 'Fix: Search UX and multi-filter logic (frontend)'\n\nBranch: 'feature/initial-fixes'\n\nPR Description:\n======\n- Improved search bar UX in app/search/page.tsx:\r\n  - X icon clears input and refocuses\r\n  - Escape key clears input\r\n  - Enter key triggers search\r\n\r\n- Updated filter count logic:\r\n  - Accurately counts all active filters\r\n  - Apply button badge reflects true total\n======\n\n\nThe PR code diff:\n======\n## File: 'app/search/page.tsx'\n\n@@ -1,7 +1,8 @@\n__new hunk__\n1  \"use client\"\n2  \n3 +import { useState, useEffect, useMemo, useRef } from \"react\"\n4 +// import { X } from \"lucide-react\"\n5  import { useSearchParams, useRouter } from \"next/navigation\"\n6  import { useQuery } from \"@tanstack/react-query\"\n7  import { Input } from \"@/components/ui/input\"\n8  import { Button } from \"@/components/ui/button\"\n__old hunk__\n \"use client\"\n \n-import { useState, useEffect, useMemo } from \"react\"\n import { useSearchParams, useRouter } from \"next/navigation\"\n import { useQuery } from \"@tanstack/react-query\"\n import { Input } from \"@/components/ui/input\"\n import { Button } from \"@/components/ui/button\"\n\n@@ -41,11 +42,12 @@\n__new hunk__\n42  export default function SearchPage() {\n43    const searchParams = useSearchParams()\n44    const router = useRouter()\n45    const { filters, setFilters, resetFilters } = useFilters()\n46    const { settings } = useSettings()\n47  \n48    const [searchQuery, setSearchQuery] = useState(searchParams.get(\"q\") || filters.q || \"\")\n49 +  const inputRef = useRef<HTMLInputElement>(null);\n50    const [sortBy, setSortBy] = useState<SortOption>(settings.behavior.defaultSort || \"time\")\n51    const [filtersOpen, setFiltersOpen] = useState(false)\n52  \n53    // Update search query from URL params\n\n@@ -75,29 +77,54 @@ export default function SearchPage() {\n__new hunk__\n77        filters.fiberMin > 0 ||\n78        filters.sugarMax < 100 ||\n79        filters.sodiumMax < 4000 ||\n80        filters.maxTime < 120 ||\n81        !!filters.mealType\n82      )\n83    }, [filters])\n84  \n85 +  // const activeFilterCount = useMemo(() => {\n86 +  //   let count = 0\n87 +  //   if (filters.dietaryRestrictions.length > 0) count++\n88 +  //   if (filters.allergens.length > 0) count++\n89 +  //   if (filters.cuisines.length > 0) count++\n90 +  //   if (filters.majorConditions.length > 0) count++\n91 +  //   if (filters.calories[0] > 0 || filters.calories[1] < 1200) count++\n92 +  //   if (filters.proteinMin > 0) count++\n93 +  //   if (filters.carbsMin > 0) count++\n94 +  //   if (filters.fatMin > 0) count++\n95 +  //   if (filters.fiberMin > 0) count++\n96 +  //   if (filters.sugarMax < 100) count++\n97 +  //   if (filters.sodiumMax < 4000) count++\n98 +  //   if (filters.maxTime < 120) count++\n99 +  //   if (filters.mealType) count++\n100 +  //   return count\n101 +  // }, [filters])\n102    const activeFilterCount = useMemo(() => {\n103 +    let count = 0;\n104 +\n105 +  // Sum all selected array filters\n106 +    count += filters.dietaryRestrictions.length;\n107 +    count += filters.allergens.length;\n108 +    count += filters.cuisines.length;\n109 +    count += filters.majorConditions.length;\n110 +\n111 +    // Range and min/max filters\n112 +    if (filters.calories[0] > 0) count++; // Min calories\n113 +    if (filters.calories[1] < 1200) count++; // Max calories\n114 +    if (filters.proteinMin > 0) count++;\n115 +    if (filters.carbsMin > 0) count++;\n116 +    if (filters.fatMin > 0) count++;\n117 +    if (filters.fiberMin > 0) count++;\n118 +    if (filters.sugarMax < 100) count++;\n119 +    if (filters.sodiumMax < 4000) count++;\n120 +    if (filters.maxTime < 120) count++;\n121 +    \n122 +    // Single-value selection\n123 +    if (filters.mealType) count++;\n124 +\n125 +    return count;\n126 +  }, [filters]);\n127  \n128    const {\n129      data: searchResults = [],\n130      isLoading,\n__old hunk__\n       filters.fiberMin > 0 ||\n       filters.sugarMax < 100 ||\n       filters.sodiumMax < 4000 ||\n       filters.maxTime < 120 ||\n       !!filters.mealType\n     )\n   }, [filters])\n \n   const activeFilterCount = useMemo(() => {\n-    let count = 0\n-    if (filters.dietaryRestrictions.length > 0) count++\n-    if (filters.allergens.length > 0) count++\n-    if (filters.cuisines.length > 0) count++\n-    if (filters.majorConditions.length > 0) count++\n-    if (filters.calories[0] > 0 || filters.calories[1] < 1200) count++\n-    if (filters.proteinMin > 0) count++\n-    if (filters.carbsMin > 0) count++\n-    if (filters.fatMin > 0) count++\n-    if (filters.fiberMin > 0) count++\n-    if (filters.sugarMax < 100) count++\n-    if (filters.sodiumMax < 4000) count++\n-    if (filters.maxTime < 120) count++\n-    if (filters.mealType) count++\n-    return count\n-  }, [filters])\n \n   const {\n     data: searchResults = [],\n     isLoading,\n\n@@ -113,12 +140,22 @@ export default function SearchPage() {\n__new hunk__\n140          const rankedResults = rank(rawResults, settings)\n141          return rankedResults\n142        }\n143  \n144        return rawResults.map((recipe) => ({ ...recipe, score: 0 }))\n145      },\n146      enabled: !!(searchQuery || hasActiveFilters),\n147    })\n148 +  const handleSearchInputKeyDown = (e: React.KeyboardEvent<HTMLInputElement>) => {\n149 +    if (e.key === \"Escape\" && searchQuery) {\n150 +      setSearchQuery(\"\");\n151 +      inputRef.current?.focus();\n152 +    }\n153 +    if (e.key === \"Enter\") {\n154 +      handleSearch(searchQuery);\n155 +    }\n156 +  };\n157 +\n158  \n159    const handleSearch = (query: string) => {\n160      setSearchQuery(query)\n161      setFilters({ ...filters, q: query })\n\n@@ -182,13 +219,13 @@ export default function SearchPage() {\n__new hunk__\n219    return (\n220      <div className=\"container px-4 py-6 max-w-6xl\">\n221        <div className=\"space-y-6\">\n222          {/* Search Header */}\n223          <div className=\"space-y-4\">\n224            <h1 className=\"text-3xl font-bold\">Search Recipes</h1>\n225  \n226            {/* Search Input */}\n227 +          {/* <div className=\"relative\">\n228              <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n229              <Input\n230                role=\"search\"\n231                placeholder=\"Search recipes, ingredients, cuisines...\"\n__old hunk__\n   return (\n     <div className=\"container px-4 py-6 max-w-6xl\">\n       <div className=\"space-y-6\">\n         {/* Search Header */}\n         <div className=\"space-y-4\">\n           <h1 className=\"text-3xl font-bold\">Search Recipes</h1>\n \n           {/* Search Input */}\n-          <div className=\"relative\">\n             <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n             <Input\n               role=\"search\"\n               placeholder=\"Search recipes, ingredients, cuisines...\"\n\n@@ -192,14 +229,51 @@ export default function SearchPage() {\n__new hunk__\n229              <Input\n230                role=\"search\"\n231                placeholder=\"Search recipes, ingredients, cuisines...\"\n232                value={searchQuery}\n233                onChange={(e) => setSearchQuery(e.target.value)}\n234                onKeyDown={(e) => e.key === \"Enter\" && handleSearch(searchQuery)}\n235                className=\"pl-10 pr-4 h-12 text-lg\"\n236              />\n237 +          </div> */}\n238 +          <div style={{ position: \"relative\", display: \"inline-block\", width: \"100%\" }}>\n239 +            <Search style={{ position: \"absolute\", left: \"0.75rem\", top: \"50%\", transform: \"translateY(-50%)\", height: \"1rem\", width: \"1rem\", color: \"gray\" }} />\n240 +            <Input\n241 +              role=\"search\"\n242 +              ref={inputRef}\n243 +              placeholder=\"Search recipes, ingredients, cuisines...\"\n244 +              value={searchQuery}\n245 +              onChange={(e) => setSearchQuery(e.target.value)}\n246 +              onKeyDown={handleSearchInputKeyDown}\n247 +              style={{ paddingRight: searchQuery ? \"2rem\" : undefined, width: \"100%\" }}\n248 +              className=\"pl-10 pr-4 h-12 text-lg\"\n249 +            />\n250 +            {searchQuery && (\n251 +              <button\n252 +                type=\"button\"\n253 +                style={{\n254 +                  position: \"absolute\",\n255 +                  right: \"0.75rem\",\n256 +                  top: \"50%\",\n257 +                  transform: \"translateY(-50%)\",\n258 +                  background: \"none\",\n259 +                  border: \"none\",\n260 +                  cursor: \"pointer\",\n261 +                  padding: 0,\n262 +                  color: \"gray\",\n263 +                }}\n264 +                aria-label=\"Clear search\"\n265 +                onClick={() => {\n266 +                  setSearchQuery(\"\");\n267 +                  inputRef.current?.focus();\n268 +              }}\n269 +              >\n270 +                <X size={20} />\n271 +            </button>\n272 +          )}\n273            </div>\n274  \n275 +\n276            {/* Search Actions */}\n277            <div className=\"flex items-center gap-2\">\n278              <Button onClick={() => handleSearch(searchQuery)} size=\"sm\">\n279                Search\n\n\n## File: 'components/filter-panel.tsx'\n\n@@ -54,35 +54,58 @@\n__new hunk__\n54  export function FilterPanel({ open, onOpenChange, initialValues, onApply, onReset }: FilterPanelProps) {\n55    const form = useForm<FiltersFormInput>({\n56      resolver: zodResolver(schema),\n57      // provide full defaults (OUTPUT fits into INPUT just fine)\n58      defaultValues: schema.parse(initialValues ?? {}),\n59      mode: \"onChange\",\n60    })\n61  \n62     useEffect(() => {\n63      form.reset(schema.parse(initialValues ?? {}));\n64    }, [open, initialValues, form]);\n65  \n66 +  // function getActiveFiltersCount(): number {\n67 +  //   const values = form.getValues()\n68 +  //   let count = 0\n69 +  //   if ((values.dietaryRestrictions || []).length > 0) count++\n70 +  //   if ((values.allergens || []).length > 0) count++\n71 +  //   if ((values.cuisines || []).length > 0) count++\n72 +  //   if ((values.majorConditions || []).length > 0) count++\n73 +  //   if (values.calories && (values.calories[0] > 0 || values.calories[1] < 1200)) count++\n74 +  //   if ((values.proteinMin || 0) > 0) count++\n75 +  //   if ((values.carbsMin || 0) > 0) count++\n76 +  //   if ((values.fatMin || 0) > 0) count++\n77 +  //   if ((values.fiberMin || 0) > 0) count++\n78 +  //   if ((values.sugarMax || 100) < 100) count++\n79 +  //   if ((values.sodiumMax || 4000) < 4000) count++\n80 +  //   2025-12-10T00:23:51.257895689Z if ((values.maxTime || 120) < 120) count++\n81 +  //   if ((values.mealType || \"\") !== \"\") count++\n82 +  //   return count\n83 +  // }\n84    function getActiveFiltersCount(): number {\n85 +    const values = form.getValues();\n86 +    let count = 0;\n87 +\n88 +    // Count all selected array filters individually\n89 +    count += values.dietaryRestrictions.length;\n90 +    count += values.allergens.length;\n91 +    count += values.cuisines.length;\n92 +    count += values.majorConditions.length;\n93 +\n94 +    // Numeric and single-value filters\n95 +    if (values.calories[0] > 0) count++;           // Min calories\n96 +    if (values.calories[1] < 1200) count++;        // Max calories\n97 +    if (values.proteinMin > 0) count++;\n98 +    if (values.carbsMin > 0) count++;\n99 +    if (values.fatMin > 0) count++;\n100 +    if (values.fiberMin > 0) count++;\n101 +    if (values.sugarMax < 100) count++;\n102 +    if (values.sodiumMax < 4000) count++;\n103 +    if (values.maxTime < 120) count++;\n104 +    if (values.mealType) count++;\n105 +\n106 +    return count;\n107    }\n108    function handleApply() {\n109      const values = schema.parse(form.getValues())\n110      onApply(values)\n111      onOpenChange(false)\n__old hunk__\n export function FilterPanel({ open, onOpenChange, initialValues, onApply, onReset }: FilterPanelProps) {\n   const form = useForm<FiltersFormInput>({\n     resolver: zodResolver(schema),\n     // provide full defaults (OUTPUT fits into INPUT just fine)\n     defaultValues: schema.parse(initialValues ?? {}),\n     mode: \"onChange\",\n   })\n \n    useEffect(() => {\n     form.reset(schema.parse(initialValues ?? {}));\n   }, [open, initialValues, form]);\n \n   function getActiveFiltersCount(): number {\n-    const values = form.getValues()\n-    let count = 0\n-    if ((values.dietaryRestrictions || []).length > 0) count++\n-    if ((values.allergens || []).length > 0) count++\n-    if ((values.cuisines || []).length > 0) count++\n-    if ((values.majorConditions || []).length > 0) count++\n-    if (values.calories && (values.calories[0] > 0 || values.calories[1] < 1200)) count++\n-    if ((values.proteinMin || 0) > 0) count++\n-    if ((values.carbsMin || 0) > 0) count++\n-    if ((values.fatMin || 0) > 0) count++\n-    if ((values.fiberMin || 0) > 0) count++\n-    if ((values.sugarMax || 100) < 100) count++\n-    if ((values.sodiumMax || 4000) < 4000) count++\n-    if ((values.maxTime || 120) < 120) count++\n-    if ((values.mealType || \"\") !== \"\") count++\n-    return count\n   }\n-\n   function handleApply() {\n     const values = schema.parse(form.getValues())\n     onApply(values)\n     onOpenChange(false)\n======\n\n\nResponse (should be a valid YAML, and nothing else):\n```yaml"}}, "file": {"name": "litellm_ai_handler.py", "path": "/app/pr_agent/algo/ai_handlers/litellm_ai_handler.py"}, "function": "chat_completion", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 383, "message": "Prompts", "module": "litellm_ai_handler", "name": "pr_agent.algo.ai_handlers.litellm_ai_handler", "process": {"id": 9, "name": "MainProcess"}, "thread": {"id": 132164652559232, "name": "MainThread"}, "time": {"repr": "2025-12-10 00:23:51.256536+00:00", "timestamp": 1765326231.256536}}}
2025-12-10T00:23:51.281614002Z {"text": "Error during LLM inference: litellm.UnsupportedParamsError: gpt-5 models (including gpt-5-codex) don't support temperature=0.2. Only temperature=1 is supported. To drop unsupported params set `litellm.drop_params = True`\n", "record": {"elapsed": {"repr": "0:00:57.242741", "seconds": 57.242741}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "81c2cab3ca9d4c39a8e2ec1a2a3402bb", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "litellm_ai_handler.py", "path": "/app/pr_agent/algo/ai_handlers/litellm_ai_handler.py"}, "function": "chat_completion", "level": {"icon": "âš ï¸", "name": "WARNING", "no": 30}, "line": 396, "message": "Error during LLM inference: litellm.UnsupportedParamsError: gpt-5 models (including gpt-5-codex) don't support temperature=0.2. Only temperature=1 is supported. To drop unsupported params set `litellm.drop_params = True`", "module": "litellm_ai_handler", "name": "pr_agent.algo.ai_handlers.litellm_ai_handler", "process": {"id": 9, "name": "MainProcess"}, "thread": {"id": 132164652559232, "name": "MainThread"}, "time": {"repr": "2025-12-10 00:23:51.278704+00:00", "timestamp": 1765326231.278704}}}
2025-12-10T00:23:51.281696907Z {"text": "Failed to generate prediction with openai/gpt-5-mini\n", "record": {"elapsed": {"repr": "0:00:57.244394", "seconds": 57.244394}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "81c2cab3ca9d4c39a8e2ec1a2a3402bb", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "artifact": {"error": "RetryError[<Future at 0x7833f2ea5c10 state=finished raised UnsupportedParamsError>]"}}, "file": {"name": "pr_processing.py", "path": "/app/pr_agent/algo/pr_processing.py"}, "function": "retry_with_fallback_models", "level": {"icon": "âš ï¸", "name": "WARNING", "no": 30}, "line": 333, "message": "Failed to generate prediction with openai/gpt-5-mini", "module": "pr_processing", "name": "pr_agent.algo.pr_processing", "process": {"id": 9, "name": "MainProcess"}, "thread": {"id": 132164652559232, "name": "MainThread"}, "time": {"repr": "2025-12-10 00:23:51.280357+00:00", "timestamp": 1765326231.280357}}}
2025-12-10T00:23:51.281840984Z {"text": "Generating prediction with openai/gpt-5-nano\n", "record": {"elapsed": {"repr": "0:00:57.244790", "seconds": 57.24479}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "81c2cab3ca9d4c39a8e2ec1a2a3402bb", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "pr_processing.py", "path": "/app/pr_agent/algo/pr_processing.py"}, "function": "retry_with_fallback_models", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 326, "message": "Generating prediction with openai/gpt-5-nano", "module": "pr_processing", "name": "pr_agent.algo.pr_processing", "process": {"id": 9, "name": "MainProcess"}, "thread": {"id": 132164652559232, "name": "MainThread"}, "time": {"repr": "2025-12-10 00:23:51.280753+00:00", "timestamp": 1765326231.280753}}}
2025-12-10T00:23:51.380550017Z {"text": "Received a GitHub webhook\n", "record": {"elapsed": {"repr": "0:00:57.668846", "seconds": 57.668846}, "exception": null, "extra": {}, "file": {"name": "github_app.py", "path": "/app/pr_agent/servers/github_app.py"}, "function": "handle_github_webhooks", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 45, "message": "Received a GitHub webhook", "module": "github_app", "name": "pr_agent.servers.github_app", "process": {"id": 27, "name": "MainProcess"}, "thread": {"id": 132164652559232, "name": "MainThread"}, "time": {"repr": "2025-12-10 00:23:51.380206+00:00", "timestamp": 1765326231.380206}}}
2025-12-10T00:23:51.424533841Z {"text": "PR main language: TypeScript\n", "record": {"elapsed": {"repr": "0:00:57.388193", "seconds": 57.388193}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "81c2cab3ca9d4c39a8e2ec1a2a3402bb", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "pr_processing.py", "path": "/app/pr_agent/algo/pr_processing.py"}, "function": "get_pr_diff", "level": {"icon": "â„¹ï¸", "name": "INFO", "no": 20}, "line": 63, "message": "PR main language: TypeScript", "module": "pr_processing", "name": "pr_agent.algo.pr_processing", "process": {"id": 9, "name": "MainProcess"}, "thread": {"id": 132164652559232, "name": "MainThread"}, "time": {"repr": "2025-12-10 00:23:51.424156+00:00", "timestamp": 1765326231.424156}}}
2025-12-10T00:23:51.434435452Z {"text": "Tokens: 4738, total tokens under limit: 32000, returning full diff.\n", "record": {"elapsed": {"repr": "0:00:57.397529", "seconds": 57.397529}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "81c2cab3ca9d4c39a8e2ec1a2a3402bb", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "pr_processing.py", "path": "/app/pr_agent/algo/pr_processing.py"}, "function": "get_pr_diff", "level": {"icon": "â„¹ï¸", "name": "INFO", "no": 20}, "line": 74, "message": "Tokens: 4738, total tokens under limit: 32000, returning full diff.", "module": "pr_processing", "name": "pr_agent.algo.pr_processing", "process": {"id": 9, "name": "MainProcess"}, "thread": {"id": 132164652559232, "name": "MainThread"}, "time": {"repr": "2025-12-10 00:23:51.433492+00:00", "timestamp": 1765326231.433492}}}
2025-12-10T00:23:51.434497375Z {"text": "PR diff\n", "record": {"elapsed": {"repr": "0:00:57.397876", "seconds": 57.397876}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "81c2cab3ca9d4c39a8e2ec1a2a3402bb", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "diff": "\n\n## File: 'app/search/page.tsx'\n\n@@ -1,7 +1,8 @@\n__new hunk__\n1  \"use client\"\n2  \n3 +import { useState, useEffect, useMemo, useRef } from \"react\"\n4 +// import { X } from \"lucide-react\"\n5  import { useSearchParams, useRouter } from \"next/navigation\"\n6  import { useQuery } from \"@tanstack/react-query\"\n7  import { Input } from \"@/components/ui/input\"\n8  import { Button } from \"@/components/ui/button\"\n__old hunk__\n \"use client\"\n \n-import { useState, useEffect, useMemo } from \"react\"\n import { useSearchParams, useRouter } from \"next/navigation\"\n import { useQuery } from \"@tanstack/react-query\"\n import { Input } from \"@/components/ui/input\"\n import { Button } from \"@/components/ui/button\"\n\n@@ -41,11 +42,12 @@\n__new hunk__\n42  export default function SearchPage() {\n43    const searchParams = useSearchParams()\n44    const router = useRouter()\n45    const { filters, setFilters, resetFilters } = useFilters()\n46    const { settings } = useSettings()\n47  \n48    const [searchQuery, setSearchQuery] = useState(searchParams.get(\"q\") || filters.q || \"\")\n49 +  const inputRef = useRef<HTMLInputElement>(null);\n50    const [sortBy, setSortBy] = useState<SortOption>(settings.behavior.defaultSort || \"time\")\n51    const [filtersOpen, setFiltersOpen] = useState(false)\n52  \n53    // Update search query from URL params\n\n@@ -75,29 +77,54 @@ export default function SearchPage() {\n__new hunk__\n77        filters.fiberMin > 0 ||\n78        filters.sugarMax < 100 ||\n79        filters.sodiumMax < 4000 ||\n80        filters.maxTime < 120 ||\n81        !!filters.mealType\n82      )\n83    }, [filters])\n84  \n85 +  // const activeFilterCount = useMemo(() => {\n86 +  //   let count = 0\n87 +  //   if (filters.dietaryRestrictions.length > 0) count++\n88 +  //   if (filters.allergens.length > 0) count++\n89 +  //   if (filters.cuisines.length > 0) count++\n90 +  //   if (filters.majorConditions.length > 0) count++\n91 +  //   if (filters.calories[0] > 0 || filters.calories[1] < 1200) count++\n92 +  //   if (filters.proteinMin > 0) count++\n93 +  //   if (filters.carbsMin > 0) count++\n94 +  //   if (filters.fatMin > 0) count++\n95 +  //   if (filters.fiberMin > 0) count++\n96 +  //   if (filters.sugarMax < 100) count++\n97 +  //   if (filters.sodiumMax < 4000) count++\n98 +  //   if (filters.maxTime < 120) count++\n99 +  //   if (filters.mealType) count++\n100 +  //   return count\n101 +  // }, [filters])\n102    const activeFilterCount = useMemo(() => {\n103 +    let count = 0;\n104 +\n105 +  // Sum all selected array filters\n106 +    count += filters.dietaryRestrictions.length;\n107 +    count += filters.allergens.length;\n108 +    count += filters.cuisines.length;\n109 +    count += filters.majorConditions.length;\n110 +\n111 +    // Range and min/max filters\n112 +    if (filters.calories[0] > 0) count++; // Min calories\n113 +    if (filters.calories[1] < 1200) count++; // Max calories\n114 +    if (filters.proteinMin > 0) count++;\n115 +    if (filters.carbsMin > 0) count++;\n116 +    if (filters.fatMin > 0) count++;\n117 +    if (filters.fiberMin > 0) count++;\n118 +    if (filters.sugarMax < 100) count++;\n119 +    if (filters.sodiumMax < 4000) count++;\n120 +    if (filters.maxTime < 120) count++;\n121 +    \n122 +    // Single-value selection\n123 +    if (filters.mealType) count++;\n124 +\n125 +    return count;\n126 +  }, [filters]);\n127  \n128    const {\n129      data: searchResults = [],\n130      isLoading,\n__old hunk__\n       filters.fiberMin > 0 ||\n       filters.sugarMax < 100 ||\n       filters.sodiumMax < 4000 ||\n       filters.maxTime < 120 ||\n       !!filters.mealType\n     )\n   }, [filters])\n \n   const activeFilterCount = useMemo(() => {\n-    let count = 0\n-    if (filters.dietaryRestrictions.length > 0) count++\n-    if (filters.allergens.length > 0) count++\n-    if (filters.cuisines.length > 0) count++\n-    if (filters.majorConditions.length > 0) count++\n-    if (filters.calories[0] > 0 || filters.calories[1] < 1200) count++\n-    if (filters.proteinMin > 0) count++\n-    if (filters.carbsMin > 0) count++\n-    if (filters.fatMin > 0) count++\n-    if (filters.fiberMin > 0) count++\n-    if (filters.sugarMax < 100) count++\n-    if (filters.sodiumMax < 4000) count++\n-    if (filters.maxTime < 120) count++\n-    if (filters.mealType) count++\n-    return count\n-  }, [filters])\n \n   const {\n     data: searchResults = [],\n     isLoading,\n\n@@ -113,12 +140,22 @@ export default function SearchPage() {\n__new hunk__\n140          const rankedResults = rank(rawResults, settings)\n141          return rankedResults\n142        }\n143  \n144        return rawResults.map((recipe) => ({ ...recipe, score: 0 }))\n145      },\n146      enabled: !!(searchQuery || hasActiveFilters),\n147    })\n148 +  const handleSearchInputKeyDown = (e: React.KeyboardEvent<HTMLInputElement>) => {\n149 +    if (e.key === \"Escape\" && searchQuery) {\n150 +      setSearchQuery(\"\");\n151 +      inputRef.current?.focus();\n152 +    }\n153 +    if (e.key === \"Enter\") {\n154 +      handleSearch(searchQuery);\n155 +    }\n156 +  };\n157 +\n158  \n159    const handleSearch = (query: string) => {\n160      setSearchQuery(query)\n161      setFilters({ ...filters, q: query })\n\n@@ -182,13 +219,13 @@ export default function SearchPage() {\n__new hunk__\n219    return (\n220      <div className=\"container px-4 py-6 max-w-6xl\">\n221        <div className=\"space-y-6\">\n222          {/* Search Header */}\n223          <div className=\"space-y-4\">\n224            <h1 className=\"text-3xl font-bold\">Search Recipes</h1>\n225  \n226            {/* Search Input */}\n227 +          {/* <div className=\"relative\">\n228              <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n229              <Input\n230                role=\"search\"\n231                placeholder=\"Search recipes, ingredients, cuisines...\"\n__old hunk__\n   return (\n     <div className=\"container px-4 py-6 max-w-6xl\">\n       <div className=\"space-y-6\">\n         {/* Search Header */}\n         <div className=\"space-y-4\">\n           <h1 className=\"text-3xl font-bold\">Search Recipes</h1>\n \n           {/* Search Input */}\n-          <div className=\"relative\">\n             <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n             <Input\n               role=\"search\"\n               placeholder=\"Search recipes, ingredients, cuisines...\"\n\n@@ -192,14 +229,51 @@ export default function SearchPage() {\n__new hunk__\n229              <Input\n230                role=\"search\"\n231                placeholder=\"Search recipes, ingredients, cuisines...\"\n232                value={searchQuery}\n233                onChange={(e) => setSearchQuery(e.target.value)}\n234                onKeyDown={(e) => e.key === \"Enter\" && handleSearch(searchQuery)}\n235                className=\"pl-10 pr-4 h-12 text-lg\"\n236              />\n237 +          </div> */}\n238 +          <div style={{ position: \"relative\", display: \"inline-block\", width: \"100%\" }}>\n239 +            <Search style={{ position: \"absolute\", left: \"0.75rem\", top: \"50%\", transform: \"translateY(-50%)\", height: \"1rem\", width: \"1rem\", color: \"gray\" }} />\n240 +            <Input\n241 +              role=\"search\"\n242 +              ref={inputRef}\n243 +              placeholder=\"Search recipes, ingredients, cuisines...\"\n244 +              value={searchQuery}\n245 +              onChange={(e) => setSearchQuery(e.target.value)}\n246 +              onKeyDown={handleSearchInputKeyDown}\n247 +              style={{ paddingRight: searchQuery ? \"2rem\" : undefined, width: \"100%\" }}\n248 +              className=\"pl-10 pr-4 h-12 text-lg\"\n249 +            />\n250 +            {searchQuery && (\n251 +              <button\n252 +                type=\"button\"\n253 +                style={{\n254 +                  position: \"absolute\",\n255 +                  right: \"0.75rem\",\n256 +                  top: \"50%\",\n257 +                  transform: \"translateY(-50%)\",\n258 +                  background: \"none\",\n259 +                  border: \"none\",\n260 +                  cursor: \"pointer\",\n261 +                  padding: 0,\n262 +                  color: \"gray\",\n263 +                }}\n264 +                aria-label=\"Clear search\"\n265 +                onClick={() => {\n266 +                  setSearchQuery(\"\");\n267 +                  inputRef.current?.focus();\n268 +              }}\n269 +              >\n270 +                <X size={20} />\n271 +            </button>\n272 +          )}\n273            </div>\n274  \n275 +\n276            {/* Search Actions */}\n277            <div className=\"flex items-center gap-2\">\n278              <Button onClick={() => handleSearch(searchQuery)} size=\"sm\">\n279                Search\n\n\n## File: 'components/filter-panel.tsx'\n\n@@ -54,35 +54,58 @@\n__new hunk__\n54  export function FilterPanel({ open, onOpenChange, initialValues, onApply, onReset }: FilterPanelProps) {\n55    const form = useForm<FiltersFormInput>({\n56      resolver: zodResolver(schema),\n57      // provide full defaults (OUTPUT fits into INPUT just fine)\n58      defaultValues: schema.parse(initialValues ?? {}),\n59      mode: \"onChange\",\n60    })\n61  \n62     useEffect(() => {\n63      form.reset(schema.parse(initialValues ?? {}));\n64    }, [open, initialValues, form]);\n65  \n66 +  // function getActiveFiltersCount(): number {\n67 +  //   const values = form.getValues()\n68 +  //   let count = 0\n69 +  //   if ((values.dietaryRestrictions || []).length > 0) count++\n70 +  //   if ((values.allergens || []).length > 0) count++\n71 +  //   if ((values.cuisines || []).length > 0) count++\n72 +  //   if ((values.majorConditions || []).length > 0) count++\n73 +  //   if (values.calories && (values.calories[0] > 0 || values.calories[1] < 1200)) count++\n74 +  //   if ((values.proteinMin || 0) > 0) count++\n75 +  //   if ((values.carbsMin || 0) > 0) count++\n76 +  //   if ((values.fatMin || 0) > 0) count++\n77 +  //   if ((values.fiberMin || 0) > 0) count++\n78 +  //   if ((values.sugarMax || 100) < 100) count++\n79 +  //   if ((values.sodiumMax || 4000) < 4000) count++\n80 +  //   if ((values.maxTime || 120) < 120) count++\n81 +  //   if ((values.mealType || \"\") !== \"\") count++\n82 +  //   return count\n83 +  // }\n84    function getActiveFiltersCount(): number {\n85 +    const values = form.getValues();\n86 +    let count = 0;\n87 +\n88 +    // Count all selected array filters individually\n89 +    count += values.dietaryRestrictions.length;\n90 +    count += values.allergens.length;\n91 +    count += values.cuisines.length;\n92 +    count += values.majorConditions.length;\n93 +\n94 +    // Numeric and single-value filters\n95 +    if (values.calories[0] > 0) count++;           // Min calories\n96 +    if (values.calories[1] < 1200) count++;        // Max calories\n97 +    if (values.proteinMin > 0) count++;\n98 +    if (values.carbsMin > 0) count++;\n99 +    if (values.fatMin > 0) count++;\n100 +    if (values.fiberMin > 0) count++;\n101 +    if (values.sugarMax < 100) count++;\n102 +    if (values.sodiumMax < 4000) count++;\n103 +    if (values.maxTime < 120) count++;\n104 +    if (values.mealType) count++;\n105 +\n106 +    return count;\n107    }\n108    function handleApply() {\n109      const values = schema.parse(form.getValues())\n110      onApply(values)\n111      onOpenChange(false)\n__old hunk__\n export function FilterPanel({ open, onOpenChange, initialValues, onApply, onReset }: FilterPanelProps) {\n   const form = useForm<FiltersFormInput>({\n     resolver: zodResolver(schema),\n     // provide full defaults (OUTPUT fits into INPUT just fine)\n     defaultValues: schema.parse(initialValues ?? {}),\n     mode: \"onChange\",\n   })\n \n    useEffect(() => {\n     form.reset(schema.parse(initialValues ?? {}));\n   }, [open, initialValues, form]);\n \n   function getActiveFiltersCount(): number {\n-    const values = form.getValues()\n-    let count = 0\n-    if ((values.dietaryRestrictions || []).length > 0) count++\n-    if ((values.allergens || []).length > 0) count++\n-    if ((values.cuisines || []).length > 0) count++\n-    if ((values.majorConditions || []).length > 0) count++\n-    if (values.calories && (values.calories[0] > 0 || values.calories[1] < 1200)) count++\n-    if ((values.proteinMin || 0) > 0) count++\n-    if ((values.carbsMin || 0) > 0) count++\n-    if ((values.fatMin || 0) > 0) count++\n-    if ((values.fiberMin || 0) > 0) count++\n-    if ((values.sugarMax || 100) < 100) count++\n-    if ((values.sodiumMax || 4000) < 4000) count++\n-    if ((values.maxTime || 120) < 120) count++\n-    if ((values.mealType || \"\") !== \"\") count++\n-    return count\n   }\n-\n   function handleApply() {\n     const values = schema.parse(form.getValues())\n     onApply(values)\n     onOpenChange(false)"}, "file": {"name": "pr_reviewer.py", "path": "/app/pr_agent/tools/pr_reviewer.py"}, "function": "_prepare_prediction", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 197, "message": "PR diff", "module": "pr_reviewer", "name": "pr_agent.tools.pr_reviewer", "process": {"id": 9, "name": "MainProcess"}, "thread": {"id": 132164652559232, "name": "MainThread"}, "time": {"repr": "2025-12-10 00:23:51.433839+00:00", "timestamp": 1765326231.433839}}}
2025-12-10T00:23:51.448320747Z {"text": "Prompts\n", "record": {"elapsed": {"repr": "0:00:57.411734", "seconds": 57.411734}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "81c2cab3ca9d4c39a8e2ec1a2a3402bb", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "artifact": {"system": "You are PR-Reviewer, a language model designed to review a Git Pull Request (PR).\nYour task is to provide constructive and concise feedback for the PR.\nThe review should focus on new code added in the PR code diff (lines starting with '+')\n\n\nThe format we will use to present the PR code diff:\n======\n## File: 'src/file1.py'\n\n\n@@ ... @@ def func1():\n__new hunk__\n11  unchanged code line0\n12  unchanged code line1\n13 +new code line2 added\n14  unchanged code line3\n__old hunk__\n unchanged code line0\n unchanged code line1\n-old code line2 removed\n unchanged code line3\n\n@@ ... @@ def func2():\n__new hunk__\n unchanged code line4\n+new code line5 added\n unchanged code line6\n\n## File: 'src/file2.py'\n...\n======\n\n- In the format above, the diff is organized into separate '__new hunk__' and '__old hunk__' sections for each code chunk. '__new hunk__' contains the updated code, while '__old hunk__' shows the removed code. If no code was removed in a specific chunk, the __old hunk__ section will be omitted.\n- We also added line numbers for the '__new hunk__' code, to help you refer to the code lines in your suggestions. These line numbers are not part of the actual code, and should only be used for reference.\n- Code lines are prefixed with symbols ('+', '-', ' '). The '+' symbol indicates new code added in the PR, the '-' symbol indicates code removed in the PR, and the ' ' symbol indicates unchanged code. The review should address new code added in the PR code diff (lines starting with '+').\n- When quoting variables, names or file paths from the code, use backticks (`) instead of single quote (').\n- Note that you only see changed code segments (diff hunks in a PR), not the entire codebase. Avoid suggestions that might duplicate existing functionality or questioning code elements (like variables declarations or import statements) that may be defined elsewhere in the codebase.\n- Also note that if the code ends at an opening brace or statement that begins a new scope (like 'if', 'for', 'try'), don't treat it as incomplete. Instead, acknowledge the visible scope boundary and analyze only the code shown.\n\n\nThe output must be a YAML object equivalent to type $PRReview, according to the following Pydantic definitions:\n=====\n\nclass KeyIssuesComponentLink(BaseModel):\n    relevant_file: str = Field(description=\"The full file path of the relevant file\")\n    issue_header: str = Field(description=\"One or two word title for the issue. For example: 'Possible Bug', etc.\")\n    issue_content: str = Field(description=\"A short and concise summary of what should be further inspected and validated during the PR review process for this issue. Do not mention line numbers in this field.\")\n    start_line: int = Field(description=\"The start line that corresponds to this issue in the relevant file\")\n    end_line: int = Field(description=\"The end line that corresponds to this issue in the relevant file\")\n\nclass Review(BaseModel):\n    estimated_effort_to_review_[1-5]: int = Field(description=\"Estimate, on a scale of 1-5 (inclusive), the time and effort required to review this PR by an experienced and knowledgeable developer. 1 means short and easy review , 5 means long and hard review. Take into account the size, complexity, quality, and the needed changes of the PR code diff.\")\n    relevant_tests: str = Field(description=\"yes/no question: does this PR have relevant tests added or updated ?\")\n    key_issues_to_review: List[KeyIssuesComponentLink] = Field(\"A short and diverse list (0-3 issues) of high-priority bugs, problems or performance concerns introduced in the PR code, which the PR reviewer should further focus on and validate during the review process.\")\n    security_concerns: str = Field(description=\"Does this PR code introduce vulnerabilities such as exposure of sensitive information (e.g., API keys, secrets, passwords), or security concerns like SQL injection, XSS, CSRF, and others ? Answer 'No' (without explaining why) if there are no possible issues. If there are security concerns or issues, start your answer with a short header, such as: 'Sensitive information exposure: ...', 'SQL injection: ...', etc. Explain your answer. Be specific and give examples if possible\")\n\nclass PRReview(BaseModel):\n    review: Review\n=====\n\n\nExample output:\n```yaml\nreview:\n  estimated_effort_to_review_[1-5]: |\n    3\n  relevant_tests: |\n    No\n  key_issues_to_review:\n    - relevant_file: |\n        directory/xxx.py\n      issue_header: |\n        Possible Bug\n      issue_content: |\n        ...\n      start_line: 12\n      end_line: 14\n    - ...\n  security_concerns: |\n    No\n```\n\nAnswer should be a valid YAML, and nothing else. Each YAML output MUST be after a newline, with proper indent, and block scalar indicator ('|')", "user": "\n\n\n--PR Info--\n\nToday's Date: 2025-12-10\n\nTitle: 'Fix: Search UX and multi-filter logic (frontend)'\n\nBranch: 'feature/initial-fixes'\n\nPR Description:\n======\n- Improved search bar UX in app/search/page.tsx:\r\n  - X icon clears input and refocuses\r\n  - Escape key clears input\r\n  - Enter key triggers search\r\n\r\n- Updated filter count logic:\r\n  - Accurately counts all active filters\r\n  - Apply button badge reflects true total\n======\n\n\nThe PR code diff:\n======\n## File: 'app/search/page.tsx'\n\n@@ -1,7 +1,8 @@\n__new hunk__\n1  \"use client\"\n2  \n3 +import { useState, useEffect, useMemo, useRef } from \"react\"\n4 +// import { X } from \"lucide-react\"\n5  import { useSearchParams, useRouter } from \"next/navigation\"\n6  import { useQuery } from \"@tanstack/react-query\"\n7  import { Input } from \"@/components/ui/input\"\n8  import { Button } from \"@/components/ui/button\"\n__old hunk__\n \"use client\"\n \n-import { useState, useEffect, useMemo } from \"react\"\n import { useSearchParams, useRouter } from \"next/navigation\"\n import { useQuery } from \"@tanstack/react-query\"\n import { Input } from \"@/components/ui/input\"\n import { Button } from \"@/components/ui/button\"\n\n@@ -41,11 +42,12 @@\n__new hunk__\n42  export default function SearchPage() {\n43    const searchParams = useSearchParams()\n44    const router = useRouter()\n45    const { filters, setFilters, resetFilters } = useFilters()\n46    const { settings } = useSettings()\n47  \n48    const [searchQuery, setSearchQuery] = useState(searchParams.get(\"q\") || filters.q || \"\")\n49 +  const inputRef = useRef<HTMLInputElement>(null);\n50    const [sortBy, setSortBy] = useState<SortOption>(settings.behavior.defaultSort || \"time\")\n51    const [filtersOpen, setFiltersOpen] = useState(false)\n52  \n53    // Update search query from URL params\n\n@@ -75,29 +77,54 @@ export default function SearchPage() {\n__new hunk__\n77        filters.fiberMin > 0 ||\n78        filters.sugarMax < 100 ||\n79        filters.sodiumMax < 4000 ||\n80        filters.maxTime < 120 ||\n81        !!filters.mealType\n82      )\n83    }, [filters])\n84  \n85 +  // const activeFilterCount = useMemo(() => {\n86 +  //   let count = 0\n87 +  //   if (filters.dietaryRestrictions.length > 0) count++\n88 +  //   if (filters.allergens.length > 0) count++\n89 +  //   if (filters.cuisines.length > 0) count++\n90 +  //   if (filters.majorConditions.length > 0) count++\n91 +  //   if (filters.calories[0] > 0 || filters.calories[1] < 1200) count++\n92 +  //   if (filters.proteinMin > 0) count++\n93 +  //   if (filters.carbsMin > 0) count++\n94 +  //   if (filters.fatMin > 0) count++\n95 +  //   if (filters.fiberMin > 0) count++\n96 +  //   if (filters.sugarMax < 100) count++\n97 +  //   if (filters.sodiumMax < 4000) count++\n98 +  //   if (filters.maxTime < 120) count++\n99 +  //   if (filters.mealType) count++\n100 +  //   return count\n101 +  // }, [filters])\n102    const activeFilterCount = useMemo(() => {\n103 +    let count = 0;\n104 +\n105 +  // Sum all selected array filters\n106 +    count += filters.dietaryRestrictions.length;\n107 +    count += filters.allergens.length;\n108 +    count += filters.cuisines.length;\n109 +    count += filters.majorConditions.length;\n110 +\n111 +    // Range and min/max filters\n112 +    if (filters.calories[0] > 0) count++; // Min calories\n113 +    if (filters.calories[1] < 1200) count++; // Max calories\n114 +    if (filters.proteinMin > 0) count++;\n115 +    if (filters.carbsMin > 0) count++;\n116 +    if (filters.fatMin > 0) count++;\n117 +    if (filters.fiberMin > 0) count++;\n118 +    if (filters.sugarMax < 100) count++;\n119 +    if (filters.sodiumMax < 4000) count++;\n120 +    if (filters.maxTime < 120) count++;\n121 +    \n122 +    // Single-value selection\n123 +    if (filters.mealType) count++;\n124 +\n125 +    return count;\n126 +  }, [filters]);\n127  \n128    const {\n129      data: searchResults = [],\n130      isLoading,\n__old hunk__\n       filters.fiberMin > 0 ||\n       filters.sugarMax < 100 ||\n       filters.sodiumMax < 4000 ||\n       filters.maxTime < 120 ||\n       !!filters.mealType\n     )\n   }, [filters])\n \n   const activeFilterCount = useMemo(() => {\n-    let count = 0\n-    if (filters.dietaryRestrictions.length > 0) count++\n-    if (filters.allergens.length > 0) count++\n-    if (filters.cuisines.length > 0) count++\n-    if (filters.majorConditions.length > 0) count++\n-    if (filters.calories[0] > 0 || filters.calories[1] < 1200) count++\n-    if (filters.proteinMin > 0) count++\n-    if (filters.carbsMin > 0) count++\n-    if (filters.fatMin > 0) count++\n-    if (filters.fiberMin > 0) count++\n-    if (filters.sugarMax < 100) count++\n-    if (filters.sodiumMax < 4000) count++\n-    if (filters.maxTime < 120) count++\n-    if (filters.mealType) count++\n-    return count\n-  }, [filters])\n \n   const {\n     data: searchResults = [],\n     isLoading,\n\n@@ -113,12 +140,22 @@ export default function SearchPage() {\n__new hunk__\n140          const rankedResults = rank(rawResults, settings)\n141          return rankedResults\n142        }\n143  \n144        return rawResults.map((recipe) => ({ ...recipe, score: 0 }))\n145      },\n146      enabled: !!(searchQuery || hasActiveFilters),\n147    })\n148 +  const handleSearchInputKeyDown = (e: React.KeyboardEvent<HTMLInputElement>) => {\n149 +    if (e.key === \"Escape\" && searchQuery) {\n150 +      setSearchQuery(\"\");\n151 +      inputRef.current?.focus();\n152 +    }\n153 +    if (e.key === \"Enter\") {\n154 +      handleSearch(searchQuery);\n155 +    }\n156 +  };\n157 +\n158  \n159    const handleSearch = (query: string) => {\n160      setSearchQuery(query)\n161      setFilters({ ...filters, q: query })\n\n@@ -182,13 +219,13 @@ export default function SearchPage() {\n__new hunk__\n219    return (\n220      <div className=\"container px-4 py-6 max-w-6xl\">\n221        <div className=\"space-y-6\">\n222          {/* Search Header */}\n223          <div className=\"space-y-4\">\n224            <h1 className=\"text-3xl font-bold\">Search Recipes</h1>\n225  \n226            {/* Search Input */}\n227 +          {/* <div className=\"relative\">\n228              <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n229              <Input\n230                role=\"search\"\n231                placeholder=\"Search recipes, ingredients, cuisines...\"\n__old hunk__\n   return (\n     <div className=\"container px-4 py-6 max-w-6xl\">\n       <div className=\"space-y-6\">\n         {/* Search Header */}\n         <div className=\"space-y-4\">\n           <h1 className=\"text-3xl font-bold\">Search Recipes</h1>\n \n           {/* Search Input */}\n-          <div className=\"relative\">\n             <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n             <Input\n               role=\"search\"\n               placeholder=\"Search recipes, ingredients, cuisines...\"\n\n@@ -192,14 +229,51 @@ export default function SearchPage() {\n__new hunk__\n229              <Input\n230                role=\"search\"\n231                placeholder=\"Search recipes, ingredients, cuisines...\"\n232                value={searchQuery}\n233                onChange={(e) => setSearchQuery(e.target.value)}\n234                onKeyDown={(e) => e.key === \"Enter\" && handleSearch(searchQuery)}\n235                className=\"pl-10 pr-4 h-12 text-lg\"\n236              />\n237 +          </div> */}\n238 +          <div style={{ position: \"relative\", display: \"inline-block\", width: \"100%\" }}>\n239 +            <Search style={{ position: \"absolute\", left: \"0.75rem\", top: \"50%\", transform: \"translateY(-50%)\", height: \"1rem\", width: \"1rem\", color: \"gray\" }} />\n240 +            <Input\n241 +              role=\"search\"\n242 +              ref={inputRef}\n243 +              placeholder=\"Search recipes, ingredients, cuisines...\"\n244 +              value={searchQuery}\n245 +              onChange={(e) => setSearchQuery(e.target.value)}\n246 +              onKeyDown={handleSearchInputKeyDown}\n247 +              style={{ paddingRight: searchQuery ? \"2rem\" : undefined, width: \"100%\" }}\n248 +              className=\"pl-10 pr-4 h-12 text-lg\"\n249 +            />\n250 +            {searchQuery && (\n251 +              <button\n252 +                type=\"button\"\n253 +                style={{\n254 +                  position: \"absolute\",\n255 +                  right: \"0.75rem\",\n256 +                  top: \"50%\",\n257 +                  transform: \"translateY(-50%)\",\n258 +                  background: \"none\",\n259 +                  border: \"none\",\n260 +                  cursor: \"pointer\",\n261 +                  padding: 0,\n262 +                  color: \"gray\",\n263 +                }}\n264 +                aria-label=\"Clear search\"\n265 +                onClick={() => {\n266 +                  setSearchQuery(\"\");\n267 +                  inputRef.current?.focus();\n268 +              }}\n269 +              >\n270 +                <X size={20} />\n271 +            </button>\n272 +          )}\n273            </div>\n274  \n275 +\n276            {/* Search Actions */}\n277            <div className=\"flex items-center gap-2\">\n278              <Button onClick={() => handleSearch(searchQuery)} size=\"sm\">\n279                Search\n\n\n## File: 'components/filter-panel.tsx'\n\n@@ -54,35 +54,58 @@\n__new hunk__\n54  export function FilterPanel({ open, onOpenChange, initialValues, onApply, onReset }: FilterPanelProps) {\n55    const form = useForm<FiltersFormInput>({\n56      resolver: zodResolver(schema),\n57      // provide full defaults (OUTPUT fits into INPUT just fine)\n58      defaultValues: schema.parse(initialValues ?? {}),\n59      mode: \"onChange\",\n60    })\n61  \n62     useEffect(() => {\n63      form.reset(schema.parse(initialValues ?? {}));\n64    }, [open, initialValues, form]);\n65  \n66 +  // function getActiveFiltersCount(): number {\n67 +  //   const values = form.getValues()\n68 +  //   let count = 0\n69 +  //   if ((values.dietaryRestrictions || []).length > 0) count++\n70 +  //   if ((values.allergens || []).length > 0) count++\n71 +  //   if ((values.cuisines || []).length > 0) count++\n72 +  //   if ((values.majorConditions || []).length > 0) count++\n73 +  //   if (values.calories && (values.calories[0] > 0 || values.calories[1] < 1200)) count++\n74 +  //   if ((values.proteinMin || 0) > 0) count++\n75 +  //   if ((values.carbsMin || 0) > 0) count++\n76 +  //   if ((values.fatMin || 0) > 0) count++\n77 +  //   if ((values.fiberMin || 0) > 0) count++\n78 +  //   if ((values.sugarMax || 100) < 100) count++\n79 +  //   if ((values.sodiumMax || 4000) < 4000) count++\n80 +  //   2025-12-10T00:23:51.448320747Z if ((values.maxTime || 120) < 120) count++\n81 +  //   if ((values.mealType || \"\") !== \"\") count++\n82 +  //   return count\n83 +  // }\n84    function getActiveFiltersCount(): number {\n85 +    const values = form.getValues();\n86 +    let count = 0;\n87 +\n88 +    // Count all selected array filters individually\n89 +    count += values.dietaryRestrictions.length;\n90 +    count += values.allergens.length;\n91 +    count += values.cuisines.length;\n92 +    count += values.majorConditions.length;\n93 +\n94 +    // Numeric and single-value filters\n95 +    if (values.calories[0] > 0) count++;           // Min calories\n96 +    if (values.calories[1] < 1200) count++;        // Max calories\n97 +    if (values.proteinMin > 0) count++;\n98 +    if (values.carbsMin > 0) count++;\n99 +    if (values.fatMin > 0) count++;\n100 +    if (values.fiberMin > 0) count++;\n101 +    if (values.sugarMax < 100) count++;\n102 +    if (values.sodiumMax < 4000) count++;\n103 +    if (values.maxTime < 120) count++;\n104 +    if (values.mealType) count++;\n105 +\n106 +    return count;\n107    }\n108    function handleApply() {\n109      const values = schema.parse(form.getValues())\n110      onApply(values)\n111      onOpenChange(false)\n__old hunk__\n export function FilterPanel({ open, onOpenChange, initialValues, onApply, onReset }: FilterPanelProps) {\n   const form = useForm<FiltersFormInput>({\n     resolver: zodResolver(schema),\n     // provide full defaults (OUTPUT fits into INPUT just fine)\n     defaultValues: schema.parse(initialValues ?? {}),\n     mode: \"onChange\",\n   })\n \n    useEffect(() => {\n     form.reset(schema.parse(initialValues ?? {}));\n   }, [open, initialValues, form]);\n \n   function getActiveFiltersCount(): number {\n-    const values = form.getValues()\n-    let count = 0\n-    if ((values.dietaryRestrictions || []).length > 0) count++\n-    if ((values.allergens || []).length > 0) count++\n-    if ((values.cuisines || []).length > 0) count++\n-    if ((values.majorConditions || []).length > 0) count++\n-    if (values.calories && (values.calories[0] > 0 || values.calories[1] < 1200)) count++\n-    if ((values.proteinMin || 0) > 0) count++\n-    if ((values.carbsMin || 0) > 0) count++\n-    if ((values.fatMin || 0) > 0) count++\n-    if ((values.fiberMin || 0) > 0) count++\n-    if ((values.sugarMax || 100) < 100) count++\n-    if ((values.sodiumMax || 4000) < 4000) count++\n-    if ((values.maxTime || 120) < 120) count++\n-    if ((values.mealType || \"\") !== \"\") count++\n-    return count\n   }\n-\n   function handleApply() {\n     const values = schema.parse(form.getValues())\n     onApply(values)\n     onOpenChange(false)\n======\n\n\nResponse (should be a valid YAML, and nothing else):\n```yaml"}}, "file": {"name": "litellm_ai_handler.py", "path": "/app/pr_agent/algo/ai_handlers/litellm_ai_handler.py"}, "function": "chat_completion", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 383, "message": "Prompts", "module": "litellm_ai_handler", "name": "pr_agent.algo.ai_handlers.litellm_ai_handler", "process": {"id": 9, "name": "MainProcess"}, "thread": {"id": 132164652559232, "name": "MainThread"}, "time": {"repr": "2025-12-10 00:23:51.447697+00:00", "timestamp": 1765326231.447697}}}
2025-12-10T00:23:51.451080016Z {"text": "Handling request with event: issue_comment, action: created\n", "record": {"elapsed": {"repr": "0:00:57.737921", "seconds": 57.737921}, "exception": null, "extra": {}, "file": {"name": "github_app.py", "path": "/app/pr_agent/servers/github_app.py"}, "function": "handle_request", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 321, "message": "Handling request with event: issue_comment, action: created", "module": "github_app", "name": "pr_agent.servers.github_app", "process": {"id": 27, "name": "MainProcess"}, "thread": {"id": 132164652559232, "name": "MainThread"}, "time": {"repr": "2025-12-10 00:23:51.449281+00:00", "timestamp": 1765326231.449281}}}
2025-12-10T00:23:51.453210476Z {"text": "Request body\n", "record": {"elapsed": {"repr": "0:00:57.739035", "seconds": 57.739035}, "exception": null, "extra": {"artifact": {"action": "created", "issue": {"url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/1", "repository_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend", "labels_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/1/labels{/name}", "comments_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/1/comments", "events_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/1/events", "html_url": "https://github.com/souravOD/nutri-b2c-frontend/pull/1", "id": 3527983986, "node_id": "PR_kwDOQEZhKM6uaI7J", "number": 1, "title": "Fix: Search UX and multi-filter logic (frontend)", "user": {"login": "NamanOdysseyts", "id": 238778617, "node_id": "U_kgDODjt4-Q", "avatar_url": "https://avatars.githubusercontent.com/u/238778617?v=4", "gravatar_id": "", "url": "https://api.github.com/users/NamanOdysseyts", "html_url": "https://github.com/NamanOdysseyts", "followers_url": "https://api.github.com/users/NamanOdysseyts/followers", "following_url": "https://api.github.com/users/NamanOdysseyts/following{/other_user}", "gists_url": "https://api.github.com/users/NamanOdysseyts/gists{/gist_id}", "starred_url": "https://api.github.com/users/NamanOdysseyts/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/NamanOdysseyts/subscriptions", "organizations_url": "https://api.github.com/users/NamanOdysseyts/orgs", "repos_url": "https://api.github.com/users/NamanOdysseyts/repos", "events_url": "https://api.github.com/users/NamanOdysseyts/events{/privacy}", "received_events_url": "https://api.github.com/users/NamanOdysseyts/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 9561404867, "node_id": "LA_kwDOQEZhKM8AAAACOed1ww", "url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/labels/Review%20effort%202/5", "name": "Review effort 2/5", "color": "d1bcf9", "default": false, "description": null}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 49, "created_at": "2025-10-18T02:45:21Z", "updated_at": "2025-12-10T00:23:49Z", "closed_at": null, "author_association": "COLLABORATOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "html_url": "https://github.com/souravOD/nutri-b2c-frontend/pull/1", "diff_url": "https://github.com/souravOD/nutri-b2c-frontend/pull/1.diff", "patch_url": "https://github.com/souravOD/nutri-b2c-frontend/pull/1.patch", "merged_at": null}, "body": "- Improved search bar UX in app/search/page.tsx:\r\n  - X icon clears input and refocuses\r\n  - Escape key clears input\r\n  - Enter key triggers search\r\n\r\n- Updated filter count logic:\r\n  - Accurately counts all active filters\r\n  - Apply button badge reflects true total", "reactions": {"url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/1/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/1/timeline", "performed_via_github_app": null, "state_reason": null}, "comment": {"url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/comments/3634834649", "html_url": "https://github.com/souravOD/nutri-b2c-frontend/pull/1#issuecomment-3634834649", "issue_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/1", "id": 3634834649, "node_id": "IC_kwDOQEZhKM7YpyzZ", "user": {"login": "confersolutions-pr-agent-testing[bot]", "id": 241213316, "node_id": "BOT_kgDODmCfhA", "avatar_url": "https://avatars.githubusercontent.com/u/238303722?v=4", "gravatar_id": "", "url": "https://api.github.com/users/confersolutions-pr-agent-testing%5Bbot%5D", "html_url": "https://github.com/apps/confersolutions-pr-agent-testing", "followers_url": "https://api.github.com/users/confersolutions-pr-agent-testing%5Bbot%5D/followers", "following_url": "https://api.github.com/users/confersolutions-pr-agent-testing%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/confersolutions-pr-agent-testing%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/confersolutions-pr-agent-testing%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/confersolutions-pr-agent-testing%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/confersolutions-pr-agent-testing%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/confersolutions-pr-agent-testing%5Bbot%5D/repos", "events_url": "https://api.github.com/users/confersolutions-pr-agent-testing%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/confersolutions-pr-agent-testing%5Bbot%5D/received_events", "type": "Bot", "user_view_type": "public", "site_admin": false}, "created_at": "2025-12-10T00:23:49Z", "updated_at": "2025-12-10T00:23:49Z", "body": "Preparing review...", "author_association": "NONE", "reactions": {"url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/comments/3634834649/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "performed_via_github_app": {"id": 2209305, "client_id": "Iv23li7bKiGgGVtVjmWH", "slug": "confersolutions-pr-agent-testing", "node_id": "A_kwDODjQ56s4AIbYZ", "owner": {"login": "souravOD", "id": 238303722, "node_id": "U_kgDODjQ56g", "avatar_url": "https://avatars.githubusercontent.com/u/238303722?v=4", "gravatar_id": "", "url": "https://api.github.com/users/souravOD", "html_url": "https://github.com/souravOD", "followers_url": "https://api.github.com/users/souravOD/followers", "following_url": "https://api.github.com/users/souravOD/following{/other_user}", "gists_url": "https://api.github.com/users/souravOD/gists{/gist_id}", "starred_url": "https://api.github.com/users/souravOD/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/souravOD/subscriptions", "organizations_url": "https://api.github.com/users/souravOD/orgs", "repos_url": "https://api.github.com/users/souravOD/repos", "events_url": "https://api.github.com/users/souravOD/events{/privacy}", "received_events_url": "https://api.github.com/users/souravOD/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "name": "confersolutions-pr-agent-testing", "description": "", "external_url": "https://app.affine.pro/workspace/5faca6c6-75a5-4a38-a457-467462b9e9bd/4tBJ2igTRqph8VLY69JYh", "html_url": "https://github.com/apps/confersolutions-pr-agent-testing", "created_at": "2025-10-30T23:17:56Z", "updated_at": "2025-12-04T21:49:27Z", "permissions": {"actions": "read", "checks": "read", "contents": "read", "issues": "write", "metadata": "read", "pull_requests": "write", "statuses": "read"}, "events": ["commit_comment", "issues", "issue_comment", "merge_queue_entry", "pull_request", "pull_request_review", "pull_request_review_comment", "pull_request_review_thread", "push"]}}, "repository": {"id": 1078354216, "node_id": "R_kgDOQEZhKA", "name": "nutri-b2c-frontend", "full_name": "souravOD/nutri-b2c-frontend", "private": false, "owner": {"login": "souravOD", "id": 238303722, "node_id": "U_kgDODjQ56g", "avatar_url": "https://avatars.githubusercontent.com/u/238303722?v=4", "gravatar_id": "", "url": "https://api.github.com/users/souravOD", "html_url": "https://github.com/souravOD", "followers_url": "https://api.github.com/users/souravOD/followers", "following_url": "https://api.github.com/users/souravOD/following{/other_user}", "gists_url": "https://api.github.com/users/souravOD/gists{/gist_id}", "starred_url": "https://api.github.com/users/souravOD/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/souravOD/subscriptions", "organizations_url": "https://api.github.com/users/souravOD/orgs", "repos_url": "https://api.github.com/users/souravOD/repos", "events_url": "https://api.github.com/users/souravOD/events{/privacy}", "received_events_url": "https://api.github.com/users/souravOD/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "html_url": "https://github.com/souravOD/nutri-b2c-frontend", "description": null, "fork": true, "url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend", "forks_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/forks", "keys_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/keys{/key_id}", "collaborators_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/collaborators{/collaborator}", "teams_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/teams", "hooks_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/hooks", "issue_events_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/events{/number}", "events_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/events", "assignees_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/assignees{/user}", "branches_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/branches{/branch}", "tags_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/tags", "blobs_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/git/blobs{/sha}", "git_tags_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/git/tags{/sha}", "git_refs_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/git/refs{/sha}", "trees_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/git/trees{/sha}", "statuses_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/statuses/{sha}", "languages_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/languages", "stargazers_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/stargazers", "contributors_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/contributors", "subscribers_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/subscribers", "subscription_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/subscription", "commits_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/commits{/sha}", "git_commits_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/git/commits{/sha}", "comments_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/comments{/number}", "issue_comment_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/comments{/number}", "contents_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/contents/{+path}", "compare_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/compare/{base}...{head}", "merges_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/merges", "archive_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/{archive_format}{/ref}", "downloads_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/downloads", "issues_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues{/number}", "pulls_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls{/number}", "milestones_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/milestones{/number}", "notifications_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/notifications{?since,all,participating}", "labels_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/labels{/name}", "releases_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/releases{/id}", "deployments_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/deployments", "created_at": "2025-10-17T15:44:00Z", "updated_at": "2025-11-14T04:02:00Z", "pushed_at": "2025-10-16T19:32:39Z", "git_url": "git://github.com/souravOD/nutri-b2c-frontend.git", "ssh_url": "git@github.com:souravOD/nutri-b2c-frontend.git", "clone_url": "https://github.com/souravOD/nutri-b2c-frontend.git", "svn_url": "https://github.com/souravOD/nutri-b2c-frontend", "homepage": "https://v0-next-js-app-requirements-omega.vercel.app", "size": 11387, "stargazers_count": 0, "watchers_count": 0, "language": null, "has_issues": false, "has_projects": true, "has_downloads": true, "has_wiki": false, "has_pages": false, "has_discussions": false, "forks_count": 1, "mirror_url": null, "archived": false, "disabled": false, "open_issues_count": 2, "license": null, "allow_forking": true, "is_template": false, "web_commit_signoff_required": false, "topics": [], "visibility": "public", "forks": 1, "open_issues": 2, "watchers": 0, "default_branch": "main"}, "sender": {"login": "confersolutions-pr-agent-testing[bot]", "id": 241213316, "node_id": "BOT_kgDODmCfhA", "avatar_url": "https://avatars.githubusercontent.com/u/238303722?v=4", "gravatar_id": "", "url": "https://api.github.com/users/confersolutions-pr-agent-testing%5Bbot%5D", "html_url": "https://github.com/apps/confersolutions-pr-agent-testing", "followers_url": "https://api.github.com/users/confersolutions-pr-agent-testing%5Bbot%5D/followers", "following_url": "https://api.github.com/users/confersolutions-pr-agent-testing%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/confersolutions-pr-agent-testing%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/confersolutions-pr-agent-testing%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/confersolutions-pr-agent-testing%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/confersolutions-pr-agent-testing%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/confersolutions-pr-agent-testing%5Bbot%5D/repos", "events_url": "https://api.github.com/users/confersolutions-pr-agent-testing%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/confersolutions-pr-agent-testing%5Bbot%5D/received_events", "type": "Bot", "user_view_type": "public", "site_admin": false}, "installation": {"id": 92375808, "node_id": "MDIzOkludGVncmF0aW9uSW5zdGFsbGF0aW9uOTIzNzU4MDg="}}, "event": "issue_comment"}, "file": {"name": "github_app.py", "path": "/app/pr_agent/servers/github_app.py"}, "function": "handle_request", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 342, "message": "Request body", "module": "github_app", "name": "pr_agent.servers.github_app", "process": {"id": 27, "name": "MainProcess"}, "thread": {"id": 132164652559232, "name": "MainThread"}, "time": {"repr": "2025-12-10 00:23:51.450395+00:00", "timestamp": 1765326231.450395}}}
2025-12-10T00:23:51.453315924Z {"text": "Ignoring comment not starting with /\n", "record": {"elapsed": {"repr": "0:00:57.740299", "seconds": 57.740299}, "exception": null, "extra": {}, "file": {"name": "github_app.py", "path": "/app/pr_agent/servers/github_app.py"}, "function": "handle_comments_on_pr", "level": {"icon": "â„¹ï¸", "name": "INFO", "no": 20}, "line": 96, "message": "Ignoring comment not starting with /", "module": "github_app", "name": "pr_agent.servers.github_app", "process": {"id": 27, "name": "MainProcess"}, "thread": {"id": 132164652559232, "name": "MainThread"}, "time": {"repr": "2025-12-10 00:23:51.451659+00:00", "timestamp": 1765326231.451659}}}
2025-12-10T00:23:51.464056752Z {"text": "Error during LLM inference: litellm.UnsupportedParamsError: gpt-5 models (including gpt-5-codex) don't support temperature=0.2. Only temperature=1 is supported. To drop unsupported params set `litellm.drop_params = True`\n", "record": {"elapsed": {"repr": "0:00:57.426909", "seconds": 57.426909}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "81c2cab3ca9d4c39a8e2ec1a2a3402bb", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "litellm_ai_handler.py", "path": "/app/pr_agent/algo/ai_handlers/litellm_ai_handler.py"}, "function": "chat_completion", "level": {"icon": "âš ï¸", "name": "WARNING", "no": 30}, "line": 396, "message": "Error during LLM inference: litellm.UnsupportedParamsError: gpt-5 models (including gpt-5-codex) don't support temperature=0.2. Only temperature=1 is supported. To drop unsupported params set `litellm.drop_params = True`", "module": "litellm_ai_handler", "name": "pr_agent.algo.ai_handlers.litellm_ai_handler", "process": {"id": 9, "name": "MainProcess"}, "thread": {"id": 132164652559232, "name": "MainThread"}, "time": {"repr": "2025-12-10 00:23:51.462872+00:00", "timestamp": 1765326231.462872}}}
2025-12-10T00:23:51.469077838Z {"text": "Prompts\n", "record": {"elapsed": {"repr": "0:00:57.431535", "seconds": 57.431535}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "81c2cab3ca9d4c39a8e2ec1a2a3402bb", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "artifact": {"system": "You are PR-Reviewer, a language model designed to review a Git Pull Request (PR).\nYour task is to provide constructive and concise feedback for the PR.\nThe review should focus on new code added in the PR code diff (lines starting with '+')\n\n\nThe format we will use to present the PR code diff:\n======\n## File: 'src/file1.py'\n\n\n@@ ... @@ def func1():\n__new hunk__\n11  unchanged code line0\n12  unchanged code line1\n13 +new code line2 added\n14  unchanged code line3\n__old hunk__\n unchanged code line0\n unchanged code line1\n-old code line2 removed\n unchanged code line3\n\n@@ ... @@ def func2():\n__new hunk__\n unchanged code line4\n+new code line5 added\n unchanged code line6\n\n## File: 'src/file2.py'\n...\n======\n\n- In the format above, the diff is organized into separate '__new hunk__' and '__old hunk__' sections for each code chunk. '__new hunk__' contains the updated code, while '__old hunk__' shows the removed code. If no code was removed in a specific chunk, the __old hunk__ section will be omitted.\n- We also added line numbers for the '__new hunk__' code, to help you refer to the code lines in your suggestions. These line numbers are not part of the actual code, and should only be used for reference.\n- Code lines are prefixed with symbols ('+', '-', ' '). The '+' symbol indicates new code added in the PR, the '-' symbol indicates code removed in the PR, and the ' ' symbol indicates unchanged code. The review should address new code added in the PR code diff (lines starting with '+').\n- When quoting variables, names or file paths from the code, use backticks (`) instead of single quote (').\n- Note that you only see changed code segments (diff hunks in a PR), not the entire codebase. Avoid suggestions that might duplicate existing functionality or questioning code elements (like variables declarations or import statements) that may be defined elsewhere in the codebase.\n- Also note that if the code ends at an opening brace or statement that begins a new scope (like 'if', 'for', 'try'), don't treat it as incomplete. Instead, acknowledge the visible scope boundary and analyze only the code shown.\n\n\nThe output must be a YAML object equivalent to type $PRReview, according to the following Pydantic definitions:\n=====\n\nclass KeyIssuesComponentLink(BaseModel):\n    relevant_file: str = Field(description=\"The full file path of the relevant file\")\n    issue_header: str = Field(description=\"One or two word title for the issue. For example: 'Possible Bug', etc.\")\n    issue_content: str = Field(description=\"A short and concise summary of what should be further inspected and validated during the PR review process for this issue. Do not mention line numbers in this field.\")\n    start_line: int = Field(description=\"The start line that corresponds to this issue in the relevant file\")\n    end_line: int = Field(description=\"The end line that corresponds to this issue in the relevant file\")\n\nclass Review(BaseModel):\n    estimated_effort_to_review_[1-5]: int = Field(description=\"Estimate, on a scale of 1-5 (inclusive), the time and effort required to review this PR by an experienced and knowledgeable developer. 1 means short and easy review , 5 means long and hard review. Take into account the size, complexity, quality, and the needed changes of the PR code diff.\")\n    relevant_tests: str = Field(description=\"yes/no question: does this PR have relevant tests added or updated ?\")\n    key_issues_to_review: List[KeyIssuesComponentLink] = Field(\"A short and diverse list (0-3 issues) of high-priority bugs, problems or performance concerns introduced in the PR code, which the PR reviewer should further focus on and validate during the review process.\")\n    security_concerns: str = Field(description=\"Does this PR code introduce vulnerabilities such as exposure of sensitive information (e.g., API keys, secrets, passwords), or security concerns like SQL injection, XSS, CSRF, and others ? Answer 'No' (without explaining why) if there are no possible issues. If there are security concerns or issues, start your answer with a short header, such as: 'Sensitive information exposure: ...', 'SQL injection: ...', etc. Explain your answer. Be specific and give examples if possible\")\n\nclass PRReview(BaseModel):\n    review: Review\n=====\n\n\nExample output:\n```yaml\nreview:\n  estimated_effort_to_review_[1-5]: |\n    3\n  relevant_tests: |\n    No\n  key_issues_to_review:\n    - relevant_file: |\n        directory/xxx.py\n      issue_header: |\n        Possible Bug\n      issue_content: |\n        ...\n      start_line: 12\n      end_line: 14\n    - ...\n  security_concerns: |\n    No\n```\n\nAnswer should be a valid YAML, and nothing else. Each YAML output MUST be after a newline, with proper indent, and block scalar indicator ('|')", "user": "\n\n\n--PR Info--\n\nToday's Date: 2025-12-10\n\nTitle: 'Fix: Search UX and multi-filter logic (frontend)'\n\nBranch: 'feature/initial-fixes'\n\nPR Description:\n======\n- Improved search bar UX in app/search/page.tsx:\r\n  - X icon clears input and refocuses\r\n  - Escape key clears input\r\n  - Enter key triggers search\r\n\r\n- Updated filter count logic:\r\n  - Accurately counts all active filters\r\n  - Apply button badge reflects true total\n======\n\n\nThe PR code diff:\n======\n## File: 'app/search/page.tsx'\n\n@@ -1,7 +1,8 @@\n__new hunk__\n1  \"use client\"\n2  \n3 +import { useState, useEffect, useMemo, useRef } from \"react\"\n4 +// import { X } from \"lucide-react\"\n5  import { useSearchParams, useRouter } from \"next/navigation\"\n6  import { useQuery } from \"@tanstack/react-query\"\n7  import { Input } from \"@/components/ui/input\"\n8  import { Button } from \"@/components/ui/button\"\n__old hunk__\n \"use client\"\n \n-import { useState, useEffect, useMemo } from \"react\"\n import { useSearchParams, useRouter } from \"next/navigation\"\n import { useQuery } from \"@tanstack/react-query\"\n import { Input } from \"@/components/ui/input\"\n import { Button } from \"@/components/ui/button\"\n\n@@ -41,11 +42,12 @@\n__new hunk__\n42  export default function SearchPage() {\n43    const searchParams = useSearchParams()\n44    const router = useRouter()\n45    const { filters, setFilters, resetFilters } = useFilters()\n46    const { settings } = useSettings()\n47  \n48    const [searchQuery, setSearchQuery] = useState(searchParams.get(\"q\") || filters.q || \"\")\n49 +  const inputRef = useRef<HTMLInputElement>(null);\n50    const [sortBy, setSortBy] = useState<SortOption>(settings.behavior.defaultSort || \"time\")\n51    const [filtersOpen, setFiltersOpen] = useState(false)\n52  \n53    // Update search query from URL params\n\n@@ -75,29 +77,54 @@ export default function SearchPage() {\n__new hunk__\n77        filters.fiberMin > 0 ||\n78        filters.sugarMax < 100 ||\n79        filters.sodiumMax < 4000 ||\n80        filters.maxTime < 120 ||\n81        !!filters.mealType\n82      )\n83    }, [filters])\n84  \n85 +  // const activeFilterCount = useMemo(() => {\n86 +  //   let count = 0\n87 +  //   if (filters.dietaryRestrictions.length > 0) count++\n88 +  //   if (filters.allergens.length > 0) count++\n89 +  //   if (filters.cuisines.length > 0) count++\n90 +  //   if (filters.majorConditions.length > 0) count++\n91 +  //   if (filters.calories[0] > 0 || filters.calories[1] < 1200) count++\n92 +  //   if (filters.proteinMin > 0) count++\n93 +  //   if (filters.carbsMin > 0) count++\n94 +  //   if (filters.fatMin > 0) count++\n95 +  //   if (filters.fiberMin > 0) count++\n96 +  //   if (filters.sugarMax < 100) count++\n97 +  //   if (filters.sodiumMax < 4000) count++\n98 +  //   if (filters.maxTime < 120) count++\n99 +  //   if (filters.mealType) count++\n100 +  //   return count\n101 +  // }, [filters])\n102    const activeFilterCount = useMemo(() => {\n103 +    let count = 0;\n104 +\n105 +  // Sum all selected array filters\n106 +    count += filters.dietaryRestrictions.length;\n107 +    count += filters.allergens.length;\n108 +    count += filters.cuisines.length;\n109 +    count += filters.majorConditions.length;\n110 +\n111 +    // Range and min/max filters\n112 +    if (filters.calories[0] > 0) count++; // Min calories\n113 +    if (filters.calories[1] < 1200) count++; // Max calories\n114 +    if (filters.proteinMin > 0) count++;\n115 +    if (filters.carbsMin > 0) count++;\n116 +    if (filters.fatMin > 0) count++;\n117 +    if (filters.fiberMin > 0) count++;\n118 +    if (filters.sugarMax < 100) count++;\n119 +    if (filters.sodiumMax < 4000) count++;\n120 +    if (filters.maxTime < 120) count++;\n121 +    \n122 +    // Single-value selection\n123 +    if (filters.mealType) count++;\n124 +\n125 +    return count;\n126 +  }, [filters]);\n127  \n128    const {\n129      data: searchResults = [],\n130      isLoading,\n__old hunk__\n       filters.fiberMin > 0 ||\n       filters.sugarMax < 100 ||\n       filters.sodiumMax < 4000 ||\n       filters.maxTime < 120 ||\n       !!filters.mealType\n     )\n   }, [filters])\n \n   const activeFilterCount = useMemo(() => {\n-    let count = 0\n-    if (filters.dietaryRestrictions.length > 0) count++\n-    if (filters.allergens.length > 0) count++\n-    if (filters.cuisines.length > 0) count++\n-    if (filters.majorConditions.length > 0) count++\n-    if (filters.calories[0] > 0 || filters.calories[1] < 1200) count++\n-    if (filters.proteinMin > 0) count++\n-    if (filters.carbsMin > 0) count++\n-    if (filters.fatMin > 0) count++\n-    if (filters.fiberMin > 0) count++\n-    if (filters.sugarMax < 100) count++\n-    if (filters.sodiumMax < 4000) count++\n-    if (filters.maxTime < 120) count++\n-    if (filters.mealType) count++\n-    return count\n-  }, [filters])\n \n   const {\n     data: searchResults = [],\n     isLoading,\n\n@@ -113,12 +140,22 @@ export default function SearchPage() {\n__new hunk__\n140          const rankedResults = rank(rawResults, settings)\n141          return rankedResults\n142        }\n143  \n144        return rawResults.map((recipe) => ({ ...recipe, score: 0 }))\n145      },\n146      enabled: !!(searchQuery || hasActiveFilters),\n147    })\n148 +  const handleSearchInputKeyDown = (e: React.KeyboardEvent<HTMLInputElement>) => {\n149 +    if (e.key === \"Escape\" && searchQuery) {\n150 +      setSearchQuery(\"\");\n151 +      inputRef.current?.focus();\n152 +    }\n153 +    if (e.key === \"Enter\") {\n154 +      handleSearch(searchQuery);\n155 +    }\n156 +  };\n157 +\n158  \n159    const handleSearch = (query: string) => {\n160      setSearchQuery(query)\n161      setFilters({ ...filters, q: query })\n\n@@ -182,13 +219,13 @@ export default function SearchPage() {\n__new hunk__\n219    return (\n220      <div className=\"container px-4 py-6 max-w-6xl\">\n221        <div className=\"space-y-6\">\n222          {/* Search Header */}\n223          <div className=\"space-y-4\">\n224            <h1 className=\"text-3xl font-bold\">Search Recipes</h1>\n225  \n226            {/* Search Input */}\n227 +          {/* <div className=\"relative\">\n228              <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n229              <Input\n230                role=\"search\"\n231                placeholder=\"Search recipes, ingredients, cuisines...\"\n__old hunk__\n   return (\n     <div className=\"container px-4 py-6 max-w-6xl\">\n       <div className=\"space-y-6\">\n         {/* Search Header */}\n         <div className=\"space-y-4\">\n           <h1 className=\"text-3xl font-bold\">Search Recipes</h1>\n \n           {/* Search Input */}\n-          <div className=\"relative\">\n             <Search className=\"absolute left-3 top-1/2 transform -translate-y-1/2 h-4 w-4 text-muted-foreground\" />\n             <Input\n               role=\"search\"\n               placeholder=\"Search recipes, ingredients, cuisines...\"\n\n@@ -192,14 +229,51 @@ export default function SearchPage() {\n__new hunk__\n229              <Input\n230                role=\"search\"\n231                placeholder=\"Search recipes, ingredients, cuisines...\"\n232                value={searchQuery}\n233                onChange={(e) => setSearchQuery(e.target.value)}\n234                onKeyDown={(e) => e.key === \"Enter\" && handleSearch(searchQuery)}\n235                className=\"pl-10 pr-4 h-12 text-lg\"\n236              />\n237 +          </div> */}\n238 +          <div style={{ position: \"relative\", display: \"inline-block\", width: \"100%\" }}>\n239 +            <Search style={{ position: \"absolute\", left: \"0.75rem\", top: \"50%\", transform: \"translateY(-50%)\", height: \"1rem\", width: \"1rem\", color: \"gray\" }} />\n240 +            <Input\n241 +              role=\"search\"\n242 +              ref={inputRef}\n243 +              placeholder=\"Search recipes, ingredients, cuisines...\"\n244 +              value={searchQuery}\n245 +              onChange={(e) => setSearchQuery(e.target.value)}\n246 +              onKeyDown={handleSearchInputKeyDown}\n247 +              style={{ paddingRight: searchQuery ? \"2rem\" : undefined, width: \"100%\" }}\n248 +              className=\"pl-10 pr-4 h-12 text-lg\"\n249 +            />\n250 +            {searchQuery && (\n251 +              <button\n252 +                type=\"button\"\n253 +                style={{\n254 +                  position: \"absolute\",\n255 +                  right: \"0.75rem\",\n256 +                  top: \"50%\",\n257 +                  transform: \"translateY(-50%)\",\n258 +                  background: \"none\",\n259 +                  border: \"none\",\n260 +                  cursor: \"pointer\",\n261 +                  padding: 0,\n262 +                  color: \"gray\",\n263 +                }}\n264 +                aria-label=\"Clear search\"\n265 +                onClick={() => {\n266 +                  setSearchQuery(\"\");\n267 +                  inputRef.current?.focus();\n268 +              }}\n269 +              >\n270 +                <X size={20} />\n271 +            </button>\n272 +          )}\n273            </div>\n274  \n275 +\n276            {/* Search Actions */}\n277            <div className=\"flex items-center gap-2\">\n278              <Button onClick={() => handleSearch(searchQuery)} size=\"sm\">\n279                Search\n\n\n## File: 'components/filter-panel.tsx'\n\n@@ -54,35 +54,58 @@\n__new hunk__\n54  export function FilterPanel({ open, onOpenChange, initialValues, onApply, onReset }: FilterPanelProps) {\n55    const form = useForm<FiltersFormInput>({\n56      resolver: zodResolver(schema),\n57      // provide full defaults (OUTPUT fits into INPUT just fine)\n58      defaultValues: schema.parse(initialValues ?? {}),\n59      mode: \"onChange\",\n60    })\n61  \n62     useEffect(() => {\n63      form.reset(schema.parse(initialValues ?? {}));\n64    }, [open, initialValues, form]);\n65  \n66 +  // function getActiveFiltersCount(): number {\n67 +  //   const values = form.getValues()\n68 +  //   let count = 0\n69 +  //   if ((values.dietaryRestrictions || []).length > 0) count++\n70 +  //   if ((values.allergens || []).length > 0) count++\n71 +  //   if ((values.cuisines || []).length > 0) count++\n72 +  //   if ((values.majorConditions || []).length > 0) count++\n73 +  //   if (values.calories && (values.calories[0] > 0 || values.calories[1] < 1200)) count++\n74 +  //   if ((values.proteinMin || 0) > 0) count++\n75 +  //   if ((values.carbsMin || 0) > 0) count++\n76 +  //   if ((values.fatMin || 0) > 0) count++\n77 +  //   if ((values.fiberMin || 0) > 0) count++\n78 +  //   if ((values.sugarMax || 100) < 100) count++\n79 +  //   if ((values.sodiumMax || 4000) < 4000) count++\n80 +  //   2025-12-10T00:23:51.469077838Z if ((values.maxTime || 120) < 120) count++\n81 +  //   if ((values.mealType || \"\") !== \"\") count++\n82 +  //   return count\n83 +  // }\n84    function getActiveFiltersCount(): number {\n85 +    const values = form.getValues();\n86 +    let count = 0;\n87 +\n88 +    // Count all selected array filters individually\n89 +    count += values.dietaryRestrictions.length;\n90 +    count += values.allergens.length;\n91 +    count += values.cuisines.length;\n92 +    count += values.majorConditions.length;\n93 +\n94 +    // Numeric and single-value filters\n95 +    if (values.calories[0] > 0) count++;           // Min calories\n96 +    if (values.calories[1] < 1200) count++;        // Max calories\n97 +    if (values.proteinMin > 0) count++;\n98 +    if (values.carbsMin > 0) count++;\n99 +    if (values.fatMin > 0) count++;\n100 +    if (values.fiberMin > 0) count++;\n101 +    if (values.sugarMax < 100) count++;\n102 +    if (values.sodiumMax < 4000) count++;\n103 +    if (values.maxTime < 120) count++;\n104 +    if (values.mealType) count++;\n105 +\n106 +    return count;\n107    }\n108    function handleApply() {\n109      const values = schema.parse(form.getValues())\n110      onApply(values)\n111      onOpenChange(false)\n__old hunk__\n export function FilterPanel({ open, onOpenChange, initialValues, onApply, onReset }: FilterPanelProps) {\n   const form = useForm<FiltersFormInput>({\n     resolver: zodResolver(schema),\n     // provide full defaults (OUTPUT fits into INPUT just fine)\n     defaultValues: schema.parse(initialValues ?? {}),\n     mode: \"onChange\",\n   })\n \n    useEffect(() => {\n     form.reset(schema.parse(initialValues ?? {}));\n   }, [open, initialValues, form]);\n \n   function getActiveFiltersCount(): number {\n-    const values = form.getValues()\n-    let count = 0\n-    if ((values.dietaryRestrictions || []).length > 0) count++\n-    if ((values.allergens || []).length > 0) count++\n-    if ((values.cuisines || []).length > 0) count++\n-    if ((values.majorConditions || []).length > 0) count++\n-    if (values.calories && (values.calories[0] > 0 || values.calories[1] < 1200)) count++\n-    if ((values.proteinMin || 0) > 0) count++\n-    if ((values.carbsMin || 0) > 0) count++\n-    if ((values.fatMin || 0) > 0) count++\n-    if ((values.fiberMin || 0) > 0) count++\n-    if ((values.sugarMax || 100) < 100) count++\n-    if ((values.sodiumMax || 4000) < 4000) count++\n-    if ((values.maxTime || 120) < 120) count++\n-    if ((values.mealType || \"\") !== \"\") count++\n-    return count\n   }\n-\n   function handleApply() {\n     const values = schema.parse(form.getValues())\n     onApply(values)\n     onOpenChange(false)\n======\n\n\nResponse (should be a valid YAML, and nothing else):\n```yaml"}}, "file": {"name": "litellm_ai_handler.py", "path": "/app/pr_agent/algo/ai_handlers/litellm_ai_handler.py"}, "function": "chat_completion", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 383, "message": "Prompts", "module": "litellm_ai_handler", "name": "pr_agent.algo.ai_handlers.litellm_ai_handler", "process": {"id": 9, "name": "MainProcess"}, "thread": {"id": 132164652559232, "name": "MainThread"}, "time": {"repr": "2025-12-10 00:23:51.467498+00:00", "timestamp": 1765326231.467498}}}
2025-12-10T00:23:51.481276381Z {"text": "Error during LLM inference: litellm.UnsupportedParamsError: gpt-5 models (including gpt-5-codex) don't support temperature=0.2. Only temperature=1 is supported. To drop unsupported params set `litellm.drop_params = True`\n", "record": {"elapsed": {"repr": "0:00:57.444817", "seconds": 57.444817}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "81c2cab3ca9d4c39a8e2ec1a2a3402bb", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "litellm_ai_handler.py", "path": "/app/pr_agent/algo/ai_handlers/litellm_ai_handler.py"}, "function": "chat_completion", "level": {"icon": "âš ï¸", "name": "WARNING", "no": 30}, "line": 396, "message": "Error during LLM inference: litellm.UnsupportedParamsError: gpt-5 models (including gpt-5-codex) don't support temperature=0.2. Only temperature=1 is supported. To drop unsupported params set `litellm.drop_params = True`", "module": "litellm_ai_handler", "name": "pr_agent.algo.ai_handlers.litellm_ai_handler", "process": {"id": 9, "name": "MainProcess"}, "thread": {"id": 132164652559232, "name": "MainThread"}, "time": {"repr": "2025-12-10 00:23:51.480780+00:00", "timestamp": 1765326231.48078}}}
2025-12-10T00:23:51.482235406Z {"text": "Failed to generate prediction with openai/gpt-5-nano\n", "record": {"elapsed": {"repr": "0:00:57.445177", "seconds": 57.445177}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "81c2cab3ca9d4c39a8e2ec1a2a3402bb", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "artifact": {"error": "RetryError[<Future at 0x7833f2ea5280 state=finished raised UnsupportedParamsError>]"}}, "file": {"name": "pr_processing.py", "path": "/app/pr_agent/algo/pr_processing.py"}, "function": "retry_with_fallback_models", "level": {"icon": "âš ï¸", "name": "WARNING", "no": 30}, "line": 333, "message": "Failed to generate prediction with openai/gpt-5-nano", "module": "pr_processing", "name": "pr_agent.algo.pr_processing", "process": {"id": 9, "name": "MainProcess"}, "thread": {"id": 132164652559232, "name": "MainThread"}, "time": {"repr": "2025-12-10 00:23:51.481140+00:00", "timestamp": 1765326231.48114}}}
2025-12-10T00:23:51.482255296Z {"text": "Failed to review PR: Failed to generate prediction with any model of ['openai/gpt-5', 'openai/gpt-5-mini', 'openai/gpt-5-nano']\n", "record": {"elapsed": {"repr": "0:00:57.445308", "seconds": 57.445308}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "81c2cab3ca9d4c39a8e2ec1a2a3402bb", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "pr_reviewer.py", "path": "/app/pr_agent/tools/pr_reviewer.py"}, "function": "run", "level": {"icon": "âŒ", "name": "ERROR", "no": 40}, "line": 184, "message": "Failed to review PR: Failed to generate prediction with any model of ['openai/gpt-5', 'openai/gpt-5-mini', 'openai/gpt-5-nano']", "module": "pr_reviewer", "name": "pr_agent.tools.pr_reviewer", "process": {"id": 9, "name": "MainProcess"}, "thread": {"id": 132164652559232, "name": "MainThread"}, "time": {"repr": "2025-12-10 00:23:51.481271+00:00", "timestamp": 1765326231.481271}}}
