2025-Dec-11 06:52:16.000686
[2025-12-11 06:52:16 +0000] [1] [INFO] Starting gunicorn 23.0.0
2025-Dec-11 06:52:16.000885
[2025-12-11 06:52:16 +0000] [1] [INFO] Listening at: http://0.0.0.0:3000 (1)
2025-Dec-11 06:52:16.001105
[2025-12-11 06:52:16 +0000] [1] [INFO] Using worker: uvicorn.workers.UvicornWorker
2025-Dec-11 06:52:16.007070
[2025-12-11 06:52:16 +0000] [7] [INFO] Booting worker with pid: 7
2025-Dec-11 06:52:16.052230
[2025-12-11 06:52:16 +0000] [8] [INFO] Booting worker with pid: 8
2025-Dec-11 06:52:16.107688
[2025-12-11 06:52:16 +0000] [9] [INFO] Booting worker with pid: 9
2025-Dec-11 06:52:16.159954
[2025-12-11 06:52:16 +0000] [10] [INFO] Booting worker with pid: 10
2025-Dec-11 06:52:16.235308
[2025-12-11 06:52:16 +0000] [11] [INFO] Booting worker with pid: 11
2025-Dec-11 06:52:16.243133
[2025-12-11 06:52:16 +0000] [12] [INFO] Booting worker with pid: 12
2025-Dec-11 06:52:16.338028
[2025-12-11 06:52:16 +0000] [13] [INFO] Booting worker with pid: 13
2025-Dec-11 06:52:16.422143
[2025-12-11 06:52:16 +0000] [14] [INFO] Booting worker with pid: 14
2025-Dec-11 06:52:16.432445
[2025-12-11 06:52:16 +0000] [15] [INFO] Booting worker with pid: 15
2025-Dec-11 06:52:16.532788
[2025-12-11 06:52:16 +0000] [16] [INFO] Booting worker with pid: 16
2025-Dec-11 06:52:16.572205
[2025-12-11 06:52:16 +0000] [17] [INFO] Booting worker with pid: 17
2025-Dec-11 06:52:16.596157
[2025-12-11 06:52:16 +0000] [18] [INFO] Booting worker with pid: 18
2025-Dec-11 06:52:16.633192
[2025-12-11 06:52:16 +0000] [19] [INFO] Booting worker with pid: 19
2025-Dec-11 06:52:16.712727
[2025-12-11 06:52:16 +0000] [20] [INFO] Booting worker with pid: 20
2025-Dec-11 06:52:16.804684
[2025-12-11 06:52:16 +0000] [21] [INFO] Booting worker with pid: 21
2025-Dec-11 06:52:16.838892
[2025-12-11 06:52:16 +0000] [22] [INFO] Booting worker with pid: 22
2025-Dec-11 06:52:16.906249
[2025-12-11 06:52:16 +0000] [23] [INFO] Booting worker with pid: 23
2025-Dec-11 06:52:17.001398
[2025-12-11 06:52:17 +0000] [24] [INFO] Booting worker with pid: 24
2025-Dec-11 06:52:17.060763
[2025-12-11 06:52:17 +0000] [25] [INFO] Booting worker with pid: 25
2025-Dec-11 06:52:17.161055
[2025-12-11 06:52:17 +0000] [26] [INFO] Booting worker with pid: 26
2025-Dec-11 06:52:17.242077
[2025-12-11 06:52:17 +0000] [27] [INFO] Booting worker with pid: 27
2025-Dec-11 06:52:17.277319
[2025-12-11 06:52:17 +0000] [28] [INFO] Booting worker with pid: 28
2025-Dec-11 06:52:17.364457
[2025-12-11 06:52:17 +0000] [29] [INFO] Booting worker with pid: 29
2025-Dec-11 06:52:17.473599
[2025-12-11 06:52:17 +0000] [30] [INFO] Booting worker with pid: 30
2025-Dec-11 06:52:17.492959
[2025-12-11 06:52:17 +0000] [31] [INFO] Booting worker with pid: 31
2025-Dec-11 06:52:26.216880
/usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-Dec-11 06:52:26.216955
import pkg_resources
2025-Dec-11 06:52:26.669054
/usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-Dec-11 06:52:26.669104
import pkg_resources
2025-Dec-11 06:52:27.601537
/usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-Dec-11 06:52:27.601611
import pkg_resources
2025-Dec-11 06:52:27.603852
2025-12-11 06:52:27.603 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-Dec-11 06:52:27.607329
2025-12-11 06:52:27.606 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-Dec-11 06:52:27.780520
/usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-Dec-11 06:52:27.780559
import pkg_resources
2025-Dec-11 06:52:27.793681
2025-12-11 06:52:27.792 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-Dec-11 06:52:27.793722
2025-12-11 06:52:27.793 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-Dec-11 06:52:27.889598
[2025-12-11 06:52:27 +0000] [13] [INFO] Started server process [13]
2025-Dec-11 06:52:27.889663
[2025-12-11 06:52:27 +0000] [13] [INFO] Waiting for application startup.
2025-Dec-11 06:52:27.889668
[2025-12-11 06:52:27 +0000] [13] [INFO] Application startup complete.
2025-Dec-11 06:52:27.976437
/usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-Dec-11 06:52:27.976490
import pkg_resources
2025-Dec-11 06:52:28.037478
2025-12-11 06:52:28.037 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-Dec-11 06:52:28.037673
2025-12-11 06:52:28.037 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-Dec-11 06:52:28.096789
/usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-Dec-11 06:52:28.096911
import pkg_resources
2025-Dec-11 06:52:28.176368
[2025-12-11 06:52:28 +0000] [9] [INFO] Started server process [9]
2025-Dec-11 06:52:28.176416
[2025-12-11 06:52:28 +0000] [9] [INFO] Waiting for application startup.
2025-Dec-11 06:52:28.176700
[2025-12-11 06:52:28 +0000] [9] [INFO] Application startup complete.
2025-Dec-11 06:52:28.199015
[2025-12-11 06:52:28 +0000] [28] [INFO] Started server process [28]
2025-Dec-11 06:52:28.199054
[2025-12-11 06:52:28 +0000] [28] [INFO] Waiting for application startup.
2025-Dec-11 06:52:28.203447
[2025-12-11 06:52:28 +0000] [28] [INFO] Application startup complete.
2025-Dec-11 06:52:28.391873
/usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-Dec-11 06:52:28.391911
import pkg_resources
2025-Dec-11 06:52:28.432845
/usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-Dec-11 06:52:28.432885
import pkg_resources
2025-Dec-11 06:52:28.434985
2025-12-11 06:52:28.434 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-Dec-11 06:52:28.439252
2025-12-11 06:52:28.438 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-Dec-11 06:52:28.605718
[2025-12-11 06:52:28 +0000] [8] [INFO] Started server process [8]
2025-Dec-11 06:52:28.606087
[2025-12-11 06:52:28 +0000] [8] [INFO] Waiting for application startup.
2025-Dec-11 06:52:28.606607
[2025-12-11 06:52:28 +0000] [8] [INFO] Application startup complete.
2025-Dec-11 06:52:28.613872
2025-12-11 06:52:28.613 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-Dec-11 06:52:28.618100
2025-12-11 06:52:28.617 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-Dec-11 06:52:28.620470
/usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-Dec-11 06:52:28.620494
import pkg_resources
2025-Dec-11 06:52:28.787431
/usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-Dec-11 06:52:28.787510
import pkg_resources
2025-Dec-11 06:52:28.842561
/usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-Dec-11 06:52:28.842614
import pkg_resources
2025-Dec-11 06:52:28.868223
2025-12-11 06:52:28.860 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-Dec-11 06:52:28.868741
2025-12-11 06:52:28.868 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-Dec-11 06:52:28.910667
[2025-12-11 06:52:28 +0000] [21] [INFO] Started server process [21]
2025-Dec-11 06:52:28.910735
[2025-12-11 06:52:28 +0000] [21] [INFO] Waiting for application startup.
2025-Dec-11 06:52:28.911119
[2025-12-11 06:52:28 +0000] [21] [INFO] Application startup complete.
2025-Dec-11 06:52:29.032311
2025-12-11 06:52:29.031 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-Dec-11 06:52:29.032482
2025-12-11 06:52:29.032 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-Dec-11 06:52:29.101109
/usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-Dec-11 06:52:29.101151
import pkg_resources
2025-Dec-11 06:52:29.160454
2025-12-11 06:52:29.159 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-Dec-11 06:52:29.160740
2025-12-11 06:52:29.160 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-Dec-11 06:52:29.187289
[2025-12-11 06:52:29 +0000] [7] [INFO] Started server process [7]
2025-Dec-11 06:52:29.187389
[2025-12-11 06:52:29 +0000] [7] [INFO] Waiting for application startup.
2025-Dec-11 06:52:29.187790
[2025-12-11 06:52:29 +0000] [7] [INFO] Application startup complete.
2025-Dec-11 06:52:29.188790
/usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-Dec-11 06:52:29.188804
import pkg_resources
2025-Dec-11 06:52:29.263255
2025-12-11 06:52:29.262 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-Dec-11 06:52:29.263484
2025-12-11 06:52:29.263 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-Dec-11 06:52:29.274289
[2025-12-11 06:52:29 +0000] [17] [INFO] Started server process [17]
2025-Dec-11 06:52:29.278142
[2025-12-11 06:52:29 +0000] [17] [INFO] Waiting for application startup.
2025-Dec-11 06:52:29.278624
[2025-12-11 06:52:29 +0000] [17] [INFO] Application startup complete.
2025-Dec-11 06:52:29.287696
/usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-Dec-11 06:52:29.287735
import pkg_resources
2025-Dec-11 06:52:29.395684
[2025-12-11 06:52:29 +0000] [19] [INFO] Started server process [19]
2025-Dec-11 06:52:29.395764
[2025-12-11 06:52:29 +0000] [19] [INFO] Waiting for application startup.
2025-Dec-11 06:52:29.396036
[2025-12-11 06:52:29 +0000] [19] [INFO] Application startup complete.
2025-Dec-11 06:52:29.424105
/usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-Dec-11 06:52:29.424167
import pkg_resources
2025-Dec-11 06:52:29.488524
2025-12-11 06:52:29.488 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-Dec-11 06:52:29.489123
2025-12-11 06:52:29.488 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-Dec-11 06:52:29.511684
/usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-Dec-11 06:52:29.511746
import pkg_resources
2025-Dec-11 06:52:29.662613
[2025-12-11 06:52:29 +0000] [11] [INFO] Started server process [11]
2025-Dec-11 06:52:29.662656
[2025-12-11 06:52:29 +0000] [11] [INFO] Waiting for application startup.
2025-Dec-11 06:52:29.662659
[2025-12-11 06:52:29 +0000] [11] [INFO] Application startup complete.
2025-Dec-11 06:52:29.669124
2025-12-11 06:52:29.668 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-Dec-11 06:52:29.669739
2025-12-11 06:52:29.669 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-Dec-11 06:52:29.733200
[2025-12-11 06:52:29 +0000] [15] [INFO] Started server process [15]
2025-Dec-11 06:52:29.733586
[2025-12-11 06:52:29 +0000] [15] [INFO] Waiting for application startup.
2025-Dec-11 06:52:29.736401
[2025-12-11 06:52:29 +0000] [15] [INFO] Application startup complete.
2025-Dec-11 06:52:29.794761
[2025-12-11 06:52:29 +0000] [14] [INFO] Started server process [14]
2025-Dec-11 06:52:29.794793
[2025-12-11 06:52:29 +0000] [14] [INFO] Waiting for application startup.
2025-Dec-11 06:52:29.794797
[2025-12-11 06:52:29 +0000] [14] [INFO] Application startup complete.
2025-Dec-11 06:52:29.897975
2025-12-11 06:52:29.896 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-Dec-11 06:52:29.898006
2025-12-11 06:52:29.897 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-Dec-11 06:52:30.203299
/usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-Dec-11 06:52:30.203335
import pkg_resources
2025-Dec-11 06:52:30.265527
2025-12-11 06:52:30.264 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-Dec-11 06:52:30.265562
2025-12-11 06:52:30.265 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-Dec-11 06:52:30.485008
/usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-Dec-11 06:52:30.485071
import pkg_resources
2025-Dec-11 06:52:30.497691
/usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-Dec-11 06:52:30.497734
import pkg_resources
2025-Dec-11 06:52:30.515408
[2025-12-11 06:52:30 +0000] [22] [INFO] Started server process [22]
2025-Dec-11 06:52:30.515433
[2025-12-11 06:52:30 +0000] [22] [INFO] Waiting for application startup.
2025-Dec-11 06:52:30.516016
[2025-12-11 06:52:30 +0000] [22] [INFO] Application startup complete.
2025-Dec-11 06:52:30.575982
[2025-12-11 06:52:30 +0000] [25] [INFO] Started server process [25]
2025-Dec-11 06:52:30.576579
[2025-12-11 06:52:30 +0000] [25] [INFO] Waiting for application startup.
2025-Dec-11 06:52:30.577523
[2025-12-11 06:52:30 +0000] [25] [INFO] Application startup complete.
2025-Dec-11 06:52:30.615276
2025-12-11 06:52:30.614 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-Dec-11 06:52:30.619210
2025-12-11 06:52:30.615 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-Dec-11 06:52:30.634064
/usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-Dec-11 06:52:30.634113
import pkg_resources
2025-Dec-11 06:52:30.634669
2025-12-11 06:52:30.627 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-Dec-11 06:52:30.635261
2025-12-11 06:52:30.634 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-Dec-11 06:52:30.735383
/usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-Dec-11 06:52:30.735428
import pkg_resources
2025-Dec-11 06:52:30.816223
[2025-12-11 06:52:30 +0000] [30] [INFO] Started server process [30]
2025-Dec-11 06:52:30.816347
[2025-12-11 06:52:30 +0000] [30] [INFO] Waiting for application startup.
2025-Dec-11 06:52:30.817218
[2025-12-11 06:52:30 +0000] [30] [INFO] Application startup complete.
2025-Dec-11 06:52:30.827027
2025-12-11 06:52:30.823 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-Dec-11 06:52:30.830088
2025-12-11 06:52:30.826 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-Dec-11 06:52:30.865900
/usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-Dec-11 06:52:30.865940
import pkg_resources
2025-Dec-11 06:52:30.895330
[2025-12-11 06:52:30 +0000] [12] [INFO] Started server process [12]
2025-Dec-11 06:52:30.895453
[2025-12-11 06:52:30 +0000] [12] [INFO] Waiting for application startup.
2025-Dec-11 06:52:30.895780
[2025-12-11 06:52:30 +0000] [12] [INFO] Application startup complete.
2025-Dec-11 06:52:30.999120
2025-12-11 06:52:30.998 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-Dec-11 06:52:31.000427
2025-12-11 06:52:30.999 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-Dec-11 06:52:31.042192
/usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-Dec-11 06:52:31.042233
import pkg_resources
2025-Dec-11 06:52:31.067636
/usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-Dec-11 06:52:31.067700
import pkg_resources
2025-Dec-11 06:52:31.127963
[2025-12-11 06:52:31 +0000] [31] [INFO] Started server process [31]
2025-Dec-11 06:52:31.128007
[2025-12-11 06:52:31 +0000] [31] [INFO] Waiting for application startup.
2025-Dec-11 06:52:31.128009
[2025-12-11 06:52:31 +0000] [31] [INFO] Application startup complete.
2025-Dec-11 06:52:31.174110
[2025-12-11 06:52:31 +0000] [10] [INFO] Started server process [10]
2025-Dec-11 06:52:31.174281
[2025-12-11 06:52:31 +0000] [10] [INFO] Waiting for application startup.
2025-Dec-11 06:52:31.174910
[2025-12-11 06:52:31 +0000] [10] [INFO] Application startup complete.
2025-Dec-11 06:52:31.224112
2025-12-11 06:52:31.221 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-Dec-11 06:52:31.224152
2025-12-11 06:52:31.221 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-Dec-11 06:52:31.244749
2025-12-11 06:52:31.244 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-Dec-11 06:52:31.245461
2025-12-11 06:52:31.245 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-Dec-11 06:52:31.260805
2025-12-11 06:52:31.260 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-Dec-11 06:52:31.260974
2025-12-11 06:52:31.260 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-Dec-11 06:52:31.310972
2025-12-11 06:52:31.308 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-Dec-11 06:52:31.311001
2025-12-11 06:52:31.308 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-Dec-11 06:52:31.391511
[2025-12-11 06:52:31 +0000] [20] [INFO] Started server process [20]
2025-Dec-11 06:52:31.391554
[2025-12-11 06:52:31 +0000] [20] [INFO] Waiting for application startup.
2025-Dec-11 06:52:31.391689
[2025-12-11 06:52:31 +0000] [20] [INFO] Application startup complete.
2025-Dec-11 06:52:31.412409
[2025-12-11 06:52:31 +0000] [27] [INFO] Started server process [27]
2025-Dec-11 06:52:31.413088
[2025-12-11 06:52:31 +0000] [27] [INFO] Waiting for application startup.
2025-Dec-11 06:52:31.413124
[2025-12-11 06:52:31 +0000] [27] [INFO] Application startup complete.
2025-Dec-11 06:52:31.421561
[2025-12-11 06:52:31 +0000] [26] [INFO] Started server process [26]
2025-Dec-11 06:52:31.421780
[2025-12-11 06:52:31 +0000] [26] [INFO] Waiting for application startup.
2025-Dec-11 06:52:31.422082
[2025-12-11 06:52:31 +0000] [26] [INFO] Application startup complete.
2025-Dec-11 06:52:31.446318
/usr/local/lib/python3.12/site-packages/azure/__init__.py:5: UserWarning: pkg_resources is deprecated as an API. See https://setuptools.pypa.io/en/latest/pkg_resources.html. The pkg_resources package is slated for removal as early as 2025-11-30. Refrain from using this package or pin to Setuptools<81.
2025-Dec-11 06:52:31.446364
import pkg_resources
2025-Dec-11 06:52:31.459436
2025-12-11 06:52:31.458 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-Dec-11 06:52:31.460318
2025-12-11 06:52:31.460 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-Dec-11 06:52:31.464998
[2025-12-11 06:52:31 +0000] [29] [INFO] Started server process [29]
2025-Dec-11 06:52:31.465396
[2025-12-11 06:52:31 +0000] [29] [INFO] Waiting for application startup.
2025-Dec-11 06:52:31.465748
[2025-12-11 06:52:31 +0000] [29] [INFO] Application startup complete.
2025-Dec-11 06:52:31.507958
2025-12-11 06:52:31.506 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-Dec-11 06:52:31.508004
2025-12-11 06:52:31.507 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-Dec-11 06:52:31.568751
2025-12-11 06:52:31.568 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-Dec-11 06:52:31.578383
2025-12-11 06:52:31.573 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-Dec-11 06:52:31.607985
[2025-12-11 06:52:31 +0000] [16] [INFO] Started server process [16]
2025-Dec-11 06:52:31.608041
[2025-12-11 06:52:31 +0000] [16] [INFO] Waiting for application startup.
2025-Dec-11 06:52:31.608314
[2025-12-11 06:52:31 +0000] [16] [INFO] Application startup complete.
2025-Dec-11 06:52:31.632605
[2025-12-11 06:52:31 +0000] [24] [INFO] Started server process [24]
2025-Dec-11 06:52:31.632652
[2025-12-11 06:52:31 +0000] [24] [INFO] Waiting for application startup.
2025-Dec-11 06:52:31.632951
[2025-12-11 06:52:31 +0000] [24] [INFO] Application startup complete.
2025-Dec-11 06:52:31.690660
[2025-12-11 06:52:31 +0000] [23] [INFO] Started server process [23]
2025-Dec-11 06:52:31.690720
[2025-12-11 06:52:31 +0000] [23] [INFO] Waiting for application startup.
2025-Dec-11 06:52:31.690907
[2025-12-11 06:52:31 +0000] [23] [INFO] Application startup complete.
2025-Dec-11 06:52:31.807910
2025-12-11 06:52:31.807 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings/.secrets.toml. Skipping it.
2025-Dec-11 06:52:31.807967
2025-12-11 06:52:31.807 | WARNING  | pr_agent.custom_merge_loader:load:62 - Settings file not found: /app/pr_agent/settings_prod/.secrets.toml. Skipping it.
2025-Dec-11 06:52:31.908642
[2025-12-11 06:52:31 +0000] [18] [INFO] Started server process [18]
2025-Dec-11 06:52:31.908796
[2025-12-11 06:52:31 +0000] [18] [INFO] Waiting for application startup.
2025-Dec-11 06:52:31.909183
[2025-12-11 06:52:31 +0000] [18] [INFO] Application startup complete.
2025-Dec-11 06:53:36.777017
{"text": "Received a GitHub webhook\n", "record": {"elapsed": {"repr": "0:01:05.384516", "seconds": 65.384516}, "exception": null, "extra": {}, "file": {"name": "github_app.py", "path": "/app/pr_agent/servers/github_app.py"}, "function": "handle_github_webhooks", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 45, "message": "Received a GitHub webhook", "module": "github_app", "name": "pr_agent.servers.github_app", "process": {"id": 18, "name": "MainProcess"}, "thread": {"id": 136556055251840, "name": "MainThread"}, "time": {"repr": "2025-12-11 06:53:36.776559+00:00", "timestamp": 1765436016.776559}}}
2025-Dec-11 06:53:36.798074
{"text": "Handling request with event: issue_comment, action: created\n", "record": {"elapsed": {"repr": "0:01:05.405602", "seconds": 65.405602}, "exception": null, "extra": {}, "file": {"name": "github_app.py", "path": "/app/pr_agent/servers/github_app.py"}, "function": "handle_request", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 321, "message": "Handling request with event: issue_comment, action: created", "module": "github_app", "name": "pr_agent.servers.github_app", "process": {"id": 18, "name": "MainProcess"}, "thread": {"id": 136556055251840, "name": "MainThread"}, "time": {"repr": "2025-12-11 06:53:36.797645+00:00", "timestamp": 1765436016.797645}}}
2025-Dec-11 06:53:36.798910
{"text": "Request body\n", "record": {"elapsed": {"repr": "0:01:05.406513", "seconds": 65.406513}, "exception": null, "extra": {"artifact": {"action": "created", "issue": {"url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/1", "repository_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend", "labels_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/1/labels{/name}", "comments_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/1/comments", "events_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/1/events", "html_url": "https://github.com/souravOD/nutri-b2c-frontend/pull/1", "id": 3527983986, "node_id": "PR_kwDOQEZhKM6uaI7J", "number": 1, "title": "Fix: Search UX and multi-filter logic (frontend)", "user": {"login": "NamanOdysseyts", "id": 238778617, "node_id": "U_kgDODjt4-Q", "avatar_url": "https://avatars.githubusercontent.com/u/238778617?v=4", "gravatar_id": "", "url": "https://api.github.com/users/NamanOdysseyts", "html_url": "https://github.com/NamanOdysseyts", "followers_url": "https://api.github.com/users/NamanOdysseyts/followers", "following_url": "https://api.github.com/users/NamanOdysseyts/following{/other_user}", "gists_url": "https://api.github.com/users/NamanOdysseyts/gists{/gist_id}", "starred_url": "https://api.github.com/users/NamanOdysseyts/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/NamanOdysseyts/subscriptions", "organizations_url": "https://api.github.com/users/NamanOdysseyts/orgs", "repos_url": "https://api.github.com/users/NamanOdysseyts/repos", "events_url": "https://api.github.com/users/NamanOdysseyts/events{/privacy}", "received_events_url": "https://api.github.com/users/NamanOdysseyts/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 9561404867, "node_id": "LA_kwDOQEZhKM8AAAACOed1ww", "url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/labels/Review%20effort%202/5", "name": "Review effort 2/5", "color": "d1bcf9", "default": false, "description": null}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 86, "created_at": "2025-10-18T02:45:21Z", "updated_at": "2025-12-11T06:53:35Z", "closed_at": null, "author_association": "COLLABORATOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "html_url": "https://github.com/souravOD/nutri-b2c-frontend/pull/1", "diff_url": "https://github.com/souravOD/nutri-b2c-frontend/pull/1.diff", "patch_url": "https://github.com/souravOD/nutri-b2c-frontend/pull/1.patch", "merged_at": null}, "body": "- Improved search bar UX in app/search/page.tsx:\r\n  - X icon clears input and refocuses\r\n  - Escape key clears input\r\n  - Enter key triggers search\r\n\r\n- Updated filter count logic:\r\n  - Accurately counts all active filters\r\n  - Apply button badge reflects true total", "reactions": {"url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/1/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/1/timeline", "performed_via_github_app": null, "state_reason": null}, "comment": {"url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/comments/3640504164", "html_url": "https://github.com/souravOD/nutri-b2c-frontend/pull/1#issuecomment-3640504164", "issue_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/1", "id": 3640504164, "node_id": "IC_kwDOQEZhKM7Y_a9k", "user": {"login": "souravOD", "id": 238303722, "node_id": "U_kgDODjQ56g", "avatar_url": "https://avatars.githubusercontent.com/u/238303722?v=4", "gravatar_id": "", "url": "https://api.github.com/users/souravOD", "html_url": "https://github.com/souravOD", "followers_url": "https://api.github.com/users/souravOD/followers", "following_url": "https://api.github.com/users/souravOD/following{/other_user}", "gists_url": "https://api.github.com/users/souravOD/gists{/gist_id}", "starred_url": "https://api.github.com/users/souravOD/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/souravOD/subscriptions", "organizations_url": "https://api.github.com/users/souravOD/orgs", "repos_url": "https://api.github.com/users/souravOD/repos", "events_url": "https://api.github.com/users/souravOD/events{/privacy}", "received_events_url": "https://api.github.com/users/souravOD/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "created_at": "2025-12-11T06:53:35Z", "updated_at": "2025-12-11T06:53:35Z", "body": "/review Can you please review this PR", "author_association": "OWNER", "reactions": {"url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/comments/3640504164/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "performed_via_github_app": null}, "repository": {"id": 1078354216, "node_id": "R_kgDOQEZhKA", "name": "nutri-b2c-frontend", "full_name": "souravOD/nutri-b2c-frontend", "private": false, "owner": {"login": "souravOD", "id": 238303722, "node_id": "U_kgDODjQ56g", "avatar_url": "https://avatars.githubusercontent.com/u/238303722?v=4", "gravatar_id": "", "url": "https://api.github.com/users/souravOD", "html_url": "https://github.com/souravOD", "followers_url": "https://api.github.com/users/souravOD/followers", "following_url": "https://api.github.com/users/souravOD/following{/other_user}", "gists_url": "https://api.github.com/users/souravOD/gists{/gist_id}", "starred_url": "https://api.github.com/users/souravOD/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/souravOD/subscriptions", "organizations_url": "https://api.github.com/users/souravOD/orgs", "repos_url": "https://api.github.com/users/souravOD/repos", "events_url": "https://api.github.com/users/souravOD/events{/privacy}", "received_events_url": "https://api.github.com/users/souravOD/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "html_url": "https://github.com/souravOD/nutri-b2c-frontend", "description": null, "fork": true, "url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend", "forks_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/forks", "keys_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/keys{/key_id}", "collaborators_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/collaborators{/collaborator}", "teams_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/teams", "hooks_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/hooks", "issue_events_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/events{/number}", "events_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/events", "assignees_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/assignees{/user}", "branches_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/branches{/branch}", "tags_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/tags", "blobs_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/git/blobs{/sha}", "git_tags_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/git/tags{/sha}", "git_refs_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/git/refs{/sha}", "trees_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/git/trees{/sha}", "statuses_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/statuses/{sha}", "languages_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/languages", "stargazers_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/stargazers", "contributors_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/contributors", "subscribers_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/subscribers", "subscription_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/subscription", "commits_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/commits{/sha}", "git_commits_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/git/commits{/sha}", "comments_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/comments{/number}", "issue_comment_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/comments{/number}", "contents_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/contents/{+path}", "compare_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/compare/{base}...{head}", "merges_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/merges", "archive_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/{archive_format}{/ref}", "downloads_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/downloads", "issues_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues{/number}", "pulls_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls{/number}", "milestones_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/milestones{/number}", "notifications_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/notifications{?since,all,participating}", "labels_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/labels{/name}", "releases_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/releases{/id}", "deployments_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/deployments", "created_at": "2025-10-17T15:44:00Z", "updated_at": "2025-11-14T04:02:00Z", "pushed_at": "2025-10-16T19:32:39Z", "git_url": "git://github.com/souravOD/nutri-b2c-frontend.git", "ssh_url": "git@github.com:souravOD/nutri-b2c-frontend.git", "clone_url": "https://github.com/souravOD/nutri-b2c-frontend.git", "svn_url": "https://github.com/souravOD/nutri-b2c-frontend", "homepage": "https://v0-next-js-app-requirements-omega.vercel.app", "size": 11387, "stargazers_count": 0, "watchers_count": 0, "language": null, "has_issues": false, "has_projects": true, "has_downloads": true, "has_wiki": false, "has_pages": false, "has_discussions": false, "forks_count": 1, "mirror_url": null, "archived": false, "disabled": false, "open_issues_count": 2, "license": null, "allow_forking": true, "is_template": false, "web_commit_signoff_required": false, "topics": [], "visibility": "public", "forks": 1, "open_issues": 2, "watchers": 0, "default_branch": "main"}, "sender": {"login": "souravOD", "id": 238303722, "node_id": "U_kgDODjQ56g", "avatar_url": "https://avatars.githubusercontent.com/u/238303722?v=4", "gravatar_id": "", "url": "https://api.github.com/users/souravOD", "html_url": "https://github.com/souravOD", "followers_url": "https://api.github.com/users/souravOD/followers", "following_url": "https://api.github.com/users/souravOD/following{/other_user}", "gists_url": "https://api.github.com/users/souravOD/gists{/gist_id}", "starred_url": "https://api.github.com/users/souravOD/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/souravOD/subscriptions", "organizations_url": "https://api.github.com/users/souravOD/orgs", "repos_url": "https://api.github.com/users/souravOD/repos", "events_url": "https://api.github.com/users/souravOD/events{/privacy}", "received_events_url": "https://api.github.com/users/souravOD/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "installation": {"id": 92375808, "node_id": "MDIzOkludGVncmF0aW9uSW5zdGFsbGF0aW9uOTIzNzU4MDg="}}, "event": "issue_comment"}, "file": {"name": "github_app.py", "path": "/app/pr_agent/servers/github_app.py"}, "function": "handle_request", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 342, "message": "Request body", "module": "github_app", "name": "pr_agent.servers.github_app", "process": {"id": 18, "name": "MainProcess"}, "thread": {"id": 136556055251840, "name": "MainThread"}, "time": {"repr": "2025-12-11 06:53:36.798556+00:00", "timestamp": 1765436016.798556}}}
2025-Dec-11 06:53:37.876074
{"text": "Processing comment on PR api_url='https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1', comment_body=/review Can you please review this PR\n", "record": {"elapsed": {"repr": "0:01:06.483563", "seconds": 66.483563}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "e928b569bf6b4265b9eb2a652d5c4f10", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "github_app.py", "path": "/app/pr_agent/servers/github_app.py"}, "function": "handle_comments_on_pr", "level": {"icon": "â„¹ï¸", "name": "INFO", "no": 20}, "line": 118, "message": "Processing comment on PR api_url='https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1', comment_body=/review Can you please review this PR", "module": "github_app", "name": "pr_agent.servers.github_app", "process": {"id": 18, "name": "MainProcess"}, "thread": {"id": 136556055251840, "name": "MainThread"}, "time": {"repr": "2025-12-11 06:53:37.875606+00:00", "timestamp": 1765436017.875606}}}
2025-Dec-11 06:53:40.967997
{"text": "AI metadata is disabled for this command\n", "record": {"elapsed": {"repr": "0:01:09.575548", "seconds": 69.575548}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "e928b569bf6b4265b9eb2a652d5c4f10", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "pr_reviewer.py", "path": "/app/pr_agent/tools/pr_reviewer.py"}, "function": "__init__", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 75, "message": "AI metadata is disabled for this command", "module": "pr_reviewer", "name": "pr_agent.tools.pr_reviewer", "process": {"id": 18, "name": "MainProcess"}, "thread": {"id": 136556055251840, "name": "MainThread"}, "time": {"repr": "2025-12-11 06:53:40.967591+00:00", "timestamp": 1765436020.967591}}}
2025-Dec-11 06:53:41.192045
{"text": "Reviewing PR: https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1 ...\n", "record": {"elapsed": {"repr": "0:01:09.799649", "seconds": 69.799649}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "e928b569bf6b4265b9eb2a652d5c4f10", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "pr_reviewer.py", "path": "/app/pr_agent/tools/pr_reviewer.py"}, "function": "run", "level": {"icon": "â„¹ï¸", "name": "INFO", "no": 20}, "line": 134, "message": "Reviewing PR: https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1 ...", "module": "pr_reviewer", "name": "pr_agent.tools.pr_reviewer", "process": {"id": 18, "name": "MainProcess"}, "thread": {"id": 136556055251840, "name": "MainThread"}, "time": {"repr": "2025-12-11 06:53:41.191692+00:00", "timestamp": 1765436021.191692}}}
2025-Dec-11 06:53:41.192954
{"text": "Relevant configs\n", "record": {"elapsed": {"repr": "0:01:09.800602", "seconds": 69.800602}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "e928b569bf6b4265b9eb2a652d5c4f10", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "artifacts": {"pr_reviewer": {"require_score_review": false, "require_tests_review": true, "require_estimate_effort_to_review": true, "require_can_be_split_review": false, "require_security_review": true, "require_estimate_contribution_time_cost": false, "require_todo_scan": false, "require_ticket_analysis_review": true, "publish_output_no_suggestions": true, "persistent_comment": true, "extra_instructions": "", "num_max_findings": 3, "final_update_message": true, "enable_review_labels_security": true, "enable_review_labels_effort": true, "require_all_thresholds_for_incremental_review": false, "minimal_commits_for_incremental_review": 0, "minimal_minutes_for_incremental_review": 0, "enable_intro_text": true, "enable_help_text": false}, "config": {"enable_ai_metadata": false, "fallback_models": "[\\\"openai/gpt-5\\\", \\\"openai/gpt-5-mini\\\", \\\"openai/gpt-5-nano\\\"]", "custom_model_max_tokens": 200000, "model": "openai/gpt-5.1", "temperature": 1, "git_provider": "github", "publish_output": true, "publish_output_progress": true, "verbosity_level": 0, "use_extra_bad_extensions": false, "log_level": "DEBUG", "use_wiki_settings_file": true, "use_repo_settings_file": true, "use_global_settings_file": true, "disable_auto_feedback": false, "ai_timeout": 120, "skip_keys": [], "custom_reasoning_model": false, "response_language": "en-US", "max_description_tokens": 500, "max_commits_tokens": 500, "max_model_tokens": 32000, "model_token_count_estimate_factor": 0.3, "patch_extension_skip_types": [".md", ".txt"], "allow_dynamic_context": true, "max_extra_lines_before_dynamic_context": 10, "patch_extra_lines_before": 5, "patch_extra_lines_after": 1, "secret_provider": "", "cli_mode": false, "ai_disclaimer_title": "", "ai_disclaimer": "", "output_relevant_configurations": false, "large_patch_policy": "clip", "duplicate_prompt_examples": false, "seed": -1, "add_repo_metadata": false, "add_repo_metadata_file_list": ["AGENTS.MD", "CLAUDE.MD", "QODO.MD"], "ignore_pr_title": ["^\\[Auto\\]", "^Auto"], "ignore_pr_target_branches": [], "ignore_pr_source_branches": [], "ignore_pr_labels": [], "ignore_pr_authors": [], "ignore_repositories": [], "ignore_language_framework": [], "is_auto_command": false, "reasoning_effort": "medium", "enable_auto_approval": false, "auto_approve_for_low_review_effort": -1, "auto_approve_for_no_suggestions": false, "ensure_ticket_compliance": false, "enable_claude_extended_thinking": false, "extended_thinking_budget_tokens": 2048, "extended_thinking_max_output_tokens": 4096, "enable_custom_labels": false}}}, "file": {"name": "pr_reviewer.py", "path": "/app/pr_agent/tools/pr_reviewer.py"}, "function": "run", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 137, "message": "Relevant configs", "module": "pr_reviewer", "name": "pr_agent.tools.pr_reviewer", "process": {"id": 18, "name": "MainProcess"}, "thread": {"id": 136556055251840, "name": "MainThread"}, "time": {"repr": "2025-12-11 06:53:41.192645+00:00", "timestamp": 1765436021.192645}}}
2025-Dec-11 06:53:41.193277
{"text": "Existing description\n", "record": {"elapsed": {"repr": "0:01:09.801088", "seconds": 69.801088}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "e928b569bf6b4265b9eb2a652d5c4f10", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "description": "- improved search bar ux in app/search/page.tsx:\r\n  - x icon clears input and refocuses\r\n  - escape key clears input\r\n  - enter key triggers search\r\n\r\n- updated filter count logic:\r\n  - accurately counts all active filters\r\n  - apply button badge reflects true total"}, "file": {"name": "git_provider.py", "path": "/app/pr_agent/git_providers/git_provider.py"}, "function": "get_user_description", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 225, "message": "Existing description", "module": "git_provider", "name": "pr_agent.git_providers.git_provider", "process": {"id": 18, "name": "MainProcess"}, "thread": {"id": 136556055251840, "name": "MainThread"}, "time": {"repr": "2025-12-11 06:53:41.193131+00:00", "timestamp": 1765436021.193131}}}
2025-Dec-11 06:53:41.193332
{"text": "Existing description was not generated by the pr-agent\n", "record": {"elapsed": {"repr": "0:01:09.801173", "seconds": 69.801173}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "e928b569bf6b4265b9eb2a652d5c4f10", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "git_provider.py", "path": "/app/pr_agent/git_providers/git_provider.py"}, "function": "get_user_description", "level": {"icon": "â„¹ï¸", "name": "INFO", "no": 20}, "line": 229, "message": "Existing description was not generated by the pr-agent", "module": "git_provider", "name": "pr_agent.git_providers.git_provider", "process": {"id": 18, "name": "MainProcess"}, "thread": {"id": 136556055251840, "name": "MainThread"}, "time": {"repr": "2025-12-11 06:53:41.193216+00:00", "timestamp": 1765436021.193216}}}
2025-Dec-11 06:53:41.767132
{"text": "Generating prediction with openai/gpt-5.1\n", "record": {"elapsed": {"repr": "0:01:10.374756", "seconds": 70.374756}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "e928b569bf6b4265b9eb2a652d5c4f10", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "pr_processing.py", "path": "/app/pr_agent/algo/pr_processing.py"}, "function": "retry_with_fallback_models", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 326, "message": "Generating prediction with openai/gpt-5.1", "module": "pr_processing", "name": "pr_agent.algo.pr_processing", "process": {"id": 18, "name": "MainProcess"}, "thread": {"id": 136556055251840, "name": "MainThread"}, "time": {"repr": "2025-12-11 06:53:41.766799+00:00", "timestamp": 1765436021.766799}}}
2025-Dec-11 06:53:42.584314
{"text": "PR main language: TypeScript\n", "record": {"elapsed": {"repr": "0:01:11.191835", "seconds": 71.191835}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "e928b569bf6b4265b9eb2a652d5c4f10", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "pr_processing.py", "path": "/app/pr_agent/algo/pr_processing.py"}, "function": "get_pr_diff", "level": {"icon": "â„¹ï¸", "name": "INFO", "no": 20}, "line": 63, "message": "PR main language: TypeScript", "module": "pr_processing", "name": "pr_agent.algo.pr_processing", "process": {"id": 18, "name": "MainProcess"}, "thread": {"id": 136556055251840, "name": "MainThread"}, "time": {"repr": "2025-12-11 06:53:42.583878+00:00", "timestamp": 1765436022.583878}}}
2025-Dec-11 06:53:42.593151
{"text": "Tokens: 4738, total tokens under limit: 32000, returning full diff.\n", "record": {"elapsed": {"repr": "0:01:11.200694", "seconds": 71.200694}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "e928b569bf6b4265b9eb2a652d5c4f10", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "pr_processing.py", "path": "/app/pr_agent/algo/pr_processing.py"}, "function": "get_pr_diff", "level": {"icon": "â„¹ï¸", "name": "INFO", "no": 20}, "line": 74, "message": "Tokens: 4738, total tokens under limit: 32000, returning full diff.", "module": "pr_processing", "name": "pr_agent.algo.pr_processing", "process": {"id": 18, "name": "MainProcess"}, "thread": {"id": 136556055251840, "name": "MainThread"}, "time": {"repr": "2025-12-11 06:53:42.592737+00:00", "timestamp": 1765436022.592737}}}
2025-Dec-11 06:53:42.593344
{"text": "PR diff\n", "record": {"elapsed": {"repr": "0:01:11.200971", "seconds": 71.200971}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "e928b569bf6b4265b9eb2a652d5c4f10", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "diff": "\n\n## File: 'app/search/page.tsx'\n\n@@ -1,7 +1,8 @@\n__new hunk__\n1  \"use client\"\n2  \n3 +import { useState, useEffect, useMemo, useRef } from \"react\"\n4 +// import { X } from \"lucide-react\"\n5  import { useSearchParams, useRouter } from \"next/navigation\"\n6  import { useQuery } from \"@tanstack/react-query\"\n7  import { Input } from \"@/components/ui/input\"\n8  import { Button } from \"@/components/ui/button\"\n__old hunk__\n \"use client\"\n \n-import { useState, useEffect, useMemo } from \"react\"\n import { useSearchParams, useRouter } from \"next/navigation\"\n import { useQuery } from \"@tanstack/react-query\"\n import { Input } from \"@/components/ui/input\"\n import { Button } from \"@/components/ui/button\"\n\n@@ -41,11 +42,12 @@\n__new hunk__\n42  export default function SearchPage() {\n43    const searchParams = useSearchParams()\n44    const router = useRouter()\n45    const { filters, setFilters, resetFilters } = useFilters()\n46    const { settings } = useSettings()\n47  \n48    const [searchQuery, setSearchQuery] = useState(searchParams.get(\"q\") || filters.q || \"\")\n49 +  const inputRef = useRef(null);\n50    const [sortBy, setSortBy] = useState(settings.behavior.defaultSort || \"time\")\n51    const [filtersOpen, setFiltersOpen] = useState(false)\n52  \n53    // Update search query from URL params\n\n@@ -75,29 +77,54 @@ export default function SearchPage() {\n__new hunk__\n77        filters.fiberMin > 0 ||\n78        filters.sugarMax < 100 ||\n79        filters.sodiumMax < 4000 ||\n80        filters.maxTime < 120 ||\n81        !!filters.mealType\n82      )\n83    }, [filters])\n84  \n85 +  // const activeFilterCount = useMemo(() => {\n86 +  //   let count = 0\n87 +  //   if (filters.dietaryRestrictions.length > 0) count++\n88 +  //   if (filters.allergens.length > 0) count++\n89 +  //   if (filters.cuisines.length > 0) count++\n90 +  //   if (filters.majorConditions.length > 0) count++\n91 +  //   if (filters.calories[0] > 0 || filters.calories[1] < 1200) count++\n92 +  //   if (filters.proteinMin > 0) count++\n93 +  //   if (filters.carbsMin > 0) count++\n94 +  //   if (filters.fatMin > 0) count++\n95 +  //   if (filters.fiberMin > 0) count++\n96 +  //   if (filters.sugarMax < 100) count++\n97 +  //   if (filters.sodiumMax < 4000) count++\n98 +  //   if (filters.maxTime < 120) count++\n99 +  //   if (filters.mealType) count++\n100 +  //   return count\n101 +  // }, [filters])\n102    const activeFilterCount = useMemo(() => {\n103 +    let count = 0;\n104 +\n105 +  // Sum all selected array filters\n106 +    count += filters.dietaryRestrictions.length;\n107 +    count += filters.allergens.length;\n108 +    count += filters.cuisines.length;\n109 +    count += filters.majorConditions.length;\n110 +\n111 +    // Range and min/max filters\n112 +    if (filters.calories[0] > 0) count++; // Min calories\n113 +    if (filters.calories[1] < 1200) count++; // Max calories\n114 +    if (filters.proteinMin > 0) count++;\n115 +    if (filters.carbsMin > 0) count++;\n116 +    if (filters.fatMin > 0) count++;\n117 +    if (filters.fiberMin > 0) count++;\n118 +    if (filters.sugarMax < 100) count++;\n119 +    if (filters.sodiumMax < 4000) count++;\n120 +    if (filters.maxTime < 120) count++;\n121 +    \n122 +    // Single-value selection\n123 +    if (filters.mealType) count++;\n124 +\n125 +    return count;\n126 +  }, [filters]);\n127  \n128    const {\n129      data: searchResults = [],\n130      isLoading,\n__old hunk__\n       filters.fiberMin > 0 ||\n       filters.sugarMax < 100 ||\n       filters.sodiumMax < 4000 ||\n       filters.maxTime < 120 ||\n       !!filters.mealType\n     )\n   }, [filters])\n \n   const activeFilterCount = useMemo(() => {\n-    let count = 0\n-    if (filters.dietaryRestrictions.length > 0) count++\n-    if (filters.allergens.length > 0) count++\n-    if (filters.cuisines.length > 0) count++\n-    if (filters.majorConditions.length > 0) count++\n-    if (filters.calories[0] > 0 || filters.calories[1] < 1200) count++\n-    if (filters.proteinMin > 0) count++\n-    if (filters.carbsMin > 0) count++\n-    if (filters.fatMin > 0) count++\n-    if (filters.fiberMin > 0) count++\n-    if (filters.sugarMax < 100) count++\n-    if (filters.sodiumMax < 4000) count++\n-    if (filters.maxTime < 120) count++\n-    if (filters.mealType) count++\n-    return count\n-  }, [filters])\n \n   const {\n     data: searchResults = [],\n     isLoading,\n\n@@ -113,12 +140,22 @@ export default function SearchPage() {\n__new hunk__\n140          const rankedResults = rank(rawResults, settings)\n141          return rankedResults\n142        }\n143  \n144        return rawResults.map((recipe) => ({ ...recipe, score: 0 }))\n145      },\n146      enabled: !!(searchQuery || hasActiveFilters),\n147    })\n148 +  const handleSearchInputKeyDown = (e: React.KeyboardEvent) => {\n149 +    if (e.key === \"Escape\" && searchQuery) {\n150 +      setSearchQuery(\"\");\n151 +      inputRef.current?.focus();\n152 +    }\n153 +    if (e.key === \"Enter\") {\n154 +      handleSearch(searchQuery);\n155 +    }\n156 +  };\n157 +\n158  \n159    const handleSearch = (query: string) => {\n160      setSearchQuery(query)\n161      setFilters({ ...filters, q: query })\n\n@@ -182,13 +219,13 @@ export default function SearchPage() {\n__new hunk__\n219    return (\n220      \n221        \n222          {/* Search Header */}\n223          \n224            Search Recipes\n225  \n226            {/* Search Input */}\n227 +          {/* \n228              \n229              \n       \n         {/* Search Header */}\n         \n           Search Recipes\n \n           {/* Search Input */}\n-          \n             \n              setSearchQuery(e.target.value)}\n234                onKeyDown={(e) => e.key === \"Enter\" && handleSearch(searchQuery)}\n235                className=\"pl-10 pr-4 h-12 text-lg\"\n236              />\n237 +           */}\n238 +          \n239 +            \n240 +             setSearchQuery(e.target.value)}\n246 +              onKeyDown={handleSearchInputKeyDown}\n247 +              style={{ paddingRight: searchQuery ? \"2rem\" : undefined, width: \"100%\" }}\n248 +              className=\"pl-10 pr-4 h-12 text-lg\"\n249 +            />\n250 +            {searchQuery && (\n251 +               {\n266 +                  setSearchQuery(\"\");\n267 +                  inputRef.current?.focus();\n268 +              }}\n269 +              >\n270 +                \n271 +            \n272 +          )}\n273            \n274  \n275 +\n276            {/* Search Actions */}\n277            \n278               handleSearch(searchQuery)} size=\"sm\">\n279                Search\n\n\n## File: 'components/filter-panel.tsx'\n\n@@ -54,35 +54,58 @@\n__new hunk__\n54  export function FilterPanel({ open, onOpenChange, initialValues, onApply, onReset }: FilterPanelProps) {\n55    const form = useForm({\n56      resolver: zodResolver(schema),\n57      // provide full defaults (OUTPUT fits into INPUT just fine)\n58      defaultValues: schema.parse(initialValues ?? {}),\n59      mode: \"onChange\",\n60    })\n61  \n62     useEffect(() => {\n63      form.reset(schema.parse(initialValues ?? {}));\n64    }, [open, initialValues, form]);\n65  \n66 +  // function getActiveFiltersCount(): number {\n67 +  //   const values = form.getValues()\n68 +  //   let count = 0\n69 +  //   if ((values.dietaryRestrictions || []).length > 0) count++\n70 +  //   if ((values.allergens || []).length > 0) count++\n71 +  //   if ((values.cuisines || []).length > 0) count++\n72 +  //   if ((values.majorConditions || []).length > 0) count++\n73 +  //   if (values.calories && (values.calories[0] > 0 || values.calories[1] < 1200)) count++\n74 +  //   if ((values.proteinMin || 0) > 0) count++\n75 +  //   if ((values.carbsMin || 0) > 0) count++\n76 +  //   if ((values.fatMin || 0) > 0) count++\n77 +  //   if ((values.fiberMin || 0) > 0) count++\n78 +  //   if ((values.sugarMax || 100) < 100) count++\n79 +  //   if ((values.sodiumMax || 4000) < 4000) count++\n80 +  //   if ((values.maxTime || 120) < 120) count++\n81 +  //   if ((values.mealType || \"\") !== \"\") count++\n82 +  //   return count\n83 +  // }\n84    function getActiveFiltersCount(): number {\n85 +    const values = form.getValues();\n86 +    let count = 0;\n87 +\n88 +    // Count all selected array filters individually\n89 +    count += values.dietaryRestrictions.length;\n90 +    count += values.allergens.length;\n91 +    count += values.cuisines.length;\n92 +    count += values.majorConditions.length;\n93 +\n94 +    // Numeric and single-value filters\n95 +    if (values.calories[0] > 0) count++;           // Min calories\n96 +    if (values.calories[1] < 1200) count++;        // Max calories\n97 +    if (values.proteinMin > 0) count++;\n98 +    if (values.carbsMin > 0) count++;\n99 +    if (values.fatMin > 0) count++;\n100 +    if (values.fiberMin > 0) count++;\n101 +    if (values.sugarMax < 100) count++;\n102 +    if (values.sodiumMax < 4000) count++;\n103 +    if (values.maxTime < 120) count++;\n104 +    if (values.mealType) count++;\n105 +\n106 +    return count;\n107    }\n108    function handleApply() {\n109      const values = schema.parse(form.getValues())\n110      onApply(values)\n111      onOpenChange(false)\n__old hunk__\n export function FilterPanel({ open, onOpenChange, initialValues, onApply, onReset }: FilterPanelProps) {\n   const form = useForm({\n     resolver: zodResolver(schema),\n     // provide full defaults (OUTPUT fits into INPUT just fine)\n     defaultValues: schema.parse(initialValues ?? {}),\n     mode: \"onChange\",\n   })\n \n    useEffect(() => {\n     form.reset(schema.parse(initialValues ?? {}));\n   }, [open, initialValues, form]);\n \n   function getActiveFiltersCount(): number {\n-    const values = form.getValues()\n-    let count = 0\n-    if ((values.dietaryRestrictions || []).length > 0) count++\n-    if ((values.allergens || []).length > 0) count++\n-    if ((values.cuisines || []).length > 0) count++\n-    if ((values.majorConditions || []).length > 0) count++\n-    if (values.calories && (values.calories[0] > 0 || values.calories[1] < 1200)) count++\n-    if ((values.proteinMin || 0) > 0) count++\n-    if ((values.carbsMin || 0) > 0) count++\n-    if ((values.fatMin || 0) > 0) count++\n-    if ((values.fiberMin || 0) > 0) count++\n-    if ((values.sugarMax || 100) < 100) count++\n-    if ((values.sodiumMax || 4000) < 4000) count++\n-    if ((values.maxTime || 120) < 120) count++\n-    if ((values.mealType || \"\") !== \"\") count++\n-    return count\n   }\n-\n   function handleApply() {\n     const values = schema.parse(form.getValues())\n     onApply(values)\n     onOpenChange(false)"}, "file": {"name": "pr_reviewer.py", "path": "/app/pr_agent/tools/pr_reviewer.py"}, "function": "_prepare_prediction", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 197, "message": "PR diff", "module": "pr_reviewer", "name": "pr_agent.tools.pr_reviewer", "process": {"id": 18, "name": "MainProcess"}, "thread": {"id": 136556055251840, "name": "MainThread"}, "time": {"repr": "2025-12-11 06:53:42.593014+00:00", "timestamp": 1765436022.593014}}}
2025-Dec-11 06:53:42.606471
{"text": "Prompts\n", "record": {"elapsed": {"repr": "0:01:11.213815", "seconds": 71.213815}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "e928b569bf6b4265b9eb2a652d5c4f10", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "artifact": {"system": "You are PR-Reviewer, a language model designed to review a Git Pull Request (PR).\nYour task is to provide constructive and concise feedback for the PR.\nThe review should focus on new code added in the PR code diff (lines starting with '+')\n\n\nThe format we will use to present the PR code diff:\n======\n## File: 'src/file1.py'\n\n\n@@ ... @@ def func1():\n__new hunk__\n11  unchanged code line0\n12  unchanged code line1\n13 +new code line2 added\n14  unchanged code line3\n__old hunk__\n unchanged code line0\n unchanged code line1\n-old code line2 removed\n unchanged code line3\n\n@@ ... @@ def func2():\n__new hunk__\n unchanged code line4\n+new code line5 added\n unchanged code line6\n\n## File: 'src/file2.py'\n...\n======\n\n- In the format above, the diff is organized into separate '__new hunk__' and '__old hunk__' sections for each code chunk. '__new hunk__' contains the updated code, while '__old hunk__' shows the removed code. If no code was removed in a specific chunk, the __old hunk__ section will be omitted.\n- We also added line numbers for the '__new hunk__' code, to help you refer to the code lines in your suggestions. These line numbers are not part of the actual code, and should only be used for reference.\n- Code lines are prefixed with symbols ('+', '-', ' '). The '+' symbol indicates new code added in the PR, the '-' symbol indicates code removed in the PR, and the ' ' symbol indicates unchanged code. The review should address new code added in the PR code diff (lines starting with '+').\n- When quoting variables, names or file paths from the code, use backticks (`) instead of single quote (').\n- Note that you only see changed code segments (diff hunks in a PR), not the entire codebase. Avoid suggestions that might duplicate existing functionality or questioning code elements (like variables declarations or import statements) that may be defined elsewhere in the codebase.\n- Also note that if the code ends at an opening brace or statement that begins a new scope (like 'if', 'for', 'try'), don't treat it as incomplete. Instead, acknowledge the visible scope boundary and analyze only the code shown.\n\n\nThe output must be a YAML object equivalent to type $PRReview, according to the following Pydantic definitions:\n=====\n\nclass KeyIssuesComponentLink(BaseModel):\n    relevant_file: str = Field(description=\"The full file path of the relevant file\")\n    issue_header: str = Field(description=\"One or two word title for the issue. For example: 'Possible Bug', etc.\")\n    issue_content: str = Field(description=\"A short and concise summary of what should be further inspected and validated during the PR review process for this issue. Do not mention line numbers in this field.\")\n    start_line: int = Field(description=\"The start line that corresponds to this issue in the relevant file\")\n    end_line: int = Field(description=\"The end line that corresponds to this issue in the relevant file\")\n\nclass Review(BaseModel):\n    estimated_effort_to_review_[1-5]: int = Field(description=\"Estimate, on a scale of 1-5 (inclusive), the time and effort required to review this PR by an experienced and knowledgeable developer. 1 means short and easy review , 5 means long and hard review. Take into account the size, complexity, quality, and the needed changes of the PR code diff.\")\n    relevant_tests: str = Field(description=\"yes/no question: does this PR have relevant tests added or updated ?\")\n    key_issues_to_review: List[KeyIssuesComponentLink] = Field(\"A short and diverse list (0-3 issues) of high-priority bugs, problems or performance concerns introduced in the PR code, which the PR reviewer should further focus on and validate during the review process.\")\n    security_concerns: str = Field(description=\"Does this PR code introduce vulnerabilities such as exposure of sensitive information (e.g., API keys, secrets, passwords), or security concerns like SQL injection, XSS, CSRF, and others ? Answer 'No' (without explaining why) if there are no possible issues. If there are security concerns or issues, start your answer with a short header, such as: 'Sensitive information exposure: ...', 'SQL injection: ...', etc. Explain your answer. Be specific and give examples if possible\")\n\nclass PRReview(BaseModel):\n    review: Review\n=====\n\n\nExample output:\n```yaml\nreview:\n  estimated_effort_to_review_[1-5]: |\n    3\n  relevant_tests: |\n    No\n  key_issues_to_review:\n    - relevant_file: |\n        directory/xxx.py\n      issue_header: |\n        Possible Bug\n      issue_content: |\n        ...\n      start_line: 12\n      end_line: 14\n    - ...\n  security_concerns: |\n    No\n```\n\nAnswer should be a valid YAML, and nothing else. Each YAML output MUST be after a newline, with proper indent, and block scalar indicator ('|')", "user": "\n\n\n--PR Info--\n\nToday's Date: 2025-12-11\n\nTitle: 'Fix: Search UX and multi-filter logic (frontend)'\n\nBranch: 'feature/initial-fixes'\n\nPR Description:\n======\n- Improved search bar UX in app/search/page.tsx:\r\n  - X icon clears input and refocuses\r\n  - Escape key clears input\r\n  - Enter key triggers search\r\n\r\n- Updated filter count logic:\r\n  - Accurately counts all active filters\r\n  - Apply button badge reflects true total\n======\n\n\nThe PR code diff:\n======\n## File: 'app/search/page.tsx'\n\n@@ -1,7 +1,8 @@\n__new hunk__\n1  \"use client\"\n2  \n3 +import { useState, useEffect, useMemo, useRef } from \"react\"\n4 +// import { X } from \"lucide-react\"\n5  import { useSearchParams, useRouter } from \"next/navigation\"\n6  import { useQuery } from \"@tanstack/react-query\"\n7  import { Input } from \"@/components/ui/input\"\n8  import { Button } from \"@/components/ui/button\"\n__old hunk__\n \"use client\"\n \n-import { useState, useEffect, useMemo } from \"react\"\n import { useSearchParams, useRouter } from \"next/navigation\"\n import { useQuery } from \"@tanstack/react-query\"\n import { Input } from \"@/components/ui/input\"\n import { Button } from \"@/components/ui/button\"\n\n@@ -41,11 +42,12 @@\n__new hunk__\n42  export default function SearchPage() {\n43    const searchParams = useSearchParams()\n44    const router = useRouter()\n45    const { filters, setFilters, resetFilters } = useFilters()\n46    const { settings } = useSettings()\n47  \n48    const [searchQuery, setSearchQuery] = useState(searchParams.get(\"q\") || filters.q || \"\")\n49 +  const inputRef = useRef(null);\n50    const [sortBy, setSortBy] = useState(settings.behavior.defaultSort || \"time\")\n51    const [filtersOpen, setFiltersOpen] = useState(false)\n52  \n53    // Update search query from URL params\n\n@@ -75,29 +77,54 @@ export default function SearchPage() {\n__new hunk__\n77        filters.fiberMin > 0 ||\n78        filters.sugarMax < 100 ||\n79        filters.sodiumMax < 4000 ||\n80        filters.maxTime < 120 ||\n81        !!filters.mealType\n82      )\n83    }, [filters])\n84  \n85 +  // const activeFilterCount = useMemo(() => {\n86 +  //   let count = 0\n87 +  //   if (filters.dietaryRestrictions.length > 0) count++\n88 +  //   if (filters.allergens.length > 0) count++\n89 +  //   if (filters.cuisines.length > 0) count++\n90 +  //   if (filters.majorConditions.length > 0) count++\n91 +  //   if (filters.calories[0] > 0 || filters.calories[1] < 1200) count++\n92 +  //   if (filters.proteinMin > 0) count++\n93 +  //   if (filters.carbsMin > 0) count++\n94 +  //   if (filters.fatMin > 0) count++\n95 +  //   if (filters.fiberMin > 0) count++\n96 +  //   if (filters.sugarMax < 100) count++\n97 +  //   if (filters.sodiumMax < 4000) count++\n98 +  //   if (filters.maxTime < 120) count++\n99 +  //   if (filters.mealType) count++\n100 +  //   return count\n101 +  // }, [filters])\n102    const activeFilterCount = useMemo(() => {\n103 +    let count = 0;\n104 +\n105 +  // Sum all selected array filters\n106 +    count += filters.dietaryRestrictions.length;\n107 +    count += filters.allergens.length;\n108 +    count += filters.cuisines.length;\n109 +    count += filters.majorConditions.length;\n110 +\n111 +    // Range and min/max filters\n112 +    if (filters.calories[0] > 0) count++; // Min calories\n113 +    if (filters.calories[1] < 1200) count++; // Max calories\n114 +    if (filters.proteinMin > 0) count++;\n115 +    if (filters.carbsMin > 0) count++;\n116 +    if (filters.fatMin > 0) count++;\n117 +    if (filters.fiberMin > 0) count++;\n118 +    if (filters.sugarMax < 100) count++;\n119 +    if (filters.sodiumMax < 4000) count++;\n120 +    if (filters.maxTime < 120) count++;\n121 +    \n122 +    // Single-value selection\n123 +    if (filters.mealType) count++;\n124 +\n125 +    return count;\n126 +  }, [filters]);\n127  \n128    const {\n129      data: searchResults = [],\n130      isLoading,\n__old hunk__\n       filters.fiberMin > 0 ||\n       filters.sugarMax < 100 ||\n       filters.sodiumMax < 4000 ||\n       filters.maxTime < 120 ||\n       !!filters.mealType\n     )\n   }, [filters])\n \n   const activeFilterCount = useMemo(() => {\n-    let count = 0\n-    if (filters.dietaryRestrictions.length > 0) count++\n-    if (filters.allergens.length > 0) count++\n-    if (filters.cuisines.length > 0) count++\n-    if (filters.majorConditions.length > 0) count++\n-    if (filters.calories[0] > 0 || filters.calories[1] < 1200) count++\n-    if (filters.proteinMin > 0) count++\n-    if (filters.carbsMin > 0) count++\n-    if (filters.fatMin > 0) count++\n-    if (filters.fiberMin > 0) count++\n-    if (filters.sugarMax < 100) count++\n-    if (filters.sodiumMax < 4000) count++\n-    if (filters.maxTime < 120) count++\n-    if (filters.mealType) count++\n-    return count\n-  }, [filters])\n \n   const {\n     data: searchResults = [],\n     isLoading,\n\n@@ -113,12 +140,22 @@ export default function SearchPage() {\n__new hunk__\n140          const rankedResults = rank(rawResults, settings)\n141          return rankedResults\n142        }\n143  \n144        return rawResults.map((recipe) => ({ ...recipe, score: 0 }))\n145      },\n146      enabled: !!(searchQuery || hasActiveFilters),\n147    })\n148 +  const handleSearchInputKeyDown = (e: React.KeyboardEvent) => {\n149 +    if (e.key === \"Escape\" && searchQuery) {\n150 +      setSearchQuery(\"\");\n151 +      inputRef.current?.focus();\n152 +    }\n153 +    if (e.key === \"Enter\") {\n154 +      handleSearch(searchQuery);\n155 +    }\n156 +  };\n157 +\n158  \n159    const handleSearch = (query: string) => {\n160      setSearchQuery(query)\n161      setFilters({ ...filters, q: query })\n\n@@ -182,13 +219,13 @@ export default function SearchPage() {\n__new hunk__\n219    return (\n220      \n221        \n222          {/* Search Header */}\n223          \n224            Search Recipes\n225  \n226            {/* Search Input */}\n227 +          {/* \n228              \n229              \n       \n         {/* Search Header */}\n         \n           Search Recipes\n \n           {/* Search Input */}\n-          \n             \n              setSearchQuery(e.target.value)}\n234                onKeyDown={(e) => e.key === \"Enter\" && handleSearch(searchQuery)}\n235                className=\"pl-10 pr-4 h-12 text-lg\"\n236              />\n237 +           */}\n238 +          \n239 +            \n240 +             setSearchQuery(e.target.value)}\n246 +              onKeyDown={handleSearchInputKeyDown}\n247 +              style={{ paddingRight: searchQuery ? \"2rem\" : undefined, width: \"100%\" }}\n248 +              className=\"pl-10 pr-4 h-12 text-lg\"\n249 +            />\n250 +            {searchQuery && (\n251 +               {\n266 +                  setSearchQuery(\"\");\n267 +                  inputRef.current?.focus();\n268 +              }}\n269 +              >\n270 +                \n271 +            \n272 +          )}\n273            \n274  \n275 +\n276            {/* Search Actions */}\n277            \n278               handleSearch(searchQuery)} size=\"sm\">\n279                Search\n\n\n## File: 'components/filter-panel.tsx'\n\n@@ -54,35 +54,58 @@\n__new hunk__\n54  export function FilterPanel({ open, onOpenChange, initialValues, onApply, onReset }: FilterPanelProps) {\n55    const form = useForm({\n56      resolver: zodResolver(schema),\n57      // provide full defaults (OUTPUT fits into INPUT just fine)\n58      defaultValues: schema.parse(initialValues ?? {}),\n59      mode: \"onChange\",\n60    })\n61  \n62     useEffect(() => {\n63      form.reset(schema.parse(initialValues ?? {}));\n64    }, [open, initialValues, form]);\n65  \n66 +  // function getActiveFiltersCount(): number {\n67 +  //   const values = form.getValues()\n68 +  //   let count = 0\n69 +  //   if ((values.dietaryRestrictions || []).length > 0) count++\n70 +  //   if ((values.allergens || []).length > 0) count++\n71 +  //   if ((values.cuisines || []).length > 0) count++\n72 +  //   if ((values.majorConditions || []).length > 0) count++\n73 +  //   if (values.calories && (values.calories[0] > 0 || values.calories[1] < 1200)) count++\n74 +  //   if ((values.proteinMin || 0) > 0) count++\n75 +  //   if ((values.carbsMin || 0) > 0) count++\n76 +  //   if ((values.fatMin || 0) > 0) count++\n77 +  //   if ((values.fiberMin || 0) > 0) count++\n78 +  //   if ((values.sugarMax || 100) < 100) count++\n79 +  //   if ((values.sodiumMax || 4000) < 4000) count++\n80 +  //   2025-12-11T06:53:42.606471289Z if ((values.maxTime || 120) < 120) count++\n81 +  //   if ((values.mealType || \"\") !== \"\") count++\n82 +  //   return count\n83 +  // }\n84    function getActiveFiltersCount(): number {\n85 +    const values = form.getValues();\n86 +    let count = 0;\n87 +\n88 +    // Count all selected array filters individually\n89 +    count += values.dietaryRestrictions.length;\n90 +    count += values.allergens.length;\n91 +    count += values.cuisines.length;\n92 +    count += values.majorConditions.length;\n93 +\n94 +    // Numeric and single-value filters\n95 +    if (values.calories[0] > 0) count++;           // Min calories\n96 +    if (values.calories[1] < 1200) count++;        // Max calories\n97 +    if (values.proteinMin > 0) count++;\n98 +    if (values.carbsMin > 0) count++;\n99 +    if (values.fatMin > 0) count++;\n100 +    if (values.fiberMin > 0) count++;\n101 +    if (values.sugarMax < 100) count++;\n102 +    if (values.sodiumMax < 4000) count++;\n103 +    if (values.maxTime < 120) count++;\n104 +    if (values.mealType) count++;\n105 +\n106 +    return count;\n107    }\n108    function handleApply() {\n109      const values = schema.parse(form.getValues())\n110      onApply(values)\n111      onOpenChange(false)\n__old hunk__\n export function FilterPanel({ open, onOpenChange, initialValues, onApply, onReset }: FilterPanelProps) {\n   const form = useForm({\n     resolver: zodResolver(schema),\n     // provide full defaults (OUTPUT fits into INPUT just fine)\n     defaultValues: schema.parse(initialValues ?? {}),\n     mode: \"onChange\",\n   })\n \n    useEffect(() => {\n     form.reset(schema.parse(initialValues ?? {}));\n   }, [open, initialValues, form]);\n \n   function getActiveFiltersCount(): number {\n-    const values = form.getValues()\n-    let count = 0\n-    if ((values.dietaryRestrictions || []).length > 0) count++\n-    if ((values.allergens || []).length > 0) count++\n-    if ((values.cuisines || []).length > 0) count++\n-    if ((values.majorConditions || []).length > 0) count++\n-    if (values.calories && (values.calories[0] > 0 || values.calories[1] < 1200)) count++\n-    if ((values.proteinMin || 0) > 0) count++\n-    if ((values.carbsMin || 0) > 0) count++\n-    if ((values.fatMin || 0) > 0) count++\n-    if ((values.fiberMin || 0) > 0) count++\n-    if ((values.sugarMax || 100) < 100) count++\n-    if ((values.sodiumMax || 4000) < 4000) count++\n-    if ((values.maxTime || 120) < 120) count++\n-    if ((values.mealType || \"\") !== \"\") count++\n-    return count\n   }\n-\n   function handleApply() {\n     const values = schema.parse(form.getValues())\n     onApply(values)\n     onOpenChange(false)\n======\n\n\nResponse (should be a valid YAML, and nothing else):\n```yaml"}}, "file": {"name": "litellm_ai_handler.py", "path": "/app/pr_agent/algo/ai_handlers/litellm_ai_handler.py"}, "function": "chat_completion", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 397, "message": "Prompts", "module": "litellm_ai_handler", "name": "pr_agent.algo.ai_handlers.litellm_ai_handler", "process": {"id": 18, "name": "MainProcess"}, "thread": {"id": 136556055251840, "name": "MainThread"}, "time": {"repr": "2025-12-11 06:53:42.605858+00:00", "timestamp": 1765436022.605858}}}
2025-Dec-11 06:53:42.606761
{"text": "LiteLLM call model='openai/gpt-5.1'\n", "record": {"elapsed": {"repr": "0:01:11.214489", "seconds": 71.214489}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "e928b569bf6b4265b9eb2a652d5c4f10", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "litellm_ai_handler.py", "path": "/app/pr_agent/algo/ai_handlers/litellm_ai_handler.py"}, "function": "chat_completion", "level": {"icon": "âš ï¸", "name": "WARNING", "no": 30}, "line": 426, "message": "LiteLLM call model='openai/gpt-5.1'", "module": "litellm_ai_handler", "name": "pr_agent.algo.ai_handlers.litellm_ai_handler", "process": {"id": 18, "name": "MainProcess"}, "thread": {"id": 136556055251840, "name": "MainThread"}, "time": {"repr": "2025-12-11 06:53:42.606532+00:00", "timestamp": 1765436022.606532}}}
2025-Dec-11 06:53:42.606793
{"text": "Using OpenAI client directly for LiteLLM proxy with model: openai/gpt-5.1\n", "record": {"elapsed": {"repr": "0:01:11.214584", "seconds": 71.214584}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "e928b569bf6b4265b9eb2a652d5c4f10", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "litellm_ai_handler.py", "path": "/app/pr_agent/algo/ai_handlers/litellm_ai_handler.py"}, "function": "_get_completion", "level": {"icon": "â„¹ï¸", "name": "INFO", "no": 20}, "line": 467, "message": "Using OpenAI client directly for LiteLLM proxy with model: openai/gpt-5.1", "module": "litellm_ai_handler", "name": "pr_agent.algo.ai_handlers.litellm_ai_handler", "process": {"id": 18, "name": "MainProcess"}, "thread": {"id": 136556055251840, "name": "MainThread"}, "time": {"repr": "2025-12-11 06:53:42.606627+00:00", "timestamp": 1765436022.606627}}}
2025-Dec-11 06:53:44.154799
{"text": "Received a GitHub webhook\n", "record": {"elapsed": {"repr": "0:01:13.178154", "seconds": 73.178154}, "exception": null, "extra": {}, "file": {"name": "github_app.py", "path": "/app/pr_agent/servers/github_app.py"}, "function": "handle_github_webhooks", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 45, "message": "Received a GitHub webhook", "module": "github_app", "name": "pr_agent.servers.github_app", "process": {"id": 23, "name": "MainProcess"}, "thread": {"id": 136556055251840, "name": "MainThread"}, "time": {"repr": "2025-12-11 06:53:44.154369+00:00", "timestamp": 1765436024.154369}}}
2025-Dec-11 06:53:44.204131
{"text": "Handling request with event: issue_comment, action: created\n", "record": {"elapsed": {"repr": "0:01:13.227563", "seconds": 73.227563}, "exception": null, "extra": {}, "file": {"name": "github_app.py", "path": "/app/pr_agent/servers/github_app.py"}, "function": "handle_request", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 321, "message": "Handling request with event: issue_comment, action: created", "module": "github_app", "name": "pr_agent.servers.github_app", "process": {"id": 23, "name": "MainProcess"}, "thread": {"id": 136556055251840, "name": "MainThread"}, "time": {"repr": "2025-12-11 06:53:44.203778+00:00", "timestamp": 1765436024.203778}}}
2025-Dec-11 06:53:44.205144
{"text": "Request body\n", "record": {"elapsed": {"repr": "0:01:13.228531", "seconds": 73.228531}, "exception": null, "extra": {"artifact": {"action": "created", "issue": {"url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/1", "repository_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend", "labels_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/1/labels{/name}", "comments_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/1/comments", "events_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/1/events", "html_url": "https://github.com/souravOD/nutri-b2c-frontend/pull/1", "id": 3527983986, "node_id": "PR_kwDOQEZhKM6uaI7J", "number": 1, "title": "Fix: Search UX and multi-filter logic (frontend)", "user": {"login": "NamanOdysseyts", "id": 238778617, "node_id": "U_kgDODjt4-Q", "avatar_url": "https://avatars.githubusercontent.com/u/238778617?v=4", "gravatar_id": "", "url": "https://api.github.com/users/NamanOdysseyts", "html_url": "https://github.com/NamanOdysseyts", "followers_url": "https://api.github.com/users/NamanOdysseyts/followers", "following_url": "https://api.github.com/users/NamanOdysseyts/following{/other_user}", "gists_url": "https://api.github.com/users/NamanOdysseyts/gists{/gist_id}", "starred_url": "https://api.github.com/users/NamanOdysseyts/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/NamanOdysseyts/subscriptions", "organizations_url": "https://api.github.com/users/NamanOdysseyts/orgs", "repos_url": "https://api.github.com/users/NamanOdysseyts/repos", "events_url": "https://api.github.com/users/NamanOdysseyts/events{/privacy}", "received_events_url": "https://api.github.com/users/NamanOdysseyts/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "labels": [{"id": 9561404867, "node_id": "LA_kwDOQEZhKM8AAAACOed1ww", "url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/labels/Review%20effort%202/5", "name": "Review effort 2/5", "color": "d1bcf9", "default": false, "description": null}], "state": "open", "locked": false, "assignee": null, "assignees": [], "milestone": null, "comments": 87, "created_at": "2025-10-18T02:45:21Z", "updated_at": "2025-12-11T06:53:41Z", "closed_at": null, "author_association": "COLLABORATOR", "active_lock_reason": null, "draft": false, "pull_request": {"url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "html_url": "https://github.com/souravOD/nutri-b2c-frontend/pull/1", "diff_url": "https://github.com/souravOD/nutri-b2c-frontend/pull/1.diff", "patch_url": "https://github.com/souravOD/nutri-b2c-frontend/pull/1.patch", "merged_at": null}, "body": "- Improved search bar UX in app/search/page.tsx:\r\n  - X icon clears input and refocuses\r\n  - Escape key clears input\r\n  - Enter key triggers search\r\n\r\n- Updated filter count logic:\r\n  - Accurately counts all active filters\r\n  - Apply button badge reflects true total", "reactions": {"url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/1/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "timeline_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/1/timeline", "performed_via_github_app": null, "state_reason": null}, "comment": {"url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/comments/3640504399", "html_url": "https://github.com/souravOD/nutri-b2c-frontend/pull/1#issuecomment-3640504399", "issue_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/1", "id": 3640504399, "node_id": "IC_kwDOQEZhKM7Y_bBP", "user": {"login": "confersolutions-pr-agent-testing[bot]", "id": 241213316, "node_id": "BOT_kgDODmCfhA", "avatar_url": "https://avatars.githubusercontent.com/u/238303722?v=4", "gravatar_id": "", "url": "https://api.github.com/users/confersolutions-pr-agent-testing%5Bbot%5D", "html_url": "https://github.com/apps/confersolutions-pr-agent-testing", "followers_url": "https://api.github.com/users/confersolutions-pr-agent-testing%5Bbot%5D/followers", "following_url": "https://api.github.com/users/confersolutions-pr-agent-testing%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/confersolutions-pr-agent-testing%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/confersolutions-pr-agent-testing%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/confersolutions-pr-agent-testing%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/confersolutions-pr-agent-testing%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/confersolutions-pr-agent-testing%5Bbot%5D/repos", "events_url": "https://api.github.com/users/confersolutions-pr-agent-testing%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/confersolutions-pr-agent-testing%5Bbot%5D/received_events", "type": "Bot", "user_view_type": "public", "site_admin": false}, "created_at": "2025-12-11T06:53:41Z", "updated_at": "2025-12-11T06:53:41Z", "body": "Preparing review...", "author_association": "NONE", "reactions": {"url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/comments/3640504399/reactions", "total_count": 0, "+1": 0, "-1": 0, "laugh": 0, "hooray": 0, "confused": 0, "heart": 0, "rocket": 0, "eyes": 0}, "performed_via_github_app": {"id": 2209305, "client_id": "Iv23li7bKiGgGVtVjmWH", "slug": "confersolutions-pr-agent-testing", "node_id": "A_kwDODjQ56s4AIbYZ", "owner": {"login": "souravOD", "id": 238303722, "node_id": "U_kgDODjQ56g", "avatar_url": "https://avatars.githubusercontent.com/u/238303722?v=4", "gravatar_id": "", "url": "https://api.github.com/users/souravOD", "html_url": "https://github.com/souravOD", "followers_url": "https://api.github.com/users/souravOD/followers", "following_url": "https://api.github.com/users/souravOD/following{/other_user}", "gists_url": "https://api.github.com/users/souravOD/gists{/gist_id}", "starred_url": "https://api.github.com/users/souravOD/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/souravOD/subscriptions", "organizations_url": "https://api.github.com/users/souravOD/orgs", "repos_url": "https://api.github.com/users/souravOD/repos", "events_url": "https://api.github.com/users/souravOD/events{/privacy}", "received_events_url": "https://api.github.com/users/souravOD/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "name": "confersolutions-pr-agent-testing", "description": "", "external_url": "https://app.affine.pro/workspace/5faca6c6-75a5-4a38-a457-467462b9e9bd/4tBJ2igTRqph8VLY69JYh", "html_url": "https://github.com/apps/confersolutions-pr-agent-testing", "created_at": "2025-10-30T23:17:56Z", "updated_at": "2025-12-04T21:49:27Z", "permissions": {"actions": "read", "checks": "read", "contents": "read", "issues": "write", "metadata": "read", "pull_requests": "write", "statuses": "read"}, "events": ["commit_comment", "issues", "issue_comment", "merge_queue_entry", "pull_request", "pull_request_review", "pull_request_review_comment", "pull_request_review_thread", "push"]}}, "repository": {"id": 1078354216, "node_id": "R_kgDOQEZhKA", "name": "nutri-b2c-frontend", "full_name": "souravOD/nutri-b2c-frontend", "private": false, "owner": {"login": "souravOD", "id": 238303722, "node_id": "U_kgDODjQ56g", "avatar_url": "https://avatars.githubusercontent.com/u/238303722?v=4", "gravatar_id": "", "url": "https://api.github.com/users/souravOD", "html_url": "https://github.com/souravOD", "followers_url": "https://api.github.com/users/souravOD/followers", "following_url": "https://api.github.com/users/souravOD/following{/other_user}", "gists_url": "https://api.github.com/users/souravOD/gists{/gist_id}", "starred_url": "https://api.github.com/users/souravOD/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/souravOD/subscriptions", "organizations_url": "https://api.github.com/users/souravOD/orgs", "repos_url": "https://api.github.com/users/souravOD/repos", "events_url": "https://api.github.com/users/souravOD/events{/privacy}", "received_events_url": "https://api.github.com/users/souravOD/received_events", "type": "User", "user_view_type": "public", "site_admin": false}, "html_url": "https://github.com/souravOD/nutri-b2c-frontend", "description": null, "fork": true, "url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend", "forks_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/forks", "keys_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/keys{/key_id}", "collaborators_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/collaborators{/collaborator}", "teams_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/teams", "hooks_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/hooks", "issue_events_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/events{/number}", "events_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/events", "assignees_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/assignees{/user}", "branches_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/branches{/branch}", "tags_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/tags", "blobs_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/git/blobs{/sha}", "git_tags_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/git/tags{/sha}", "git_refs_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/git/refs{/sha}", "trees_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/git/trees{/sha}", "statuses_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/statuses/{sha}", "languages_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/languages", "stargazers_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/stargazers", "contributors_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/contributors", "subscribers_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/subscribers", "subscription_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/subscription", "commits_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/commits{/sha}", "git_commits_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/git/commits{/sha}", "comments_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/comments{/number}", "issue_comment_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues/comments{/number}", "contents_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/contents/{+path}", "compare_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/compare/{base}...{head}", "merges_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/merges", "archive_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/{archive_format}{/ref}", "downloads_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/downloads", "issues_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/issues{/number}", "pulls_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls{/number}", "milestones_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/milestones{/number}", "notifications_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/notifications{?since,all,participating}", "labels_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/labels{/name}", "releases_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/releases{/id}", "deployments_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/deployments", "created_at": "2025-10-17T15:44:00Z", "updated_at": "2025-11-14T04:02:00Z", "pushed_at": "2025-10-16T19:32:39Z", "git_url": "git://github.com/souravOD/nutri-b2c-frontend.git", "ssh_url": "git@github.com:souravOD/nutri-b2c-frontend.git", "clone_url": "https://github.com/souravOD/nutri-b2c-frontend.git", "svn_url": "https://github.com/souravOD/nutri-b2c-frontend", "homepage": "https://v0-next-js-app-requirements-omega.vercel.app", "size": 11387, "stargazers_count": 0, "watchers_count": 0, "language": null, "has_issues": false, "has_projects": true, "has_downloads": true, "has_wiki": false, "has_pages": false, "has_discussions": false, "forks_count": 1, "mirror_url": null, "archived": false, "disabled": false, "open_issues_count": 2, "license": null, "allow_forking": true, "is_template": false, "web_commit_signoff_required": false, "topics": [], "visibility": "public", "forks": 1, "open_issues": 2, "watchers": 0, "default_branch": "main"}, "sender": {"login": "confersolutions-pr-agent-testing[bot]", "id": 241213316, "node_id": "BOT_kgDODmCfhA", "avatar_url": "https://avatars.githubusercontent.com/u/238303722?v=4", "gravatar_id": "", "url": "https://api.github.com/users/confersolutions-pr-agent-testing%5Bbot%5D", "html_url": "https://github.com/apps/confersolutions-pr-agent-testing", "followers_url": "https://api.github.com/users/confersolutions-pr-agent-testing%5Bbot%5D/followers", "following_url": "https://api.github.com/users/confersolutions-pr-agent-testing%5Bbot%5D/following{/other_user}", "gists_url": "https://api.github.com/users/confersolutions-pr-agent-testing%5Bbot%5D/gists{/gist_id}", "starred_url": "https://api.github.com/users/confersolutions-pr-agent-testing%5Bbot%5D/starred{/owner}{/repo}", "subscriptions_url": "https://api.github.com/users/confersolutions-pr-agent-testing%5Bbot%5D/subscriptions", "organizations_url": "https://api.github.com/users/confersolutions-pr-agent-testing%5Bbot%5D/orgs", "repos_url": "https://api.github.com/users/confersolutions-pr-agent-testing%5Bbot%5D/repos", "events_url": "https://api.github.com/users/confersolutions-pr-agent-testing%5Bbot%5D/events{/privacy}", "received_events_url": "https://api.github.com/users/confersolutions-pr-agent-testing%5Bbot%5D/received_events", "type": "Bot", "user_view_type": "public", "site_admin": false}, "installation": {"id": 92375808, "node_id": "MDIzOkludGVncmF0aW9uSW5zdGFsbGF0aW9uOTIzNzU4MDg="}}, "event": "issue_comment"}, "file": {"name": "github_app.py", "path": "/app/pr_agent/servers/github_app.py"}, "function": "handle_request", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 342, "message": "Request body", "module": "github_app", "name": "pr_agent.servers.github_app", "process": {"id": 23, "name": "MainProcess"}, "thread": {"id": 136556055251840, "name": "MainThread"}, "time": {"repr": "2025-12-11 06:53:44.204746+00:00", "timestamp": 1765436024.204746}}}
2025-Dec-11 06:53:44.205219
{"text": "Ignoring comment not starting with /\n", "record": {"elapsed": {"repr": "0:01:13.228832", "seconds": 73.228832}, "exception": null, "extra": {}, "file": {"name": "github_app.py", "path": "/app/pr_agent/servers/github_app.py"}, "function": "handle_comments_on_pr", "level": {"icon": "â„¹ï¸", "name": "INFO", "no": 20}, "line": 96, "message": "Ignoring comment not starting with /", "module": "github_app", "name": "pr_agent.servers.github_app", "process": {"id": 23, "name": "MainProcess"}, "thread": {"id": 136556055251840, "name": "MainThread"}, "time": {"repr": "2025-12-11 06:53:44.205047+00:00", "timestamp": 1765436024.205047}}}
2025-Dec-11 06:53:50.637488
{"text": "\nAI response:\nreview:\n  estimated_effort_to_review_[1-5]: |\n    2\n  relevant_tests: |\n    No\n  key_issues_to_review:\n    - relevant_file: |\n        app/search/page.tsx\n      issue_header: |\n        Possible Bug\n      issue_content: |\n        The `X` clear button uses `` but the `X` icon import is commented out, which will likely cause a runtime/compile error; ensure the icon is correctly imported or the usage removed.\n      start_line: 239\n      end_line: 271\n    - relevant_file: |\n        app/search/page.tsx\n      issue_header: |\n        Behavior Consistency\n      issue_content: |\n        `handleSearch` both updates state and pushes router params, but pressing Enter now calls `handleSearch` before the function is defined in the source order; verify there are no TypeScript/hoisting issues and that Enter/Escape behavior matches UX expectations across devices.\n      start_line: 148\n      end_line: 160\n    - relevant_file: |\n        components/filter-panel.tsx\n      issue_header: |\n        Null Safety\n      issue_content: |\n        `getActiveFiltersCount` assumes all array and numeric fields are always defined (e.g., `values.dietaryRestrictions`, `values.calories[0]`), which may throw if defaults or schema change; consider adding defensive defaults similar to the previous implementation.\n      start_line: 85\n      end_line: 106\n  security_concerns: |\n    No\n", "record": {"elapsed": {"repr": "0:01:19.245073", "seconds": 79.245073}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "e928b569bf6b4265b9eb2a652d5c4f10", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "litellm_ai_handler.py", "path": "/app/pr_agent/algo/ai_handlers/litellm_ai_handler.py"}, "function": "chat_completion", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 439, "message": "\nAI response:\nreview:\n  estimated_effort_to_review_[1-5]: |\n    2\n  relevant_tests: |\n    No\n  key_issues_to_review:\n    - relevant_file: |\n        app/search/page.tsx\n      issue_header: |\n        Possible Bug\n      issue_content: |\n        The `X` clear button uses `` but the `X` icon import is commented out, which will likely cause a runtime/compile error; ensure the icon is correctly imported or the usage removed.\n      start_line: 239\n      end_line: 271\n    - relevant_file: |\n        app/search/page.tsx\n      issue_header: |\n        Behavior Consistency\n      issue_content: |\n        `handleSearch` both updates state and pushes router params, but pressing Enter now calls `handleSearch` before the function is defined in the source order; verify there are no TypeScript/hoisting issues and that Enter/Escape behavior matches UX expectations across devices.\n      start_line: 148\n      end_line: 160\n    - relevant_file: |\n        components/filter-panel.tsx\n      issue_header: |\n        Null Safety\n      issue_content: |\n        `getActiveFiltersCount` assumes all array and numeric fields are always defined (e.g., `values.dietaryRestrictions`, `values.calories[0]`), which may throw if defaults or schema change; consider adding defensive defaults similar to the previous implementation.\n      start_line: 85\n      end_line: 106\n  security_concerns: |\n    No", "module": "litellm_ai_handler", "name": "pr_agent.algo.ai_handlers.litellm_ai_handler", "process": {"id": 18, "name": "MainProcess"}, "thread": {"id": 136556055251840, "name": "MainThread"}, "time": {"repr": "2025-12-11 06:53:50.637116+00:00", "timestamp": 1765436030.637116}}}
2025-Dec-11 06:53:50.637674
{"text": "Failed to generate prediction with openai/gpt-5.1\n", "record": {"elapsed": {"repr": "0:01:19.245434", "seconds": 79.245434}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "e928b569bf6b4265b9eb2a652d5c4f10", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "artifact": {"error": "'dict' object has no attribute 'dict'"}}, "file": {"name": "pr_processing.py", "path": "/app/pr_agent/algo/pr_processing.py"}, "function": "retry_with_fallback_models", "level": {"icon": "âš ï¸", "name": "WARNING", "no": 30}, "line": 333, "message": "Failed to generate prediction with openai/gpt-5.1", "module": "pr_processing", "name": "pr_agent.algo.pr_processing", "process": {"id": 18, "name": "MainProcess"}, "thread": {"id": 136556055251840, "name": "MainThread"}, "time": {"repr": "2025-12-11 06:53:50.637477+00:00", "timestamp": 1765436030.637477}}}
2025-Dec-11 06:53:50.637754
{"text": "Generating prediction with openai/gpt-5\n", "record": {"elapsed": {"repr": "0:01:19.245529", "seconds": 79.245529}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "e928b569bf6b4265b9eb2a652d5c4f10", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "pr_processing.py", "path": "/app/pr_agent/algo/pr_processing.py"}, "function": "retry_with_fallback_models", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 326, "message": "Generating prediction with openai/gpt-5", "module": "pr_processing", "name": "pr_agent.algo.pr_processing", "process": {"id": 18, "name": "MainProcess"}, "thread": {"id": 136556055251840, "name": "MainThread"}, "time": {"repr": "2025-12-11 06:53:50.637572+00:00", "timestamp": 1765436030.637572}}}
2025-Dec-11 06:53:50.767646
{"text": "PR main language: TypeScript\n", "record": {"elapsed": {"repr": "0:01:19.375235", "seconds": 79.375235}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "e928b569bf6b4265b9eb2a652d5c4f10", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "pr_processing.py", "path": "/app/pr_agent/algo/pr_processing.py"}, "function": "get_pr_diff", "level": {"icon": "â„¹ï¸", "name": "INFO", "no": 20}, "line": 63, "message": "PR main language: TypeScript", "module": "pr_processing", "name": "pr_agent.algo.pr_processing", "process": {"id": 18, "name": "MainProcess"}, "thread": {"id": 136556055251840, "name": "MainThread"}, "time": {"repr": "2025-12-11 06:53:50.767278+00:00", "timestamp": 1765436030.767278}}}
2025-Dec-11 06:53:50.775315
{"text": "Tokens: 4738, total tokens under limit: 32000, returning full diff.\n", "record": {"elapsed": {"repr": "0:01:19.382934", "seconds": 79.382934}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "e928b569bf6b4265b9eb2a652d5c4f10", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "pr_processing.py", "path": "/app/pr_agent/algo/pr_processing.py"}, "function": "get_pr_diff", "level": {"icon": "â„¹ï¸", "name": "INFO", "no": 20}, "line": 74, "message": "Tokens: 4738, total tokens under limit: 32000, returning full diff.", "module": "pr_processing", "name": "pr_agent.algo.pr_processing", "process": {"id": 18, "name": "MainProcess"}, "thread": {"id": 136556055251840, "name": "MainThread"}, "time": {"repr": "2025-12-11 06:53:50.774977+00:00", "timestamp": 1765436030.774977}}}
2025-Dec-11 06:53:50.775567
{"text": "PR diff\n", "record": {"elapsed": {"repr": "0:01:19.383130", "seconds": 79.38313}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "e928b569bf6b4265b9eb2a652d5c4f10", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "diff": "\n\n## File: 'app/search/page.tsx'\n\n@@ -1,7 +1,8 @@\n__new hunk__\n1  \"use client\"\n2  \n3 +import { useState, useEffect, useMemo, useRef } from \"react\"\n4 +// import { X } from \"lucide-react\"\n5  import { useSearchParams, useRouter } from \"next/navigation\"\n6  import { useQuery } from \"@tanstack/react-query\"\n7  import { Input } from \"@/components/ui/input\"\n8  import { Button } from \"@/components/ui/button\"\n__old hunk__\n \"use client\"\n \n-import { useState, useEffect, useMemo } from \"react\"\n import { useSearchParams, useRouter } from \"next/navigation\"\n import { useQuery } from \"@tanstack/react-query\"\n import { Input } from \"@/components/ui/input\"\n import { Button } from \"@/components/ui/button\"\n\n@@ -41,11 +42,12 @@\n__new hunk__\n42  export default function SearchPage() {\n43    const searchParams = useSearchParams()\n44    const router = useRouter()\n45    const { filters, setFilters, resetFilters } = useFilters()\n46    const { settings } = useSettings()\n47  \n48    const [searchQuery, setSearchQuery] = useState(searchParams.get(\"q\") || filters.q || \"\")\n49 +  const inputRef = useRef(null);\n50    const [sortBy, setSortBy] = useState(settings.behavior.defaultSort || \"time\")\n51    const [filtersOpen, setFiltersOpen] = useState(false)\n52  \n53    // Update search query from URL params\n\n@@ -75,29 +77,54 @@ export default function SearchPage() {\n__new hunk__\n77        filters.fiberMin > 0 ||\n78        filters.sugarMax < 100 ||\n79        filters.sodiumMax < 4000 ||\n80        filters.maxTime < 120 ||\n81        !!filters.mealType\n82      )\n83    }, [filters])\n84  \n85 +  // const activeFilterCount = useMemo(() => {\n86 +  //   let count = 0\n87 +  //   if (filters.dietaryRestrictions.length > 0) count++\n88 +  //   if (filters.allergens.length > 0) count++\n89 +  //   if (filters.cuisines.length > 0) count++\n90 +  //   if (filters.majorConditions.length > 0) count++\n91 +  //   if (filters.calories[0] > 0 || filters.calories[1] < 1200) count++\n92 +  //   if (filters.proteinMin > 0) count++\n93 +  //   if (filters.carbsMin > 0) count++\n94 +  //   if (filters.fatMin > 0) count++\n95 +  //   if (filters.fiberMin > 0) count++\n96 +  //   if (filters.sugarMax < 100) count++\n97 +  //   if (filters.sodiumMax < 4000) count++\n98 +  //   if (filters.maxTime < 120) count++\n99 +  //   if (filters.mealType) count++\n100 +  //   return count\n101 +  // }, [filters])\n102    const activeFilterCount = useMemo(() => {\n103 +    let count = 0;\n104 +\n105 +  // Sum all selected array filters\n106 +    count += filters.dietaryRestrictions.length;\n107 +    count += filters.allergens.length;\n108 +    count += filters.cuisines.length;\n109 +    count += filters.majorConditions.length;\n110 +\n111 +    // Range and min/max filters\n112 +    if (filters.calories[0] > 0) count++; // Min calories\n113 +    if (filters.calories[1] < 1200) count++; // Max calories\n114 +    if (filters.proteinMin > 0) count++;\n115 +    if (filters.carbsMin > 0) count++;\n116 +    if (filters.fatMin > 0) count++;\n117 +    if (filters.fiberMin > 0) count++;\n118 +    if (filters.sugarMax < 100) count++;\n119 +    if (filters.sodiumMax < 4000) count++;\n120 +    if (filters.maxTime < 120) count++;\n121 +    \n122 +    // Single-value selection\n123 +    if (filters.mealType) count++;\n124 +\n125 +    return count;\n126 +  }, [filters]);\n127  \n128    const {\n129      data: searchResults = [],\n130      isLoading,\n__old hunk__\n       filters.fiberMin > 0 ||\n       filters.sugarMax < 100 ||\n       filters.sodiumMax < 4000 ||\n       filters.maxTime < 120 ||\n       !!filters.mealType\n     )\n   }, [filters])\n \n   const activeFilterCount = useMemo(() => {\n-    let count = 0\n-    if (filters.dietaryRestrictions.length > 0) count++\n-    if (filters.allergens.length > 0) count++\n-    if (filters.cuisines.length > 0) count++\n-    if (filters.majorConditions.length > 0) count++\n-    if (filters.calories[0] > 0 || filters.calories[1] < 1200) count++\n-    if (filters.proteinMin > 0) count++\n-    if (filters.carbsMin > 0) count++\n-    if (filters.fatMin > 0) count++\n-    if (filters.fiberMin > 0) count++\n-    if (filters.sugarMax < 100) count++\n-    if (filters.sodiumMax < 4000) count++\n-    if (filters.maxTime < 120) count++\n-    if (filters.mealType) count++\n-    return count\n-  }, [filters])\n \n   const {\n     data: searchResults = [],\n     isLoading,\n\n@@ -113,12 +140,22 @@ export default function SearchPage() {\n__new hunk__\n140          const rankedResults = rank(rawResults, settings)\n141          return rankedResults\n142        }\n143  \n144        return rawResults.map((recipe) => ({ ...recipe, score: 0 }))\n145      },\n146      enabled: !!(searchQuery || hasActiveFilters),\n147    })\n148 +  const handleSearchInputKeyDown = (e: React.KeyboardEvent) => {\n149 +    if (e.key === \"Escape\" && searchQuery) {\n150 +      setSearchQuery(\"\");\n151 +      inputRef.current?.focus();\n152 +    }\n153 +    if (e.key === \"Enter\") {\n154 +      handleSearch(searchQuery);\n155 +    }\n156 +  };\n157 +\n158  \n159    const handleSearch = (query: string) => {\n160      setSearchQuery(query)\n161      setFilters({ ...filters, q: query })\n\n@@ -182,13 +219,13 @@ export default function SearchPage() {\n__new hunk__\n219    return (\n220      \n221        \n222          {/* Search Header */}\n223          \n224            Search Recipes\n225  \n226            {/* Search Input */}\n227 +          {/* \n228              \n229              \n       \n         {/* Search Header */}\n         \n           Search Recipes\n \n           {/* Search Input */}\n-          \n             \n              setSearchQuery(e.target.value)}\n234                onKeyDown={(e) => e.key === \"Enter\" && handleSearch(searchQuery)}\n235                className=\"pl-10 pr-4 h-12 text-lg\"\n236              />\n237 +           */}\n238 +          \n239 +            \n240 +             setSearchQuery(e.target.value)}\n246 +              onKeyDown={handleSearchInputKeyDown}\n247 +              style={{ paddingRight: searchQuery ? \"2rem\" : undefined, width: \"100%\" }}\n248 +              className=\"pl-10 pr-4 h-12 text-lg\"\n249 +            />\n250 +            {searchQuery && (\n251 +               {\n266 +                  setSearchQuery(\"\");\n267 +                  inputRef.current?.focus();\n268 +              }}\n269 +              >\n270 +                \n271 +            \n272 +          )}\n273            \n274  \n275 +\n276            {/* Search Actions */}\n277            \n278               handleSearch(searchQuery)} size=\"sm\">\n279                Search\n\n\n## File: 'components/filter-panel.tsx'\n\n@@ -54,35 +54,58 @@\n__new hunk__\n54  export function FilterPanel({ open, onOpenChange, initialValues, onApply, onReset }: FilterPanelProps) {\n55    const form = useForm({\n56      resolver: zodResolver(schema),\n57      // provide full defaults (OUTPUT fits into INPUT just fine)\n58      defaultValues: schema.parse(initialValues ?? {}),\n59      mode: \"onChange\",\n60    })\n61  \n62     useEffect(() => {\n63      form.reset(schema.parse(initialValues ?? {}));\n64    }, [open, initialValues, form]);\n65  \n66 +  // function getActiveFiltersCount(): number {\n67 +  //   const values = form.getValues()\n68 +  //   let count = 0\n69 +  //   if ((values.dietaryRestrictions || []).length > 0) count++\n70 +  //   if ((values.allergens || []).length > 0) count++\n71 +  //   if ((values.cuisines || []).length > 0) count++\n72 +  //   if ((values.majorConditions || []).length > 0) count++\n73 +  //   if (values.calories && (values.calories[0] > 0 || values.calories[1] < 1200)) count++\n74 +  //   if ((values.proteinMin || 0) > 0) count++\n75 +  //   if ((values.carbsMin || 0) > 0) count++\n76 +  //   if ((values.fatMin || 0) > 0) count++\n77 +  //   if ((values.fiberMin || 0) > 0) count++\n78 +  //   if ((values.sugarMax || 100) < 100) count++\n79 +  //   if ((values.sodiumMax || 4000) < 4000) count++\n80 +  //   if ((values.maxTime || 120) < 120) count++\n81 +  //   if ((values.mealType || \"\") !== \"\") count++\n82 +  //   return count\n83 +  // }\n84    function getActiveFiltersCount(): number {\n85 +    const values = form.getValues();\n86 +    let count = 0;\n87 +\n88 +    // Count all selected array filters individually\n89 +    count += values.dietaryRestrictions.length;\n90 +    count += values.allergens.length;\n91 +    count += values.cuisines.length;\n92 +    count += values.majorConditions.length;\n93 +\n94 +    // Numeric and single-value filters\n95 +    if (values.calories[0] > 0) count++;           // Min calories\n96 +    if (values.calories[1] < 1200) count++;        // Max calories\n97 +    if (values.proteinMin > 0) count++;\n98 +    if (values.carbsMin > 0) count++;\n99 +    if (values.fatMin > 0) count++;\n100 +    if (values.fiberMin > 0) count++;\n101 +    if (values.sugarMax < 100) count++;\n102 +    if (values.sodiumMax < 4000) count++;\n103 +    if (values.maxTime < 120) count++;\n104 +    if (values.mealType) count++;\n105 +\n106 +    return count;\n107    }\n108    function handleApply() {\n109      const values = schema.parse(form.getValues())\n110      onApply(values)\n111      onOpenChange(false)\n__old hunk__\n export function FilterPanel({ open, onOpenChange, initialValues, onApply, onReset }: FilterPanelProps) {\n   const form = useForm({\n     resolver: zodResolver(schema),\n     // provide full defaults (OUTPUT fits into INPUT just fine)\n     defaultValues: schema.parse(initialValues ?? {}),\n     mode: \"onChange\",\n   })\n \n    useEffect(() => {\n     form.reset(schema.parse(initialValues ?? {}));\n   }, [open, initialValues, form]);\n \n   function getActiveFiltersCount(): number {\n-    const values = form.getValues()\n-    let count = 0\n-    if ((values.dietaryRestrictions || []).length > 0) count++\n-    if ((values.allergens || []).length > 0) count++\n-    if ((values.cuisines || []).length > 0) count++\n-    if ((values.majorConditions || []).length > 0) count++\n-    if (values.calories && (values.calories[0] > 0 || values.calories[1] < 1200)) count++\n-    if ((values.proteinMin || 0) > 0) count++\n-    if ((values.carbsMin || 0) > 0) count++\n-    if ((values.fatMin || 0) > 0) count++\n-    if ((values.fiberMin || 0) > 0) count++\n-    if ((values.sugarMax || 100) < 100) count++\n-    if ((values.sodiumMax || 4000) < 4000) count++\n-    if ((values.maxTime || 120) < 120) count++\n-    if ((values.mealType || \"\") !== \"\") count++\n-    return count\n   }\n-\n   function handleApply() {\n     const values = schema.parse(form.getValues())\n     onApply(values)\n     onOpenChange(false)"}, "file": {"name": "pr_reviewer.py", "path": "/app/pr_agent/tools/pr_reviewer.py"}, "function": "_prepare_prediction", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 197, "message": "PR diff", "module": "pr_reviewer", "name": "pr_agent.tools.pr_reviewer", "process": {"id": 18, "name": "MainProcess"}, "thread": {"id": 136556055251840, "name": "MainThread"}, "time": {"repr": "2025-12-11 06:53:50.775173+00:00", "timestamp": 1765436030.775173}}}
2025-Dec-11 06:53:50.787984
{"text": "Prompts\n", "record": {"elapsed": {"repr": "0:01:19.395406", "seconds": 79.395406}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "e928b569bf6b4265b9eb2a652d5c4f10", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "artifact": {"system": "You are PR-Reviewer, a language model designed to review a Git Pull Request (PR).\nYour task is to provide constructive and concise feedback for the PR.\nThe review should focus on new code added in the PR code diff (lines starting with '+')\n\n\nThe format we will use to present the PR code diff:\n======\n## File: 'src/file1.py'\n\n\n@@ ... @@ def func1():\n__new hunk__\n11  unchanged code line0\n12  unchanged code line1\n13 +new code line2 added\n14  unchanged code line3\n__old hunk__\n unchanged code line0\n unchanged code line1\n-old code line2 removed\n unchanged code line3\n\n@@ ... @@ def func2():\n__new hunk__\n unchanged code line4\n+new code line5 added\n unchanged code line6\n\n## File: 'src/file2.py'\n...\n======\n\n- In the format above, the diff is organized into separate '__new hunk__' and '__old hunk__' sections for each code chunk. '__new hunk__' contains the updated code, while '__old hunk__' shows the removed code. If no code was removed in a specific chunk, the __old hunk__ section will be omitted.\n- We also added line numbers for the '__new hunk__' code, to help you refer to the code lines in your suggestions. These line numbers are not part of the actual code, and should only be used for reference.\n- Code lines are prefixed with symbols ('+', '-', ' '). The '+' symbol indicates new code added in the PR, the '-' symbol indicates code removed in the PR, and the ' ' symbol indicates unchanged code. The review should address new code added in the PR code diff (lines starting with '+').\n- When quoting variables, names or file paths from the code, use backticks (`) instead of single quote (').\n- Note that you only see changed code segments (diff hunks in a PR), not the entire codebase. Avoid suggestions that might duplicate existing functionality or questioning code elements (like variables declarations or import statements) that may be defined elsewhere in the codebase.\n- Also note that if the code ends at an opening brace or statement that begins a new scope (like 'if', 'for', 'try'), don't treat it as incomplete. Instead, acknowledge the visible scope boundary and analyze only the code shown.\n\n\nThe output must be a YAML object equivalent to type $PRReview, according to the following Pydantic definitions:\n=====\n\nclass KeyIssuesComponentLink(BaseModel):\n    relevant_file: str = Field(description=\"The full file path of the relevant file\")\n    issue_header: str = Field(description=\"One or two word title for the issue. For example: 'Possible Bug', etc.\")\n    issue_content: str = Field(description=\"A short and concise summary of what should be further inspected and validated during the PR review process for this issue. Do not mention line numbers in this field.\")\n    start_line: int = Field(description=\"The start line that corresponds to this issue in the relevant file\")\n    end_line: int = Field(description=\"The end line that corresponds to this issue in the relevant file\")\n\nclass Review(BaseModel):\n    estimated_effort_to_review_[1-5]: int = Field(description=\"Estimate, on a scale of 1-5 (inclusive), the time and effort required to review this PR by an experienced and knowledgeable developer. 1 means short and easy review , 5 means long and hard review. Take into account the size, complexity, quality, and the needed changes of the PR code diff.\")\n    relevant_tests: str = Field(description=\"yes/no question: does this PR have relevant tests added or updated ?\")\n    key_issues_to_review: List[KeyIssuesComponentLink] = Field(\"A short and diverse list (0-3 issues) of high-priority bugs, problems or performance concerns introduced in the PR code, which the PR reviewer should further focus on and validate during the review process.\")\n    security_concerns: str = Field(description=\"Does this PR code introduce vulnerabilities such as exposure of sensitive information (e.g., API keys, secrets, passwords), or security concerns like SQL injection, XSS, CSRF, and others ? Answer 'No' (without explaining why) if there are no possible issues. If there are security concerns or issues, start your answer with a short header, such as: 'Sensitive information exposure: ...', 'SQL injection: ...', etc. Explain your answer. Be specific and give examples if possible\")\n\nclass PRReview(BaseModel):\n    review: Review\n=====\n\n\nExample output:\n```yaml\nreview:\n  estimated_effort_to_review_[1-5]: |\n    3\n  relevant_tests: |\n    No\n  key_issues_to_review:\n    - relevant_file: |\n        directory/xxx.py\n      issue_header: |\n        Possible Bug\n      issue_content: |\n        ...\n      start_line: 12\n      end_line: 14\n    - ...\n  security_concerns: |\n    No\n```\n\nAnswer should be a valid YAML, and nothing else. Each YAML output MUST be after a newline, with proper indent, and block scalar indicator ('|')", "user": "\n\n\n--PR Info--\n\nToday's Date: 2025-12-11\n\nTitle: 'Fix: Search UX and multi-filter logic (frontend)'\n\nBranch: 'feature/initial-fixes'\n\nPR Description:\n======\n- Improved search bar UX in app/search/page.tsx:\r\n  - X icon clears input and refocuses\r\n  - Escape key clears input\r\n  - Enter key triggers search\r\n\r\n- Updated filter count logic:\r\n  - Accurately counts all active filters\r\n  - Apply button badge reflects true total\n======\n\n\nThe PR code diff:\n======\n## File: 'app/search/page.tsx'\n\n@@ -1,7 +1,8 @@\n__new hunk__\n1  \"use client\"\n2  \n3 +import { useState, useEffect, useMemo, useRef } from \"react\"\n4 +// import { X } from \"lucide-react\"\n5  import { useSearchParams, useRouter } from \"next/navigation\"\n6  import { useQuery } from \"@tanstack/react-query\"\n7  import { Input } from \"@/components/ui/input\"\n8  import { Button } from \"@/components/ui/button\"\n__old hunk__\n \"use client\"\n \n-import { useState, useEffect, useMemo } from \"react\"\n import { useSearchParams, useRouter } from \"next/navigation\"\n import { useQuery } from \"@tanstack/react-query\"\n import { Input } from \"@/components/ui/input\"\n import { Button } from \"@/components/ui/button\"\n\n@@ -41,11 +42,12 @@\n__new hunk__\n42  export default function SearchPage() {\n43    const searchParams = useSearchParams()\n44    const router = useRouter()\n45    const { filters, setFilters, resetFilters } = useFilters()\n46    const { settings } = useSettings()\n47  \n48    const [searchQuery, setSearchQuery] = useState(searchParams.get(\"q\") || filters.q || \"\")\n49 +  const inputRef = useRef(null);\n50    const [sortBy, setSortBy] = useState(settings.behavior.defaultSort || \"time\")\n51    const [filtersOpen, setFiltersOpen] = useState(false)\n52  \n53    // Update search query from URL params\n\n@@ -75,29 +77,54 @@ export default function SearchPage() {\n__new hunk__\n77        filters.fiberMin > 0 ||\n78        filters.sugarMax < 100 ||\n79        filters.sodiumMax < 4000 ||\n80        filters.maxTime < 120 ||\n81        !!filters.mealType\n82      )\n83    }, [filters])\n84  \n85 +  // const activeFilterCount = useMemo(() => {\n86 +  //   let count = 0\n87 +  //   if (filters.dietaryRestrictions.length > 0) count++\n88 +  //   if (filters.allergens.length > 0) count++\n89 +  //   if (filters.cuisines.length > 0) count++\n90 +  //   if (filters.majorConditions.length > 0) count++\n91 +  //   if (filters.calories[0] > 0 || filters.calories[1] < 1200) count++\n92 +  //   if (filters.proteinMin > 0) count++\n93 +  //   if (filters.carbsMin > 0) count++\n94 +  //   if (filters.fatMin > 0) count++\n95 +  //   if (filters.fiberMin > 0) count++\n96 +  //   if (filters.sugarMax < 100) count++\n97 +  //   if (filters.sodiumMax < 4000) count++\n98 +  //   if (filters.maxTime < 120) count++\n99 +  //   if (filters.mealType) count++\n100 +  //   return count\n101 +  // }, [filters])\n102    const activeFilterCount = useMemo(() => {\n103 +    let count = 0;\n104 +\n105 +  // Sum all selected array filters\n106 +    count += filters.dietaryRestrictions.length;\n107 +    count += filters.allergens.length;\n108 +    count += filters.cuisines.length;\n109 +    count += filters.majorConditions.length;\n110 +\n111 +    // Range and min/max filters\n112 +    if (filters.calories[0] > 0) count++; // Min calories\n113 +    if (filters.calories[1] < 1200) count++; // Max calories\n114 +    if (filters.proteinMin > 0) count++;\n115 +    if (filters.carbsMin > 0) count++;\n116 +    if (filters.fatMin > 0) count++;\n117 +    if (filters.fiberMin > 0) count++;\n118 +    if (filters.sugarMax < 100) count++;\n119 +    if (filters.sodiumMax < 4000) count++;\n120 +    if (filters.maxTime < 120) count++;\n121 +    \n122 +    // Single-value selection\n123 +    if (filters.mealType) count++;\n124 +\n125 +    return count;\n126 +  }, [filters]);\n127  \n128    const {\n129      data: searchResults = [],\n130      isLoading,\n__old hunk__\n       filters.fiberMin > 0 ||\n       filters.sugarMax < 100 ||\n       filters.sodiumMax < 4000 ||\n       filters.maxTime < 120 ||\n       !!filters.mealType\n     )\n   }, [filters])\n \n   const activeFilterCount = useMemo(() => {\n-    let count = 0\n-    if (filters.dietaryRestrictions.length > 0) count++\n-    if (filters.allergens.length > 0) count++\n-    if (filters.cuisines.length > 0) count++\n-    if (filters.majorConditions.length > 0) count++\n-    if (filters.calories[0] > 0 || filters.calories[1] < 1200) count++\n-    if (filters.proteinMin > 0) count++\n-    if (filters.carbsMin > 0) count++\n-    if (filters.fatMin > 0) count++\n-    if (filters.fiberMin > 0) count++\n-    if (filters.sugarMax < 100) count++\n-    if (filters.sodiumMax < 4000) count++\n-    if (filters.maxTime < 120) count++\n-    if (filters.mealType) count++\n-    return count\n-  }, [filters])\n \n   const {\n     data: searchResults = [],\n     isLoading,\n\n@@ -113,12 +140,22 @@ export default function SearchPage() {\n__new hunk__\n140          const rankedResults = rank(rawResults, settings)\n141          return rankedResults\n142        }\n143  \n144        return rawResults.map((recipe) => ({ ...recipe, score: 0 }))\n145      },\n146      enabled: !!(searchQuery || hasActiveFilters),\n147    })\n148 +  const handleSearchInputKeyDown = (e: React.KeyboardEvent) => {\n149 +    if (e.key === \"Escape\" && searchQuery) {\n150 +      setSearchQuery(\"\");\n151 +      inputRef.current?.focus();\n152 +    }\n153 +    if (e.key === \"Enter\") {\n154 +      handleSearch(searchQuery);\n155 +    }\n156 +  };\n157 +\n158  \n159    const handleSearch = (query: string) => {\n160      setSearchQuery(query)\n161      setFilters({ ...filters, q: query })\n\n@@ -182,13 +219,13 @@ export default function SearchPage() {\n__new hunk__\n219    return (\n220      \n221        \n222          {/* Search Header */}\n223          \n224            Search Recipes\n225  \n226            {/* Search Input */}\n227 +          {/* \n228              \n229              \n       \n         {/* Search Header */}\n         \n           Search Recipes\n \n           {/* Search Input */}\n-          \n             \n              setSearchQuery(e.target.value)}\n234                onKeyDown={(e) => e.key === \"Enter\" && handleSearch(searchQuery)}\n235                className=\"pl-10 pr-4 h-12 text-lg\"\n236              />\n237 +           */}\n238 +          \n239 +            \n240 +             setSearchQuery(e.target.value)}\n246 +              onKeyDown={handleSearchInputKeyDown}\n247 +              style={{ paddingRight: searchQuery ? \"2rem\" : undefined, width: \"100%\" }}\n248 +              className=\"pl-10 pr-4 h-12 text-lg\"\n249 +            />\n250 +            {searchQuery && (\n251 +               {\n266 +                  setSearchQuery(\"\");\n267 +                  inputRef.current?.focus();\n268 +              }}\n269 +              >\n270 +                \n271 +            \n272 +          )}\n273            \n274  \n275 +\n276            {/* Search Actions */}\n277            \n278               handleSearch(searchQuery)} size=\"sm\">\n279                Search\n\n\n## File: 'components/filter-panel.tsx'\n\n@@ -54,35 +54,58 @@\n__new hunk__\n54  export function FilterPanel({ open, onOpenChange, initialValues, onApply, onReset }: FilterPanelProps) {\n55    const form = useForm({\n56      resolver: zodResolver(schema),\n57      // provide full defaults (OUTPUT fits into INPUT just fine)\n58      defaultValues: schema.parse(initialValues ?? {}),\n59      mode: \"onChange\",\n60    })\n61  \n62     useEffect(() => {\n63      form.reset(schema.parse(initialValues ?? {}));\n64    }, [open, initialValues, form]);\n65  \n66 +  // function getActiveFiltersCount(): number {\n67 +  //   const values = form.getValues()\n68 +  //   let count = 0\n69 +  //   if ((values.dietaryRestrictions || []).length > 0) count++\n70 +  //   if ((values.allergens || []).length > 0) count++\n71 +  //   if ((values.cuisines || []).length > 0) count++\n72 +  //   if ((values.majorConditions || []).length > 0) count++\n73 +  //   if (values.calories && (values.calories[0] > 0 || values.calories[1] < 1200)) count++\n74 +  //   if ((values.proteinMin || 0) > 0) count++\n75 +  //   if ((values.carbsMin || 0) > 0) count++\n76 +  //   if ((values.fatMin || 0) > 0) count++\n77 +  //   if ((values.fiberMin || 0) > 0) count++\n78 +  //   if ((values.sugarMax || 100) < 100) count++\n79 +  //   if ((values.sodiumMax || 4000) < 4000) count++\n80 +  //   2025-12-11T06:53:50.787984741Z if ((values.maxTime || 120) < 120) count++\n81 +  //   if ((values.mealType || \"\") !== \"\") count++\n82 +  //   return count\n83 +  // }\n84    function getActiveFiltersCount(): number {\n85 +    const values = form.getValues();\n86 +    let count = 0;\n87 +\n88 +    // Count all selected array filters individually\n89 +    count += values.dietaryRestrictions.length;\n90 +    count += values.allergens.length;\n91 +    count += values.cuisines.length;\n92 +    count += values.majorConditions.length;\n93 +\n94 +    // Numeric and single-value filters\n95 +    if (values.calories[0] > 0) count++;           // Min calories\n96 +    if (values.calories[1] < 1200) count++;        // Max calories\n97 +    if (values.proteinMin > 0) count++;\n98 +    if (values.carbsMin > 0) count++;\n99 +    if (values.fatMin > 0) count++;\n100 +    if (values.fiberMin > 0) count++;\n101 +    if (values.sugarMax < 100) count++;\n102 +    if (values.sodiumMax < 4000) count++;\n103 +    if (values.maxTime < 120) count++;\n104 +    if (values.mealType) count++;\n105 +\n106 +    return count;\n107    }\n108    function handleApply() {\n109      const values = schema.parse(form.getValues())\n110      onApply(values)\n111      onOpenChange(false)\n__old hunk__\n export function FilterPanel({ open, onOpenChange, initialValues, onApply, onReset }: FilterPanelProps) {\n   const form = useForm({\n     resolver: zodResolver(schema),\n     // provide full defaults (OUTPUT fits into INPUT just fine)\n     defaultValues: schema.parse(initialValues ?? {}),\n     mode: \"onChange\",\n   })\n \n    useEffect(() => {\n     form.reset(schema.parse(initialValues ?? {}));\n   }, [open, initialValues, form]);\n \n   function getActiveFiltersCount(): number {\n-    const values = form.getValues()\n-    let count = 0\n-    if ((values.dietaryRestrictions || []).length > 0) count++\n-    if ((values.allergens || []).length > 0) count++\n-    if ((values.cuisines || []).length > 0) count++\n-    if ((values.majorConditions || []).length > 0) count++\n-    if (values.calories && (values.calories[0] > 0 || values.calories[1] < 1200)) count++\n-    if ((values.proteinMin || 0) > 0) count++\n-    if ((values.carbsMin || 0) > 0) count++\n-    if ((values.fatMin || 0) > 0) count++\n-    if ((values.fiberMin || 0) > 0) count++\n-    if ((values.sugarMax || 100) < 100) count++\n-    if ((values.sodiumMax || 4000) < 4000) count++\n-    if ((values.maxTime || 120) < 120) count++\n-    if ((values.mealType || \"\") !== \"\") count++\n-    return count\n   }\n-\n   function handleApply() {\n     const values = schema.parse(form.getValues())\n     onApply(values)\n     onOpenChange(false)\n======\n\n\nResponse (should be a valid YAML, and nothing else):\n```yaml"}}, "file": {"name": "litellm_ai_handler.py", "path": "/app/pr_agent/algo/ai_handlers/litellm_ai_handler.py"}, "function": "chat_completion", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 397, "message": "Prompts", "module": "litellm_ai_handler", "name": "pr_agent.algo.ai_handlers.litellm_ai_handler", "process": {"id": 18, "name": "MainProcess"}, "thread": {"id": 136556055251840, "name": "MainThread"}, "time": {"repr": "2025-12-11 06:53:50.787449+00:00", "timestamp": 1765436030.787449}}}
2025-Dec-11 06:53:50.788235
{"text": "LiteLLM call model='openai/gpt-5'\n", "record": {"elapsed": {"repr": "0:01:19.396036", "seconds": 79.396036}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "e928b569bf6b4265b9eb2a652d5c4f10", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "litellm_ai_handler.py", "path": "/app/pr_agent/algo/ai_handlers/litellm_ai_handler.py"}, "function": "chat_completion", "level": {"icon": "âš ï¸", "name": "WARNING", "no": 30}, "line": 426, "message": "LiteLLM call model='openai/gpt-5'", "module": "litellm_ai_handler", "name": "pr_agent.algo.ai_handlers.litellm_ai_handler", "process": {"id": 18, "name": "MainProcess"}, "thread": {"id": 136556055251840, "name": "MainThread"}, "time": {"repr": "2025-12-11 06:53:50.788079+00:00", "timestamp": 1765436030.788079}}}
2025-Dec-11 06:53:50.788270
{"text": "Using OpenAI client directly for LiteLLM proxy with model: openai/gpt-5\n", "record": {"elapsed": {"repr": "0:01:19.396114", "seconds": 79.396114}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "e928b569bf6b4265b9eb2a652d5c4f10", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "litellm_ai_handler.py", "path": "/app/pr_agent/algo/ai_handlers/litellm_ai_handler.py"}, "function": "_get_completion", "level": {"icon": "â„¹ï¸", "name": "INFO", "no": 20}, "line": 467, "message": "Using OpenAI client directly for LiteLLM proxy with model: openai/gpt-5", "module": "litellm_ai_handler", "name": "pr_agent.algo.ai_handlers.litellm_ai_handler", "process": {"id": 18, "name": "MainProcess"}, "thread": {"id": 136556055251840, "name": "MainThread"}, "time": {"repr": "2025-12-11 06:53:50.788157+00:00", "timestamp": 1765436030.788157}}}
2025-Dec-11 06:55:04.719867
{"text": "\nAI response:\nreview:\n  estimated_effort_to_review_[1-5]: |\n    2\n  relevant_tests: |\n    No\n  key_issues_to_review:\n    - relevant_file: |\n        app/search/page.tsx\n      issue_header: |\n        Undefined Component\n      issue_content: |\n        The clear button renders `X` but there is no import for it (the `lucide-react` import is commented out), which will cause a reference/compile error.\n      start_line: 270\n      end_line: 270\n    - relevant_file: |\n        app/search/page.tsx\n      issue_header: |\n        State Desync\n      issue_content: |\n        Clearing via Escape only updates `searchQuery` and not `filters.q`/URL, which can lead to stale query params and inconsistent search results; consider invoking the existing `handleSearch(\"\")` to keep state, filters, and URL in sync. The clear button behavior should align as well.\n      start_line: 149\n      end_line: 156\n    - relevant_file: |\n        components/filter-panel.tsx\n      issue_header: |\n        Robustness\n      issue_content: |\n        `getActiveFiltersCount` directly indexes arrays and ranges (e.g., `values.calories[0]`) assuming schema-provided defaults; if defaults ever change or values come in undefined, this will throw. Consider defensive checks or ensuring strong defaults at the schema level.\n      start_line: 88\n      end_line: 96\n  security_concerns: |\n    No\n", "record": {"elapsed": {"repr": "0:02:33.327440", "seconds": 153.32744}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "e928b569bf6b4265b9eb2a652d5c4f10", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "litellm_ai_handler.py", "path": "/app/pr_agent/algo/ai_handlers/litellm_ai_handler.py"}, "function": "chat_completion", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 439, "message": "\nAI response:\nreview:\n  estimated_effort_to_review_[1-5]: |\n    2\n  relevant_tests: |\n    No\n  key_issues_to_review:\n    - relevant_file: |\n        app/search/page.tsx\n      issue_header: |\n        Undefined Component\n      issue_content: |\n        The clear button renders `X` but there is no import for it (the `lucide-react` import is commented out), which will cause a reference/compile error.\n      start_line: 270\n      end_line: 270\n    - relevant_file: |\n        app/search/page.tsx\n      issue_header: |\n        State Desync\n      issue_content: |\n        Clearing via Escape only updates `searchQuery` and not `filters.q`/URL, which can lead to stale query params and inconsistent search results; consider invoking the existing `handleSearch(\"\")` to keep state, filters, and URL in sync. The clear button behavior should align as well.\n      start_line: 149\n      end_line: 156\n    - relevant_file: |\n        components/filter-panel.tsx\n      issue_header: |\n        Robustness\n      issue_content: |\n        `getActiveFiltersCount` directly indexes arrays and ranges (e.g., `values.calories[0]`) assuming schema-provided defaults; if defaults ever change or values come in undefined, this will throw. Consider defensive checks or ensuring strong defaults at the schema level.\n      start_line: 88\n      end_line: 96\n  security_concerns: |\n    No", "module": "litellm_ai_handler", "name": "pr_agent.algo.ai_handlers.litellm_ai_handler", "process": {"id": 18, "name": "MainProcess"}, "thread": {"id": 136556055251840, "name": "MainThread"}, "time": {"repr": "2025-12-11 06:55:04.719483+00:00", "timestamp": 1765436104.719483}}}
2025-Dec-11 06:55:04.719971
{"text": "Failed to generate prediction with openai/gpt-5\n", "record": {"elapsed": {"repr": "0:02:33.327782", "seconds": 153.327782}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "e928b569bf6b4265b9eb2a652d5c4f10", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "artifact": {"error": "'dict' object has no attribute 'dict'"}}, "file": {"name": "pr_processing.py", "path": "/app/pr_agent/algo/pr_processing.py"}, "function": "retry_with_fallback_models", "level": {"icon": "âš ï¸", "name": "WARNING", "no": 30}, "line": 333, "message": "Failed to generate prediction with openai/gpt-5", "module": "pr_processing", "name": "pr_agent.algo.pr_processing", "process": {"id": 18, "name": "MainProcess"}, "thread": {"id": 136556055251840, "name": "MainThread"}, "time": {"repr": "2025-12-11 06:55:04.719825+00:00", "timestamp": 1765436104.719825}}}
2025-Dec-11 06:55:04.720049
{"text": "Generating prediction with openai/gpt-5-mini\n", "record": {"elapsed": {"repr": "0:02:33.327867", "seconds": 153.327867}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "e928b569bf6b4265b9eb2a652d5c4f10", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "pr_processing.py", "path": "/app/pr_agent/algo/pr_processing.py"}, "function": "retry_with_fallback_models", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 326, "message": "Generating prediction with openai/gpt-5-mini", "module": "pr_processing", "name": "pr_agent.algo.pr_processing", "process": {"id": 18, "name": "MainProcess"}, "thread": {"id": 136556055251840, "name": "MainThread"}, "time": {"repr": "2025-12-11 06:55:04.719910+00:00", "timestamp": 1765436104.71991}}}
2025-Dec-11 06:55:04.943607
{"text": "PR main language: TypeScript\n", "record": {"elapsed": {"repr": "0:02:33.550651", "seconds": 153.550651}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "e928b569bf6b4265b9eb2a652d5c4f10", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "pr_processing.py", "path": "/app/pr_agent/algo/pr_processing.py"}, "function": "get_pr_diff", "level": {"icon": "â„¹ï¸", "name": "INFO", "no": 20}, "line": 63, "message": "PR main language: TypeScript", "module": "pr_processing", "name": "pr_agent.algo.pr_processing", "process": {"id": 18, "name": "MainProcess"}, "thread": {"id": 136556055251840, "name": "MainThread"}, "time": {"repr": "2025-12-11 06:55:04.942694+00:00", "timestamp": 1765436104.942694}}}
2025-Dec-11 06:55:04.949748
{"text": "Tokens: 4738, total tokens under limit: 32000, returning full diff.\n", "record": {"elapsed": {"repr": "0:02:33.557259", "seconds": 153.557259}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "e928b569bf6b4265b9eb2a652d5c4f10", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "pr_processing.py", "path": "/app/pr_agent/algo/pr_processing.py"}, "function": "get_pr_diff", "level": {"icon": "â„¹ï¸", "name": "INFO", "no": 20}, "line": 74, "message": "Tokens: 4738, total tokens under limit: 32000, returning full diff.", "module": "pr_processing", "name": "pr_agent.algo.pr_processing", "process": {"id": 18, "name": "MainProcess"}, "thread": {"id": 136556055251840, "name": "MainThread"}, "time": {"repr": "2025-12-11 06:55:04.949302+00:00", "timestamp": 1765436104.949302}}}
2025-Dec-11 06:55:04.950018
{"text": "PR diff\n", "record": {"elapsed": {"repr": "0:02:33.557528", "seconds": 153.557528}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "e928b569bf6b4265b9eb2a652d5c4f10", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "diff": "\n\n## File: 'app/search/page.tsx'\n\n@@ -1,7 +1,8 @@\n__new hunk__\n1  \"use client\"\n2  \n3 +import { useState, useEffect, useMemo, useRef } from \"react\"\n4 +// import { X } from \"lucide-react\"\n5  import { useSearchParams, useRouter } from \"next/navigation\"\n6  import { useQuery } from \"@tanstack/react-query\"\n7  import { Input } from \"@/components/ui/input\"\n8  import { Button } from \"@/components/ui/button\"\n__old hunk__\n \"use client\"\n \n-import { useState, useEffect, useMemo } from \"react\"\n import { useSearchParams, useRouter } from \"next/navigation\"\n import { useQuery } from \"@tanstack/react-query\"\n import { Input } from \"@/components/ui/input\"\n import { Button } from \"@/components/ui/button\"\n\n@@ -41,11 +42,12 @@\n__new hunk__\n42  export default function SearchPage() {\n43    const searchParams = useSearchParams()\n44    const router = useRouter()\n45    const { filters, setFilters, resetFilters } = useFilters()\n46    const { settings } = useSettings()\n47  \n48    const [searchQuery, setSearchQuery] = useState(searchParams.get(\"q\") || filters.q || \"\")\n49 +  const inputRef = useRef(null);\n50    const [sortBy, setSortBy] = useState(settings.behavior.defaultSort || \"time\")\n51    const [filtersOpen, setFiltersOpen] = useState(false)\n52  \n53    // Update search query from URL params\n\n@@ -75,29 +77,54 @@ export default function SearchPage() {\n__new hunk__\n77        filters.fiberMin > 0 ||\n78        filters.sugarMax < 100 ||\n79        filters.sodiumMax < 4000 ||\n80        filters.maxTime < 120 ||\n81        !!filters.mealType\n82      )\n83    }, [filters])\n84  \n85 +  // const activeFilterCount = useMemo(() => {\n86 +  //   let count = 0\n87 +  //   if (filters.dietaryRestrictions.length > 0) count++\n88 +  //   if (filters.allergens.length > 0) count++\n89 +  //   if (filters.cuisines.length > 0) count++\n90 +  //   if (filters.majorConditions.length > 0) count++\n91 +  //   if (filters.calories[0] > 0 || filters.calories[1] < 1200) count++\n92 +  //   if (filters.proteinMin > 0) count++\n93 +  //   if (filters.carbsMin > 0) count++\n94 +  //   if (filters.fatMin > 0) count++\n95 +  //   if (filters.fiberMin > 0) count++\n96 +  //   if (filters.sugarMax < 100) count++\n97 +  //   if (filters.sodiumMax < 4000) count++\n98 +  //   if (filters.maxTime < 120) count++\n99 +  //   if (filters.mealType) count++\n100 +  //   return count\n101 +  // }, [filters])\n102    const activeFilterCount = useMemo(() => {\n103 +    let count = 0;\n104 +\n105 +  // Sum all selected array filters\n106 +    count += filters.dietaryRestrictions.length;\n107 +    count += filters.allergens.length;\n108 +    count += filters.cuisines.length;\n109 +    count += filters.majorConditions.length;\n110 +\n111 +    // Range and min/max filters\n112 +    if (filters.calories[0] > 0) count++; // Min calories\n113 +    if (filters.calories[1] < 1200) count++; // Max calories\n114 +    if (filters.proteinMin > 0) count++;\n115 +    if (filters.carbsMin > 0) count++;\n116 +    if (filters.fatMin > 0) count++;\n117 +    if (filters.fiberMin > 0) count++;\n118 +    if (filters.sugarMax < 100) count++;\n119 +    if (filters.sodiumMax < 4000) count++;\n120 +    if (filters.maxTime < 120) count++;\n121 +    \n122 +    // Single-value selection\n123 +    if (filters.mealType) count++;\n124 +\n125 +    return count;\n126 +  }, [filters]);\n127  \n128    const {\n129      data: searchResults = [],\n130      isLoading,\n__old hunk__\n       filters.fiberMin > 0 ||\n       filters.sugarMax < 100 ||\n       filters.sodiumMax < 4000 ||\n       filters.maxTime < 120 ||\n       !!filters.mealType\n     )\n   }, [filters])\n \n   const activeFilterCount = useMemo(() => {\n-    let count = 0\n-    if (filters.dietaryRestrictions.length > 0) count++\n-    if (filters.allergens.length > 0) count++\n-    if (filters.cuisines.length > 0) count++\n-    if (filters.majorConditions.length > 0) count++\n-    if (filters.calories[0] > 0 || filters.calories[1] < 1200) count++\n-    if (filters.proteinMin > 0) count++\n-    if (filters.carbsMin > 0) count++\n-    if (filters.fatMin > 0) count++\n-    if (filters.fiberMin > 0) count++\n-    if (filters.sugarMax < 100) count++\n-    if (filters.sodiumMax < 4000) count++\n-    if (filters.maxTime < 120) count++\n-    if (filters.mealType) count++\n-    return count\n-  }, [filters])\n \n   const {\n     data: searchResults = [],\n     isLoading,\n\n@@ -113,12 +140,22 @@ export default function SearchPage() {\n__new hunk__\n140          const rankedResults = rank(rawResults, settings)\n141          return rankedResults\n142        }\n143  \n144        return rawResults.map((recipe) => ({ ...recipe, score: 0 }))\n145      },\n146      enabled: !!(searchQuery || hasActiveFilters),\n147    })\n148 +  const handleSearchInputKeyDown = (e: React.KeyboardEvent) => {\n149 +    if (e.key === \"Escape\" && searchQuery) {\n150 +      setSearchQuery(\"\");\n151 +      inputRef.current?.focus();\n152 +    }\n153 +    if (e.key === \"Enter\") {\n154 +      handleSearch(searchQuery);\n155 +    }\n156 +  };\n157 +\n158  \n159    const handleSearch = (query: string) => {\n160      setSearchQuery(query)\n161      setFilters({ ...filters, q: query })\n\n@@ -182,13 +219,13 @@ export default function SearchPage() {\n__new hunk__\n219    return (\n220      \n221        \n222          {/* Search Header */}\n223          \n224            Search Recipes\n225  \n226            {/* Search Input */}\n227 +          {/* \n228              \n229              \n       \n         {/* Search Header */}\n         \n           Search Recipes\n \n           {/* Search Input */}\n-          \n             \n              setSearchQuery(e.target.value)}\n234                onKeyDown={(e) => e.key === \"Enter\" && handleSearch(searchQuery)}\n235                className=\"pl-10 pr-4 h-12 text-lg\"\n236              />\n237 +           */}\n238 +          \n239 +            \n240 +             setSearchQuery(e.target.value)}\n246 +              onKeyDown={handleSearchInputKeyDown}\n247 +              style={{ paddingRight: searchQuery ? \"2rem\" : undefined, width: \"100%\" }}\n248 +              className=\"pl-10 pr-4 h-12 text-lg\"\n249 +            />\n250 +            {searchQuery && (\n251 +               {\n266 +                  setSearchQuery(\"\");\n267 +                  inputRef.current?.focus();\n268 +              }}\n269 +              >\n270 +                \n271 +            \n272 +          )}\n273            \n274  \n275 +\n276            {/* Search Actions */}\n277            \n278               handleSearch(searchQuery)} size=\"sm\">\n279                Search\n\n\n## File: 'components/filter-panel.tsx'\n\n@@ -54,35 +54,58 @@\n__new hunk__\n54  export function FilterPanel({ open, onOpenChange, initialValues, onApply, onReset }: FilterPanelProps) {\n55    const form = useForm({\n56      resolver: zodResolver(schema),\n57      // provide full defaults (OUTPUT fits into INPUT just fine)\n58      defaultValues: schema.parse(initialValues ?? {}),\n59      mode: \"onChange\",\n60    })\n61  \n62     useEffect(() => {\n63      form.reset(schema.parse(initialValues ?? {}));\n64    }, [open, initialValues, form]);\n65  \n66 +  // function getActiveFiltersCount(): number {\n67 +  //   const values = form.getValues()\n68 +  //   let count = 0\n69 +  //   if ((values.dietaryRestrictions || []).length > 0) count++\n70 +  //   if ((values.allergens || []).length > 0) count++\n71 +  //   if ((values.cuisines || []).length > 0) count++\n72 +  //   if ((values.majorConditions || []).length > 0) count++\n73 +  //   if (values.calories && (values.calories[0] > 0 || values.calories[1] < 1200)) count++\n74 +  //   if ((values.proteinMin || 0) > 0) count++\n75 +  //   if ((values.carbsMin || 0) > 0) count++\n76 +  //   if ((values.fatMin || 0) > 0) count++\n77 +  //   if ((values.fiberMin || 0) > 0) count++\n78 +  //   if ((values.sugarMax || 100) < 100) count++\n79 +  //   if ((values.sodiumMax || 4000) < 4000) count++\n80 +  //   if ((values.maxTime || 120) < 120) count++\n81 +  //   if ((values.mealType || \"\") !== \"\") count++\n82 +  //   return count\n83 +  // }\n84    function getActiveFiltersCount(): number {\n85 +    const values = form.getValues();\n86 +    let count = 0;\n87 +\n88 +    // Count all selected array filters individually\n89 +    count += values.dietaryRestrictions.length;\n90 +    count += values.allergens.length;\n91 +    count += values.cuisines.length;\n92 +    count += values.majorConditions.length;\n93 +\n94 +    // Numeric and single-value filters\n95 +    if (values.calories[0] > 0) count++;           // Min calories\n96 +    if (values.calories[1] < 1200) count++;        // Max calories\n97 +    if (values.proteinMin > 0) count++;\n98 +    if (values.carbsMin > 0) count++;\n99 +    if (values.fatMin > 0) count++;\n100 +    if (values.fiberMin > 0) count++;\n101 +    if (values.sugarMax < 100) count++;\n102 +    if (values.sodiumMax < 4000) count++;\n103 +    if (values.maxTime < 120) count++;\n104 +    if (values.mealType) count++;\n105 +\n106 +    return count;\n107    }\n108    function handleApply() {\n109      const values = schema.parse(form.getValues())\n110      onApply(values)\n111      onOpenChange(false)\n__old hunk__\n export function FilterPanel({ open, onOpenChange, initialValues, onApply, onReset }: FilterPanelProps) {\n   const form = useForm({\n     resolver: zodResolver(schema),\n     // provide full defaults (OUTPUT fits into INPUT just fine)\n     defaultValues: schema.parse(initialValues ?? {}),\n     mode: \"onChange\",\n   })\n \n    useEffect(() => {\n     form.reset(schema.parse(initialValues ?? {}));\n   }, [open, initialValues, form]);\n \n   function getActiveFiltersCount(): number {\n-    const values = form.getValues()\n-    let count = 0\n-    if ((values.dietaryRestrictions || []).length > 0) count++\n-    if ((values.allergens || []).length > 0) count++\n-    if ((values.cuisines || []).length > 0) count++\n-    if ((values.majorConditions || []).length > 0) count++\n-    if (values.calories && (values.calories[0] > 0 || values.calories[1] < 1200)) count++\n-    if ((values.proteinMin || 0) > 0) count++\n-    if ((values.carbsMin || 0) > 0) count++\n-    if ((values.fatMin || 0) > 0) count++\n-    if ((values.fiberMin || 0) > 0) count++\n-    if ((values.sugarMax || 100) < 100) count++\n-    if ((values.sodiumMax || 4000) < 4000) count++\n-    if ((values.maxTime || 120) < 120) count++\n-    if ((values.mealType || \"\") !== \"\") count++\n-    return count\n   }\n-\n   function handleApply() {\n     const values = schema.parse(form.getValues())\n     onApply(values)\n     onOpenChange(false)"}, "file": {"name": "pr_reviewer.py", "path": "/app/pr_agent/tools/pr_reviewer.py"}, "function": "_prepare_prediction", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 197, "message": "PR diff", "module": "pr_reviewer", "name": "pr_agent.tools.pr_reviewer", "process": {"id": 18, "name": "MainProcess"}, "thread": {"id": 136556055251840, "name": "MainThread"}, "time": {"repr": "2025-12-11 06:55:04.949571+00:00", "timestamp": 1765436104.949571}}}
2025-Dec-11 06:55:04.962419
{"text": "Prompts\n", "record": {"elapsed": {"repr": "0:02:33.569754", "seconds": 153.569754}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "e928b569bf6b4265b9eb2a652d5c4f10", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "artifact": {"system": "You are PR-Reviewer, a language model designed to review a Git Pull Request (PR).\nYour task is to provide constructive and concise feedback for the PR.\nThe review should focus on new code added in the PR code diff (lines starting with '+')\n\n\nThe format we will use to present the PR code diff:\n======\n## File: 'src/file1.py'\n\n\n@@ ... @@ def func1():\n__new hunk__\n11  unchanged code line0\n12  unchanged code line1\n13 +new code line2 added\n14  unchanged code line3\n__old hunk__\n unchanged code line0\n unchanged code line1\n-old code line2 removed\n unchanged code line3\n\n@@ ... @@ def func2():\n__new hunk__\n unchanged code line4\n+new code line5 added\n unchanged code line6\n\n## File: 'src/file2.py'\n...\n======\n\n- In the format above, the diff is organized into separate '__new hunk__' and '__old hunk__' sections for each code chunk. '__new hunk__' contains the updated code, while '__old hunk__' shows the removed code. If no code was removed in a specific chunk, the __old hunk__ section will be omitted.\n- We also added line numbers for the '__new hunk__' code, to help you refer to the code lines in your suggestions. These line numbers are not part of the actual code, and should only be used for reference.\n- Code lines are prefixed with symbols ('+', '-', ' '). The '+' symbol indicates new code added in the PR, the '-' symbol indicates code removed in the PR, and the ' ' symbol indicates unchanged code. The review should address new code added in the PR code diff (lines starting with '+').\n- When quoting variables, names or file paths from the code, use backticks (`) instead of single quote (').\n- Note that you only see changed code segments (diff hunks in a PR), not the entire codebase. Avoid suggestions that might duplicate existing functionality or questioning code elements (like variables declarations or import statements) that may be defined elsewhere in the codebase.\n- Also note that if the code ends at an opening brace or statement that begins a new scope (like 'if', 'for', 'try'), don't treat it as incomplete. Instead, acknowledge the visible scope boundary and analyze only the code shown.\n\n\nThe output must be a YAML object equivalent to type $PRReview, according to the following Pydantic definitions:\n=====\n\nclass KeyIssuesComponentLink(BaseModel):\n    relevant_file: str = Field(description=\"The full file path of the relevant file\")\n    issue_header: str = Field(description=\"One or two word title for the issue. For example: 'Possible Bug', etc.\")\n    issue_content: str = Field(description=\"A short and concise summary of what should be further inspected and validated during the PR review process for this issue. Do not mention line numbers in this field.\")\n    start_line: int = Field(description=\"The start line that corresponds to this issue in the relevant file\")\n    end_line: int = Field(description=\"The end line that corresponds to this issue in the relevant file\")\n\nclass Review(BaseModel):\n    estimated_effort_to_review_[1-5]: int = Field(description=\"Estimate, on a scale of 1-5 (inclusive), the time and effort required to review this PR by an experienced and knowledgeable developer. 1 means short and easy review , 5 means long and hard review. Take into account the size, complexity, quality, and the needed changes of the PR code diff.\")\n    relevant_tests: str = Field(description=\"yes/no question: does this PR have relevant tests added or updated ?\")\n    key_issues_to_review: List[KeyIssuesComponentLink] = Field(\"A short and diverse list (0-3 issues) of high-priority bugs, problems or performance concerns introduced in the PR code, which the PR reviewer should further focus on and validate during the review process.\")\n    security_concerns: str = Field(description=\"Does this PR code introduce vulnerabilities such as exposure of sensitive information (e.g., API keys, secrets, passwords), or security concerns like SQL injection, XSS, CSRF, and others ? Answer 'No' (without explaining why) if there are no possible issues. If there are security concerns or issues, start your answer with a short header, such as: 'Sensitive information exposure: ...', 'SQL injection: ...', etc. Explain your answer. Be specific and give examples if possible\")\n\nclass PRReview(BaseModel):\n    review: Review\n=====\n\n\nExample output:\n```yaml\nreview:\n  estimated_effort_to_review_[1-5]: |\n    3\n  relevant_tests: |\n    No\n  key_issues_to_review:\n    - relevant_file: |\n        directory/xxx.py\n      issue_header: |\n        Possible Bug\n      issue_content: |\n        ...\n      start_line: 12\n      end_line: 14\n    - ...\n  security_concerns: |\n    No\n```\n\nAnswer should be a valid YAML, and nothing else. Each YAML output MUST be after a newline, with proper indent, and block scalar indicator ('|')", "user": "\n\n\n--PR Info--\n\nToday's Date: 2025-12-11\n\nTitle: 'Fix: Search UX and multi-filter logic (frontend)'\n\nBranch: 'feature/initial-fixes'\n\nPR Description:\n======\n- Improved search bar UX in app/search/page.tsx:\r\n  - X icon clears input and refocuses\r\n  - Escape key clears input\r\n  - Enter key triggers search\r\n\r\n- Updated filter count logic:\r\n  - Accurately counts all active filters\r\n  - Apply button badge reflects true total\n======\n\n\nThe PR code diff:\n======\n## File: 'app/search/page.tsx'\n\n@@ -1,7 +1,8 @@\n__new hunk__\n1  \"use client\"\n2  \n3 +import { useState, useEffect, useMemo, useRef } from \"react\"\n4 +// import { X } from \"lucide-react\"\n5  import { useSearchParams, useRouter } from \"next/navigation\"\n6  import { useQuery } from \"@tanstack/react-query\"\n7  import { Input } from \"@/components/ui/input\"\n8  import { Button } from \"@/components/ui/button\"\n__old hunk__\n \"use client\"\n \n-import { useState, useEffect, useMemo } from \"react\"\n import { useSearchParams, useRouter } from \"next/navigation\"\n import { useQuery } from \"@tanstack/react-query\"\n import { Input } from \"@/components/ui/input\"\n import { Button } from \"@/components/ui/button\"\n\n@@ -41,11 +42,12 @@\n__new hunk__\n42  export default function SearchPage() {\n43    const searchParams = useSearchParams()\n44    const router = useRouter()\n45    const { filters, setFilters, resetFilters } = useFilters()\n46    const { settings } = useSettings()\n47  \n48    const [searchQuery, setSearchQuery] = useState(searchParams.get(\"q\") || filters.q || \"\")\n49 +  const inputRef = useRef(null);\n50    const [sortBy, setSortBy] = useState(settings.behavior.defaultSort || \"time\")\n51    const [filtersOpen, setFiltersOpen] = useState(false)\n52  \n53    // Update search query from URL params\n\n@@ -75,29 +77,54 @@ export default function SearchPage() {\n__new hunk__\n77        filters.fiberMin > 0 ||\n78        filters.sugarMax < 100 ||\n79        filters.sodiumMax < 4000 ||\n80        filters.maxTime < 120 ||\n81        !!filters.mealType\n82      )\n83    }, [filters])\n84  \n85 +  // const activeFilterCount = useMemo(() => {\n86 +  //   let count = 0\n87 +  //   if (filters.dietaryRestrictions.length > 0) count++\n88 +  //   if (filters.allergens.length > 0) count++\n89 +  //   if (filters.cuisines.length > 0) count++\n90 +  //   if (filters.majorConditions.length > 0) count++\n91 +  //   if (filters.calories[0] > 0 || filters.calories[1] < 1200) count++\n92 +  //   if (filters.proteinMin > 0) count++\n93 +  //   if (filters.carbsMin > 0) count++\n94 +  //   if (filters.fatMin > 0) count++\n95 +  //   if (filters.fiberMin > 0) count++\n96 +  //   if (filters.sugarMax < 100) count++\n97 +  //   if (filters.sodiumMax < 4000) count++\n98 +  //   if (filters.maxTime < 120) count++\n99 +  //   if (filters.mealType) count++\n100 +  //   return count\n101 +  // }, [filters])\n102    const activeFilterCount = useMemo(() => {\n103 +    let count = 0;\n104 +\n105 +  // Sum all selected array filters\n106 +    count += filters.dietaryRestrictions.length;\n107 +    count += filters.allergens.length;\n108 +    count += filters.cuisines.length;\n109 +    count += filters.majorConditions.length;\n110 +\n111 +    // Range and min/max filters\n112 +    if (filters.calories[0] > 0) count++; // Min calories\n113 +    if (filters.calories[1] < 1200) count++; // Max calories\n114 +    if (filters.proteinMin > 0) count++;\n115 +    if (filters.carbsMin > 0) count++;\n116 +    if (filters.fatMin > 0) count++;\n117 +    if (filters.fiberMin > 0) count++;\n118 +    if (filters.sugarMax < 100) count++;\n119 +    if (filters.sodiumMax < 4000) count++;\n120 +    if (filters.maxTime < 120) count++;\n121 +    \n122 +    // Single-value selection\n123 +    if (filters.mealType) count++;\n124 +\n125 +    return count;\n126 +  }, [filters]);\n127  \n128    const {\n129      data: searchResults = [],\n130      isLoading,\n__old hunk__\n       filters.fiberMin > 0 ||\n       filters.sugarMax < 100 ||\n       filters.sodiumMax < 4000 ||\n       filters.maxTime < 120 ||\n       !!filters.mealType\n     )\n   }, [filters])\n \n   const activeFilterCount = useMemo(() => {\n-    let count = 0\n-    if (filters.dietaryRestrictions.length > 0) count++\n-    if (filters.allergens.length > 0) count++\n-    if (filters.cuisines.length > 0) count++\n-    if (filters.majorConditions.length > 0) count++\n-    if (filters.calories[0] > 0 || filters.calories[1] < 1200) count++\n-    if (filters.proteinMin > 0) count++\n-    if (filters.carbsMin > 0) count++\n-    if (filters.fatMin > 0) count++\n-    if (filters.fiberMin > 0) count++\n-    if (filters.sugarMax < 100) count++\n-    if (filters.sodiumMax < 4000) count++\n-    if (filters.maxTime < 120) count++\n-    if (filters.mealType) count++\n-    return count\n-  }, [filters])\n \n   const {\n     data: searchResults = [],\n     isLoading,\n\n@@ -113,12 +140,22 @@ export default function SearchPage() {\n__new hunk__\n140          const rankedResults = rank(rawResults, settings)\n141          return rankedResults\n142        }\n143  \n144        return rawResults.map((recipe) => ({ ...recipe, score: 0 }))\n145      },\n146      enabled: !!(searchQuery || hasActiveFilters),\n147    })\n148 +  const handleSearchInputKeyDown = (e: React.KeyboardEvent) => {\n149 +    if (e.key === \"Escape\" && searchQuery) {\n150 +      setSearchQuery(\"\");\n151 +      inputRef.current?.focus();\n152 +    }\n153 +    if (e.key === \"Enter\") {\n154 +      handleSearch(searchQuery);\n155 +    }\n156 +  };\n157 +\n158  \n159    const handleSearch = (query: string) => {\n160      setSearchQuery(query)\n161      setFilters({ ...filters, q: query })\n\n@@ -182,13 +219,13 @@ export default function SearchPage() {\n__new hunk__\n219    return (\n220      \n221        \n222          {/* Search Header */}\n223          \n224            Search Recipes\n225  \n226            {/* Search Input */}\n227 +          {/* \n228              \n229              \n       \n         {/* Search Header */}\n         \n           Search Recipes\n \n           {/* Search Input */}\n-          \n             \n              setSearchQuery(e.target.value)}\n234                onKeyDown={(e) => e.key === \"Enter\" && handleSearch(searchQuery)}\n235                className=\"pl-10 pr-4 h-12 text-lg\"\n236              />\n237 +           */}\n238 +          \n239 +            \n240 +             setSearchQuery(e.target.value)}\n246 +              onKeyDown={handleSearchInputKeyDown}\n247 +              style={{ paddingRight: searchQuery ? \"2rem\" : undefined, width: \"100%\" }}\n248 +              className=\"pl-10 pr-4 h-12 text-lg\"\n249 +            />\n250 +            {searchQuery && (\n251 +               {\n266 +                  setSearchQuery(\"\");\n267 +                  inputRef.current?.focus();\n268 +              }}\n269 +              >\n270 +                \n271 +            \n272 +          )}\n273            \n274  \n275 +\n276            {/* Search Actions */}\n277            \n278               handleSearch(searchQuery)} size=\"sm\">\n279                Search\n\n\n## File: 'components/filter-panel.tsx'\n\n@@ -54,35 +54,58 @@\n__new hunk__\n54  export function FilterPanel({ open, onOpenChange, initialValues, onApply, onReset }: FilterPanelProps) {\n55    const form = useForm({\n56      resolver: zodResolver(schema),\n57      // provide full defaults (OUTPUT fits into INPUT just fine)\n58      defaultValues: schema.parse(initialValues ?? {}),\n59      mode: \"onChange\",\n60    })\n61  \n62     useEffect(() => {\n63      form.reset(schema.parse(initialValues ?? {}));\n64    }, [open, initialValues, form]);\n65  \n66 +  // function getActiveFiltersCount(): number {\n67 +  //   const values = form.getValues()\n68 +  //   let count = 0\n69 +  //   if ((values.dietaryRestrictions || []).length > 0) count++\n70 +  //   if ((values.allergens || []).length > 0) count++\n71 +  //   if ((values.cuisines || []).length > 0) count++\n72 +  //   if ((values.majorConditions || []).length > 0) count++\n73 +  //   if (values.calories && (values.calories[0] > 0 || values.calories[1] < 1200)) count++\n74 +  //   if ((values.proteinMin || 0) > 0) count++\n75 +  //   if ((values.carbsMin || 0) > 0) count++\n76 +  //   if ((values.fatMin || 0) > 0) count++\n77 +  //   if ((values.fiberMin || 0) > 0) count++\n78 +  //   if ((values.sugarMax || 100) < 100) count++\n79 +  //   if ((values.sodiumMax || 4000) < 4000) count++\n80 +  //  2025-12-11T06:55:04.962419559Z  if ((values.maxTime || 120) < 120) count++\n81 +  //   if ((values.mealType || \"\") !== \"\") count++\n82 +  //   return count\n83 +  // }\n84    function getActiveFiltersCount(): number {\n85 +    const values = form.getValues();\n86 +    let count = 0;\n87 +\n88 +    // Count all selected array filters individually\n89 +    count += values.dietaryRestrictions.length;\n90 +    count += values.allergens.length;\n91 +    count += values.cuisines.length;\n92 +    count += values.majorConditions.length;\n93 +\n94 +    // Numeric and single-value filters\n95 +    if (values.calories[0] > 0) count++;           // Min calories\n96 +    if (values.calories[1] < 1200) count++;        // Max calories\n97 +    if (values.proteinMin > 0) count++;\n98 +    if (values.carbsMin > 0) count++;\n99 +    if (values.fatMin > 0) count++;\n100 +    if (values.fiberMin > 0) count++;\n101 +    if (values.sugarMax < 100) count++;\n102 +    if (values.sodiumMax < 4000) count++;\n103 +    if (values.maxTime < 120) count++;\n104 +    if (values.mealType) count++;\n105 +\n106 +    return count;\n107    }\n108    function handleApply() {\n109      const values = schema.parse(form.getValues())\n110      onApply(values)\n111      onOpenChange(false)\n__old hunk__\n export function FilterPanel({ open, onOpenChange, initialValues, onApply, onReset }: FilterPanelProps) {\n   const form = useForm({\n     resolver: zodResolver(schema),\n     // provide full defaults (OUTPUT fits into INPUT just fine)\n     defaultValues: schema.parse(initialValues ?? {}),\n     mode: \"onChange\",\n   })\n \n    useEffect(() => {\n     form.reset(schema.parse(initialValues ?? {}));\n   }, [open, initialValues, form]);\n \n   function getActiveFiltersCount(): number {\n-    const values = form.getValues()\n-    let count = 0\n-    if ((values.dietaryRestrictions || []).length > 0) count++\n-    if ((values.allergens || []).length > 0) count++\n-    if ((values.cuisines || []).length > 0) count++\n-    if ((values.majorConditions || []).length > 0) count++\n-    if (values.calories && (values.calories[0] > 0 || values.calories[1] < 1200)) count++\n-    if ((values.proteinMin || 0) > 0) count++\n-    if ((values.carbsMin || 0) > 0) count++\n-    if ((values.fatMin || 0) > 0) count++\n-    if ((values.fiberMin || 0) > 0) count++\n-    if ((values.sugarMax || 100) < 100) count++\n-    if ((values.sodiumMax || 4000) < 4000) count++\n-    if ((values.maxTime || 120) < 120) count++\n-    if ((values.mealType || \"\") !== \"\") count++\n-    return count\n   }\n-\n   function handleApply() {\n     const values = schema.parse(form.getValues())\n     onApply(values)\n     onOpenChange(false)\n======\n\n\nResponse (should be a valid YAML, and nothing else):\n```yaml"}}, "file": {"name": "litellm_ai_handler.py", "path": "/app/pr_agent/algo/ai_handlers/litellm_ai_handler.py"}, "function": "chat_completion", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 397, "message": "Prompts", "module": "litellm_ai_handler", "name": "pr_agent.algo.ai_handlers.litellm_ai_handler", "process": {"id": 18, "name": "MainProcess"}, "thread": {"id": 136556055251840, "name": "MainThread"}, "time": {"repr": "2025-12-11 06:55:04.961797+00:00", "timestamp": 1765436104.961797}}}
2025-Dec-11 06:55:04.962601
{"text": "LiteLLM call model='openai/gpt-5-mini'\n", "record": {"elapsed": {"repr": "0:02:33.570310", "seconds": 153.57031}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "e928b569bf6b4265b9eb2a652d5c4f10", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "litellm_ai_handler.py", "path": "/app/pr_agent/algo/ai_handlers/litellm_ai_handler.py"}, "function": "chat_completion", "level": {"icon": "âš ï¸", "name": "WARNING", "no": 30}, "line": 426, "message": "LiteLLM call model='openai/gpt-5-mini'", "module": "litellm_ai_handler", "name": "pr_agent.algo.ai_handlers.litellm_ai_handler", "process": {"id": 18, "name": "MainProcess"}, "thread": {"id": 136556055251840, "name": "MainThread"}, "time": {"repr": "2025-12-11 06:55:04.962353+00:00", "timestamp": 1765436104.962353}}}
2025-Dec-11 06:55:04.962608
{"text": "Using OpenAI client directly for LiteLLM proxy with model: openai/gpt-5-mini\n", "record": {"elapsed": {"repr": "0:02:33.570396", "seconds": 153.570396}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "e928b569bf6b4265b9eb2a652d5c4f10", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "litellm_ai_handler.py", "path": "/app/pr_agent/algo/ai_handlers/litellm_ai_handler.py"}, "function": "_get_completion", "level": {"icon": "â„¹ï¸", "name": "INFO", "no": 20}, "line": 467, "message": "Using OpenAI client directly for LiteLLM proxy with model: openai/gpt-5-mini", "module": "litellm_ai_handler", "name": "pr_agent.algo.ai_handlers.litellm_ai_handler", "process": {"id": 18, "name": "MainProcess"}, "thread": {"id": 136556055251840, "name": "MainThread"}, "time": {"repr": "2025-12-11 06:55:04.962439+00:00", "timestamp": 1765436104.962439}}}
2025-Dec-11 06:55:50.012241
{"text": "\nAI response:\nreview:\n  estimated_effort_to_review_[1-5]: |\n    2\n  relevant_tests: |\n    No\n  key_issues_to_review:\n    - relevant_file: |\n        app/search/page.tsx\n      issue_header: |\n        Missing import\n      issue_content: |\n        The clear (X) icon component `X` is used in the JSX but the import is commented out. This will cause a compile/runtime error. Either re-enable the import (e.g. `import { X } from \"lucide-react\"`) or replace the usage with another icon component that is already imported.\n      start_line: 3\n      end_line: 271\n    - relevant_file: |\n        app/search/page.tsx\n      issue_header: |\n        Type/React namespace\n      issue_content: |\n        The keyboard handler is typed as `React.KeyboardEvent` but `React` is not imported into the module (only named hooks are imported). This may cause TypeScript errors. Either import `React` (for the type) or change the handler signature to use a DOM/inline type that doesn't require the `React` namespace.\n      start_line: 148\n      end_line: 156\n    - relevant_file: |\n        components/filter-panel.tsx\n      issue_header: |\n        Non-reactive filter count\n      issue_content: |\n        `getActiveFiltersCount` uses `form.getValues()` to compute the active filters count. `getValues()` does not subscribe to form value changes, so the UI that calls this might not update when form fields change. Consider using `form.watch` or `useWatch` (from react-hook-form) or deriving the count from `watch` so it updates reactively. Also ensure array fields exist (defaults) to avoid undefined access if defaults change.\n      start_line: 84\n      end_line: 107\n  security_concerns: |\n    No\n", "record": {"elapsed": {"repr": "0:03:18.619656", "seconds": 198.619656}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "e928b569bf6b4265b9eb2a652d5c4f10", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "litellm_ai_handler.py", "path": "/app/pr_agent/algo/ai_handlers/litellm_ai_handler.py"}, "function": "chat_completion", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 439, "message": "\nAI response:\nreview:\n  estimated_effort_to_review_[1-5]: |\n    2\n  relevant_tests: |\n    No\n  key_issues_to_review:\n    - relevant_file: |\n        app/search/page.tsx\n      issue_header: |\n        Missing import\n      issue_content: |\n        The clear (X) icon component `X` is used in the JSX but the import is commented out. This will cause a compile/runtime error. Either re-enable the import (e.g. `import { X } from \"lucide-react\"`) or replace the usage with another icon component that is already imported.\n      start_line: 3\n      end_line: 271\n    - relevant_file: |\n        app/search/page.tsx\n      issue_header: |\n        Type/React namespace\n      issue_content: |\n        The keyboard handler is typed as `React.KeyboardEvent` but `React` is not imported into the module (only named hooks are imported). This may cause TypeScript errors. Either import `React` (for the type) or change the handler signature to use a DOM/inline type that doesn't require the `React` namespace.\n      start_line: 148\n      end_line: 156\n    - relevant_file: |\n        components/filter-panel.tsx\n      issue_header: |\n        Non-reactive filter count\n      issue_content: |\n        `getActiveFiltersCount` uses `form.getValues()` to compute the active filters count. `getValues()` does not subscribe to form value changes, so the UI that calls this might not update when form fields change. Consider using `form.watch` or `useWatch` (from react-hook-form) or deriving the count from `watch` so it updates reactively. Also ensure array fields exist (defaults) to avoid undefined access if defaults change.\n      start_line: 84\n      end_line: 107\n  security_concerns: |\n    No", "module": "litellm_ai_handler", "name": "pr_agent.algo.ai_handlers.litellm_ai_handler", "process": {"id": 18, "name": "MainProcess"}, "thread": {"id": 136556055251840, "name": "MainThread"}, "time": {"repr": "2025-12-11 06:55:50.011699+00:00", "timestamp": 1765436150.011699}}}
2025-Dec-11 06:55:50.012351
{"text": "Failed to generate prediction with openai/gpt-5-mini\n", "record": {"elapsed": {"repr": "0:03:18.619989", "seconds": 198.619989}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "e928b569bf6b4265b9eb2a652d5c4f10", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "artifact": {"error": "'dict' object has no attribute 'dict'"}}, "file": {"name": "pr_processing.py", "path": "/app/pr_agent/algo/pr_processing.py"}, "function": "retry_with_fallback_models", "level": {"icon": "âš ï¸", "name": "WARNING", "no": 30}, "line": 333, "message": "Failed to generate prediction with openai/gpt-5-mini", "module": "pr_processing", "name": "pr_agent.algo.pr_processing", "process": {"id": 18, "name": "MainProcess"}, "thread": {"id": 136556055251840, "name": "MainThread"}, "time": {"repr": "2025-12-11 06:55:50.012032+00:00", "timestamp": 1765436150.012032}}}
2025-Dec-11 06:55:50.012359
{"text": "Generating prediction with openai/gpt-5-nano\n", "record": {"elapsed": {"repr": "0:03:18.620058", "seconds": 198.620058}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "e928b569bf6b4265b9eb2a652d5c4f10", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "pr_processing.py", "path": "/app/pr_agent/algo/pr_processing.py"}, "function": "retry_with_fallback_models", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 326, "message": "Generating prediction with openai/gpt-5-nano", "module": "pr_processing", "name": "pr_agent.algo.pr_processing", "process": {"id": 18, "name": "MainProcess"}, "thread": {"id": 136556055251840, "name": "MainThread"}, "time": {"repr": "2025-12-11 06:55:50.012101+00:00", "timestamp": 1765436150.012101}}}
2025-Dec-11 06:55:50.209608
{"text": "PR main language: TypeScript\n", "record": {"elapsed": {"repr": "0:03:18.817174", "seconds": 198.817174}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "e928b569bf6b4265b9eb2a652d5c4f10", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "pr_processing.py", "path": "/app/pr_agent/algo/pr_processing.py"}, "function": "get_pr_diff", "level": {"icon": "â„¹ï¸", "name": "INFO", "no": 20}, "line": 63, "message": "PR main language: TypeScript", "module": "pr_processing", "name": "pr_agent.algo.pr_processing", "process": {"id": 18, "name": "MainProcess"}, "thread": {"id": 136556055251840, "name": "MainThread"}, "time": {"repr": "2025-12-11 06:55:50.209217+00:00", "timestamp": 1765436150.209217}}}
2025-Dec-11 06:55:50.216856
{"text": "Tokens: 4738, total tokens under limit: 32000, returning full diff.\n", "record": {"elapsed": {"repr": "0:03:18.824411", "seconds": 198.824411}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "e928b569bf6b4265b9eb2a652d5c4f10", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "pr_processing.py", "path": "/app/pr_agent/algo/pr_processing.py"}, "function": "get_pr_diff", "level": {"icon": "â„¹ï¸", "name": "INFO", "no": 20}, "line": 74, "message": "Tokens: 4738, total tokens under limit: 32000, returning full diff.", "module": "pr_processing", "name": "pr_agent.algo.pr_processing", "process": {"id": 18, "name": "MainProcess"}, "thread": {"id": 136556055251840, "name": "MainThread"}, "time": {"repr": "2025-12-11 06:55:50.216454+00:00", "timestamp": 1765436150.216454}}}
2025-Dec-11 06:55:50.217165
{"text": "PR diff\n", "record": {"elapsed": {"repr": "0:03:18.824654", "seconds": 198.824654}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "e928b569bf6b4265b9eb2a652d5c4f10", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "diff": "\n\n## File: 'app/search/page.tsx'\n\n@@ -1,7 +1,8 @@\n__new hunk__\n1  \"use client\"\n2  \n3 +import { useState, useEffect, useMemo, useRef } from \"react\"\n4 +// import { X } from \"lucide-react\"\n5  import { useSearchParams, useRouter } from \"next/navigation\"\n6  import { useQuery } from \"@tanstack/react-query\"\n7  import { Input } from \"@/components/ui/input\"\n8  import { Button } from \"@/components/ui/button\"\n__old hunk__\n \"use client\"\n \n-import { useState, useEffect, useMemo } from \"react\"\n import { useSearchParams, useRouter } from \"next/navigation\"\n import { useQuery } from \"@tanstack/react-query\"\n import { Input } from \"@/components/ui/input\"\n import { Button } from \"@/components/ui/button\"\n\n@@ -41,11 +42,12 @@\n__new hunk__\n42  export default function SearchPage() {\n43    const searchParams = useSearchParams()\n44    const router = useRouter()\n45    const { filters, setFilters, resetFilters } = useFilters()\n46    const { settings } = useSettings()\n47  \n48    const [searchQuery, setSearchQuery] = useState(searchParams.get(\"q\") || filters.q || \"\")\n49 +  const inputRef = useRef(null);\n50    const [sortBy, setSortBy] = useState(settings.behavior.defaultSort || \"time\")\n51    const [filtersOpen, setFiltersOpen] = useState(false)\n52  \n53    // Update search query from URL params\n\n@@ -75,29 +77,54 @@ export default function SearchPage() {\n__new hunk__\n77        filters.fiberMin > 0 ||\n78        filters.sugarMax < 100 ||\n79        filters.sodiumMax < 4000 ||\n80        filters.maxTime < 120 ||\n81        !!filters.mealType\n82      )\n83    }, [filters])\n84  \n85 +  // const activeFilterCount = useMemo(() => {\n86 +  //   let count = 0\n87 +  //   if (filters.dietaryRestrictions.length > 0) count++\n88 +  //   if (filters.allergens.length > 0) count++\n89 +  //   if (filters.cuisines.length > 0) count++\n90 +  //   if (filters.majorConditions.length > 0) count++\n91 +  //   if (filters.calories[0] > 0 || filters.calories[1] < 1200) count++\n92 +  //   if (filters.proteinMin > 0) count++\n93 +  //   if (filters.carbsMin > 0) count++\n94 +  //   if (filters.fatMin > 0) count++\n95 +  //   if (filters.fiberMin > 0) count++\n96 +  //   if (filters.sugarMax < 100) count++\n97 +  //   if (filters.sodiumMax < 4000) count++\n98 +  //   if (filters.maxTime < 120) count++\n99 +  //   if (filters.mealType) count++\n100 +  //   return count\n101 +  // }, [filters])\n102    const activeFilterCount = useMemo(() => {\n103 +    let count = 0;\n104 +\n105 +  // Sum all selected array filters\n106 +    count += filters.dietaryRestrictions.length;\n107 +    count += filters.allergens.length;\n108 +    count += filters.cuisines.length;\n109 +    count += filters.majorConditions.length;\n110 +\n111 +    // Range and min/max filters\n112 +    if (filters.calories[0] > 0) count++; // Min calories\n113 +    if (filters.calories[1] < 1200) count++; // Max calories\n114 +    if (filters.proteinMin > 0) count++;\n115 +    if (filters.carbsMin > 0) count++;\n116 +    if (filters.fatMin > 0) count++;\n117 +    if (filters.fiberMin > 0) count++;\n118 +    if (filters.sugarMax < 100) count++;\n119 +    if (filters.sodiumMax < 4000) count++;\n120 +    if (filters.maxTime < 120) count++;\n121 +    \n122 +    // Single-value selection\n123 +    if (filters.mealType) count++;\n124 +\n125 +    return count;\n126 +  }, [filters]);\n127  \n128    const {\n129      data: searchResults = [],\n130      isLoading,\n__old hunk__\n       filters.fiberMin > 0 ||\n       filters.sugarMax < 100 ||\n       filters.sodiumMax < 4000 ||\n       filters.maxTime < 120 ||\n       !!filters.mealType\n     )\n   }, [filters])\n \n   const activeFilterCount = useMemo(() => {\n-    let count = 0\n-    if (filters.dietaryRestrictions.length > 0) count++\n-    if (filters.allergens.length > 0) count++\n-    if (filters.cuisines.length > 0) count++\n-    if (filters.majorConditions.length > 0) count++\n-    if (filters.calories[0] > 0 || filters.calories[1] < 1200) count++\n-    if (filters.proteinMin > 0) count++\n-    if (filters.carbsMin > 0) count++\n-    if (filters.fatMin > 0) count++\n-    if (filters.fiberMin > 0) count++\n-    if (filters.sugarMax < 100) count++\n-    if (filters.sodiumMax < 4000) count++\n-    if (filters.maxTime < 120) count++\n-    if (filters.mealType) count++\n-    return count\n-  }, [filters])\n \n   const {\n     data: searchResults = [],\n     isLoading,\n\n@@ -113,12 +140,22 @@ export default function SearchPage() {\n__new hunk__\n140          const rankedResults = rank(rawResults, settings)\n141          return rankedResults\n142        }\n143  \n144        return rawResults.map((recipe) => ({ ...recipe, score: 0 }))\n145      },\n146      enabled: !!(searchQuery || hasActiveFilters),\n147    })\n148 +  const handleSearchInputKeyDown = (e: React.KeyboardEvent) => {\n149 +    if (e.key === \"Escape\" && searchQuery) {\n150 +      setSearchQuery(\"\");\n151 +      inputRef.current?.focus();\n152 +    }\n153 +    if (e.key === \"Enter\") {\n154 +      handleSearch(searchQuery);\n155 +    }\n156 +  };\n157 +\n158  \n159    const handleSearch = (query: string) => {\n160      setSearchQuery(query)\n161      setFilters({ ...filters, q: query })\n\n@@ -182,13 +219,13 @@ export default function SearchPage() {\n__new hunk__\n219    return (\n220      \n221        \n222          {/* Search Header */}\n223          \n224            Search Recipes\n225  \n226            {/* Search Input */}\n227 +          {/* \n228              \n229              \n       \n         {/* Search Header */}\n         \n           Search Recipes\n \n           {/* Search Input */}\n-          \n             \n              setSearchQuery(e.target.value)}\n234                onKeyDown={(e) => e.key === \"Enter\" && handleSearch(searchQuery)}\n235                className=\"pl-10 pr-4 h-12 text-lg\"\n236              />\n237 +           */}\n238 +          \n239 +            \n240 +             setSearchQuery(e.target.value)}\n246 +              onKeyDown={handleSearchInputKeyDown}\n247 +              style={{ paddingRight: searchQuery ? \"2rem\" : undefined, width: \"100%\" }}\n248 +              className=\"pl-10 pr-4 h-12 text-lg\"\n249 +            />\n250 +            {searchQuery && (\n251 +               {\n266 +                  setSearchQuery(\"\");\n267 +                  inputRef.current?.focus();\n268 +              }}\n269 +              >\n270 +                \n271 +            \n272 +          )}\n273            \n274  \n275 +\n276            {/* Search Actions */}\n277            \n278               handleSearch(searchQuery)} size=\"sm\">\n279                Search\n\n\n## File: 'components/filter-panel.tsx'\n\n@@ -54,35 +54,58 @@\n__new hunk__\n54  export function FilterPanel({ open, onOpenChange, initialValues, onApply, onReset }: FilterPanelProps) {\n55    const form = useForm({\n56      resolver: zodResolver(schema),\n57      // provide full defaults (OUTPUT fits into INPUT just fine)\n58      defaultValues: schema.parse(initialValues ?? {}),\n59      mode: \"onChange\",\n60    })\n61  \n62     useEffect(() => {\n63      form.reset(schema.parse(initialValues ?? {}));\n64    }, [open, initialValues, form]);\n65  \n66 +  // function getActiveFiltersCount(): number {\n67 +  //   const values = form.getValues()\n68 +  //   let count = 0\n69 +  //   if ((values.dietaryRestrictions || []).length > 0) count++\n70 +  //   if ((values.allergens || []).length > 0) count++\n71 +  //   if ((values.cuisines || []).length > 0) count++\n72 +  //   if ((values.majorConditions || []).length > 0) count++\n73 +  //   if (values.calories && (values.calories[0] > 0 || values.calories[1] < 1200)) count++\n74 +  //   if ((values.proteinMin || 0) > 0) count++\n75 +  //   if ((values.carbsMin || 0) > 0) count++\n76 +  //   if ((values.fatMin || 0) > 0) count++\n77 +  //   if ((values.fiberMin || 0) > 0) count++\n78 +  //   if ((values.sugarMax || 100) < 100) count++\n79 +  //   if ((values.sodiumMax || 4000) < 4000) count++\n80 +  //   if ((values.maxTime || 120) < 120) count++\n81 +  //   if ((values.mealType || \"\") !== \"\") count++\n82 +  //   return count\n83 +  // }\n84    function getActiveFiltersCount(): number {\n85 +    const values = form.getValues();\n86 +    let count = 0;\n87 +\n88 +    // Count all selected array filters individually\n89 +    count += values.dietaryRestrictions.length;\n90 +    count += values.allergens.length;\n91 +    count += values.cuisines.length;\n92 +    count += values.majorConditions.length;\n93 +\n94 +    // Numeric and single-value filters\n95 +    if (values.calories[0] > 0) count++;           // Min calories\n96 +    if (values.calories[1] < 1200) count++;        // Max calories\n97 +    if (values.proteinMin > 0) count++;\n98 +    if (values.carbsMin > 0) count++;\n99 +    if (values.fatMin > 0) count++;\n100 +    if (values.fiberMin > 0) count++;\n101 +    if (values.sugarMax < 100) count++;\n102 +    if (values.sodiumMax < 4000) count++;\n103 +    if (values.maxTime < 120) count++;\n104 +    if (values.mealType) count++;\n105 +\n106 +    return count;\n107    }\n108    function handleApply() {\n109      const values = schema.parse(form.getValues())\n110      onApply(values)\n111      onOpenChange(false)\n__old hunk__\n export function FilterPanel({ open, onOpenChange, initialValues, onApply, onReset }: FilterPanelProps) {\n   const form = useForm({\n     resolver: zodResolver(schema),\n     // provide full defaults (OUTPUT fits into INPUT just fine)\n     defaultValues: schema.parse(initialValues ?? {}),\n     mode: \"onChange\",\n   })\n \n    useEffect(() => {\n     form.reset(schema.parse(initialValues ?? {}));\n   }, [open, initialValues, form]);\n \n   function getActiveFiltersCount(): number {\n-    const values = form.getValues()\n-    let count = 0\n-    if ((values.dietaryRestrictions || []).length > 0) count++\n-    if ((values.allergens || []).length > 0) count++\n-    if ((values.cuisines || []).length > 0) count++\n-    if ((values.majorConditions || []).length > 0) count++\n-    if (values.calories && (values.calories[0] > 0 || values.calories[1] < 1200)) count++\n-    if ((values.proteinMin || 0) > 0) count++\n-    if ((values.carbsMin || 0) > 0) count++\n-    if ((values.fatMin || 0) > 0) count++\n-    if ((values.fiberMin || 0) > 0) count++\n-    if ((values.sugarMax || 100) < 100) count++\n-    if ((values.sodiumMax || 4000) < 4000) count++\n-    if ((values.maxTime || 120) < 120) count++\n-    if ((values.mealType || \"\") !== \"\") count++\n-    return count\n   }\n-\n   function handleApply() {\n     const values = schema.parse(form.getValues())\n     onApply(values)\n     onOpenChange(false)"}, "file": {"name": "pr_reviewer.py", "path": "/app/pr_agent/tools/pr_reviewer.py"}, "function": "_prepare_prediction", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 197, "message": "PR diff", "module": "pr_reviewer", "name": "pr_agent.tools.pr_reviewer", "process": {"id": 18, "name": "MainProcess"}, "thread": {"id": 136556055251840, "name": "MainThread"}, "time": {"repr": "2025-12-11 06:55:50.216697+00:00", "timestamp": 1765436150.216697}}}
2025-Dec-11 06:55:50.227194
{"text": "Prompts\n", "record": {"elapsed": {"repr": "0:03:18.834577", "seconds": 198.834577}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "e928b569bf6b4265b9eb2a652d5c4f10", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "artifact": {"system": "You are PR-Reviewer, a language model designed to review a Git Pull Request (PR).\nYour task is to provide constructive and concise feedback for the PR.\nThe review should focus on new code added in the PR code diff (lines starting with '+')\n\n\nThe format we will use to present the PR code diff:\n======\n## File: 'src/file1.py'\n\n\n@@ ... @@ def func1():\n__new hunk__\n11  unchanged code line0\n12  unchanged code line1\n13 +new code line2 added\n14  unchanged code line3\n__old hunk__\n unchanged code line0\n unchanged code line1\n-old code line2 removed\n unchanged code line3\n\n@@ ... @@ def func2():\n__new hunk__\n unchanged code line4\n+new code line5 added\n unchanged code line6\n\n## File: 'src/file2.py'\n...\n======\n\n- In the format above, the diff is organized into separate '__new hunk__' and '__old hunk__' sections for each code chunk. '__new hunk__' contains the updated code, while '__old hunk__' shows the removed code. If no code was removed in a specific chunk, the __old hunk__ section will be omitted.\n- We also added line numbers for the '__new hunk__' code, to help you refer to the code lines in your suggestions. These line numbers are not part of the actual code, and should only be used for reference.\n- Code lines are prefixed with symbols ('+', '-', ' '). The '+' symbol indicates new code added in the PR, the '-' symbol indicates code removed in the PR, and the ' ' symbol indicates unchanged code. The review should address new code added in the PR code diff (lines starting with '+').\n- When quoting variables, names or file paths from the code, use backticks (`) instead of single quote (').\n- Note that you only see changed code segments (diff hunks in a PR), not the entire codebase. Avoid suggestions that might duplicate existing functionality or questioning code elements (like variables declarations or import statements) that may be defined elsewhere in the codebase.\n- Also note that if the code ends at an opening brace or statement that begins a new scope (like 'if', 'for', 'try'), don't treat it as incomplete. Instead, acknowledge the visible scope boundary and analyze only the code shown.\n\n\nThe output must be a YAML object equivalent to type $PRReview, according to the following Pydantic definitions:\n=====\n\nclass KeyIssuesComponentLink(BaseModel):\n    relevant_file: str = Field(description=\"The full file path of the relevant file\")\n    issue_header: str = Field(description=\"One or two word title for the issue. For example: 'Possible Bug', etc.\")\n    issue_content: str = Field(description=\"A short and concise summary of what should be further inspected and validated during the PR review process for this issue. Do not mention line numbers in this field.\")\n    start_line: int = Field(description=\"The start line that corresponds to this issue in the relevant file\")\n    end_line: int = Field(description=\"The end line that corresponds to this issue in the relevant file\")\n\nclass Review(BaseModel):\n    estimated_effort_to_review_[1-5]: int = Field(description=\"Estimate, on a scale of 1-5 (inclusive), the time and effort required to review this PR by an experienced and knowledgeable developer. 1 means short and easy review , 5 means long and hard review. Take into account the size, complexity, quality, and the needed changes of the PR code diff.\")\n    relevant_tests: str = Field(description=\"yes/no question: does this PR have relevant tests added or updated ?\")\n    key_issues_to_review: List[KeyIssuesComponentLink] = Field(\"A short and diverse list (0-3 issues) of high-priority bugs, problems or performance concerns introduced in the PR code, which the PR reviewer should further focus on and validate during the review process.\")\n    security_concerns: str = Field(description=\"Does this PR code introduce vulnerabilities such as exposure of sensitive information (e.g., API keys, secrets, passwords), or security concerns like SQL injection, XSS, CSRF, and others ? Answer 'No' (without explaining why) if there are no possible issues. If there are security concerns or issues, start your answer with a short header, such as: 'Sensitive information exposure: ...', 'SQL injection: ...', etc. Explain your answer. Be specific and give examples if possible\")\n\nclass PRReview(BaseModel):\n    review: Review\n=====\n\n\nExample output:\n```yaml\nreview:\n  estimated_effort_to_review_[1-5]: |\n    3\n  relevant_tests: |\n    No\n  key_issues_to_review:\n    - relevant_file: |\n        directory/xxx.py\n      issue_header: |\n        Possible Bug\n      issue_content: |\n        ...\n      start_line: 12\n      end_line: 14\n    - ...\n  security_concerns: |\n    No\n```\n\nAnswer should be a valid YAML, and nothing else. Each YAML output MUST be after a newline, with proper indent, and block scalar indicator ('|')", "user": "\n\n\n--PR Info--\n\nToday's Date: 2025-12-11\n\nTitle: 'Fix: Search UX and multi-filter logic (frontend)'\n\nBranch: 'feature/initial-fixes'\n\nPR Description:\n======\n- Improved search bar UX in app/search/page.tsx:\r\n  - X icon clears input and refocuses\r\n  - Escape key clears input\r\n  - Enter key triggers search\r\n\r\n- Updated filter count logic:\r\n  - Accurately counts all active filters\r\n  - Apply button badge reflects true total\n======\n\n\nThe PR code diff:\n======\n## File: 'app/search/page.tsx'\n\n@@ -1,7 +1,8 @@\n__new hunk__\n1  \"use client\"\n2  \n3 +import { useState, useEffect, useMemo, useRef } from \"react\"\n4 +// import { X } from \"lucide-react\"\n5  import { useSearchParams, useRouter } from \"next/navigation\"\n6  import { useQuery } from \"@tanstack/react-query\"\n7  import { Input } from \"@/components/ui/input\"\n8  import { Button } from \"@/components/ui/button\"\n__old hunk__\n \"use client\"\n \n-import { useState, useEffect, useMemo } from \"react\"\n import { useSearchParams, useRouter } from \"next/navigation\"\n import { useQuery } from \"@tanstack/react-query\"\n import { Input } from \"@/components/ui/input\"\n import { Button } from \"@/components/ui/button\"\n\n@@ -41,11 +42,12 @@\n__new hunk__\n42  export default function SearchPage() {\n43    const searchParams = useSearchParams()\n44    const router = useRouter()\n45    const { filters, setFilters, resetFilters } = useFilters()\n46    const { settings } = useSettings()\n47  \n48    const [searchQuery, setSearchQuery] = useState(searchParams.get(\"q\") || filters.q || \"\")\n49 +  const inputRef = useRef(null);\n50    const [sortBy, setSortBy] = useState(settings.behavior.defaultSort || \"time\")\n51    const [filtersOpen, setFiltersOpen] = useState(false)\n52  \n53    // Update search query from URL params\n\n@@ -75,29 +77,54 @@ export default function SearchPage() {\n__new hunk__\n77        filters.fiberMin > 0 ||\n78        filters.sugarMax < 100 ||\n79        filters.sodiumMax < 4000 ||\n80        filters.maxTime < 120 ||\n81        !!filters.mealType\n82      )\n83    }, [filters])\n84  \n85 +  // const activeFilterCount = useMemo(() => {\n86 +  //   let count = 0\n87 +  //   if (filters.dietaryRestrictions.length > 0) count++\n88 +  //   if (filters.allergens.length > 0) count++\n89 +  //   if (filters.cuisines.length > 0) count++\n90 +  //   if (filters.majorConditions.length > 0) count++\n91 +  //   if (filters.calories[0] > 0 || filters.calories[1] < 1200) count++\n92 +  //   if (filters.proteinMin > 0) count++\n93 +  //   if (filters.carbsMin > 0) count++\n94 +  //   if (filters.fatMin > 0) count++\n95 +  //   if (filters.fiberMin > 0) count++\n96 +  //   if (filters.sugarMax < 100) count++\n97 +  //   if (filters.sodiumMax < 4000) count++\n98 +  //   if (filters.maxTime < 120) count++\n99 +  //   if (filters.mealType) count++\n100 +  //   return count\n101 +  // }, [filters])\n102    const activeFilterCount = useMemo(() => {\n103 +    let count = 0;\n104 +\n105 +  // Sum all selected array filters\n106 +    count += filters.dietaryRestrictions.length;\n107 +    count += filters.allergens.length;\n108 +    count += filters.cuisines.length;\n109 +    count += filters.majorConditions.length;\n110 +\n111 +    // Range and min/max filters\n112 +    if (filters.calories[0] > 0) count++; // Min calories\n113 +    if (filters.calories[1] < 1200) count++; // Max calories\n114 +    if (filters.proteinMin > 0) count++;\n115 +    if (filters.carbsMin > 0) count++;\n116 +    if (filters.fatMin > 0) count++;\n117 +    if (filters.fiberMin > 0) count++;\n118 +    if (filters.sugarMax < 100) count++;\n119 +    if (filters.sodiumMax < 4000) count++;\n120 +    if (filters.maxTime < 120) count++;\n121 +    \n122 +    // Single-value selection\n123 +    if (filters.mealType) count++;\n124 +\n125 +    return count;\n126 +  }, [filters]);\n127  \n128    const {\n129      data: searchResults = [],\n130      isLoading,\n__old hunk__\n       filters.fiberMin > 0 ||\n       filters.sugarMax < 100 ||\n       filters.sodiumMax < 4000 ||\n       filters.maxTime < 120 ||\n       !!filters.mealType\n     )\n   }, [filters])\n \n   const activeFilterCount = useMemo(() => {\n-    let count = 0\n-    if (filters.dietaryRestrictions.length > 0) count++\n-    if (filters.allergens.length > 0) count++\n-    if (filters.cuisines.length > 0) count++\n-    if (filters.majorConditions.length > 0) count++\n-    if (filters.calories[0] > 0 || filters.calories[1] < 1200) count++\n-    if (filters.proteinMin > 0) count++\n-    if (filters.carbsMin > 0) count++\n-    if (filters.fatMin > 0) count++\n-    if (filters.fiberMin > 0) count++\n-    if (filters.sugarMax < 100) count++\n-    if (filters.sodiumMax < 4000) count++\n-    if (filters.maxTime < 120) count++\n-    if (filters.mealType) count++\n-    return count\n-  }, [filters])\n \n   const {\n     data: searchResults = [],\n     isLoading,\n\n@@ -113,12 +140,22 @@ export default function SearchPage() {\n__new hunk__\n140          const rankedResults = rank(rawResults, settings)\n141          return rankedResults\n142        }\n143  \n144        return rawResults.map((recipe) => ({ ...recipe, score: 0 }))\n145      },\n146      enabled: !!(searchQuery || hasActiveFilters),\n147    })\n148 +  const handleSearchInputKeyDown = (e: React.KeyboardEvent) => {\n149 +    if (e.key === \"Escape\" && searchQuery) {\n150 +      setSearchQuery(\"\");\n151 +      inputRef.current?.focus();\n152 +    }\n153 +    if (e.key === \"Enter\") {\n154 +      handleSearch(searchQuery);\n155 +    }\n156 +  };\n157 +\n158  \n159    const handleSearch = (query: string) => {\n160      setSearchQuery(query)\n161      setFilters({ ...filters, q: query })\n\n@@ -182,13 +219,13 @@ export default function SearchPage() {\n__new hunk__\n219    return (\n220      \n221        \n222          {/* Search Header */}\n223          \n224            Search Recipes\n225  \n226            {/* Search Input */}\n227 +          {/* \n228              \n229              \n       \n         {/* Search Header */}\n         \n           Search Recipes\n \n           {/* Search Input */}\n-          \n             \n              setSearchQuery(e.target.value)}\n234                onKeyDown={(e) => e.key === \"Enter\" && handleSearch(searchQuery)}\n235                className=\"pl-10 pr-4 h-12 text-lg\"\n236              />\n237 +           */}\n238 +          \n239 +            \n240 +             setSearchQuery(e.target.value)}\n246 +              onKeyDown={handleSearchInputKeyDown}\n247 +              style={{ paddingRight: searchQuery ? \"2rem\" : undefined, width: \"100%\" }}\n248 +              className=\"pl-10 pr-4 h-12 text-lg\"\n249 +            />\n250 +            {searchQuery && (\n251 +               {\n266 +                  setSearchQuery(\"\");\n267 +                  inputRef.current?.focus();\n268 +              }}\n269 +              >\n270 +                \n271 +            \n272 +          )}\n273            \n274  \n275 +\n276            {/* Search Actions */}\n277            \n278               handleSearch(searchQuery)} size=\"sm\">\n279                Search\n\n\n## File: 'components/filter-panel.tsx'\n\n@@ -54,35 +54,58 @@\n__new hunk__\n54  export function FilterPanel({ open, onOpenChange, initialValues, onApply, onReset }: FilterPanelProps) {\n55    const form = useForm({\n56      resolver: zodResolver(schema),\n57      // provide full defaults (OUTPUT fits into INPUT just fine)\n58      defaultValues: schema.parse(initialValues ?? {}),\n59      mode: \"onChange\",\n60    })\n61  \n62     useEffect(() => {\n63      form.reset(schema.parse(initialValues ?? {}));\n64    }, [open, initialValues, form]);\n65  \n66 +  // function getActiveFiltersCount(): number {\n67 +  //   const values = form.getValues()\n68 +  //   let count = 0\n69 +  //   if ((values.dietaryRestrictions || []).length > 0) count++\n70 +  //   if ((values.allergens || []).length > 0) count++\n71 +  //   if ((values.cuisines || []).length > 0) count++\n72 +  //   if ((values.majorConditions || []).length > 0) count++\n73 +  //   if (values.calories && (values.calories[0] > 0 || values.calories[1] < 1200)) count++\n74 +  //   if ((values.proteinMin || 0) > 0) count++\n75 +  //   if ((values.carbsMin || 0) > 0) count++\n76 +  //   if ((values.fatMin || 0) > 0) count++\n77 +  //   if ((values.fiberMin || 0) > 0) count++\n78 +  //   if ((values.sugarMax || 100) < 100) count++\n79 +  //   if ((values.sodiumMax || 4000) < 4000) count++\n80 +  //  2025-12-11T06:55:50.227194686Z  if ((values.maxTime || 120) < 120) count++\n81 +  //   if ((values.mealType || \"\") !== \"\") count++\n82 +  //   return count\n83 +  // }\n84    function getActiveFiltersCount(): number {\n85 +    const values = form.getValues();\n86 +    let count = 0;\n87 +\n88 +    // Count all selected array filters individually\n89 +    count += values.dietaryRestrictions.length;\n90 +    count += values.allergens.length;\n91 +    count += values.cuisines.length;\n92 +    count += values.majorConditions.length;\n93 +\n94 +    // Numeric and single-value filters\n95 +    if (values.calories[0] > 0) count++;           // Min calories\n96 +    if (values.calories[1] < 1200) count++;        // Max calories\n97 +    if (values.proteinMin > 0) count++;\n98 +    if (values.carbsMin > 0) count++;\n99 +    if (values.fatMin > 0) count++;\n100 +    if (values.fiberMin > 0) count++;\n101 +    if (values.sugarMax < 100) count++;\n102 +    if (values.sodiumMax < 4000) count++;\n103 +    if (values.maxTime < 120) count++;\n104 +    if (values.mealType) count++;\n105 +\n106 +    return count;\n107    }\n108    function handleApply() {\n109      const values = schema.parse(form.getValues())\n110      onApply(values)\n111      onOpenChange(false)\n__old hunk__\n export function FilterPanel({ open, onOpenChange, initialValues, onApply, onReset }: FilterPanelProps) {\n   const form = useForm({\n     resolver: zodResolver(schema),\n     // provide full defaults (OUTPUT fits into INPUT just fine)\n     defaultValues: schema.parse(initialValues ?? {}),\n     mode: \"onChange\",\n   })\n \n    useEffect(() => {\n     form.reset(schema.parse(initialValues ?? {}));\n   }, [open, initialValues, form]);\n \n   function getActiveFiltersCount(): number {\n-    const values = form.getValues()\n-    let count = 0\n-    if ((values.dietaryRestrictions || []).length > 0) count++\n-    if ((values.allergens || []).length > 0) count++\n-    if ((values.cuisines || []).length > 0) count++\n-    if ((values.majorConditions || []).length > 0) count++\n-    if (values.calories && (values.calories[0] > 0 || values.calories[1] < 1200)) count++\n-    if ((values.proteinMin || 0) > 0) count++\n-    if ((values.carbsMin || 0) > 0) count++\n-    if ((values.fatMin || 0) > 0) count++\n-    if ((values.fiberMin || 0) > 0) count++\n-    if ((values.sugarMax || 100) < 100) count++\n-    if ((values.sodiumMax || 4000) < 4000) count++\n-    if ((values.maxTime || 120) < 120) count++\n-    if ((values.mealType || \"\") !== \"\") count++\n-    return count\n   }\n-\n   function handleApply() {\n     const values = schema.parse(form.getValues())\n     onApply(values)\n     onOpenChange(false)\n======\n\n\nResponse (should be a valid YAML, and nothing else):\n```yaml"}}, "file": {"name": "litellm_ai_handler.py", "path": "/app/pr_agent/algo/ai_handlers/litellm_ai_handler.py"}, "function": "chat_completion", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 397, "message": "Prompts", "module": "litellm_ai_handler", "name": "pr_agent.algo.ai_handlers.litellm_ai_handler", "process": {"id": 18, "name": "MainProcess"}, "thread": {"id": 136556055251840, "name": "MainThread"}, "time": {"repr": "2025-12-11 06:55:50.226620+00:00", "timestamp": 1765436150.22662}}}
2025-Dec-11 06:55:50.227360
{"text": "LiteLLM call model='openai/gpt-5-nano'\n", "record": {"elapsed": {"repr": "0:03:18.835112", "seconds": 198.835112}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "e928b569bf6b4265b9eb2a652d5c4f10", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "litellm_ai_handler.py", "path": "/app/pr_agent/algo/ai_handlers/litellm_ai_handler.py"}, "function": "chat_completion", "level": {"icon": "âš ï¸", "name": "WARNING", "no": 30}, "line": 426, "message": "LiteLLM call model='openai/gpt-5-nano'", "module": "litellm_ai_handler", "name": "pr_agent.algo.ai_handlers.litellm_ai_handler", "process": {"id": 18, "name": "MainProcess"}, "thread": {"id": 136556055251840, "name": "MainThread"}, "time": {"repr": "2025-12-11 06:55:50.227155+00:00", "timestamp": 1765436150.227155}}}
2025-Dec-11 06:55:50.227444
{"text": "Using OpenAI client directly for LiteLLM proxy with model: openai/gpt-5-nano\n", "record": {"elapsed": {"repr": "0:03:18.835188", "seconds": 198.835188}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "e928b569bf6b4265b9eb2a652d5c4f10", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "litellm_ai_handler.py", "path": "/app/pr_agent/algo/ai_handlers/litellm_ai_handler.py"}, "function": "_get_completion", "level": {"icon": "â„¹ï¸", "name": "INFO", "no": 20}, "line": 467, "message": "Using OpenAI client directly for LiteLLM proxy with model: openai/gpt-5-nano", "module": "litellm_ai_handler", "name": "pr_agent.algo.ai_handlers.litellm_ai_handler", "process": {"id": 18, "name": "MainProcess"}, "thread": {"id": 136556055251840, "name": "MainThread"}, "time": {"repr": "2025-12-11 06:55:50.227231+00:00", "timestamp": 1765436150.227231}}}
2025-Dec-11 06:56:32.804237
{"text": "\nAI response:\n```yaml\nreview:\n  estimated_effort_to_review_[1-5]: |\n    4\n  relevant_tests: |\n    No\n  key_issues_to_review:\n    - relevant_file: |\n        app/search/page.tsx\n      issue_header: |\n        Missing Icon Imports\n      issue_content: |\n        The lucide-react icons used in the new search UI (X and the Search icon) are referenced in JSX, but the import line is currently commented out. This will cause a compile/runtime error. Ensure you either import X and Search from lucide-react (or replace with lightweight SVGs) and remove the comment, or switch to icons that are already available.\n      start_line: 3\n      end_line: 5\n    - relevant_file: |\n        app/search/page.tsx\n      issue_header: |\n        Input ref forwarding risk\n      issue_content: |\n        The search input is given a ref (inputRef) and passed to a custom Input component. Confirm that the Input component forwards the ref to the underlying input element; otherwise calling focus() on the ref may fail and degrade the UX.\n      start_line: 49\n      end_line: 50\n    - relevant_file: |\n        components/filter-panel.tsx\n      issue_header: |\n        Active filters count logic\n      issue_content: |\n        The new getActiveFiltersCount function aggregates counts across all filter fields to drive the Apply button badge. Verify this matches the UI behavior and edge cases (empty arrays, default numeric ranges). Ensure this function is wired to the badge display and covered by tests.\n      start_line: 66\n      end_line: 107\n  security_concerns: |\n    No\n```\n", "record": {"elapsed": {"repr": "0:04:01.411804", "seconds": 241.411804}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "e928b569bf6b4265b9eb2a652d5c4f10", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1"}, "file": {"name": "litellm_ai_handler.py", "path": "/app/pr_agent/algo/ai_handlers/litellm_ai_handler.py"}, "function": "chat_completion", "level": {"icon": "ðŸž", "name": "DEBUG", "no": 10}, "line": 439, "message": "\nAI response:\n```yaml\nreview:\n  estimated_effort_to_review_[1-5]: |\n    4\n  relevant_tests: |\n    No\n  key_issues_to_review:\n    - relevant_file: |\n        app/search/page.tsx\n      issue_header: |\n        Missing Icon Imports\n      issue_content: |\n        The lucide-react icons used in the new search UI (X and the Search icon) are referenced in JSX, but the import line is currently commented out. This will cause a compile/runtime error. Ensure you either import X and Search from lucide-react (or replace with lightweight SVGs) and remove the comment, or switch to icons that are already available.\n      start_line: 3\n      end_line: 5\n    - relevant_file: |\n        app/search/page.tsx\n      issue_header: |\n        Input ref forwarding risk\n      issue_content: |\n        The search input is given a ref (inputRef) and passed to a custom Input component. Confirm that the Input component forwards the ref to the underlying input element; otherwise calling focus() on the ref may fail and degrade the UX.\n      start_line: 49\n      end_line: 50\n    - relevant_file: |\n        components/filter-panel.tsx\n      issue_header: |\n        Active filters count logic\n      issue_content: |\n        The new getActiveFiltersCount function aggregates counts across all filter fields to drive the Apply button badge. Verify this matches the UI behavior and edge cases (empty arrays, default numeric ranges). Ensure this function is wired to the badge display and covered by tests.\n      start_line: 66\n      end_line: 107\n  security_concerns: |\n    No\n```", "module": "litellm_ai_handler", "name": "pr_agent.algo.ai_handlers.litellm_ai_handler", "process": {"id": 18, "name": "MainProcess"}, "thread": {"id": 136556055251840, "name": "MainThread"}, "time": {"repr": "2025-12-11 06:56:32.803847+00:00", "timestamp": 1765436192.803847}}}
2025-Dec-11 06:56:32.804337
{"text": "Failed to generate prediction with openai/gpt-5-nano\n", "record": {"elapsed": {"repr": "0:04:01.412094", "seconds": 241.412094}, "exception": null, "extra": {"action": "created", "event": "issue_comment", "sender": "souravOD", "server_type": "github_app", "request_id": "e928b569bf6b4265b9eb2a652d5c4f10", "build_number": "unknown", "app_name": "Unknown", "repo": "souravOD/nutri-b2c-frontend", "git_org": "", "installation_id": 92375808, "api_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "command": "review", "pr_url": "https://api.github.com/repos/souravOD/nutri-b2c-frontend/pulls/1", "artifact": {"error": "'dict' object has no attribute 'dict'"}}, "file": {"name": "pr_processing.py", "path": "/app/pr_agent/algo/pr_processing.py"}, "function": "retry_with_fallback_models", "level": {"icon": "âš ï¸", "name": "WARNING", "no": 30}, "line": 333, "message": "Failed to generate prediction with openai/gpt-5-nano", "module": "pr_processing", "name": "pr_agent.algo.pr_processing", "process": {"id": 18, "name": "MainProcess"}, "thread": {"id": 136556055251840, "name": "MainThread"}, "time": {"repr": "2025-12-11 06:56:32.804137+00:00", "timestamp": 1765436192.804137}}}
2025-Dec-11 06:56:32.804344
